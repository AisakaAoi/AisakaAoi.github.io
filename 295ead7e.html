<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0"><meta name="baidu-site-verification" content="code-KCMz4b3cnd"><meta name="google-site-verification" content="MTp8U7dJ1uzrfz8Mu6rgqX1CIm3HjqPWd0xaRcv1tFg"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="mask-icon" href="/images/favicon.png" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"aisakaaoi.github.io",root:"/",scheme:"Pisces",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:"valine",storage:!0,lazyload:!1,nav:null,activeClass:"valine"},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="ğŸ“– å¼€ç¯‡è¯­è¿˜è®°å¾—ä½ ç¬¬ä¸€æ¬¡å‘é¢†å¯¼æ±‡æŠ¥è´¢åŠ¡æ•°æ®çš„æƒ…æ™¯å—ï¼Ÿ  Excelè¡¨æ ¼åšå¥½äº†ï¼Œä½†è€æ¿è¯´ï¼šâ€œè¿™äº›æ•°æ®æˆ‘çœ‹ä¸æ‡‚ï¼Œç»™æˆ‘åšä¸ªå›¾è¡¨ï¼â€äºæ˜¯ä½ å¼€å§‹å­¦ä¹ æ’å…¥å›¾è¡¨ã€è°ƒæ•´é¢œè‰²ã€è®¾ç½®æ ¼å¼â€¦åšå®Œåå‘ç°ï¼šæ•°æ®æ›´æ–°äº†ï¼Œå›¾è¡¨åˆè¦é‡æ–°åšä¸€éï¼  ä»Šå¤©æˆ‘ä»¬è¦å­¦çš„ï¼Œå°±æ˜¯è®©Pythonå¸®ä½ è‡ªåŠ¨ç”Ÿæˆä¸“ä¸šçš„æ•°æ®æŠ¥å‘Šã€‚æ•°æ®æ›´æ–°äº†ï¼Ÿè¿è¡Œä¸€ä¸‹ä»£ç ï¼Œå…¨æ–°çš„æŠ¥å‘Šå°±ç”Ÿæˆäº†ï¼ ä½ ä¼šå‘ç°ï¼š  å‡ è¡Œä»£ç å°±èƒ½ç”Ÿæˆæ¼‚äº®çš„å›¾è¡¨ Excelèƒ½åšçš„å›¾è¡¨ï¼ŒPyth"><meta property="og:type" content="article"><meta property="og:title" content="Python-ç¬¬12ç¯‡ã€Šåˆ¶ä½œä½ çš„ç¬¬ä¸€ä¸ªæ•°æ®æŠ¥å‘Šã€‹"><meta property="og:url" content="https://aisakaaoi.github.io/295ead7e.html"><meta property="og:site_name" content="é€¢å‚è‘µçš„ä¸ªäººåšå®¢"><meta property="og:description" content="ğŸ“– å¼€ç¯‡è¯­è¿˜è®°å¾—ä½ ç¬¬ä¸€æ¬¡å‘é¢†å¯¼æ±‡æŠ¥è´¢åŠ¡æ•°æ®çš„æƒ…æ™¯å—ï¼Ÿ  Excelè¡¨æ ¼åšå¥½äº†ï¼Œä½†è€æ¿è¯´ï¼šâ€œè¿™äº›æ•°æ®æˆ‘çœ‹ä¸æ‡‚ï¼Œç»™æˆ‘åšä¸ªå›¾è¡¨ï¼â€äºæ˜¯ä½ å¼€å§‹å­¦ä¹ æ’å…¥å›¾è¡¨ã€è°ƒæ•´é¢œè‰²ã€è®¾ç½®æ ¼å¼â€¦åšå®Œåå‘ç°ï¼šæ•°æ®æ›´æ–°äº†ï¼Œå›¾è¡¨åˆè¦é‡æ–°åšä¸€éï¼  ä»Šå¤©æˆ‘ä»¬è¦å­¦çš„ï¼Œå°±æ˜¯è®©Pythonå¸®ä½ è‡ªåŠ¨ç”Ÿæˆä¸“ä¸šçš„æ•°æ®æŠ¥å‘Šã€‚æ•°æ®æ›´æ–°äº†ï¼Ÿè¿è¡Œä¸€ä¸‹ä»£ç ï¼Œå…¨æ–°çš„æŠ¥å‘Šå°±ç”Ÿæˆäº†ï¼ ä½ ä¼šå‘ç°ï¼š  å‡ è¡Œä»£ç å°±èƒ½ç”Ÿæˆæ¼‚äº®çš„å›¾è¡¨ Excelèƒ½åšçš„å›¾è¡¨ï¼ŒPyth"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2026-01-30T21:53:14.000Z"><meta property="article:modified_time" content="2026-01-30T22:01:13.665Z"><meta property="article:author" content="Aisaka Aoi"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://aisakaaoi.github.io/295ead7e.html"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>Python-ç¬¬12ç¯‡ã€Šåˆ¶ä½œä½ çš„ç¬¬ä¸€ä¸ªæ•°æ®æŠ¥å‘Šã€‹ | é€¢å‚è‘µçš„ä¸ªäººåšå®¢</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?7308ed05421777c301eefa3754da1b42",document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="é€¢å‚è‘µçš„ä¸ªäººåšå®¢" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ "><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">aoiå­¦é™¢</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">Aisaka's Blog, School of Aoi, Aisaka University</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»<span class="badge">20</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£<span class="badge">1023</span></a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="æœç´¢..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="reading-progress-bar"></div><a href="https://github.com/AisakaAoi" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://aisakaaoi.github.io/295ead7e.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/manatsu.jpg"><meta itemprop="name" content="Aisaka Aoi"><meta itemprop="description" content="Aisaka's Blog, School of Aoi, Aisaka University"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="é€¢å‚è‘µçš„ä¸ªäººåšå®¢"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Python-ç¬¬12ç¯‡ã€Šåˆ¶ä½œä½ çš„ç¬¬ä¸€ä¸ªæ•°æ®æŠ¥å‘Šã€‹</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">å‘è¡¨äº</span> <time title="åˆ›å»ºæ—¶é—´ï¼š2026-01-31 05:53:14" itemprop="dateCreated datePublished" datetime="2026-01-31T05:53:14+08:00">2026-01-31</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">åˆ†ç±»äº</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%F0%9F%8C%99%E9%80%A2%E5%9D%82%E6%9D%82%E8%B0%88%E4%B8%8E%E6%90%AC%E8%BF%90/" itemprop="url" rel="index"><span itemprop="name">ğŸŒ™é€¢å‚æ‚è°ˆä¸æ¬è¿</span></a> </span>ï¼Œ <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%F0%9F%8C%99%E9%80%A2%E5%9D%82%E6%9D%82%E8%B0%88%E4%B8%8E%E6%90%AC%E8%BF%90/%E2%AD%90%E6%9E%9C%E6%9E%9C%E8%AF%BE%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">â­æœæœè¯¾ç¨‹</span></a> </span></span><span id="/295ead7e.html" class="post-meta-item leancloud_visitors" data-flag-title="Python-ç¬¬12ç¯‡ã€Šåˆ¶ä½œä½ çš„ç¬¬ä¸€ä¸ªæ•°æ®æŠ¥å‘Šã€‹" title="é˜…è¯»æ¬¡æ•°"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span> <span class="leancloud-visitors-count"></span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Valineï¼š</span> <a title="valine" href="/295ead7e.html#valine-comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/295ead7e.html" itemprop="commentCount"></span></a></span><br><span class="post-meta-item" title="æœ¬æ–‡å­—æ•°"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span> <span>70k</span> </span><span class="post-meta-item" title="é˜…è¯»æ—¶é•¿"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span> <span>2:55</span></span></div></header><div class="post-body" itemprop="articleBody"><h3 id="ğŸ“–-å¼€ç¯‡è¯­"><a href="#ğŸ“–-å¼€ç¯‡è¯­" class="headerlink" title="ğŸ“– å¼€ç¯‡è¯­"></a>ğŸ“– å¼€ç¯‡è¯­</h3><p>è¿˜è®°å¾—ä½ ç¬¬ä¸€æ¬¡å‘é¢†å¯¼æ±‡æŠ¥è´¢åŠ¡æ•°æ®çš„æƒ…æ™¯å—ï¼Ÿ</p><blockquote><p>Excelè¡¨æ ¼åšå¥½äº†ï¼Œä½†è€æ¿è¯´ï¼šâ€œè¿™äº›æ•°æ®æˆ‘çœ‹ä¸æ‡‚ï¼Œç»™æˆ‘åšä¸ªå›¾è¡¨ï¼â€<br>äºæ˜¯ä½ å¼€å§‹å­¦ä¹ æ’å…¥å›¾è¡¨ã€è°ƒæ•´é¢œè‰²ã€è®¾ç½®æ ¼å¼â€¦<br>åšå®Œåå‘ç°ï¼šæ•°æ®æ›´æ–°äº†ï¼Œå›¾è¡¨åˆè¦é‡æ–°åšä¸€éï¼</p></blockquote><p>ä»Šå¤©æˆ‘ä»¬è¦å­¦çš„ï¼Œå°±æ˜¯è®©Pythonå¸®ä½ è‡ªåŠ¨ç”Ÿæˆä¸“ä¸šçš„æ•°æ®æŠ¥å‘Šã€‚<br>æ•°æ®æ›´æ–°äº†ï¼Ÿè¿è¡Œä¸€ä¸‹ä»£ç ï¼Œå…¨æ–°çš„æŠ¥å‘Šå°±ç”Ÿæˆäº†ï¼</p><p><strong>ä½ ä¼šå‘ç°ï¼š</strong></p><ul><li>å‡ è¡Œä»£ç å°±èƒ½ç”Ÿæˆæ¼‚äº®çš„å›¾è¡¨</li><li>Excelèƒ½åšçš„å›¾è¡¨ï¼ŒPythonéƒ½èƒ½åšï¼Œè€Œä¸”æ›´å¥½çœ‹</li><li>å¯ä»¥ä¸€é”®å¯¼å‡ºPDFã€Excelã€PPTç­‰å¤šç§æ ¼å¼</li></ul><span id="more"></span><hr><h3 id="ğŸ¯-ä»Šæ—¥å­¦ä¹ ç›®æ ‡"><a href="#ğŸ¯-ä»Šæ—¥å­¦ä¹ ç›®æ ‡" class="headerlink" title="ğŸ¯ ä»Šæ—¥å­¦ä¹ ç›®æ ‡"></a>ğŸ¯ ä»Šæ—¥å­¦ä¹ ç›®æ ‡</h3><ul><li>å­¦ä¼šç”¨Pythonç”Ÿæˆå„ç§å›¾è¡¨ï¼ˆæŸ±çŠ¶å›¾ã€æŠ˜çº¿å›¾ã€é¥¼å›¾ï¼‰</li><li>æŒæ¡æ•°æ®æŠ¥å‘Šçš„å¯¼å‡ºæ–¹æ³•</li><li>å®æˆ˜åˆ¶ä½œä¸ªäººç†è´¢å¹´åº¦æŠ¥å‘Š</li></ul><hr><h3 id="ğŸ“Š-å›¾è¡¨ç”Ÿæˆï¼šè®©æ•°æ®â€œå¯è§†åŒ–â€"><a href="#ğŸ“Š-å›¾è¡¨ç”Ÿæˆï¼šè®©æ•°æ®â€œå¯è§†åŒ–â€" class="headerlink" title="ğŸ“Š å›¾è¡¨ç”Ÿæˆï¼šè®©æ•°æ®â€œå¯è§†åŒ–â€"></a>ğŸ“Š å›¾è¡¨ç”Ÿæˆï¼šè®©æ•°æ®â€œå¯è§†åŒ–â€</h3><p><strong>å‡†å¤‡å·¥ä½œï¼šå®‰è£…å¿…è¦çš„åº“</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…ç»˜å›¾åº“</span></span><br><span class="line">pip install matplotlib seaborn openpyxl</span><br></pre></td></tr></table></figure><p><strong>åˆ›å»ºç¤ºä¾‹æ•°æ®ï¼šä¸ªäººç†è´¢æ•°æ®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, timedelta</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line">warnings.filterwarnings(<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®ä¸­æ–‡å­—ä½“ï¼ˆè§£å†³ä¸­æ–‡æ˜¾ç¤ºé—®é¢˜ï¼‰</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]  <span class="comment"># ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span>   <span class="comment"># ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºè´Ÿå·</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»º2024å¹´ä¸ªäººç†è´¢æ•°æ®</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=== åˆ›å»ºä¸ªäººç†è´¢æ•°æ® ===&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆ12ä¸ªæœˆçš„æ”¶å…¥å’Œæ”¯å‡ºæ•°æ®</span></span><br><span class="line">æœˆä»½åˆ—è¡¨ = [<span class="string">&#x27;1æœˆ&#x27;</span>, <span class="string">&#x27;2æœˆ&#x27;</span>, <span class="string">&#x27;3æœˆ&#x27;</span>, <span class="string">&#x27;4æœˆ&#x27;</span>, <span class="string">&#x27;5æœˆ&#x27;</span>, <span class="string">&#x27;6æœˆ&#x27;</span>, <span class="string">&#x27;7æœˆ&#x27;</span>, <span class="string">&#x27;8æœˆ&#x27;</span>, <span class="string">&#x27;9æœˆ&#x27;</span>, <span class="string">&#x27;10æœˆ&#x27;</span>, <span class="string">&#x27;11æœˆ&#x27;</span>, <span class="string">&#x27;12æœˆ&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœˆåº¦æ”¶å…¥æ•°æ®ï¼ˆå·¥èµ„+æŠ•èµ„æ”¶ç›Š+å…¶ä»–ï¼‰</span></span><br><span class="line">æœˆåº¦æ”¶å…¥ = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;æœˆä»½&#x27;</span>: æœˆä»½åˆ—è¡¨,</span><br><span class="line">    <span class="string">&#x27;å·¥èµ„æ”¶å…¥&#x27;</span>: [<span class="number">15000</span>, <span class="number">15000</span>, <span class="number">15000</span>, <span class="number">15000</span>, <span class="number">15000</span>, <span class="number">15000</span>, <span class="number">15000</span>, <span class="number">15000</span>, <span class="number">15000</span>, <span class="number">15000</span>, <span class="number">15000</span>, <span class="number">15000</span>],</span><br><span class="line">    <span class="string">&#x27;æŠ•èµ„æ”¶ç›Š&#x27;</span>: [<span class="number">1200</span>, <span class="number">800</span>, <span class="number">1500</span>, <span class="number">2000</span>, <span class="number">1800</span>, <span class="number">2200</span>, <span class="number">2500</span>, <span class="number">1800</span>, <span class="number">1600</span>, <span class="number">2100</span>, <span class="number">1900</span>, <span class="number">2300</span>],</span><br><span class="line">    <span class="string">&#x27;å…¶ä»–æ”¶å…¥&#x27;</span>: [<span class="number">500</span>, <span class="number">300</span>, <span class="number">800</span>, <span class="number">600</span>, <span class="number">400</span>, <span class="number">700</span>, <span class="number">900</span>, <span class="number">500</span>, <span class="number">600</span>, <span class="number">800</span>, <span class="number">700</span>, <span class="number">1000</span>],</span><br><span class="line">    <span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>: <span class="number">0</span>  <span class="comment"># å¾…è®¡ç®—</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—æ€»æ”¶å…¥</span></span><br><span class="line">æœˆåº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>] = æœˆåº¦æ”¶å…¥[[<span class="string">&#x27;å·¥èµ„æ”¶å…¥&#x27;</span>, <span class="string">&#x27;æŠ•èµ„æ”¶ç›Š&#x27;</span>, <span class="string">&#x27;å…¶ä»–æ”¶å…¥&#x27;</span>]].<span class="built_in">sum</span>(axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœˆåº¦æ”¯å‡ºæ•°æ®</span></span><br><span class="line">æœˆåº¦æ”¯å‡º = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;æœˆä»½&#x27;</span>: æœˆä»½åˆ—è¡¨,</span><br><span class="line">    <span class="string">&#x27;ç”Ÿæ´»è´¹ç”¨&#x27;</span>: [<span class="number">6000</span>, <span class="number">5500</span>, <span class="number">5800</span>, <span class="number">6200</span>, <span class="number">5900</span>, <span class="number">6100</span>, <span class="number">6300</span>, <span class="number">6000</span>, <span class="number">5800</span>, <span class="number">6200</span>, <span class="number">6000</span>, <span class="number">6500</span>],</span><br><span class="line">    <span class="string">&#x27;æˆ¿ç§Ÿ/æˆ¿è´·&#x27;</span>: [<span class="number">3500</span>, <span class="number">3500</span>, <span class="number">3500</span>, <span class="number">3500</span>, <span class="number">3500</span>, <span class="number">3500</span>, <span class="number">3500</span>, <span class="number">3500</span>, <span class="number">3500</span>, <span class="number">3500</span>, <span class="number">3500</span>, <span class="number">3500</span>],</span><br><span class="line">    <span class="string">&#x27;äº¤é€šè´¹ç”¨&#x27;</span>: [<span class="number">800</span>, <span class="number">750</span>, <span class="number">820</span>, <span class="number">900</span>, <span class="number">780</span>, <span class="number">850</span>, <span class="number">920</span>, <span class="number">800</span>, <span class="number">760</span>, <span class="number">880</span>, <span class="number">820</span>, <span class="number">950</span>],</span><br><span class="line">    <span class="string">&#x27;å¨±ä¹æ¶ˆè´¹&#x27;</span>: [<span class="number">1200</span>, <span class="number">1000</span>, <span class="number">1500</span>, <span class="number">1800</span>, <span class="number">1300</span>, <span class="number">1600</span>, <span class="number">2000</span>, <span class="number">1400</span>, <span class="number">1200</span>, <span class="number">1700</span>, <span class="number">1500</span>, <span class="number">2200</span>],</span><br><span class="line">    <span class="string">&#x27;å­¦ä¹ åŸ¹è®­&#x27;</span>: [<span class="number">500</span>, <span class="number">800</span>, <span class="number">600</span>, <span class="number">1200</span>, <span class="number">700</span>, <span class="number">900</span>, <span class="number">1100</span>, <span class="number">600</span>, <span class="number">800</span>, <span class="number">1000</span>, <span class="number">900</span>, <span class="number">1300</span>],</span><br><span class="line">    <span class="string">&#x27;å…¶ä»–æ”¯å‡º&#x27;</span>: [<span class="number">300</span>, <span class="number">200</span>, <span class="number">400</span>, <span class="number">500</span>, <span class="number">350</span>, <span class="number">450</span>, <span class="number">600</span>, <span class="number">350</span>, <span class="number">300</span>, <span class="number">500</span>, <span class="number">400</span>, <span class="number">700</span>],</span><br><span class="line">    <span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>: <span class="number">0</span>  <span class="comment"># å¾…è®¡ç®—</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—æ€»æ”¯å‡º</span></span><br><span class="line">æœˆåº¦æ”¯å‡º[<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>] = æœˆåº¦æ”¯å‡º[[<span class="string">&#x27;ç”Ÿæ´»è´¹ç”¨&#x27;</span>, <span class="string">&#x27;æˆ¿ç§Ÿ/æˆ¿è´·&#x27;</span>, <span class="string">&#x27;äº¤é€šè´¹ç”¨&#x27;</span>, <span class="string">&#x27;å¨±ä¹æ¶ˆè´¹&#x27;</span>, <span class="string">&#x27;å­¦ä¹ åŸ¹è®­&#x27;</span>, <span class="string">&#x27;å…¶ä»–æ”¯å‡º&#x27;</span>]].<span class="built_in">sum</span>(axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—æœˆåº¦ç»“ä½™</span></span><br><span class="line">æœˆåº¦ç»“ä½™ = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;æœˆä»½&#x27;</span>: æœˆä»½åˆ—è¡¨,</span><br><span class="line">    <span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>: æœˆåº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>: æœˆåº¦æ”¯å‡º[<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>: æœˆåº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>] - æœˆåº¦æ”¯å‡º[<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;ç»“ä½™ç‡&#x27;</span>: (æœˆåº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>] - æœˆåº¦æ”¯å‡º[<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>]) / æœˆåº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>] * <span class="number">100</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;âœ… ä¸ªäººç†è´¢æ•°æ®åˆ›å»ºå®Œæˆï¼&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æœˆåº¦ç»“ä½™é¢„è§ˆï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(æœˆåº¦ç»“ä½™.head())</span><br></pre></td></tr></table></figure><p><strong>åŸºç¡€å›¾è¡¨åˆ¶ä½œï¼ˆæ¯”Excelæ›´ä¸“ä¸šï¼‰</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n=== åŸºç¡€å›¾è¡¨åˆ¶ä½œ ===&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®å›¾è¡¨æ ·å¼</span></span><br><span class="line">plt.style.use(<span class="string">&#x27;seaborn-v0_8&#x27;</span>)  <span class="comment"># ä½¿ç”¨ä¸“ä¸šå›¾è¡¨æ ·å¼</span></span><br><span class="line">sns.set_palette(<span class="string">&quot;husl&quot;</span>)        <span class="comment"># è®¾ç½®é¢œè‰²æ–¹æ¡ˆ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. æœˆåº¦æ”¶æ”¯æŠ˜çº¿å›¾</span></span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>, <span class="number">6</span>))</span><br><span class="line">plt.plot(æœˆåº¦æ”¶å…¥[<span class="string">&#x27;æœˆä»½&#x27;</span>], æœˆåº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>], marker=<span class="string">&#x27;o&#x27;</span>, linewidth=<span class="number">3</span>, label=<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>, color=<span class="string">&#x27;#2E8B57&#x27;</span>)</span><br><span class="line">plt.plot(æœˆåº¦æ”¯å‡º[<span class="string">&#x27;æœˆä»½&#x27;</span>], æœˆåº¦æ”¯å‡º[<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>], marker=<span class="string">&#x27;s&#x27;</span>, linewidth=<span class="number">3</span>, label=<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>, color=<span class="string">&#x27;#DC143C&#x27;</span>)</span><br><span class="line">plt.plot(æœˆåº¦ç»“ä½™[<span class="string">&#x27;æœˆä»½&#x27;</span>], æœˆåº¦ç»“ä½™[<span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>], marker=<span class="string">&#x27;^&#x27;</span>, linewidth=<span class="number">3</span>, label=<span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>, color=<span class="string">&#x27;#4169E1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">&#x27;2024å¹´æœˆåº¦æ”¶æ”¯æƒ…å†µ&#x27;</span>, fontsize=<span class="number">16</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>, pad=<span class="number">20</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;æœˆä»½&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;é‡‘é¢ï¼ˆå…ƒï¼‰&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">plt.legend(fontsize=<span class="number">12</span>)</span><br><span class="line">plt.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line">plt.xticks(rotation=<span class="number">45</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ æ•°å€¼æ ‡ç­¾</span></span><br><span class="line"><span class="keyword">for</span> i, (æœˆä»½, æ”¶å…¥, æ”¯å‡º, ç»“ä½™) <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">zip</span>(æœˆåº¦æ”¶å…¥[<span class="string">&#x27;æœˆä»½&#x27;</span>], æœˆåº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>], æœˆåº¦æ”¯å‡º[<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>], æœˆåº¦ç»“ä½™[<span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>])):</span><br><span class="line">    plt.annotate(<span class="string">f&#x27;<span class="subst">&#123;æ”¶å…¥:,&#125;</span>&#x27;</span>, (i, æ”¶å…¥), textcoords=<span class="string">&quot;offset points&quot;</span>, xytext=(<span class="number">0</span>,<span class="number">10</span>), ha=<span class="string">&#x27;center&#x27;</span>, fontsize=<span class="number">9</span>)</span><br><span class="line">    plt.annotate(<span class="string">f&#x27;<span class="subst">&#123;æ”¯å‡º:,&#125;</span>&#x27;</span>, (i, æ”¯å‡º), textcoords=<span class="string">&quot;offset points&quot;</span>, xytext=(<span class="number">0</span>,-<span class="number">15</span>), ha=<span class="string">&#x27;center&#x27;</span>, fontsize=<span class="number">9</span>)</span><br><span class="line"></span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.savefig(<span class="string">&#x27;æœˆåº¦æ”¶æ”¯æŠ˜çº¿å›¾.png&#x27;</span>, dpi=<span class="number">300</span>, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;âœ… æœˆåº¦æ”¶æ”¯æŠ˜çº¿å›¾å·²ç”Ÿæˆï¼&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. æ”¯å‡ºåˆ†ç±»æŸ±çŠ¶å›¾</span></span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‡†å¤‡æ•°æ®</span></span><br><span class="line">æ”¯å‡ºæ˜ç»† = æœˆåº¦æ”¯å‡º.drop([<span class="string">&#x27;æœˆä»½&#x27;</span>, <span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>], axis=<span class="number">1</span>)</span><br><span class="line">æ”¯å‡ºåˆ†ç±» = æ”¯å‡ºæ˜ç»†.<span class="built_in">sum</span>().sort_values(ascending=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºæŸ±çŠ¶å›¾</span></span><br><span class="line">bars = plt.bar(æ”¯å‡ºåˆ†ç±».index, æ”¯å‡ºåˆ†ç±».values, color=[<span class="string">&#x27;#FF6B6B&#x27;</span>, <span class="string">&#x27;#4ECDC4&#x27;</span>, <span class="string">&#x27;#45B7D1&#x27;</span>, <span class="string">&#x27;#96CEB4&#x27;</span>, <span class="string">&#x27;#FECA57&#x27;</span>, <span class="string">&#x27;#FF9FF3&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ æ•°å€¼æ ‡ç­¾</span></span><br><span class="line"><span class="keyword">for</span> bar, æ•°å€¼ <span class="keyword">in</span> <span class="built_in">zip</span>(bars, æ”¯å‡ºåˆ†ç±».values):</span><br><span class="line">    plt.annotate(<span class="string">f&#x27;<span class="subst">&#123;æ•°å€¼:,&#125;</span>&#x27;</span>, (bar.get_x() + bar.get_width()/<span class="number">2</span>, bar.get_height() + <span class="number">200</span>), </span><br><span class="line">                ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;bottom&#x27;</span>, fontsize=<span class="number">11</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">&#x27;2024å¹´å„ç±»æ”¯å‡ºæ€»é¢&#x27;</span>, fontsize=<span class="number">16</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>, pad=<span class="number">20</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;æ”¯å‡ºç±»åˆ«&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;æ”¯å‡ºé‡‘é¢ï¼ˆå…ƒï¼‰&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">plt.xticks(rotation=<span class="number">45</span>, ha=<span class="string">&#x27;right&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ æ€»è®¡</span></span><br><span class="line">æ€»è®¡ = æ”¯å‡ºåˆ†ç±».<span class="built_in">sum</span>()</span><br><span class="line">plt.text(<span class="number">0.02</span>, <span class="number">0.98</span>, <span class="string">f&#x27;æ€»æ”¯å‡ºï¼š<span class="subst">&#123;æ€»è®¡:,&#125;</span>å…ƒ&#x27;</span>, transform=plt.gca().transAxes, </span><br><span class="line">         fontsize=<span class="number">12</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>, verticalalignment=<span class="string">&#x27;top&#x27;</span>,</span><br><span class="line">         bbox=<span class="built_in">dict</span>(boxstyle=<span class="string">&#x27;round&#x27;</span>, facecolor=<span class="string">&#x27;wheat&#x27;</span>, alpha=<span class="number">0.8</span>))</span><br><span class="line"></span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.savefig(<span class="string">&#x27;æ”¯å‡ºåˆ†ç±»æŸ±çŠ¶å›¾.png&#x27;</span>, dpi=<span class="number">300</span>, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;âœ… æ”¯å‡ºåˆ†ç±»æŸ±çŠ¶å›¾å·²ç”Ÿæˆï¼&quot;</span>)</span><br></pre></td></tr></table></figure><p><strong>é«˜çº§å›¾è¡¨ï¼ˆExcelåšä¸åˆ°çš„å›¾è¡¨ï¼‰</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n=== é«˜çº§å›¾è¡¨åˆ¶ä½œ ===&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. æ”¶å…¥ç»“æ„å †å é¢ç§¯å›¾</span></span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>, <span class="number">6</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‡†å¤‡å †å æ•°æ®</span></span><br><span class="line">æ”¶å…¥æ•°æ® = æœˆåº¦æ”¶å…¥[[<span class="string">&#x27;æœˆä»½&#x27;</span>, <span class="string">&#x27;å·¥èµ„æ”¶å…¥&#x27;</span>, <span class="string">&#x27;æŠ•èµ„æ”¶ç›Š&#x27;</span>, <span class="string">&#x27;å…¶ä»–æ”¶å…¥&#x27;</span>]].set_index(<span class="string">&#x27;æœˆä»½&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå †å é¢ç§¯å›¾</span></span><br><span class="line">plt.stackplot(æ”¶å…¥æ•°æ®.index, </span><br><span class="line">              æ”¶å…¥_data[<span class="string">&#x27;å·¥èµ„æ”¶å…¥&#x27;</span>], </span><br><span class="line">              æ”¶å…¥_data[<span class="string">&#x27;æŠ•èµ„æ”¶ç›Š&#x27;</span>], </span><br><span class="line">              æ”¶å…¥_data[<span class="string">&#x27;å…¶ä»–æ”¶å…¥&#x27;</span>],</span><br><span class="line">              labels=[<span class="string">&#x27;å·¥èµ„æ”¶å…¥&#x27;</span>, <span class="string">&#x27;æŠ•èµ„æ”¶ç›Š&#x27;</span>, <span class="string">&#x27;å…¶ä»–æ”¶å…¥&#x27;</span>],</span><br><span class="line">              colors=[<span class="string">&#x27;#3498DB&#x27;</span>, <span class="string">&#x27;#2ECC71&#x27;</span>, <span class="string">&#x27;#F39C12&#x27;</span>],</span><br><span class="line">              alpha=<span class="number">0.8</span>)</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">&#x27;2024å¹´æœˆåº¦æ”¶å…¥ç»“æ„åˆ†æ&#x27;</span>, fontsize=<span class="number">16</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>, pad=<span class="number">20</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;æœˆä»½&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;æ”¶å…¥é‡‘é¢ï¼ˆå…ƒï¼‰&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;upper left&#x27;</span>, fontsize=<span class="number">11</span>)</span><br><span class="line">plt.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ æ€»è®¡æ ‡ç­¾</span></span><br><span class="line"><span class="keyword">for</span> i, æœˆä»½ <span class="keyword">in</span> <span class="built_in">enumerate</span>(æ”¶å…¥æ•°æ®.index):</span><br><span class="line">    æ€»è®¡ = æ”¶å…¥æ•°æ®.iloc[i].<span class="built_in">sum</span>()</span><br><span class="line">    plt.annotate(<span class="string">f&#x27;<span class="subst">&#123;æ€»è®¡:,&#125;</span>&#x27;</span>, (i, æ€»è®¡), textcoords=<span class="string">&quot;offset points&quot;</span>, xytext=(<span class="number">0</span>,<span class="number">10</span>), </span><br><span class="line">                ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;bottom&#x27;</span>, fontsize=<span class="number">9</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.savefig(<span class="string">&#x27;æ”¶å…¥ç»“æ„å †å å›¾.png&#x27;</span>, dpi=<span class="number">300</span>, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;âœ… æ”¶å…¥ç»“æ„å †å å›¾å·²ç”Ÿæˆï¼&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. ç»“ä½™ç‡ä»ªè¡¨ç›˜å¼å›¾è¡¨</span></span><br><span class="line">fig, (ax1, ax2) = plt.subplots(<span class="number">1</span>, <span class="number">2</span>, figsize=(<span class="number">15</span>, <span class="number">6</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># å·¦ä¾§ï¼šç»“ä½™ç‡æŸ±çŠ¶å›¾</span></span><br><span class="line">bars = ax1.bar(æœˆåº¦ç»“ä½™[<span class="string">&#x27;æœˆä»½&#x27;</span>], æœˆåº¦ç»“ä½™[<span class="string">&#x27;ç»“ä½™ç‡&#x27;</span>], </span><br><span class="line">               color=[<span class="string">&#x27;#2ECC71&#x27;</span> <span class="keyword">if</span> x &gt;= <span class="number">20</span> <span class="keyword">else</span> <span class="string">&#x27;#F39C12&#x27;</span> <span class="keyword">if</span> x &gt;= <span class="number">10</span> <span class="keyword">else</span> <span class="string">&#x27;#E74C3C&#x27;</span> <span class="keyword">for</span> x <span class="keyword">in</span> æœˆåº¦ç»“ä½™[<span class="string">&#x27;ç»“ä½™ç‡&#x27;</span>]])</span><br><span class="line"></span><br><span class="line">ax1.set_title(<span class="string">&#x27;æœˆåº¦ç»“ä½™ç‡&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">ax1.set_xlabel(<span class="string">&#x27;æœˆä»½&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">ax1.set_ylabel(<span class="string">&#x27;ç»“ä½™ç‡ï¼ˆ%ï¼‰&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">ax1.axhline(y=<span class="number">20</span>, color=<span class="string">&#x27;green&#x27;</span>, linestyle=<span class="string">&#x27;--&#x27;</span>, alpha=<span class="number">0.7</span>, label=<span class="string">&#x27;ç›®æ ‡ç»“ä½™ç‡ï¼ˆ20%ï¼‰&#x27;</span>)</span><br><span class="line">ax1.legend()</span><br><span class="line">ax1.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ æ•°å€¼æ ‡ç­¾</span></span><br><span class="line"><span class="keyword">for</span> bar, æ•°å€¼ <span class="keyword">in</span> <span class="built_in">zip</span>(bars, æœˆåº¦ç»“ä½™[<span class="string">&#x27;ç»“ä½™ç‡&#x27;</span>]):</span><br><span class="line">    ax1.annotate(<span class="string">f&#x27;<span class="subst">&#123;æ•°å€¼:<span class="number">.1</span>f&#125;</span>%&#x27;</span>, (bar.get_x() + bar.get_width()/<span class="number">2</span>, bar.get_height() + <span class="number">0.5</span>), </span><br><span class="line">                ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;bottom&#x27;</span>, fontsize=<span class="number">10</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å³ä¾§ï¼šå¹´åº¦å¹³å‡ç»“ä½™ç‡é¥¼å›¾</span></span><br><span class="line">å¹´åº¦å¹³å‡ç»“ä½™ç‡ = æœˆåº¦ç»“ä½™[<span class="string">&#x27;ç»“ä½™ç‡&#x27;</span>].mean()</span><br><span class="line">å…¶ä»–å æ¯” = <span class="number">100</span> - å¹´åº¦å¹³å‡ç»“ä½™ç‡</span><br><span class="line"></span><br><span class="line">ax2.pie([å¹´åº¦å¹³å‡ç»“ä½™ç‡, å…¶ä»–å æ¯”], </span><br><span class="line">        labels=[<span class="string">f&#x27;ç»“ä½™\n<span class="subst">&#123;å¹´åº¦å¹³å‡ç»“ä½™ç‡:<span class="number">.1</span>f&#125;</span>%&#x27;</span>, <span class="string">f&#x27;æ”¯å‡º\n<span class="subst">&#123;å…¶ä»–å æ¯”:<span class="number">.1</span>f&#125;</span>%&#x27;</span>],</span><br><span class="line">        colors=[<span class="string">&#x27;#2ECC71&#x27;</span>, <span class="string">&#x27;#E74C3C&#x27;</span>],</span><br><span class="line">        startangle=<span class="number">90</span>,</span><br><span class="line">        autopct=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ax2.set_title(<span class="string">f&#x27;å¹´åº¦å¹³å‡ç»“ä½™ç‡\n<span class="subst">&#123;å¹´åº¦å¹³å‡ç»“ä½™ç‡:<span class="number">.1</span>f&#125;</span>%&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¹æ®ç»“ä½™ç‡æ˜¾ç¤ºè¯„ä»·</span></span><br><span class="line"><span class="keyword">if</span> å¹´åº¦å¹³å‡ç»“ä½™ç‡ &gt;= <span class="number">25</span>:</span><br><span class="line">    è¯„ä»· = <span class="string">&quot;ä¼˜ç§€ ğŸ†&quot;</span></span><br><span class="line">    é¢œè‰² = <span class="string">&quot;#2ECC71&quot;</span></span><br><span class="line"><span class="keyword">elif</span> å¹´åº¦å¹³å‡ç»“ä½™ç‡ &gt;= <span class="number">20</span>:</span><br><span class="line">    è¯„ä»· = <span class="string">&quot;è‰¯å¥½ ğŸ‘&quot;</span></span><br><span class="line">    é¢œè‰² = <span class="string">&quot;#F39C12&quot;</span></span><br><span class="line"><span class="keyword">elif</span> å¹´åº¦å¹³å‡ç»“ä½™ç‡ &gt;= <span class="number">15</span>:</span><br><span class="line">    è¯„ä»· = <span class="string">&quot;ä¸€èˆ¬ âš ï¸&quot;</span></span><br><span class="line">    é¢œè‰² = <span class="string">&quot;#E67E22&quot;</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    è¯„ä»· = <span class="string">&quot;éœ€æ”¹å–„ ğŸ’”&quot;</span></span><br><span class="line">    é¢œè‰² = <span class="string">&quot;#E74C3C&quot;</span></span><br><span class="line"></span><br><span class="line">plt.figtext(<span class="number">0.5</span>, <span class="number">0.02</span>, <span class="string">f&#x27;è´¢åŠ¡å¥åº·åº¦ï¼š<span class="subst">&#123;è¯„ä»·&#125;</span>&#x27;</span>, ha=<span class="string">&#x27;center&#x27;</span>, fontsize=<span class="number">16</span>, </span><br><span class="line">            fontweight=<span class="string">&#x27;bold&#x27;</span>, color=é¢œè‰², transform=fig.transFigure)</span><br><span class="line"></span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.savefig(<span class="string">&#x27;ç»“ä½™ç‡åˆ†æå›¾.png&#x27;</span>, dpi=<span class="number">300</span>, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;âœ… ç»“ä½™ç‡åˆ†æå›¾å·²ç”Ÿæˆï¼&quot;</span>)</span><br></pre></td></tr></table></figure><p><strong>çƒ­åŠ›å›¾ï¼ˆä¸“ä¸šè´¢åŠ¡åˆ†æå›¾ï¼‰</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 6. æœˆåº¦æ”¶æ”¯çƒ­åŠ›å›¾</span></span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºæœˆåº¦æ•°æ®çŸ©é˜µ</span></span><br><span class="line">æœˆåº¦æ•°æ® = pd.merge(æœˆåº¦æ”¶å…¥, æœˆåº¦æ”¯å‡º, on=<span class="string">&#x27;æœˆä»½&#x27;</span>)</span><br><span class="line">æ”¶æ”¯æ˜ç»† = æœˆåº¦æ•°æ®.drop([<span class="string">&#x27;æœˆä»½&#x27;</span>, <span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>, <span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>, <span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>, <span class="string">&#x27;ç»“ä½™ç‡&#x27;</span>], axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è½¬ç½®æ•°æ®ä»¥ä¾¿ç»˜åˆ¶çƒ­åŠ›å›¾</span></span><br><span class="line">çƒ­åŠ›å›¾æ•°æ® = æ”¶æ”¯æ˜ç»†.T</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºçƒ­åŠ›å›¾</span></span><br><span class="line">sns.heatmap(çƒ­åŠ›å›¾æ•°æ®, </span><br><span class="line">            annot=<span class="literal">True</span>, </span><br><span class="line">            fmt=<span class="string">&#x27;d&#x27;</span>, </span><br><span class="line">            cmap=<span class="string">&#x27;RdYlGn_r&#x27;</span>,  <span class="comment"># çº¢-é»„-ç»¿è‰²è°±ï¼Œçº¢è‰²è¡¨ç¤ºé«˜å€¼</span></span><br><span class="line">            cbar_kws=&#123;<span class="string">&#x27;label&#x27;</span>: <span class="string">&#x27;é‡‘é¢ï¼ˆå…ƒï¼‰&#x27;</span>&#125;,</span><br><span class="line">            linewidths=<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">&#x27;2024å¹´æœˆåº¦æ”¶æ”¯çƒ­åŠ›å›¾&#x27;</span>, fontsize=<span class="number">16</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>, pad=<span class="number">20</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;æœˆä»½&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;æ”¶æ”¯é¡¹ç›®&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">plt.xticks(rotation=<span class="number">0</span>)</span><br><span class="line">plt.yticks(rotation=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ æ³¨é‡Š</span></span><br><span class="line">plt.figtext(<span class="number">0.02</span>, <span class="number">0.02</span>, <span class="string">&#x27;é¢œè‰²è¶Šæ·±è¡¨ç¤ºé‡‘é¢è¶Šé«˜&#x27;</span>, fontsize=<span class="number">10</span>, </span><br><span class="line">            transform=plt.gca().transFigure, style=<span class="string">&#x27;italic&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.savefig(<span class="string">&#x27;æœˆåº¦æ”¶æ”¯çƒ­åŠ›å›¾.png&#x27;</span>, dpi=<span class="number">300</span>, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;âœ… æœˆåº¦æ”¶æ”¯çƒ­åŠ›å›¾å·²ç”Ÿæˆï¼&quot;</span>)</span><br></pre></td></tr></table></figure><hr><h3 id="ğŸ’¾-æ•°æ®å¯¼å‡ºï¼šå¤šç§æ ¼å¼è¾“å‡º"><a href="#ğŸ’¾-æ•°æ®å¯¼å‡ºï¼šå¤šç§æ ¼å¼è¾“å‡º" class="headerlink" title="ğŸ’¾ æ•°æ®å¯¼å‡ºï¼šå¤šç§æ ¼å¼è¾“å‡º"></a>ğŸ’¾ æ•°æ®å¯¼å‡ºï¼šå¤šç§æ ¼å¼è¾“å‡º</h3><p><strong>å¯¼å‡ºåˆ°Excelï¼ˆæœ€å¸¸ç”¨ï¼‰</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n=== æ•°æ®å¯¼å‡º ===&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. å¯¼å‡ºåˆ°Excel</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">å¯¼å‡ºåˆ°Excel</span>(<span class="params">æ•°æ®å­—å…¸, æ–‡ä»¶å=<span class="string">&quot;ä¸ªäººç†è´¢æŠ¥å‘Š.xlsx&quot;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å°†å¤šä¸ªæ•°æ®è¡¨å¯¼å‡ºåˆ°Excelæ–‡ä»¶&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ğŸ“Š æ­£åœ¨å¯¼å‡ºåˆ°Excelï¼š<span class="subst">&#123;æ–‡ä»¶å&#125;</span>...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> pd.ExcelWriter(æ–‡ä»¶å, engine=<span class="string">&#x27;openpyxl&#x27;</span>) <span class="keyword">as</span> writer:</span><br><span class="line">        <span class="comment"># å¯¼å‡ºå„ä¸ªæ•°æ®è¡¨</span></span><br><span class="line">        æœˆåº¦æ”¶å…¥.to_excel(writer, sheet_name=<span class="string">&#x27;æœˆåº¦æ”¶å…¥&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">        æœˆåº¦æ”¯å‡º.to_excel(writer, sheet_name=<span class="string">&#x27;æœˆåº¦æ”¯å‡º&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">        æœˆåº¦ç»“ä½™.to_excel(writer, sheet_name=<span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åˆ›å»ºæ±‡æ€»è¡¨</span></span><br><span class="line">        æ±‡æ€»è¡¨ = pd.DataFrame(&#123;</span><br><span class="line">            <span class="string">&#x27;é¡¹ç›®&#x27;</span>: [<span class="string">&#x27;å¹´åº¦æ€»æ”¶å…¥&#x27;</span>, <span class="string">&#x27;å¹´åº¦æ€»æ”¯å‡º&#x27;</span>, <span class="string">&#x27;å¹´åº¦æ€»ç»“ä½™&#x27;</span>, <span class="string">&#x27;å¹³å‡æœˆç»“ä½™&#x27;</span>, <span class="string">&#x27;å¹³å‡ç»“ä½™ç‡&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;é‡‘é¢&#x27;</span>: [</span><br><span class="line">                æœˆåº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>].<span class="built_in">sum</span>(),</span><br><span class="line">                æœˆåº¦æ”¯å‡º[<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>].<span class="built_in">sum</span>(),</span><br><span class="line">                æœˆåº¦ç»“ä½™[<span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>].<span class="built_in">sum</span>(),</span><br><span class="line">                æœˆåº¦ç»“ä½™[<span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>].mean(),</span><br><span class="line">                æœˆåº¦ç»“ä½™[<span class="string">&#x27;ç»“ä½™ç‡&#x27;</span>].mean()</span><br><span class="line">            ],</span><br><span class="line">            <span class="string">&#x27;å•ä½&#x27;</span>: [<span class="string">&#x27;å…ƒ&#x27;</span>, <span class="string">&#x27;å…ƒ&#x27;</span>, <span class="string">&#x27;å…ƒ&#x27;</span>, <span class="string">&#x27;å…ƒ&#x27;</span>, <span class="string">&#x27;%&#x27;</span>]</span><br><span class="line">        &#125;)</span><br><span class="line">        æ±‡æ€»è¡¨.to_excel(writer, sheet_name=<span class="string">&#x27;å¹´åº¦æ±‡æ€»&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åˆ›å»ºå¹´åº¦å¯¹æ¯”è¡¨</span></span><br><span class="line">        å¹´åº¦å¯¹æ¯” = pd.DataFrame(&#123;</span><br><span class="line">            <span class="string">&#x27;æœˆä»½&#x27;</span>: æœˆåº¦ç»“ä½™[<span class="string">&#x27;æœˆä»½&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;æ”¶å…¥&#x27;</span>: æœˆåº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;æ”¯å‡º&#x27;</span>: æœˆåº¦æ”¯å‡º[<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;ç»“ä½™&#x27;</span>: æœˆåº¦ç»“ä½™[<span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;ç»“ä½™ç‡&#x27;</span>: æœˆåº¦ç»“ä½™[<span class="string">&#x27;ç»“ä½™ç‡&#x27;</span>]</span><br><span class="line">        &#125;)</span><br><span class="line">        å¹´åº¦å¯¹æ¯”.to_excel(writer, sheet_name=<span class="string">&#x27;å¹´åº¦å¯¹æ¯”&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;âœ… Excelæ–‡ä»¶å¯¼å‡ºå®Œæˆï¼&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨å‡½æ•°å¯¼å‡º</span></span><br><span class="line">å¯¼å‡ºåˆ°Excel(&#123;</span><br><span class="line">    <span class="string">&#x27;æœˆåº¦æ”¶å…¥&#x27;</span>: æœˆåº¦æ”¶å…¥,</span><br><span class="line">    <span class="string">&#x27;æœˆåº¦æ”¯å‡º&#x27;</span>: æœˆåº¦æ”¯å‡º,</span><br><span class="line">    <span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>: æœˆåº¦ç»“ä½™</span><br><span class="line">&#125;, <span class="string">&quot;ä¸ªäººç†è´¢æŠ¥å‘Š_åŸºç¡€ç‰ˆ.xlsx&quot;</span>)</span><br></pre></td></tr></table></figure><p><strong>å¯¼å‡ºåˆ°CSVï¼ˆé€šç”¨æ ¼å¼ï¼‰</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2. å¯¼å‡ºåˆ°CSV</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">å¯¼å‡ºåˆ°CSV</span>(<span class="params">æ•°æ®è¡¨, æ–‡ä»¶å</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å¯¼å‡ºæ•°æ®åˆ°CSVæ–‡ä»¶&quot;&quot;&quot;</span></span><br><span class="line">    æ•°æ®è¡¨.to_csv(æ–‡ä»¶å, index=<span class="literal">False</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;âœ… CSVæ–‡ä»¶å¯¼å‡ºå®Œæˆï¼š<span class="subst">&#123;æ–‡ä»¶å&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¼å‡ºä¸»è¦æ•°æ®</span></span><br><span class="line">å¯¼å‡ºåˆ°CSV(æœˆåº¦ç»“ä½™, <span class="string">&quot;æœˆåº¦ç»“ä½™æ˜ç»†.csv&quot;</span>)</span><br><span class="line">å¯¼å‡ºåˆ°CSV(æœˆåº¦æ”¶å…¥, <span class="string">&quot;æœˆåº¦æ”¶å…¥æ˜ç»†.csv&quot;</span>)</span><br><span class="line">å¯¼å‡ºåˆ°CSV(æœˆåº¦æ”¯å‡º, <span class="string">&quot;æœˆåº¦æ”¯å‡ºæ˜ç»†.csv&quot;</span>)</span><br></pre></td></tr></table></figure><p><strong>å¯¼å‡ºåˆ°PDFï¼ˆä¸“ä¸šæŠ¥å‘Šï¼‰</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3. ç”ŸæˆPDFæŠ¥å‘Š</span></span><br><span class="line"><span class="keyword">from</span> matplotlib.backends.backend_pdf <span class="keyword">import</span> PdfPages</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ç”ŸæˆPDFæŠ¥å‘Š</span>(<span class="params">æ–‡ä»¶å=<span class="string">&quot;ä¸ªäººç†è´¢å¹´åº¦æŠ¥å‘Š.pdf&quot;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ç”ŸæˆåŒ…å«å¤šä¸ªå›¾è¡¨çš„PDFæŠ¥å‘Š&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ğŸ“„ æ­£åœ¨ç”ŸæˆPDFæŠ¥å‘Šï¼š<span class="subst">&#123;æ–‡ä»¶å&#125;</span>...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> PdfPages(æ–‡ä»¶å) <span class="keyword">as</span> pdf:</span><br><span class="line">        <span class="comment"># ç¬¬ä¸€é¡µï¼šå°é¢</span></span><br><span class="line">        fig = plt.figure(figsize=(<span class="number">8.27</span>, <span class="number">11.69</span>))  <span class="comment"># A4å°ºå¯¸</span></span><br><span class="line">        plt.text(<span class="number">0.5</span>, <span class="number">0.7</span>, <span class="string">&#x27;ä¸ªäººç†è´¢å¹´åº¦æŠ¥å‘Š&#x27;</span>, ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;center&#x27;</span>, </span><br><span class="line">                fontsize=<span class="number">32</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>, transform=fig.transFigure)</span><br><span class="line">        plt.text(<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="string">f&#x27;2024å¹´åº¦è´¢åŠ¡åˆ†ææŠ¥å‘Š&#x27;</span>, ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;center&#x27;</span>, </span><br><span class="line">                fontsize=<span class="number">20</span>, transform=fig.transFigure)</span><br><span class="line">        plt.text(<span class="number">0.5</span>, <span class="number">0.3</span>, <span class="string">f&#x27;ç”Ÿæˆæ—¶é—´ï¼š<span class="subst">&#123;datetime.now().strftime(<span class="string">&quot;%Yå¹´%mæœˆ%dæ—¥&quot;</span>)&#125;</span>&#x27;</span>, </span><br><span class="line">                ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;center&#x27;</span>, fontsize=<span class="number">14</span>, transform=fig.transFigure)</span><br><span class="line">        plt.text(<span class="number">0.5</span>, <span class="number">0.2</span>, <span class="string">f&#x27;å¹´åº¦æ€»ç»“ä½™ï¼š<span class="subst">&#123;æœˆåº¦ç»“ä½™[<span class="string">&quot;æœˆåº¦ç»“ä½™&quot;</span>].<span class="built_in">sum</span>():,<span class="number">.2</span>f&#125;</span>å…ƒ&#x27;</span>, </span><br><span class="line">                ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;center&#x27;</span>, fontsize=<span class="number">16</span>, color=<span class="string">&#x27;#2ECC71&#x27;</span>, </span><br><span class="line">                transform=fig.transFigure, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">        plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">        pdf.savefig(fig, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br><span class="line">        plt.close()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç¬¬äºŒé¡µï¼šæ”¶æ”¯æ€»è§ˆ</span></span><br><span class="line">        fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(<span class="number">2</span>, <span class="number">2</span>, figsize=(<span class="number">11.69</span>, <span class="number">8.27</span>))</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ”¶æ”¯æŠ˜çº¿å›¾</span></span><br><span class="line">        ax1.plot(æœˆåº¦æ”¶å…¥[<span class="string">&#x27;æœˆä»½&#x27;</span>], æœˆåº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>], marker=<span class="string">&#x27;o&#x27;</span>, linewidth=<span class="number">3</span>, label=<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>, color=<span class="string">&#x27;#2E8B57&#x27;</span>)</span><br><span class="line">        ax1.plot(æœˆåº¦æ”¯å‡º[<span class="string">&#x27;æœˆä»½&#x27;</span>], æœˆåº¦æ”¯å‡º[<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>], marker=<span class="string">&#x27;s&#x27;</span>, linewidth=<span class="number">3</span>, label=<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>, color=<span class="string">&#x27;#DC143C&#x27;</span>)</span><br><span class="line">        ax1.set_title(<span class="string">&#x27;æœˆåº¦æ”¶æ”¯æƒ…å†µ&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">        ax1.legend()</span><br><span class="line">        ax1.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ”¶å…¥é¥¼å›¾</span></span><br><span class="line">        å¹´åº¦æ”¶å…¥ç»“æ„ = æœˆåº¦æ”¶å…¥[[<span class="string">&#x27;å·¥èµ„æ”¶å…¥&#x27;</span>, <span class="string">&#x27;æŠ•èµ„æ”¶ç›Š&#x27;</span>, <span class="string">&#x27;å…¶ä»–æ”¶å…¥&#x27;</span>]].<span class="built_in">sum</span>()</span><br><span class="line">        ax2.pie(å¹´åº¦æ”¶å…¥ç»“æ„.values, labels=å¹´åº¦æ”¶å…¥ç»“æ„.index, autopct=<span class="string">&#x27;%1.1f%%&#x27;</span>, startangle=<span class="number">90</span>)</span><br><span class="line">        ax2.set_title(<span class="string">&#x27;å¹´åº¦æ”¶å…¥ç»“æ„&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ”¯å‡ºé¥¼å›¾</span></span><br><span class="line">        å¹´åº¦æ”¯å‡ºç»“æ„ = æœˆåº¦æ”¯å‡º.drop([<span class="string">&#x27;æœˆä»½&#x27;</span>, <span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>], axis=<span class="number">1</span>).<span class="built_in">sum</span>()</span><br><span class="line">        ax3.pie(å¹´åº¦æ”¯å‡ºç»“æ„.values, labels=å¹´åº¦æ”¯å‡ºç»“æ„.index, autopct=<span class="string">&#x27;%1.1f%%&#x27;</span>, startangle=<span class="number">90</span>)</span><br><span class="line">        ax3.set_title(<span class="string">&#x27;å¹´åº¦æ”¯å‡ºç»“æ„&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç»“ä½™ç‡æŸ±çŠ¶å›¾</span></span><br><span class="line">        bars = ax4.bar(æœˆåº¦ç»“ä½™[<span class="string">&#x27;æœˆä»½&#x27;</span>], æœˆåº¦ç»“ä½™[<span class="string">&#x27;ç»“ä½™ç‡&#x27;</span>], </span><br><span class="line">                      color=[<span class="string">&#x27;#2ECC71&#x27;</span> <span class="keyword">if</span> x &gt;= <span class="number">20</span> <span class="keyword">else</span> <span class="string">&#x27;#F39C12&#x27;</span> <span class="keyword">if</span> x &gt;= <span class="number">10</span> <span class="keyword">else</span> <span class="string">&#x27;#E74C3C&#x27;</span> <span class="keyword">for</span> x <span class="keyword">in</span> æœˆåº¦ç»“ä½™[<span class="string">&#x27;ç»“ä½™ç‡&#x27;</span>]])</span><br><span class="line">        ax4.set_title(<span class="string">&#x27;æœˆåº¦ç»“ä½™ç‡&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">        ax4.axhline(y=<span class="number">20</span>, color=<span class="string">&#x27;green&#x27;</span>, linestyle=<span class="string">&#x27;--&#x27;</span>, alpha=<span class="number">0.7</span>, label=<span class="string">&#x27;ç›®æ ‡ç»“ä½™ç‡&#x27;</span>)</span><br><span class="line">        ax4.legend()</span><br><span class="line">        </span><br><span class="line">        plt.suptitle(<span class="string">&#x27;2024å¹´åº¦è´¢åŠ¡æ€»è§ˆ&#x27;</span>, fontsize=<span class="number">18</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>, y=<span class="number">0.95</span>)</span><br><span class="line">        plt.tight_layout()</span><br><span class="line">        pdf.savefig(fig, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br><span class="line">        plt.close()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç¬¬ä¸‰é¡µï¼šè¯¦ç»†åˆ†æ</span></span><br><span class="line">        fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(<span class="number">2</span>, <span class="number">2</span>, figsize=(<span class="number">11.69</span>, <span class="number">8.27</span>))</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æœˆåº¦ç»“ä½™è¶‹åŠ¿</span></span><br><span class="line">        ax1.bar(æœˆåº¦ç»“ä½™[<span class="string">&#x27;æœˆä»½&#x27;</span>], æœˆåº¦ç»“ä½™[<span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>], </span><br><span class="line">               color=[<span class="string">&#x27;#2ECC71&#x27;</span> <span class="keyword">if</span> x &gt;= <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;#E74C3C&#x27;</span> <span class="keyword">for</span> x <span class="keyword">in</span> æœˆåº¦ç»“ä½™[<span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>]])</span><br><span class="line">        ax1.set_title(<span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">        ax1.axhline(y=<span class="number">0</span>, color=<span class="string">&#x27;black&#x27;</span>, linestyle=<span class="string">&#x27;-&#x27;</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ”¶å…¥å †å å›¾</span></span><br><span class="line">        æ”¶å…¥æ•°æ® = æœˆåº¦æ”¶å…¥[[<span class="string">&#x27;æœˆä»½&#x27;</span>, <span class="string">&#x27;å·¥èµ„æ”¶å…¥&#x27;</span>, <span class="string">&#x27;æŠ•èµ„æ”¶ç›Š&#x27;</span>, <span class="string">&#x27;å…¶ä»–æ”¶å…¥&#x27;</span>]].set_index(<span class="string">&#x27;æœˆä»½&#x27;</span>)</span><br><span class="line">        ax2.stackplot(æ”¶å…¥æ•°æ®.index, æ”¶å…¥æ•°æ®[<span class="string">&#x27;å·¥èµ„æ”¶å…¥&#x27;</span>], æ”¶å…¥æ•°æ®[<span class="string">&#x27;æŠ•èµ„æ”¶ç›Š&#x27;</span>], æ”¶å…¥æ•°æ®[<span class="string">&#x27;å…¶ä»–æ”¶å…¥&#x27;</span>],</span><br><span class="line">                     labels=[<span class="string">&#x27;å·¥èµ„æ”¶å…¥&#x27;</span>, <span class="string">&#x27;æŠ•èµ„æ”¶ç›Š&#x27;</span>, <span class="string">&#x27;å…¶ä»–æ”¶å…¥&#x27;</span>], alpha=<span class="number">0.8</span>)</span><br><span class="line">        ax2.set_title(<span class="string">&#x27;æ”¶å…¥ç»“æ„å˜åŒ–&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">        ax2.legend(loc=<span class="string">&#x27;upper left&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ”¯å‡ºå †å å›¾</span></span><br><span class="line">        æ”¯å‡ºæ•°æ® = æœˆåº¦æ”¯å‡º[[<span class="string">&#x27;æœˆä»½&#x27;</span>, <span class="string">&#x27;ç”Ÿæ´»è´¹ç”¨&#x27;</span>, <span class="string">&#x27;æˆ¿ç§Ÿ/æˆ¿è´·&#x27;</span>, <span class="string">&#x27;äº¤é€šè´¹ç”¨&#x27;</span>, <span class="string">&#x27;å¨±ä¹æ¶ˆè´¹&#x27;</span>, <span class="string">&#x27;å­¦ä¹ åŸ¹è®­&#x27;</span>, <span class="string">&#x27;å…¶ä»–æ”¯å‡º&#x27;</span>]].set_index(<span class="string">&#x27;æœˆä»½&#x27;</span>)</span><br><span class="line">        ax3.stackplot(æ”¯å‡ºæ•°æ®.index, </span><br><span class="line">                     æ”¯å‡ºæ•°æ®[<span class="string">&#x27;ç”Ÿæ´»è´¹ç”¨&#x27;</span>], æ”¯å‡ºæ•°æ®[<span class="string">&#x27;æˆ¿ç§Ÿ/æˆ¿è´·&#x27;</span>], æ”¯å‡ºæ•°æ®[<span class="string">&#x27;äº¤é€šè´¹ç”¨&#x27;</span>], </span><br><span class="line">                     æ”¯å‡ºæ•°æ®[<span class="string">&#x27;å¨±ä¹æ¶ˆè´¹&#x27;</span>], æ”¯å‡ºæ•°æ®[<span class="string">&#x27;å­¦ä¹ åŸ¹è®­&#x27;</span>], æ”¯å‡ºæ•°æ®[<span class="string">&#x27;å…¶ä»–æ”¯å‡º&#x27;</span>],</span><br><span class="line">                     labels=[<span class="string">&#x27;ç”Ÿæ´»è´¹ç”¨&#x27;</span>, <span class="string">&#x27;æˆ¿ç§Ÿ/æˆ¿è´·&#x27;</span>, <span class="string">&#x27;äº¤é€šè´¹ç”¨&#x27;</span>, <span class="string">&#x27;å¨±ä¹æ¶ˆè´¹&#x27;</span>, <span class="string">&#x27;å­¦ä¹ åŸ¹è®­&#x27;</span>, <span class="string">&#x27;å…¶ä»–æ”¯å‡º&#x27;</span>], alpha=<span class="number">0.8</span>)</span><br><span class="line">        ax3.set_title(<span class="string">&#x27;æ”¯å‡ºç»“æ„å˜åŒ–&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">        ax3.legend(loc=<span class="string">&#x27;upper left&#x27;</span>, bbox_to_anchor=(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># çƒ­åŠ›å›¾</span></span><br><span class="line">        æ”¶æ”¯æ˜ç»† = æœˆåº¦æ”¯å‡º.drop([<span class="string">&#x27;æœˆä»½&#x27;</span>, <span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>], axis=<span class="number">1</span>)</span><br><span class="line">        sns.heatmap(æ”¶æ”¯æ˜ç»†.T, annot=<span class="literal">True</span>, fmt=<span class="string">&#x27;d&#x27;</span>, cmap=<span class="string">&#x27;RdYlGn_r&#x27;</span>, ax=ax4, cbar_kws=&#123;<span class="string">&#x27;label&#x27;</span>: <span class="string">&#x27;é‡‘é¢ï¼ˆå…ƒï¼‰&#x27;</span>&#125;)</span><br><span class="line">        ax4.set_title(<span class="string">&#x27;æœˆåº¦æ”¯å‡ºçƒ­åŠ›å›¾&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        plt.suptitle(<span class="string">&#x27;2024å¹´åº¦è´¢åŠ¡è¯¦ç»†åˆ†æ&#x27;</span>, fontsize=<span class="number">16</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>, y=<span class="number">0.95</span>)</span><br><span class="line">        plt.tight_layout()</span><br><span class="line">        pdf.savefig(fig, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br><span class="line">        plt.close()</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;âœ… PDFæŠ¥å‘Šç”Ÿæˆå®Œæˆï¼&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”ŸæˆPDFæŠ¥å‘Š</span></span><br><span class="line">ç”ŸæˆPDFæŠ¥å‘Š(<span class="string">&quot;ä¸ªäººç†è´¢å¹´åº¦æŠ¥å‘Š_å®Œæ•´ç‰ˆ.pdf&quot;</span>)</span><br></pre></td></tr></table></figure><hr><h3><a href="#" class="headerlink"></a></h3><details><summary>ç‰ˆæœ¬1.0ï¼šåŸºç¡€å¹´åº¦æŠ¥å‘Š</summary><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸ªäººç†è´¢å¹´åº¦æŠ¥å‘Š - åŸºç¡€ç‰ˆ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=== ä¸ªäººç†è´¢å¹´åº¦æŠ¥å‘Šç”Ÿæˆå™¨ ===&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ç”ŸæˆåŸºç¡€å¹´æŠ¥</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ç”ŸæˆåŸºç¡€ç‰ˆå¹´åº¦æŠ¥å‘Š&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ğŸ“Š å¼€å§‹ç”ŸæˆåŸºç¡€å¹´åº¦æŠ¥å‘Š...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 1. è®¡ç®—å¹´åº¦å…³é”®æŒ‡æ ‡</span></span><br><span class="line">    å¹´åº¦æŒ‡æ ‡ = &#123;</span><br><span class="line">        <span class="string">&#x27;å¹´åº¦æ€»æ”¶å…¥&#x27;</span>: æœˆåº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>].<span class="built_in">sum</span>(),</span><br><span class="line">        <span class="string">&#x27;å¹´åº¦æ€»æ”¯å‡º&#x27;</span>: æœˆåº¦æ”¯å‡º[<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>].<span class="built_in">sum</span>(),</span><br><span class="line">        <span class="string">&#x27;å¹´åº¦æ€»ç»“ä½™&#x27;</span>: æœˆåº¦ç»“ä½™[<span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>].<span class="built_in">sum</span>(),</span><br><span class="line">        <span class="string">&#x27;å¹³å‡æœˆç»“ä½™&#x27;</span>: æœˆåº¦ç»“ä½™[<span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>].mean(),</span><br><span class="line">        <span class="string">&#x27;å¹³å‡ç»“ä½™ç‡&#x27;</span>: æœˆåº¦ç»“ä½™[<span class="string">&#x27;ç»“ä½™ç‡&#x27;</span>].mean(),</span><br><span class="line">        <span class="string">&#x27;æœ€é«˜æœˆç»“ä½™&#x27;</span>: æœˆåº¦ç»“ä½™[<span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>].<span class="built_in">max</span>(),</span><br><span class="line">        <span class="string">&#x27;æœ€ä½æœˆç»“ä½™&#x27;</span>: æœˆåº¦ç»“ä½™[<span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>].<span class="built_in">min</span>(),</span><br><span class="line">        <span class="string">&#x27;æœ€é«˜ç»“ä½™ç‡&#x27;</span>: æœˆåº¦ç»“ä½™[<span class="string">&#x27;ç»“ä½™ç‡&#x27;</span>].<span class="built_in">max</span>(),</span><br><span class="line">        <span class="string">&#x27;æœ€ä½ç»“ä½™ç‡&#x27;</span>: æœˆåº¦ç»“ä½™[<span class="string">&#x27;ç»“ä½™ç‡&#x27;</span>].<span class="built_in">min</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nğŸ“ˆ å¹´åº¦è´¢åŠ¡æ¦‚å†µï¼š&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;  å¹´åº¦æ€»æ”¶å…¥ï¼š<span class="subst">&#123;å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;å¹´åº¦æ€»æ”¶å…¥&#x27;</span>]:,&#125;</span>å…ƒ&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;  å¹´åº¦æ€»æ”¯å‡ºï¼š<span class="subst">&#123;å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;å¹´åº¦æ€»æ”¯å‡º&#x27;</span>]:,&#125;</span>å…ƒ&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;  å¹´åº¦æ€»ç»“ä½™ï¼š<span class="subst">&#123;å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;å¹´åº¦æ€»ç»“ä½™&#x27;</span>]:,&#125;</span>å…ƒ&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;  å¹³å‡ç»“ä½™ç‡ï¼š<span class="subst">&#123;å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;å¹³å‡ç»“ä½™ç‡&#x27;</span>]:<span class="number">.1</span>f&#125;</span>%&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. ç”Ÿæˆå¹´åº¦åˆ†ææŠ¥å‘Š</span></span><br><span class="line">    æŠ¥å‘Šå†…å®¹ = <span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span><br><span class="line"><span class="string">                            ä¸ªäººç†è´¢å¹´åº¦æŠ¥å‘Š</span></span><br><span class="line"><span class="string">                                2024å¹´åº¦</span></span><br><span class="line"><span class="string">    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    ğŸ“Š å¹´åº¦è´¢åŠ¡æ¦‚å†µ</span></span><br><span class="line"><span class="string">    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span><br><span class="line"><span class="string">    â€¢ å¹´åº¦æ€»æ”¶å…¥ï¼š<span class="subst">&#123;å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;å¹´åº¦æ€»æ”¶å…¥&#x27;</span>]:,&#125;</span>å…ƒ</span></span><br><span class="line"><span class="string">    â€¢ å¹´åº¦æ€»æ”¯å‡ºï¼š<span class="subst">&#123;å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;å¹´åº¦æ€»æ”¯å‡º&#x27;</span>]:,&#125;</span>å…ƒ  </span></span><br><span class="line"><span class="string">    â€¢ å¹´åº¦æ€»ç»“ä½™ï¼š<span class="subst">&#123;å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;å¹´åº¦æ€»ç»“ä½™&#x27;</span>]:,&#125;</span>å…ƒ</span></span><br><span class="line"><span class="string">    â€¢ å¹³å‡æœˆç»“ä½™ï¼š<span class="subst">&#123;å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;å¹³å‡æœˆç»“ä½™&#x27;</span>]:,<span class="number">.2</span>f&#125;</span>å…ƒ</span></span><br><span class="line"><span class="string">    â€¢ å¹³å‡ç»“ä½™ç‡ï¼š<span class="subst">&#123;å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;å¹³å‡ç»“ä½™ç‡&#x27;</span>]:<span class="number">.1</span>f&#125;</span>%</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    ğŸ“ˆ æ”¶å…¥åˆ†æ</span></span><br><span class="line"><span class="string">    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span><br><span class="line"><span class="string">    â€¢ å·¥èµ„æ”¶å…¥ï¼š<span class="subst">&#123;æœˆåº¦æ”¶å…¥[<span class="string">&#x27;å·¥èµ„æ”¶å…¥&#x27;</span>].<span class="built_in">sum</span>():,&#125;</span>å…ƒï¼ˆå æ¯”<span class="subst">&#123;æœˆåº¦æ”¶å…¥[<span class="string">&#x27;å·¥èµ„æ”¶å…¥&#x27;</span>].<span class="built_in">sum</span>()/å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;å¹´åº¦æ€»æ”¶å…¥&#x27;</span>]*<span class="number">100</span>:<span class="number">.1</span>f&#125;</span>%ï¼‰</span></span><br><span class="line"><span class="string">    â€¢ æŠ•èµ„æ”¶ç›Šï¼š<span class="subst">&#123;æœˆåº¦æ”¶å…¥[<span class="string">&#x27;æŠ•èµ„æ”¶ç›Š&#x27;</span>].<span class="built_in">sum</span>():,&#125;</span>å…ƒï¼ˆå æ¯”<span class="subst">&#123;æœˆåº¦æ”¶å…¥[<span class="string">&#x27;æŠ•èµ„æ”¶ç›Š&#x27;</span>].<span class="built_in">sum</span>()/å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;å¹´åº¦æ€»æ”¶å…¥&#x27;</span>]*<span class="number">100</span>:<span class="number">.1</span>f&#125;</span>%ï¼‰</span></span><br><span class="line"><span class="string">    â€¢ å…¶ä»–æ”¶å…¥ï¼š<span class="subst">&#123;æœˆåº¦æ”¶å…¥[<span class="string">&#x27;å…¶ä»–æ”¶å…¥&#x27;</span>].<span class="built_in">sum</span>():,&#125;</span>å…ƒï¼ˆå æ¯”<span class="subst">&#123;æœˆåº¦æ”¶å…¥[<span class="string">&#x27;å…¶ä»–æ”¶å…¥&#x27;</span>].<span class="built_in">sum</span>()/å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;å¹´åº¦æ€»æ”¶å…¥&#x27;</span>]*<span class="number">100</span>:<span class="number">.1</span>f&#125;</span>%ï¼‰</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    ğŸ’° æ”¯å‡ºåˆ†æ  </span></span><br><span class="line"><span class="string">    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span><br><span class="line"><span class="string">    â€¢ ç”Ÿæ´»è´¹ç”¨ï¼š<span class="subst">&#123;æœˆåº¦æ”¯å‡º[<span class="string">&#x27;ç”Ÿæ´»è´¹ç”¨&#x27;</span>].<span class="built_in">sum</span>():,&#125;</span>å…ƒï¼ˆå æ¯”<span class="subst">&#123;æœˆåº¦æ”¯å‡º[<span class="string">&#x27;ç”Ÿæ´»è´¹ç”¨&#x27;</span>].<span class="built_in">sum</span>()/å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;å¹´åº¦æ€»æ”¯å‡º&#x27;</span>]*<span class="number">100</span>:<span class="number">.1</span>f&#125;</span>%ï¼‰</span></span><br><span class="line"><span class="string">    â€¢ æˆ¿ç§Ÿ/æˆ¿è´·ï¼š<span class="subst">&#123;æœˆåº¦æ”¯å‡º[<span class="string">&#x27;æˆ¿ç§Ÿ/æˆ¿è´·&#x27;</span>].<span class="built_in">sum</span>():,&#125;</span>å…ƒï¼ˆå æ¯”<span class="subst">&#123;æœˆåº¦æ”¯å‡º[<span class="string">&#x27;æˆ¿ç§Ÿ/æˆ¿è´·&#x27;</span>].<span class="built_in">sum</span>()/å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;å¹´åº¦æ€»æ”¯å‡º&#x27;</span>]*<span class="number">100</span>:<span class="number">.1</span>f&#125;</span>%ï¼‰</span></span><br><span class="line"><span class="string">    â€¢ äº¤é€šè´¹ç”¨ï¼š<span class="subst">&#123;æœˆåº¦æ”¯å‡º[<span class="string">&#x27;äº¤é€šè´¹ç”¨&#x27;</span>].<span class="built_in">sum</span>():,&#125;</span>å…ƒï¼ˆå æ¯”<span class="subst">&#123;æœˆåº¦æ”¯å‡º[<span class="string">&#x27;äº¤é€šè´¹ç”¨&#x27;</span>].<span class="built_in">sum</span>()/å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;å¹´åº¦æ€»æ”¯å‡º&#x27;</span>]*<span class="number">100</span>:<span class="number">.1</span>f&#125;</span>%ï¼‰</span></span><br><span class="line"><span class="string">    â€¢ å¨±ä¹æ¶ˆè´¹ï¼š<span class="subst">&#123;æœˆåº¦æ”¯å‡º[<span class="string">&#x27;å¨±ä¹æ¶ˆè´¹&#x27;</span>].<span class="built_in">sum</span>():,&#125;</span>å…ƒï¼ˆå æ¯”<span class="subst">&#123;æœˆåº¦æ”¯å‡º[<span class="string">&#x27;å¨±ä¹æ¶ˆè´¹&#x27;</span>].<span class="built_in">sum</span>()/å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;å¹´åº¦æ€»æ”¯å‡º&#x27;</span>]*<span class="number">100</span>:<span class="number">.1</span>f&#125;</span>%ï¼‰</span></span><br><span class="line"><span class="string">    â€¢ å­¦ä¹ åŸ¹è®­ï¼š<span class="subst">&#123;æœˆåº¦æ”¯å‡º[<span class="string">&#x27;å­¦ä¹ åŸ¹è®­&#x27;</span>].<span class="built_in">sum</span>():,&#125;</span>å…ƒï¼ˆå æ¯”<span class="subst">&#123;æœˆåº¦æ”¯å‡º[<span class="string">&#x27;å­¦ä¹ åŸ¹è®­&#x27;</span>].<span class="built_in">sum</span>()/å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;å¹´åº¦æ€»æ”¯å‡º&#x27;</span>]*<span class="number">100</span>:<span class="number">.1</span>f&#125;</span>%ï¼‰</span></span><br><span class="line"><span class="string">    â€¢ å…¶ä»–æ”¯å‡ºï¼š<span class="subst">&#123;æœˆåº¦æ”¯å‡º[<span class="string">&#x27;å…¶ä»–æ”¯å‡º&#x27;</span>].<span class="built_in">sum</span>():,&#125;</span>å…ƒï¼ˆå æ¯”<span class="subst">&#123;æœˆåº¦æ”¯å‡º[<span class="string">&#x27;å…¶ä»–æ”¯å‡º&#x27;</span>].<span class="built_in">sum</span>()/å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;å¹´åº¦æ€»æ”¯å‡º&#x27;</span>]*<span class="number">100</span>:<span class="number">.1</span>f&#125;</span>%ï¼‰</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    ğŸ“Š ç»“ä½™æƒ…å†µ</span></span><br><span class="line"><span class="string">    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span><br><span class="line"><span class="string">    â€¢ æœ€é«˜æœˆç»“ä½™ï¼š<span class="subst">&#123;å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;æœ€é«˜æœˆç»“ä½™&#x27;</span>]:,&#125;</span>å…ƒï¼ˆ<span class="subst">&#123;æœˆåº¦ç»“ä½™[æœˆåº¦ç»“ä½™[<span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>]==å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;æœ€é«˜æœˆç»“ä½™&#x27;</span>]][<span class="string">&#x27;æœˆä»½&#x27;</span>].values[<span class="number">0</span>]&#125;</span>ï¼‰</span></span><br><span class="line"><span class="string">    â€¢ æœ€ä½æœˆç»“ä½™ï¼š<span class="subst">&#123;å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;æœ€ä½æœˆç»“ä½™&#x27;</span>]:,&#125;</span>å…ƒï¼ˆ<span class="subst">&#123;æœˆåº¦ç»“ä½™[æœˆåº¦ç»“ä½™[<span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>]==å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;æœ€ä½æœˆç»“ä½™&#x27;</span>]][<span class="string">&#x27;æœˆä»½&#x27;</span>].values[<span class="number">0</span>]&#125;</span>ï¼‰</span></span><br><span class="line"><span class="string">    â€¢ æœ€é«˜ç»“ä½™ç‡ï¼š<span class="subst">&#123;å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;æœ€é«˜ç»“ä½™ç‡&#x27;</span>]:<span class="number">.1</span>f&#125;</span>%ï¼ˆ<span class="subst">&#123;æœˆåº¦ç»“ä½™[æœˆåº¦ç»“ä½™[<span class="string">&#x27;ç»“ä½™ç‡&#x27;</span>]==å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;æœ€é«˜ç»“ä½™ç‡&#x27;</span>]][<span class="string">&#x27;æœˆä»½&#x27;</span>].values[<span class="number">0</span>]&#125;</span>ï¼‰</span></span><br><span class="line"><span class="string">    â€¢ æœ€ä½ç»“ä½™ç‡ï¼š<span class="subst">&#123;å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;æœ€ä½ç»“ä½™ç‡&#x27;</span>]:<span class="number">.1</span>f&#125;</span>%ï¼ˆ<span class="subst">&#123;æœˆåº¦ç»“ä½™[æœˆåº¦ç»“ä½™[<span class="string">&#x27;ç»“ä½™ç‡&#x27;</span>]==å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;æœ€ä½ç»“ä½™ç‡&#x27;</span>]][<span class="string">&#x27;æœˆä»½&#x27;</span>].values[<span class="number">0</span>]&#125;</span>ï¼‰</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    ğŸ’¡ è´¢åŠ¡å¥åº·åº¦è¯„ä¼°</span></span><br><span class="line"><span class="string">    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ ¹æ®ç»“ä½™ç‡è¯„ä¼°è´¢åŠ¡å¥åº·åº¦</span></span><br><span class="line">    <span class="keyword">if</span> å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;å¹³å‡ç»“ä½™ç‡&#x27;</span>] &gt;= <span class="number">25</span>:</span><br><span class="line">        å¥åº·è¯„ä»· = <span class="string">&quot;ä¼˜ç§€ ğŸ†&quot;</span></span><br><span class="line">        å»ºè®® = <span class="string">&quot;æ‚¨çš„è´¢åŠ¡çŠ¶å†µéå¸¸å¥åº·ï¼å»ºè®®ç»§ç»­ä¿æŒè‰¯å¥½çš„å‚¨è“„ä¹ æƒ¯ï¼Œå¹¶è€ƒè™‘å¢åŠ æŠ•èµ„ä»¥å®ç°è´¢å¯Œå¢å€¼ã€‚&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;å¹³å‡ç»“ä½™ç‡&#x27;</span>] &gt;= <span class="number">20</span>:</span><br><span class="line">        å¥åº·è¯„ä»· = <span class="string">&quot;è‰¯å¥½ ğŸ‘&quot;</span></span><br><span class="line">        å»ºè®® = <span class="string">&quot;æ‚¨çš„è´¢åŠ¡çŠ¶å†µè‰¯å¥½ï¼å»ºè®®ç»§ç»­ä¿æŒï¼Œå¯ä»¥é€‚å½“å¢åŠ æŠ•èµ„æˆ–åº”æ€¥å‚¨å¤‡ã€‚&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;å¹³å‡ç»“ä½™ç‡&#x27;</span>] &gt;= <span class="number">15</span>:</span><br><span class="line">        å¥åº·è¯„ä»· = <span class="string">&quot;ä¸€èˆ¬ âš ï¸&quot;</span></span><br><span class="line">        å»ºè®® = <span class="string">&quot;æ‚¨çš„è´¢åŠ¡çŠ¶å†µä¸€èˆ¬ï¼Œå»ºè®®é€‚å½“æ§åˆ¶æ”¯å‡ºï¼Œæé«˜å‚¨è“„ç‡ã€‚&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        å¥åº·è¯„ä»· = <span class="string">&quot;éœ€æ”¹å–„ ğŸ’”&quot;</span></span><br><span class="line">        å»ºè®® = <span class="string">&quot;æ‚¨çš„è´¢åŠ¡çŠ¶å†µéœ€è¦æ”¹å–„ï¼Œå»ºè®®è¯¦ç»†åˆ†ææ”¯å‡ºç»“æ„ï¼Œåˆ¶å®šä¸¥æ ¼çš„é¢„ç®—è®¡åˆ’ã€‚&quot;</span></span><br><span class="line">    </span><br><span class="line">    æŠ¥å‘Šå†…å®¹ += <span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    â€¢ è´¢åŠ¡å¥åº·åº¦ï¼š<span class="subst">&#123;å¥åº·è¯„ä»·&#125;</span></span></span><br><span class="line"><span class="string">    â€¢ å¹³å‡ç»“ä½™ç‡ï¼š<span class="subst">&#123;å¹´åº¦æŒ‡æ ‡[<span class="string">&#x27;å¹³å‡ç»“ä½™ç‡&#x27;</span>]:<span class="number">.1</span>f&#125;</span>%</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    ğŸ’° ç†è´¢å»ºè®®</span></span><br><span class="line"><span class="string">    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span><br><span class="line"><span class="string">    <span class="subst">&#123;å»ºè®®&#125;</span></span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    ğŸ¯ æ˜å¹´ç›®æ ‡å»ºè®®</span></span><br><span class="line"><span class="string">    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span><br><span class="line"><span class="string">    â€¢ ç›®æ ‡ç»“ä½™ç‡ï¼šâ‰¥25%</span></span><br><span class="line"><span class="string">    â€¢ å»ºè®®å¢åŠ æŠ•èµ„æ”¶å…¥å æ¯”</span></span><br><span class="line"><span class="string">    â€¢ æ§åˆ¶éå¿…è¦æ”¯å‡º</span></span><br><span class="line"><span class="string">    â€¢ å»ºç«‹åº”æ€¥åŸºé‡‘ï¼ˆ6ä¸ªæœˆç”Ÿæ´»è´¹ï¼‰</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    ğŸ“… æŠ¥å‘Šç”Ÿæˆæ—¶é—´ï¼š<span class="subst">&#123;datetime.now().strftime(<span class="string">&#x27;%Yå¹´%mæœˆ%dæ—¥ %H:%M&#x27;</span>)&#125;</span></span></span><br><span class="line"><span class="string">    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> æŠ¥å‘Šå†…å®¹</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”ŸæˆåŸºç¡€æŠ¥å‘Š</span></span><br><span class="line">åŸºç¡€æŠ¥å‘Š = ç”ŸæˆåŸºç¡€å¹´æŠ¥()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿å­˜åˆ°æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;ä¸ªäººç†è´¢å¹´åº¦æŠ¥å‘Š_åŸºç¡€ç‰ˆ.txt&quot;</span>, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(åŸºç¡€æŠ¥å‘Š)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;âœ… åŸºç¡€å¹´åº¦æŠ¥å‘Šå·²ç”Ÿæˆï¼šä¸ªäººç†è´¢å¹´åº¦æŠ¥å‘Š_åŸºç¡€ç‰ˆ.txt&quot;</span>)</span><br></pre></td></tr></table></figure></details><details><summary>ç‰ˆæœ¬2.0ï¼šå¯è§†åŒ–å¹´åº¦æŠ¥å‘Š</summary><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯è§†åŒ–å¹´åº¦æŠ¥å‘Š</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n=== å¯è§†åŒ–å¹´åº¦æŠ¥å‘Š ===&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ç”Ÿæˆå¯è§†åŒ–å¹´æŠ¥</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ç”ŸæˆåŒ…å«ä¸°å¯Œå›¾è¡¨çš„å¹´åº¦æŠ¥å‘Š&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ğŸ“Š å¼€å§‹ç”Ÿæˆå¯è§†åŒ–å¹´åº¦æŠ¥å‘Š...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åˆ›å»ºå¤§å‹å›¾è¡¨ç»„åˆ</span></span><br><span class="line">    fig = plt.figure(figsize=(<span class="number">16</span>, <span class="number">12</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åˆ›å»ºç½‘æ ¼å¸ƒå±€</span></span><br><span class="line">    gs = fig.add_gridspec(<span class="number">3</span>, <span class="number">3</span>, hspace=<span class="number">0.3</span>, wspace=<span class="number">0.3</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 1. å¹´åº¦æ”¶æ”¯æ€»è§ˆï¼ˆå¤§å›¾ï¼Œå æ®2x2åŒºåŸŸï¼‰</span></span><br><span class="line">    ax1 = fig.add_subplot(gs[<span class="number">0</span>, :<span class="number">2</span>])</span><br><span class="line">    ax1.plot(æœˆåº¦æ”¶å…¥[<span class="string">&#x27;æœˆä»½&#x27;</span>], æœˆåº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>], marker=<span class="string">&#x27;o&#x27;</span>, linewidth=<span class="number">4</span>, </span><br><span class="line">            label=<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>, color=<span class="string">&#x27;#2E8B57&#x27;</span>, markersize=<span class="number">8</span>)</span><br><span class="line">    ax1.plot(æœˆåº¦æ”¯å‡º[<span class="string">&#x27;æœˆä»½&#x27;</span>], æœˆåº¦æ”¯å‡º[<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>], marker=<span class="string">&#x27;s&#x27;</span>, linewidth=<span class="number">4</span>, </span><br><span class="line">            label=<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>, color=<span class="string">&#x27;#DC143C&#x27;</span>, markersize=<span class="number">8</span>)</span><br><span class="line">    ax1.fill_between(æœˆåº¦æ”¶å…¥[<span class="string">&#x27;æœˆä»½&#x27;</span>], æœˆåº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>], alpha=<span class="number">0.3</span>, color=<span class="string">&#x27;#2E8B57&#x27;</span>)</span><br><span class="line">    ax1.fill_between(æœˆåº¦æ”¯å‡º[<span class="string">&#x27;æœˆä»½&#x27;</span>], æœˆåº¦æ”¯å‡º[<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>], alpha=<span class="number">0.3</span>, color=<span class="string">&#x27;#DC143C&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ·»åŠ å¹´åº¦æ€»è®¡</span></span><br><span class="line">    å¹´åº¦æ€»æ”¶å…¥ = æœˆåº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>].<span class="built_in">sum</span>()</span><br><span class="line">    å¹´åº¦æ€»æ”¯å‡º = æœˆåº¦æ”¯å‡º[<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>].<span class="built_in">sum</span>()</span><br><span class="line">    ax1.text(<span class="number">0.02</span>, <span class="number">0.98</span>, <span class="string">f&#x27;å¹´åº¦æ€»æ”¶å…¥ï¼š<span class="subst">&#123;å¹´åº¦æ€»æ”¶å…¥:,&#125;</span>å…ƒ&#x27;</span>, transform=ax1.transAxes, </span><br><span class="line">            fontsize=<span class="number">12</span>, verticalalignment=<span class="string">&#x27;top&#x27;</span>, bbox=<span class="built_in">dict</span>(boxstyle=<span class="string">&#x27;round&#x27;</span>, facecolor=<span class="string">&#x27;lightgreen&#x27;</span>, alpha=<span class="number">0.7</span>))</span><br><span class="line">    ax1.text(<span class="number">0.02</span>, <span class="number">0.88</span>, <span class="string">f&#x27;å¹´åº¦æ€»æ”¯å‡ºï¼š<span class="subst">&#123;å¹´åº¦æ€»æ”¯å‡º:,&#125;</span>å…ƒ&#x27;</span>, transform=ax1.transAxes, </span><br><span class="line">            fontsize=<span class="number">12</span>, verticalalignment=<span class="string">&#x27;top&#x27;</span>, bbox=<span class="built_in">dict</span>(boxstyle=<span class="string">&#x27;round&#x27;</span>, facecolor=<span class="string">&#x27;lightcoral&#x27;</span>, alpha=<span class="number">0.7</span>))</span><br><span class="line">    </span><br><span class="line">    ax1.set_title(<span class="string">&#x27;2024å¹´åº¦æ”¶æ”¯æ€»è§ˆ&#x27;</span>, fontsize=<span class="number">18</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>, pad=<span class="number">20</span>)</span><br><span class="line">    ax1.set_xlabel(<span class="string">&#x27;æœˆä»½&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">    ax1.set_ylabel(<span class="string">&#x27;é‡‘é¢ï¼ˆå…ƒï¼‰&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">    ax1.legend(fontsize=<span class="number">12</span>, loc=<span class="string">&#x27;upper right&#x27;</span>)</span><br><span class="line">    ax1.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. æ”¶å…¥ç»“æ„é¥¼å›¾</span></span><br><span class="line">    ax2 = fig.add_subplot(gs[<span class="number">0</span>, <span class="number">2</span>])</span><br><span class="line">    å¹´åº¦æ”¶å…¥ç»“æ„ = æœˆåº¦æ”¶å…¥[[<span class="string">&#x27;å·¥èµ„æ”¶å…¥&#x27;</span>, <span class="string">&#x27;æŠ•èµ„æ”¶ç›Š&#x27;</span>, <span class="string">&#x27;å…¶ä»–æ”¶å…¥&#x27;</span>]].<span class="built_in">sum</span>()</span><br><span class="line">    colors = [<span class="string">&#x27;#3498DB&#x27;</span>, <span class="string">&#x27;#2ECC71&#x27;</span>, <span class="string">&#x27;#F39C12&#x27;</span>]</span><br><span class="line">    wedges, texts, autotexts = ax2.pie(å¹´åº¦æ”¶å…¥ç»“æ„.values, labels=å¹´åº¦æ”¶å…¥ç»“æ„.index, </span><br><span class="line">                                       autopct=<span class="string">&#x27;%1.1f%%&#x27;</span>, startangle=<span class="number">90</span>, colors=colors)</span><br><span class="line">    ax2.set_title(<span class="string">&#x27;å¹´åº¦æ”¶å…¥ç»“æ„&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ç¾åŒ–é¥¼å›¾æ–‡å­—</span></span><br><span class="line">    <span class="keyword">for</span> autotext <span class="keyword">in</span> autotexts:</span><br><span class="line">        autotext.set_color(<span class="string">&#x27;white&#x27;</span>)</span><br><span class="line">        autotext.set_fontweight(<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. æ”¯å‡ºç»“æ„å †å å›¾</span></span><br><span class="line">    ax3 = fig.add_subplot(gs[<span class="number">1</span>, :])</span><br><span class="line">    æ”¯å‡ºæ•°æ® = æœˆåº¦æ”¯å‡º[[<span class="string">&#x27;æœˆä»½&#x27;</span>, <span class="string">&#x27;ç”Ÿæ´»è´¹ç”¨&#x27;</span>, <span class="string">&#x27;æˆ¿ç§Ÿ/æˆ¿è´·&#x27;</span>, <span class="string">&#x27;äº¤é€šè´¹ç”¨&#x27;</span>, <span class="string">&#x27;å¨±ä¹æ¶ˆè´¹&#x27;</span>, <span class="string">&#x27;å­¦ä¹ åŸ¹è®­&#x27;</span>, <span class="string">&#x27;å…¶ä»–æ”¯å‡º&#x27;</span>]].set_index(<span class="string">&#x27;æœˆä»½&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    ax3.stackplot(æ”¯å‡ºæ•°æ®.index, </span><br><span class="line">                  æ”¯å‡ºæ•°æ®[<span class="string">&#x27;ç”Ÿæ´»è´¹ç”¨&#x27;</span>], æ”¯å‡ºæ•°æ®[<span class="string">&#x27;æˆ¿ç§Ÿ/æˆ¿è´·&#x27;</span>], æ”¯å‡ºæ•°æ®[<span class="string">&#x27;äº¤é€šè´¹ç”¨&#x27;</span>],</span><br><span class="line">                  æ”¯å‡ºæ•°æ®[<span class="string">&#x27;å¨±ä¹æ¶ˆè´¹&#x27;</span>], æ”¯å‡ºæ•°æ®[<span class="string">&#x27;å­¦ä¹ åŸ¹è®­&#x27;</span>], æ”¯å‡ºæ•°æ®[<span class="string">&#x27;å…¶ä»–æ”¯å‡º&#x27;</span>],</span><br><span class="line">                  labels=[<span class="string">&#x27;ç”Ÿæ´»è´¹ç”¨&#x27;</span>, <span class="string">&#x27;æˆ¿ç§Ÿ/æˆ¿è´·&#x27;</span>, <span class="string">&#x27;äº¤é€šè´¹ç”¨&#x27;</span>, <span class="string">&#x27;å¨±ä¹æ¶ˆè´¹&#x27;</span>, <span class="string">&#x27;å­¦ä¹ åŸ¹è®­&#x27;</span>, <span class="string">&#x27;å…¶ä»–æ”¯å‡º&#x27;</span>],</span><br><span class="line">                  colors=[<span class="string">&#x27;#FF6B6B&#x27;</span>, <span class="string">&#x27;#4ECDC4&#x27;</span>, <span class="string">&#x27;#45B7D1&#x27;</span>, <span class="string">&#x27;#96CEB4&#x27;</span>, <span class="string">&#x27;#FECA57&#x27;</span>, <span class="string">&#x27;#FF9FF3&#x27;</span>],</span><br><span class="line">                  alpha=<span class="number">0.8</span>)</span><br><span class="line">    </span><br><span class="line">    ax3.set_title(<span class="string">&#x27;æœˆåº¦æ”¯å‡ºç»“æ„å˜åŒ–&#x27;</span>, fontsize=<span class="number">16</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">    ax3.set_xlabel(<span class="string">&#x27;æœˆä»½&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">    ax3.set_ylabel(<span class="string">&#x27;æ”¯å‡ºé‡‘é¢ï¼ˆå…ƒï¼‰&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">    ax3.legend(loc=<span class="string">&#x27;upper left&#x27;</span>, bbox_to_anchor=(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">    ax3.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 4. ç»“ä½™ç‡åˆ†æ</span></span><br><span class="line">    ax4 = fig.add_subplot(gs[<span class="number">2</span>, <span class="number">0</span>])</span><br><span class="line">    bars = ax4.bar(æœˆåº¦ç»“ä½™[<span class="string">&#x27;æœˆä»½&#x27;</span>], æœˆåº¦ç»“ä½™[<span class="string">&#x27;ç»“ä½™ç‡&#x27;</span>], </span><br><span class="line">                   color=[<span class="string">&#x27;#2ECC71&#x27;</span> <span class="keyword">if</span> x &gt;= <span class="number">20</span> <span class="keyword">else</span> <span class="string">&#x27;#F39C12&#x27;</span> <span class="keyword">if</span> x &gt;= <span class="number">10</span> <span class="keyword">else</span> <span class="string">&#x27;#E74C3C&#x27;</span> <span class="keyword">for</span> x <span class="keyword">in</span> æœˆåº¦ç»“ä½™[<span class="string">&#x27;ç»“ä½™ç‡&#x27;</span>]])</span><br><span class="line">    </span><br><span class="line">    ax4.set_title(<span class="string">&#x27;æœˆåº¦ç»“ä½™ç‡&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">    ax4.set_xlabel(<span class="string">&#x27;æœˆä»½&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">    ax4.set_ylabel(<span class="string">&#x27;ç»“ä½™ç‡ï¼ˆ%ï¼‰&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">    ax4.axhline(y=<span class="number">20</span>, color=<span class="string">&#x27;green&#x27;</span>, linestyle=<span class="string">&#x27;--&#x27;</span>, alpha=<span class="number">0.7</span>, label=<span class="string">&#x27;ç›®æ ‡ç»“ä½™ç‡&#x27;</span>)</span><br><span class="line">    ax4.legend()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ·»åŠ æ•°å€¼æ ‡ç­¾</span></span><br><span class="line">    <span class="keyword">for</span> bar, æ•°å€¼ <span class="keyword">in</span> <span class="built_in">zip</span>(bars, æœˆåº¦ç»“ä½™[<span class="string">&#x27;ç»“ä½™ç‡&#x27;</span>]):</span><br><span class="line">        ax4.annotate(<span class="string">f&#x27;<span class="subst">&#123;æ•°å€¼:<span class="number">.1</span>f&#125;</span>%&#x27;</span>, (bar.get_x() + bar.get_width()/<span class="number">2</span>, bar.get_height() + <span class="number">0.5</span>), </span><br><span class="line">                    ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;bottom&#x27;</span>, fontsize=<span class="number">9</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 5. æ”¶å…¥å¯¹æ¯”æŸ±çŠ¶å›¾</span></span><br><span class="line">    ax5 = fig.add_subplot(gs[<span class="number">2</span>, <span class="number">1</span>])</span><br><span class="line">    æ”¶å…¥å¯¹æ¯” = æœˆåº¦æ”¶å…¥.set_index(<span class="string">&#x27;æœˆä»½&#x27;</span>)[[<span class="string">&#x27;å·¥èµ„æ”¶å…¥&#x27;</span>, <span class="string">&#x27;æŠ•èµ„æ”¶ç›Š&#x27;</span>, <span class="string">&#x27;å…¶ä»–æ”¶å…¥&#x27;</span>]]</span><br><span class="line">    </span><br><span class="line">    æ”¶å…¥å¯¹æ¯”.plot(kind=<span class="string">&#x27;bar&#x27;</span>, ax=ax5, color=[<span class="string">&#x27;#3498DB&#x27;</span>, <span class="string">&#x27;#2ECC71&#x27;</span>, <span class="string">&#x27;#F39C12&#x27;</span>], width=<span class="number">0.8</span>)</span><br><span class="line">    ax5.set_title(<span class="string">&#x27;å„ç±»æ”¶å…¥æœˆåº¦å¯¹æ¯”&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">    ax5.set_xlabel(<span class="string">&#x27;æœˆä»½&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">    ax5.set_ylabel(<span class="string">&#x27;æ”¶å…¥é‡‘é¢ï¼ˆå…ƒï¼‰&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">    ax5.legend(fontsize=<span class="number">10</span>)</span><br><span class="line">    ax5.tick_params(axis=<span class="string">&#x27;x&#x27;</span>, rotation=<span class="number">45</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 6. çƒ­åŠ›å›¾</span></span><br><span class="line">    ax6 = fig.add_subplot(gs[<span class="number">2</span>, <span class="number">2</span>])</span><br><span class="line">    æ”¶æ”¯æ˜ç»† = æœˆåº¦æ”¯å‡º.drop([<span class="string">&#x27;æœˆä»½&#x27;</span>, <span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>], axis=<span class="number">1</span>)</span><br><span class="line">    çƒ­åŠ›å›¾æ•°æ® = æ”¶æ”¯æ˜ç»†.T</span><br><span class="line">    </span><br><span class="line">    sns.heatmap(çƒ­åŠ›å›¾æ•°æ®, annot=<span class="literal">True</span>, fmt=<span class="string">&#x27;d&#x27;</span>, cmap=<span class="string">&#x27;RdYlGn_r&#x27;</span>, ax=ax6, </span><br><span class="line">                cbar_kws=&#123;<span class="string">&#x27;label&#x27;</span>: <span class="string">&#x27;é‡‘é¢ï¼ˆå…ƒï¼‰&#x27;</span>&#125;, linewidths=<span class="number">0.5</span>)</span><br><span class="line">    ax6.set_title(<span class="string">&#x27;æœˆåº¦æ”¯å‡ºçƒ­åŠ›å›¾&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">    ax6.set_xlabel(<span class="string">&#x27;æœˆä»½&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">    ax6.set_ylabel(<span class="string">&#x27;æ”¯å‡ºç±»åˆ«&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ•´ä½“æ ‡é¢˜</span></span><br><span class="line">    fig.suptitle(<span class="string">&#x27;ä¸ªäººç†è´¢å¹´åº¦æŠ¥å‘Š 2024&#x27;</span>, fontsize=<span class="number">24</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>, y=<span class="number">0.98</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ·»åŠ é¡µè„šä¿¡æ¯</span></span><br><span class="line">    fig.text(<span class="number">0.5</span>, <span class="number">0.02</span>, </span><br><span class="line">             <span class="string">f&#x27;æŠ¥å‘Šç”Ÿæˆæ—¶é—´ï¼š<span class="subst">&#123;datetime.now().strftime(<span class="string">&quot;%Yå¹´%mæœˆ%dæ—¥ %H:%M&quot;</span>)&#125;</span> | &#x27;</span> +</span><br><span class="line">             <span class="string">f&#x27;å¹´åº¦æ€»ç»“ä½™ï¼š<span class="subst">&#123;æœˆåº¦ç»“ä½™[<span class="string">&quot;æœˆåº¦ç»“ä½™&quot;</span>].<span class="built_in">sum</span>():,&#125;</span>å…ƒ | &#x27;</span> +</span><br><span class="line">             <span class="string">f&#x27;å¹³å‡ç»“ä½™ç‡ï¼š<span class="subst">&#123;æœˆåº¦ç»“ä½™[<span class="string">&quot;ç»“ä½™ç‡&quot;</span>].mean():<span class="number">.1</span>f&#125;</span>%&#x27;</span>,</span><br><span class="line">             ha=<span class="string">&#x27;center&#x27;</span>, fontsize=<span class="number">12</span>, style=<span class="string">&#x27;italic&#x27;</span>,</span><br><span class="line">             bbox=<span class="built_in">dict</span>(boxstyle=<span class="string">&#x27;round,pad=0.5&#x27;</span>, facecolor=<span class="string">&#x27;lightgray&#x27;</span>, alpha=<span class="number">0.8</span>))</span><br><span class="line">    </span><br><span class="line">    plt.tight_layout()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ä¿å­˜å›¾è¡¨</span></span><br><span class="line">    plt.savefig(<span class="string">&#x27;ä¸ªäººç†è´¢å¹´åº¦æŠ¥å‘Š_å®Œæ•´ç‰ˆ.png&#x27;</span>, dpi=<span class="number">300</span>, bbox_inches=<span class="string">&#x27;tight&#x27;</span>, facecolor=<span class="string">&#x27;white&#x27;</span>)</span><br><span class="line">    plt.show()</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;âœ… å¯è§†åŒ–å¹´åº¦æŠ¥å‘Šå·²ç”Ÿæˆï¼šä¸ªäººç†è´¢å¹´åº¦æŠ¥å‘Š_å®Œæ•´ç‰ˆ.png&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> fig</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆå¯è§†åŒ–å¹´æŠ¥</span></span><br><span class="line">å¯è§†åŒ–å¹´æŠ¥ = ç”Ÿæˆå¯è§†åŒ–å¹´æŠ¥()</span><br></pre></td></tr></table></figure></details><details><summary>ç‰ˆæœ¬3.0ï¼šä¸“ä¸šå¹´åº¦æŠ¥å‘Šç³»ç»Ÿ</summary><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸“ä¸šå¹´åº¦æŠ¥å‘Šç³»ç»Ÿ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n=== ä¸“ä¸šå¹´åº¦æŠ¥å‘Šç³»ç»Ÿ ===&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">å¹´åº¦æŠ¥å‘Šç”Ÿæˆå™¨</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ä¸“ä¸šå¹´åº¦æŠ¥å‘Šç”Ÿæˆå™¨&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.å¹´åº¦æ•°æ® = <span class="literal">None</span></span><br><span class="line">        self.åˆ†ææŠ¥å‘Š = &#123;&#125;</span><br><span class="line">        self.å›¾è¡¨æ–‡ä»¶ = []</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">åŠ è½½æ•°æ®</span>(<span class="params">self, æ”¶å…¥æ•°æ®, æ”¯å‡ºæ•°æ®, ç»“ä½™æ•°æ®</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;åŠ è½½å¹´åº¦è´¢åŠ¡æ•°æ®&quot;&quot;&quot;</span></span><br><span class="line">        self.å¹´åº¦æ”¶å…¥ = æ”¶å…¥æ•°æ®</span><br><span class="line">        self.å¹´åº¦æ”¯å‡º = æ”¯å‡ºæ•°æ®</span><br><span class="line">        self.å¹´åº¦ç»“ä½™ = ç»“ä½™æ•°æ®</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è®¡ç®—å¹´åº¦æ±‡æ€»</span></span><br><span class="line">        self.è®¡ç®—å¹´åº¦æ±‡æ€»()</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;âœ… å¹´åº¦æ•°æ®åŠ è½½å®Œæˆ&quot;</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">è®¡ç®—å¹´åº¦æ±‡æ€»</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;è®¡ç®—å¹´åº¦å…³é”®æŒ‡æ ‡&quot;&quot;&quot;</span></span><br><span class="line">        self.å¹´åº¦æ±‡æ€» = &#123;</span><br><span class="line">            <span class="string">&#x27;å¹´åº¦æ€»æ”¶å…¥&#x27;</span>: self.å¹´åº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>].<span class="built_in">sum</span>(),</span><br><span class="line">            <span class="string">&#x27;å¹´åº¦æ€»æ”¯å‡º&#x27;</span>: self.å¹´åº¦æ”¯å‡º[<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>].<span class="built_in">sum</span>(),</span><br><span class="line">            <span class="string">&#x27;å¹´åº¦æ€»ç»“ä½™&#x27;</span>: self.å¹´åº¦ç»“ä½™[<span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>].<span class="built_in">sum</span>(),</span><br><span class="line">            <span class="string">&#x27;å¹³å‡æœˆç»“ä½™&#x27;</span>: self.å¹´åº¦ç»“ä½™[<span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>].mean(),</span><br><span class="line">            <span class="string">&#x27;å¹³å‡ç»“ä½™ç‡&#x27;</span>: self.å¹´åº¦ç»“ä½™[<span class="string">&#x27;ç»“ä½™ç‡&#x27;</span>].mean(),</span><br><span class="line">            <span class="string">&#x27;æ”¶å…¥ç»“æ„&#x27;</span>: self.å¹´åº¦æ”¶å…¥[[<span class="string">&#x27;å·¥èµ„æ”¶å…¥&#x27;</span>, <span class="string">&#x27;æŠ•èµ„æ”¶ç›Š&#x27;</span>, <span class="string">&#x27;å…¶ä»–æ”¶å…¥&#x27;</span>]].<span class="built_in">sum</span>(),</span><br><span class="line">            <span class="string">&#x27;æ”¯å‡ºç»“æ„&#x27;</span>: self.å¹´åº¦æ”¯å‡º.drop([<span class="string">&#x27;æœˆä»½&#x27;</span>, <span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>], axis=<span class="number">1</span>).<span class="built_in">sum</span>()</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è®¡ç®—æ’åå’Œå æ¯”</span></span><br><span class="line">        self.è®¡ç®—è¯¦ç»†åˆ†æ()</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">è®¡ç®—è¯¦ç»†åˆ†æ</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;è¿›è¡Œè¯¦ç»†çš„æ•°æ®åˆ†æ&quot;&quot;&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æœˆåº¦æ’å</span></span><br><span class="line">        self.æœˆåº¦æ’å = &#123;</span><br><span class="line">            <span class="string">&#x27;æ”¶å…¥æœ€é«˜æœˆä»½&#x27;</span>: self.å¹´åº¦æ”¶å…¥.loc[self.å¹´åº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>].idxmax(), <span class="string">&#x27;æœˆä»½&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;æ”¶å…¥æœ€ä½æœˆä»½&#x27;</span>: self.å¹´åº¦æ”¶å…¥.loc[self.å¹´åº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>].idxmin(), <span class="string">&#x27;æœˆä»½&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;æ”¯å‡ºæœ€é«˜æœˆä»½&#x27;</span>: self.å¹´åº¦æ”¯å‡º.loc[self.å¹´åº¦æ”¯å‡º[<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>].idxmax(), <span class="string">&#x27;æœˆä»½&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;æ”¯å‡ºæœ€ä½æœˆä»½&#x27;</span>: self.å¹´åº¦æ”¯å‡º.loc[self.å¹´åº¦æ”¯å‡º[<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>].idxmin(), <span class="string">&#x27;æœˆä»½&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;ç»“ä½™æœ€é«˜æœˆä»½&#x27;</span>: self.å¹´åº¦ç»“ä½™.loc[self.å¹´åº¦ç»“ä½™[<span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>].idxmax(), <span class="string">&#x27;æœˆä»½&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;ç»“ä½™æœ€ä½æœˆä»½&#x27;</span>: self.å¹´åº¦ç»“ä½™.loc[self.å¹´åº¦ç»“ä½™[<span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>].idxmin(), <span class="string">&#x27;æœˆä»½&#x27;</span>]</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è¶‹åŠ¿åˆ†æ</span></span><br><span class="line">        self.è¶‹åŠ¿åˆ†æ = &#123;</span><br><span class="line">            <span class="string">&#x27;æ”¶å…¥è¶‹åŠ¿&#x27;</span>: <span class="string">&#x27;ä¸Šå‡&#x27;</span> <span class="keyword">if</span> self.å¹´åº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>].iloc[-<span class="number">1</span>] &gt; self.å¹´åº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>].iloc[<span class="number">0</span>] <span class="keyword">else</span> <span class="string">&#x27;ä¸‹é™&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;æ”¯å‡ºè¶‹åŠ¿&#x27;</span>: <span class="string">&#x27;ä¸Šå‡&#x27;</span> <span class="keyword">if</span> self.å¹´åº¦æ”¯å‡º[<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>].iloc[-<span class="number">1</span>] &gt; self.å¹´åº¦æ”¯å‡º[<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>].iloc[<span class="number">0</span>] <span class="keyword">else</span> <span class="string">&#x27;ä¸‹é™&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;ç»“ä½™è¶‹åŠ¿&#x27;</span>: <span class="string">&#x27;æ”¹å–„&#x27;</span> <span class="keyword">if</span> self.å¹´åº¦ç»“ä½™[<span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>].iloc[-<span class="number">1</span>] &gt; self.å¹´åº¦ç»“ä½™[<span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>].iloc[<span class="number">0</span>] <span class="keyword">else</span> <span class="string">&#x27;æ¶åŒ–&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¥åº·åº¦è¯„ä¼°</span></span><br><span class="line">        self.å¥åº·åº¦è¯„ä¼°()</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">å¥åº·åº¦è¯„ä¼°</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;è¯„ä¼°è´¢åŠ¡å¥åº·åº¦&quot;&quot;&quot;</span></span><br><span class="line">        å¹³å‡ç»“ä½™ç‡ = self.å¹´åº¦æ±‡æ€»[<span class="string">&#x27;å¹³å‡ç»“ä½™ç‡&#x27;</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åŸºç¡€å¥åº·åº¦è¯„åˆ†</span></span><br><span class="line">        <span class="keyword">if</span> å¹³å‡ç»“ä½™ç‡ &gt;= <span class="number">25</span>:</span><br><span class="line">            self.å¥åº·ç­‰çº§ = <span class="string">&quot;ä¼˜ç§€&quot;</span></span><br><span class="line">            self.å¥åº·å¾—åˆ† = <span class="number">90</span></span><br><span class="line">            self.å¥åº·å»ºè®® = <span class="string">&quot;æ‚¨çš„è´¢åŠ¡çŠ¶å†µéå¸¸ä¼˜ç§€ï¼å»ºè®®ç»§ç»­ä¿æŒï¼Œå¹¶è€ƒè™‘å¢åŠ æŠ•èµ„ã€‚&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> å¹³å‡ç»“ä½™ç‡ &gt;= <span class="number">20</span>:</span><br><span class="line">            self.å¥åº·ç­‰çº§ = <span class="string">&quot;è‰¯å¥½&quot;</span></span><br><span class="line">            self.å¥åº·å¾—åˆ† = <span class="number">80</span></span><br><span class="line">            self.å¥åº·å»ºè®® = <span class="string">&quot;æ‚¨çš„è´¢åŠ¡çŠ¶å†µè‰¯å¥½ï¼å»ºè®®é€‚å½“ä¼˜åŒ–æ”¯å‡ºç»“æ„ï¼Œæé«˜å‚¨è“„æ•ˆç‡ã€‚&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> å¹³å‡ç»“ä½™ç‡ &gt;= <span class="number">15</span>:</span><br><span class="line">            self.å¥åº·ç­‰çº§ = <span class="string">&quot;ä¸€èˆ¬&quot;</span></span><br><span class="line">            self.å¥åº·å¾—åˆ† = <span class="number">70</span></span><br><span class="line">            self.å¥åº·å»ºè®® = <span class="string">&quot;æ‚¨çš„è´¢åŠ¡çŠ¶å†µä¸€èˆ¬ï¼Œå»ºè®®æ§åˆ¶éå¿…è¦æ”¯å‡ºï¼Œæé«˜ç»“ä½™ç‡ã€‚&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.å¥åº·ç­‰çº§ = <span class="string">&quot;éœ€æ”¹å–„&quot;</span></span><br><span class="line">            self.å¥åº·å¾—åˆ† = <span class="number">60</span></span><br><span class="line">            self.å¥åº·å»ºè®® = <span class="string">&quot;æ‚¨çš„è´¢åŠ¡çŠ¶å†µéœ€è¦æ”¹å–„ï¼Œå»ºè®®åˆ¶å®šä¸¥æ ¼çš„é¢„ç®—è®¡åˆ’ï¼Œå‡å°‘ä¸å¿…è¦çš„å¼€æ”¯ã€‚&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è¯¦ç»†å¥åº·æŒ‡æ ‡</span></span><br><span class="line">        self.å¥åº·æŒ‡æ ‡ = &#123;</span><br><span class="line">            <span class="string">&#x27;ç»“ä½™ç‡å¾—åˆ†&#x27;</span>: <span class="built_in">min</span>(<span class="number">100</span>, å¹³å‡ç»“ä½™ç‡ * <span class="number">4</span>),</span><br><span class="line">            <span class="string">&#x27;æ”¶å…¥ç¨³å®šæ€§å¾—åˆ†&#x27;</span>: <span class="built_in">max</span>(<span class="number">0</span>, <span class="number">100</span> - (self.å¹´åº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>].std() / self.å¹´åº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>].mean() * <span class="number">100</span>)),</span><br><span class="line">            <span class="string">&#x27;æ”¯å‡ºæ§åˆ¶å¾—åˆ†&#x27;</span>: <span class="built_in">max</span>(<span class="number">0</span>, <span class="number">100</span> - (self.å¹´åº¦æ”¯å‡º[<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>].std() / self.å¹´åº¦æ”¯å‡º[<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>].mean() * <span class="number">100</span>)),</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        self.å¥åº·æŒ‡æ ‡[<span class="string">&#x27;ç»¼åˆå¾—åˆ†&#x27;</span>] = <span class="built_in">sum</span>(self.å¥åº·æŒ‡æ ‡.values()) / <span class="built_in">len</span>(self.å¥åº·æŒ‡æ ‡)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ç”Ÿæˆå›¾è¡¨é›†</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç”Ÿæˆå®Œæ•´çš„å›¾è¡¨é›†&quot;&quot;&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ğŸ“Š ç”Ÿæˆä¸“ä¸šå›¾è¡¨é›†...&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åˆ›å»ºå¤§å‹å›¾è¡¨ç»„åˆ</span></span><br><span class="line">        self.å›¾è¡¨é›† = plt.figure(figsize=(<span class="number">20</span>, <span class="number">16</span>))</span><br><span class="line">        gs = self.å›¾è¡¨é›†.add_gridspec(<span class="number">4</span>, <span class="number">4</span>, hspace=<span class="number">0.4</span>, wspace=<span class="number">0.3</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 1. å¹´åº¦æ€»è§ˆï¼ˆå¤§å›¾ï¼‰</span></span><br><span class="line">        ax1 = self.å›¾è¡¨é›†.add_subplot(gs[<span class="number">0</span>, :<span class="number">2</span>])</span><br><span class="line">        self._ç»˜åˆ¶å¹´åº¦æ€»è§ˆ(ax1)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 2. æ”¶å…¥ç»“æ„ç¯å½¢å›¾</span></span><br><span class="line">        ax2 = self.å›¾è¡¨é›†.add_subplot(gs[<span class="number">0</span>, <span class="number">2</span>])</span><br><span class="line">        self._ç»˜åˆ¶æ”¶å…¥ç»“æ„(ax2)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 3. æ”¯å‡ºç»“æ„é¥¼å›¾</span></span><br><span class="line">        ax3 = self.å›¾è¡¨é›†.add_subplot(gs[<span class="number">0</span>, <span class="number">3</span>])</span><br><span class="line">        self._ç»˜åˆ¶æ”¯å‡ºç»“æ„(ax3)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 4. æœˆåº¦è¶‹åŠ¿å¯¹æ¯”</span></span><br><span class="line">        ax4 = self.å›¾è¡¨é›†.add_subplot(gs[<span class="number">1</span>, :<span class="number">2</span>])</span><br><span class="line">        self._ç»˜åˆ¶æœˆåº¦è¶‹åŠ¿(ax4)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 5. æ”¶æ”¯çƒ­åŠ›å›¾</span></span><br><span class="line">        ax5 = self.å›¾è¡¨é›†.add_subplot(gs[<span class="number">1</span>, <span class="number">2</span>:])</span><br><span class="line">        self._ç»˜åˆ¶çƒ­åŠ›å›¾(ax5)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 6. ç»“ä½™ç‡åˆ†æ</span></span><br><span class="line">        ax6 = self.å›¾è¡¨é›†.add_subplot(gs[<span class="number">2</span>, :<span class="number">2</span>])</span><br><span class="line">        self._ç»˜åˆ¶ç»“ä½™ç‡åˆ†æ(ax6)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 7. æ”¶å…¥å¯¹æ¯”</span></span><br><span class="line">        ax7 = self.å›¾è¡¨é›†.add_subplot(gs[<span class="number">2</span>, <span class="number">2</span>])</span><br><span class="line">        self._ç»˜åˆ¶æ”¶å…¥å¯¹æ¯”(ax7)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 8. æ”¯å‡ºå¯¹æ¯”</span></span><br><span class="line">        ax8 = self.å›¾è¡¨é›†.add_subplot(gs[<span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">        self._ç»˜åˆ¶æ”¯å‡ºå¯¹æ¯”(ax8)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 9. å¥åº·åº¦é›·è¾¾å›¾</span></span><br><span class="line">        ax9 = self.å›¾è¡¨é›†.add_subplot(gs[<span class="number">3</span>, :<span class="number">2</span>])</span><br><span class="line">        self._ç»˜åˆ¶å¥åº·åº¦é›·è¾¾å›¾(ax9)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 10. å…³é”®æŒ‡æ ‡ä»ªè¡¨ç›˜</span></span><br><span class="line">        ax10 = self.å›¾è¡¨é›†.add_subplot(gs[<span class="number">3</span>, <span class="number">2</span>:])</span><br><span class="line">        self._ç»˜åˆ¶å…³é”®æŒ‡æ ‡(ax10)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ•´ä½“æ ‡é¢˜</span></span><br><span class="line">        self.å›¾è¡¨é›†.suptitle(<span class="string">f&#x27;ä¸ªäººç†è´¢å¹´åº¦æŠ¥å‘Š 2024\nè´¢åŠ¡å¥åº·åº¦ï¼š<span class="subst">&#123;self.å¥åº·ç­‰çº§&#125;</span>ï¼ˆ<span class="subst">&#123;self.å¥åº·å¾—åˆ†&#125;</span>åˆ†ï¼‰&#x27;</span>, </span><br><span class="line">                           fontsize=<span class="number">28</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>, y=<span class="number">0.98</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># é¡µè„šä¿¡æ¯</span></span><br><span class="line">        self.å›¾è¡¨é›†.text(<span class="number">0.5</span>, <span class="number">0.02</span>, </span><br><span class="line">                       <span class="string">f&#x27;æŠ¥å‘Šç”Ÿæˆæ—¶é—´ï¼š<span class="subst">&#123;datetime.now().strftime(<span class="string">&quot;%Yå¹´%mæœˆ%dæ—¥ %H:%M&quot;</span>)&#125;</span> | &#x27;</span> +</span><br><span class="line">                       <span class="string">f&#x27;å¹´åº¦æ€»ç»“ä½™ï¼š<span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹´åº¦æ€»ç»“ä½™&quot;</span>]:,&#125;</span>å…ƒ | &#x27;</span> +</span><br><span class="line">                       <span class="string">f&#x27;å¹³å‡ç»“ä½™ç‡ï¼š<span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹³å‡ç»“ä½™ç‡&quot;</span>]:<span class="number">.1</span>f&#125;</span>%&#x27;</span>,</span><br><span class="line">                       ha=<span class="string">&#x27;center&#x27;</span>, fontsize=<span class="number">14</span>, style=<span class="string">&#x27;italic&#x27;</span>,</span><br><span class="line">                       bbox=<span class="built_in">dict</span>(boxstyle=<span class="string">&#x27;round,pad=0.5&#x27;</span>, facecolor=<span class="string">&#x27;lightgray&#x27;</span>, alpha=<span class="number">0.8</span>),</span><br><span class="line">                       transform=self.å›¾è¡¨é›†.transFigure)</span><br><span class="line">        </span><br><span class="line">        plt.tight_layout()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ä¿å­˜å›¾è¡¨</span></span><br><span class="line">        å›¾è¡¨æ–‡ä»¶ = <span class="string">&#x27;ä¸ªäººç†è´¢å¹´åº¦æŠ¥å‘Š_ä¸“ä¸šç‰ˆ.png&#x27;</span></span><br><span class="line">        plt.savefig(å›¾è¡¨æ–‡ä»¶, dpi=<span class="number">300</span>, bbox_inches=<span class="string">&#x27;tight&#x27;</span>, facecolor=<span class="string">&#x27;white&#x27;</span>)</span><br><span class="line">        plt.show()</span><br><span class="line">        </span><br><span class="line">        self.å›¾è¡¨æ–‡ä»¶.append(å›¾è¡¨æ–‡ä»¶)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;âœ… ä¸“ä¸šå›¾è¡¨é›†å·²ç”Ÿæˆï¼&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> å›¾è¡¨æ–‡ä»¶</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_ç»˜åˆ¶å¹´åº¦æ€»è§ˆ</span>(<span class="params">self, ax</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç»˜åˆ¶å¹´åº¦æ€»è§ˆå›¾&quot;&quot;&quot;</span></span><br><span class="line">        ax.plot(self.å¹´åº¦æ”¶å…¥[<span class="string">&#x27;æœˆä»½&#x27;</span>], self.å¹´åº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>], </span><br><span class="line">                marker=<span class="string">&#x27;o&#x27;</span>, linewidth=<span class="number">4</span>, label=<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>, color=<span class="string">&#x27;#2E8B57&#x27;</span>, markersize=<span class="number">8</span>)</span><br><span class="line">        ax.plot(self.å¹´åº¦æ”¯å‡º[<span class="string">&#x27;æœˆä»½&#x27;</span>], self.å¹´åº¦æ”¯å‡º[<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>], </span><br><span class="line">                marker=<span class="string">&#x27;s&#x27;</span>, linewidth=<span class="number">4</span>, label=<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>, color=<span class="string">&#x27;#DC143C&#x27;</span>, markersize=<span class="number">8</span>)</span><br><span class="line">        ax.fill_between(self.å¹´åº¦æ”¶å…¥[<span class="string">&#x27;æœˆä»½&#x27;</span>], self.å¹´åº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>], alpha=<span class="number">0.3</span>, color=<span class="string">&#x27;#2E8B57&#x27;</span>)</span><br><span class="line">        ax.fill_between(self.å¹´åº¦æ”¯å‡º[<span class="string">&#x27;æœˆä»½&#x27;</span>], self.å¹´åº¦æ”¯å‡º[<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>], alpha=<span class="number">0.3</span>, color=<span class="string">&#x27;#DC143C&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ·»åŠ æ€»è®¡æ³¨é‡Š</span></span><br><span class="line">        ax.text(<span class="number">0.02</span>, <span class="number">0.98</span>, <span class="string">f&#x27;æ€»æ”¶å…¥ï¼š<span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹´åº¦æ€»æ”¶å…¥&quot;</span>]:,&#125;</span>å…ƒ&#x27;</span>, </span><br><span class="line">                transform=ax.transAxes, fontsize=<span class="number">12</span>, verticalalignment=<span class="string">&#x27;top&#x27;</span>,</span><br><span class="line">                bbox=<span class="built_in">dict</span>(boxstyle=<span class="string">&#x27;round&#x27;</span>, facecolor=<span class="string">&#x27;lightgreen&#x27;</span>, alpha=<span class="number">0.8</span>))</span><br><span class="line">        ax.text(<span class="number">0.02</span>, <span class="number">0.88</span>, <span class="string">f&#x27;æ€»æ”¯å‡ºï¼š<span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹´åº¦æ€»æ”¯å‡º&quot;</span>]:,&#125;</span>å…ƒ&#x27;</span>, </span><br><span class="line">                transform=ax.transAxes, fontsize=<span class="number">12</span>, verticalalignment=<span class="string">&#x27;top&#x27;</span>,</span><br><span class="line">                bbox=<span class="built_in">dict</span>(boxstyle=<span class="string">&#x27;round&#x27;</span>, facecolor=<span class="string">&#x27;lightcoral&#x27;</span>, alpha=<span class="number">0.8</span>))</span><br><span class="line">        </span><br><span class="line">        ax.set_title(<span class="string">&#x27;å¹´åº¦æ”¶æ”¯æ€»è§ˆ&#x27;</span>, fontsize=<span class="number">16</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">        ax.set_xlabel(<span class="string">&#x27;æœˆä»½&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">        ax.set_ylabel(<span class="string">&#x27;é‡‘é¢ï¼ˆå…ƒï¼‰&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">        ax.legend(fontsize=<span class="number">12</span>, loc=<span class="string">&#x27;upper right&#x27;</span>)</span><br><span class="line">        ax.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_ç»˜åˆ¶æ”¶å…¥ç»“æ„</span>(<span class="params">self, ax</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç»˜åˆ¶æ”¶å…¥ç»“æ„å›¾&quot;&quot;&quot;</span></span><br><span class="line">        æ”¶å…¥ç»“æ„ = self.å¹´åº¦æ±‡æ€»[<span class="string">&#x27;æ”¶å…¥ç»“æ„&#x27;</span>]</span><br><span class="line">        wedges, texts, autotexts = ax.pie(æ”¶å…¥ç»“æ„.values, labels=æ”¶å…¥ç»“æ„.index, </span><br><span class="line">                                          autopct=<span class="string">&#x27;%1.1f%%&#x27;</span>, startangle=<span class="number">90</span>,</span><br><span class="line">                                          colors=[<span class="string">&#x27;#3498DB&#x27;</span>, <span class="string">&#x27;#2ECC71&#x27;</span>, <span class="string">&#x27;#F39C12&#x27;</span>])</span><br><span class="line">        </span><br><span class="line">        ax.set_title(<span class="string">&#x27;å¹´åº¦æ”¶å…¥ç»“æ„&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç¾åŒ–æ–‡å­—</span></span><br><span class="line">        <span class="keyword">for</span> autotext <span class="keyword">in</span> autotexts:</span><br><span class="line">            autotext.set_color(<span class="string">&#x27;white&#x27;</span>)</span><br><span class="line">            autotext.set_fontweight(<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_ç»˜åˆ¶æ”¯å‡ºç»“æ„</span>(<span class="params">self, ax</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç»˜åˆ¶æ”¯å‡ºç»“æ„å›¾&quot;&quot;&quot;</span></span><br><span class="line">        æ”¯å‡ºç»“æ„ = self.å¹´åº¦æ±‡æ€»[<span class="string">&#x27;æ”¯å‡ºç»“æ„&#x27;</span>]</span><br><span class="line">        wedges, texts, autotexts = ax.pie(æ”¯å‡ºç»“æ„.values, labels=æ”¯å‡ºç»“æ„.index, </span><br><span class="line">                                          autopct=<span class="string">&#x27;%1.1f%%&#x27;</span>, startangle=<span class="number">90</span>,</span><br><span class="line">                                          colors=[<span class="string">&#x27;#FF6B6B&#x27;</span>, <span class="string">&#x27;#4ECDC4&#x27;</span>, <span class="string">&#x27;#45B7D1&#x27;</span>, <span class="string">&#x27;#96CEB4&#x27;</span>, <span class="string">&#x27;#FECA57&#x27;</span>, <span class="string">&#x27;#FF9FF3&#x27;</span>])</span><br><span class="line">        </span><br><span class="line">        ax.set_title(<span class="string">&#x27;å¹´åº¦æ”¯å‡ºç»“æ„&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç¾åŒ–æ–‡å­—</span></span><br><span class="line">        <span class="keyword">for</span> autotext <span class="keyword">in</span> autotexts:</span><br><span class="line">            autotext.set_color(<span class="string">&#x27;white&#x27;</span>)</span><br><span class="line">            autotext.set_fontweight(<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_ç»˜åˆ¶æœˆåº¦è¶‹åŠ¿</span>(<span class="params">self, ax</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç»˜åˆ¶æœˆåº¦è¶‹åŠ¿å¯¹æ¯”å›¾&quot;&quot;&quot;</span></span><br><span class="line">        æ”¶æ”¯å¯¹æ¯” = pd.DataFrame(&#123;</span><br><span class="line">            <span class="string">&#x27;æœˆä»½&#x27;</span>: self.å¹´åº¦æ”¶å…¥[<span class="string">&#x27;æœˆä»½&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;æ”¶å…¥&#x27;</span>: self.å¹´åº¦æ”¶å…¥[<span class="string">&#x27;æ€»æ”¶å…¥&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;æ”¯å‡º&#x27;</span>: self.å¹´åº¦æ”¯å‡º[<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;ç»“ä½™&#x27;</span>: self.å¹´åº¦ç»“ä½™[<span class="string">&#x27;æœˆåº¦ç»“ä½™&#x27;</span>]</span><br><span class="line">        &#125;)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç»˜åˆ¶åŒè½´å›¾</span></span><br><span class="line">        ax_twin = ax.twinx()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ”¶å…¥å’Œæ”¯å‡º</span></span><br><span class="line">        æ”¶æ”¯å¯¹æ¯”.plot(x=<span class="string">&#x27;æœˆä»½&#x27;</span>, y=[<span class="string">&#x27;æ”¶å…¥&#x27;</span>, <span class="string">&#x27;æ”¯å‡º&#x27;</span>], kind=<span class="string">&#x27;line&#x27;</span>, ax=ax, </span><br><span class="line">                     color=[<span class="string">&#x27;#2E8B57&#x27;</span>, <span class="string">&#x27;#DC143C&#x27;</span>], linewidth=<span class="number">3</span>, marker=<span class="string">&#x27;o&#x27;</span>, markersize=<span class="number">6</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç»“ä½™ï¼ˆä½¿ç”¨å³ä¾§åæ ‡è½´ï¼‰</span></span><br><span class="line">        ax_twin.plot(æ”¶æ”¯å¯¹æ¯”[<span class="string">&#x27;æœˆä»½&#x27;</span>], æ”¶æ”¯å¯¹æ¯”[<span class="string">&#x27;ç»“ä½™&#x27;</span>], color=<span class="string">&#x27;#4169E1&#x27;</span>, </span><br><span class="line">                    linewidth=<span class="number">3</span>, marker=<span class="string">&#x27;^&#x27;</span>, markersize=<span class="number">6</span>, label=<span class="string">&#x27;ç»“ä½™&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        ax.set_title(<span class="string">&#x27;æœˆåº¦æ”¶æ”¯è¶‹åŠ¿å¯¹æ¯”&#x27;</span>, fontsize=<span class="number">16</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">        ax.set_xlabel(<span class="string">&#x27;æœˆä»½&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">        ax.set_ylabel(<span class="string">&#x27;æ”¶å…¥/æ”¯å‡ºï¼ˆå…ƒï¼‰&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">        ax_twin.set_ylabel(<span class="string">&#x27;ç»“ä½™ï¼ˆå…ƒï¼‰&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">        </span><br><span class="line">        ax.legend(loc=<span class="string">&#x27;upper left&#x27;</span>)</span><br><span class="line">        ax_twin.legend(loc=<span class="string">&#x27;upper right&#x27;</span>)</span><br><span class="line">        ax.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_ç»˜åˆ¶çƒ­åŠ›å›¾</span>(<span class="params">self, ax</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç»˜åˆ¶æ”¶æ”¯çƒ­åŠ›å›¾&quot;&quot;&quot;</span></span><br><span class="line">        æ”¯å‡ºæ˜ç»† = self.å¹´åº¦æ”¯å‡º.drop([<span class="string">&#x27;æœˆä»½&#x27;</span>, <span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>], axis=<span class="number">1</span>)</span><br><span class="line">        çƒ­åŠ›å›¾æ•°æ® = æ”¯å‡ºæ˜ç»†.T</span><br><span class="line">        </span><br><span class="line">        sns.heatmap(çƒ­åŠ›å›¾æ•°æ®, annot=<span class="literal">True</span>, fmt=<span class="string">&#x27;d&#x27;</span>, cmap=<span class="string">&#x27;RdYlGn_r&#x27;</span>, ax=ax, </span><br><span class="line">                    cbar_kws=&#123;<span class="string">&#x27;label&#x27;</span>: <span class="string">&#x27;é‡‘é¢ï¼ˆå…ƒï¼‰&#x27;</span>&#125;, linewidths=<span class="number">0.5</span>)</span><br><span class="line">        </span><br><span class="line">        ax.set_title(<span class="string">&#x27;æœˆåº¦æ”¯å‡ºçƒ­åŠ›å›¾&#x27;</span>, fontsize=<span class="number">16</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">        ax.set_xlabel(<span class="string">&#x27;æœˆä»½&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">        ax.set_ylabel(<span class="string">&#x27;æ”¯å‡ºç±»åˆ«&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_ç»˜åˆ¶ç»“ä½™ç‡åˆ†æ</span>(<span class="params">self, ax</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç»˜åˆ¶ç»“ä½™ç‡åˆ†æå›¾&quot;&quot;&quot;</span></span><br><span class="line">        bars = ax.bar(self.å¹´åº¦ç»“ä½™[<span class="string">&#x27;æœˆä»½&#x27;</span>], self.å¹´åº¦ç»“ä½™[<span class="string">&#x27;ç»“ä½™ç‡&#x27;</span>], </span><br><span class="line">                     color=[<span class="string">&#x27;#2ECC71&#x27;</span> <span class="keyword">if</span> x &gt;= <span class="number">20</span> <span class="keyword">else</span> <span class="string">&#x27;#F39C12&#x27;</span> <span class="keyword">if</span> x &gt;= <span class="number">10</span> <span class="keyword">else</span> <span class="string">&#x27;#E74C3C&#x27;</span> <span class="keyword">for</span> x <span class="keyword">in</span> self.å¹´åº¦ç»“ä½™[<span class="string">&#x27;ç»“ä½™ç‡&#x27;</span>]])</span><br><span class="line">        </span><br><span class="line">        ax.set_title(<span class="string">&#x27;æœˆåº¦ç»“ä½™ç‡åˆ†æ&#x27;</span>, fontsize=<span class="number">16</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">        ax.set_xlabel(<span class="string">&#x27;æœˆä»½&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">        ax.set_ylabel(<span class="string">&#x27;ç»“ä½™ç‡ï¼ˆ%ï¼‰&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">        ax.axhline(y=<span class="number">20</span>, color=<span class="string">&#x27;green&#x27;</span>, linestyle=<span class="string">&#x27;--&#x27;</span>, alpha=<span class="number">0.7</span>, label=<span class="string">&#x27;ç›®æ ‡ç»“ä½™ç‡ï¼ˆ20%ï¼‰&#x27;</span>)</span><br><span class="line">        ax.axhline(y=self.å¹´åº¦æ±‡æ€»[<span class="string">&#x27;å¹³å‡ç»“ä½™ç‡&#x27;</span>], color=<span class="string">&#x27;blue&#x27;</span>, linestyle=<span class="string">&#x27;--&#x27;</span>, alpha=<span class="number">0.7</span>, label=<span class="string">f&#x27;å¹³å‡ç»“ä½™ç‡ï¼ˆ<span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹³å‡ç»“ä½™ç‡&quot;</span>]:<span class="number">.1</span>f&#125;</span>%ï¼‰&#x27;</span>)</span><br><span class="line">        ax.legend()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ·»åŠ æ•°å€¼æ ‡ç­¾</span></span><br><span class="line">        <span class="keyword">for</span> bar, æ•°å€¼ <span class="keyword">in</span> <span class="built_in">zip</span>(bars, self.å¹´åº¦ç»“ä½™[<span class="string">&#x27;ç»“ä½™ç‡&#x27;</span>]):</span><br><span class="line">            ax.annotate(<span class="string">f&#x27;<span class="subst">&#123;æ•°å€¼:<span class="number">.1</span>f&#125;</span>%&#x27;</span>, (bar.get_x() + bar.get_width()/<span class="number">2</span>, bar.get_height() + <span class="number">0.5</span>), </span><br><span class="line">                        ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;bottom&#x27;</span>, fontsize=<span class="number">10</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_ç»˜åˆ¶æ”¶å…¥å¯¹æ¯”</span>(<span class="params">self, ax</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç»˜åˆ¶æ”¶å…¥å¯¹æ¯”å›¾&quot;&quot;&quot;</span></span><br><span class="line">        æ”¶å…¥å¯¹æ¯” = self.å¹´åº¦æ”¶å…¥.set_index(<span class="string">&#x27;æœˆä»½&#x27;</span>)[[<span class="string">&#x27;å·¥èµ„æ”¶å…¥&#x27;</span>, <span class="string">&#x27;æŠ•èµ„æ”¶ç›Š&#x27;</span>, <span class="string">&#x27;å…¶ä»–æ”¶å…¥&#x27;</span>]]</span><br><span class="line">        </span><br><span class="line">        æ”¶å…¥å¯¹æ¯”.plot(kind=<span class="string">&#x27;bar&#x27;</span>, ax=ax, color=[<span class="string">&#x27;#3498DB&#x27;</span>, <span class="string">&#x27;#2ECC71&#x27;</span>, <span class="string">&#x27;#F39C12&#x27;</span>], width=<span class="number">0.8</span>)</span><br><span class="line">        ax.set_title(<span class="string">&#x27;å„ç±»æ”¶å…¥æœˆåº¦å¯¹æ¯”&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">        ax.set_xlabel(<span class="string">&#x27;æœˆä»½&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">        ax.set_ylabel(<span class="string">&#x27;æ”¶å…¥é‡‘é¢ï¼ˆå…ƒï¼‰&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">        ax.legend(fontsize=<span class="number">10</span>)</span><br><span class="line">        ax.tick_params(axis=<span class="string">&#x27;x&#x27;</span>, rotation=<span class="number">45</span>)</span><br><span class="line">        ax.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_ç»˜åˆ¶æ”¯å‡ºå¯¹æ¯”</span>(<span class="params">self, ax</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç»˜åˆ¶æ”¯å‡ºå¯¹æ¯”å›¾&quot;&quot;&quot;</span></span><br><span class="line">        æ”¯å‡ºå¯¹æ¯” = self.å¹´åº¦æ”¯å‡º.set_index(<span class="string">&#x27;æœˆä»½&#x27;</span>).drop([<span class="string">&#x27;æ€»æ”¯å‡º&#x27;</span>], axis=<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        æ”¯å‡ºå¯¹æ¯”.plot(kind=<span class="string">&#x27;bar&#x27;</span>, ax=ax, stacked=<span class="literal">True</span>, </span><br><span class="line">                     color=[<span class="string">&#x27;#FF6B6B&#x27;</span>, <span class="string">&#x27;#4ECDC4&#x27;</span>, <span class="string">&#x27;#45B7D1&#x27;</span>, <span class="string">&#x27;#96CEB4&#x27;</span>, <span class="string">&#x27;#FECA57&#x27;</span>, <span class="string">&#x27;#FF9FF3&#x27;</span>], width=<span class="number">0.8</span>)</span><br><span class="line">        ax.set_title(<span class="string">&#x27;å„ç±»æ”¯å‡ºæœˆåº¦å¯¹æ¯”&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">        ax.set_xlabel(<span class="string">&#x27;æœˆä»½&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">        ax.set_ylabel(<span class="string">&#x27;æ”¯å‡ºé‡‘é¢ï¼ˆå…ƒï¼‰&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">        ax.legend(fontsize=<span class="number">9</span>, loc=<span class="string">&#x27;upper left&#x27;</span>, bbox_to_anchor=(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">        ax.tick_params(axis=<span class="string">&#x27;x&#x27;</span>, rotation=<span class="number">45</span>)</span><br><span class="line">        ax.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_ç»˜åˆ¶å¥åº·åº¦é›·è¾¾å›¾</span>(<span class="params">self, ax</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç»˜åˆ¶å¥åº·åº¦é›·è¾¾å›¾&quot;&quot;&quot;</span></span><br><span class="line">        æŒ‡æ ‡åˆ—è¡¨ = <span class="built_in">list</span>(self.å¥åº·æŒ‡æ ‡.keys())</span><br><span class="line">        æ•°å€¼åˆ—è¡¨ = <span class="built_in">list</span>(self.å¥åº·æŒ‡æ ‡.values())</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># é—­åˆå›¾å½¢</span></span><br><span class="line">        æŒ‡æ ‡åˆ—è¡¨ += [æŒ‡æ ‡åˆ—è¡¨[<span class="number">0</span>]]</span><br><span class="line">        æ•°å€¼åˆ—è¡¨ += [æ•°å€¼åˆ—è¡¨[<span class="number">0</span>]]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è®¡ç®—è§’åº¦</span></span><br><span class="line">        è§’åº¦ = np.linspace(<span class="number">0</span>, <span class="number">2</span> * np.pi, <span class="built_in">len</span>(æŒ‡æ ‡åˆ—è¡¨), endpoint=<span class="literal">True</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç»˜åˆ¶é›·è¾¾å›¾</span></span><br><span class="line">        ax.plot(è§’åº¦, æ•°å€¼åˆ—è¡¨, <span class="string">&#x27;o-&#x27;</span>, linewidth=<span class="number">3</span>, color=<span class="string">&#x27;#3498DB&#x27;</span>)</span><br><span class="line">        ax.fill(è§’åº¦, æ•°å€¼åˆ—è¡¨, alpha=<span class="number">0.3</span>, color=<span class="string">&#x27;#3498DB&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è®¾ç½®æ ‡ç­¾</span></span><br><span class="line">        ax.set_xticks(è§’åº¦[:-<span class="number">1</span>])</span><br><span class="line">        ax.set_xticklabels(æŒ‡æ ‡åˆ—è¡¨[:-<span class="number">1</span>])</span><br><span class="line">        ax.set_ylim(<span class="number">0</span>, <span class="number">100</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ·»åŠ ç½‘æ ¼</span></span><br><span class="line">        ax.grid(<span class="literal">True</span>)</span><br><span class="line">        </span><br><span class="line">        ax.set_title(<span class="string">&#x27;è´¢åŠ¡å¥åº·åº¦è¯„ä¼°&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_ç»˜åˆ¶å…³é”®æŒ‡æ ‡</span>(<span class="params">self, ax</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç»˜åˆ¶å…³é”®æŒ‡æ ‡ä»ªè¡¨ç›˜&quot;&quot;&quot;</span></span><br><span class="line">        ax.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å…³é”®æŒ‡æ ‡æ–‡æœ¬</span></span><br><span class="line">        å…³é”®æŒ‡æ ‡æ–‡æœ¬ = <span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        å…³é”®è´¢åŠ¡æŒ‡æ ‡</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        å¹´åº¦æ€»æ”¶å…¥ï¼š<span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹´åº¦æ€»æ”¶å…¥&quot;</span>]:,<span class="number">.0</span>f&#125;</span>å…ƒ</span></span><br><span class="line"><span class="string">        å¹´åº¦æ€»æ”¯å‡ºï¼š<span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹´åº¦æ€»æ”¯å‡º&quot;</span>]:,<span class="number">.0</span>f&#125;</span>å…ƒ  </span></span><br><span class="line"><span class="string">        å¹´åº¦æ€»ç»“ä½™ï¼š<span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹´åº¦æ€»ç»“ä½™&quot;</span>]:,<span class="number">.0</span>f&#125;</span>å…ƒ</span></span><br><span class="line"><span class="string">        å¹³å‡ç»“ä½™ç‡ï¼š<span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹³å‡ç»“ä½™ç‡&quot;</span>]:<span class="number">.1</span>f&#125;</span>%</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        è´¢åŠ¡å¥åº·ç­‰çº§ï¼š<span class="subst">&#123;self.å¥åº·ç­‰çº§&#125;</span></span></span><br><span class="line"><span class="string">        å¥åº·åº¦è¯„åˆ†ï¼š<span class="subst">&#123;self.å¥åº·å¾—åˆ†&#125;</span>åˆ†</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        æ”¶å…¥æœ€é«˜æœˆä»½ï¼š<span class="subst">&#123;self.æœˆåº¦æ’å[<span class="string">&quot;æ”¶å…¥æœ€é«˜æœˆä»½&quot;</span>]&#125;</span></span></span><br><span class="line"><span class="string">        æ”¯å‡ºæœ€é«˜æœˆä»½ï¼š<span class="subst">&#123;self.æœˆåº¦æ’å[<span class="string">&quot;æ”¯å‡ºæœ€é«˜æœˆä»½&quot;</span>]&#125;</span></span></span><br><span class="line"><span class="string">        ç»“ä½™æœ€é«˜æœˆä»½ï¼š<span class="subst">&#123;self.æœˆåº¦æ’å[<span class="string">&quot;ç»“ä½™æœ€é«˜æœˆä»½&quot;</span>]&#125;</span></span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        </span><br><span class="line">        ax.text(<span class="number">0.5</span>, <span class="number">0.5</span>, å…³é”®æŒ‡æ ‡æ–‡æœ¬, transform=ax.transAxes, </span><br><span class="line">                fontsize=<span class="number">12</span>, ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;center&#x27;</span>,</span><br><span class="line">                bbox=<span class="built_in">dict</span>(boxstyle=<span class="string">&#x27;round,pad=0.5&#x27;</span>, facecolor=<span class="string">&#x27;lightblue&#x27;</span>, alpha=<span class="number">0.8</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ç”Ÿæˆå®Œæ•´æŠ¥å‘Š</span>(<span class="params">self, è¾“å‡ºç›®å½•=<span class="string">&quot;å¹´åº¦æŠ¥å‘Š&quot;</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç”Ÿæˆå®Œæ•´çš„å¹´åº¦æŠ¥å‘ŠåŒ…&quot;&quot;&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ğŸ“¦ ç”Ÿæˆå®Œæ•´å¹´åº¦æŠ¥å‘ŠåŒ…...&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åˆ›å»ºè¾“å‡ºç›®å½•</span></span><br><span class="line">        <span class="keyword">import</span> os</span><br><span class="line">        os.makedirs(è¾“å‡ºç›®å½•, exist_ok=<span class="literal">True</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 1. ç”Ÿæˆå›¾è¡¨é›†</span></span><br><span class="line">        å›¾è¡¨æ–‡ä»¶ = self.ç”Ÿæˆå›¾è¡¨é›†()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 2. ç”ŸæˆExcelæŠ¥å‘Š</span></span><br><span class="line">        Excelæ–‡ä»¶ = self.ç”ŸæˆExcelæŠ¥å‘Š(os.path.join(è¾“å‡ºç›®å½•, <span class="string">&quot;å¹´åº¦è´¢åŠ¡æ•°æ®.xlsx&quot;</span>))</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 3. ç”ŸæˆPDFæŠ¥å‘Š</span></span><br><span class="line">        PDFæ–‡ä»¶ = self.ç”ŸæˆPDFæŠ¥å‘Š(os.path.join(è¾“å‡ºç›®å½•, <span class="string">&quot;å¹´åº¦æŠ¥å‘Š.pdf&quot;</span>))</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 4. ç”Ÿæˆæ–‡æœ¬æŠ¥å‘Š</span></span><br><span class="line">        æ–‡æœ¬æ–‡ä»¶ = self.ç”Ÿæˆæ–‡æœ¬æŠ¥å‘Š(os.path.join(è¾“å‡ºç›®å½•, <span class="string">&quot;å¹´åº¦æŠ¥å‘Šæ‘˜è¦.txt&quot;</span>))</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 5. ç”ŸæˆMarkdownæŠ¥å‘Š</span></span><br><span class="line">        Markdownæ–‡ä»¶ = self.ç”ŸæˆMarkdownæŠ¥å‘Š(os.path.join(è¾“å‡ºç›®å½•, <span class="string">&quot;å¹´åº¦æŠ¥å‘Š.md&quot;</span>))</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;âœ… å®Œæ•´å¹´åº¦æŠ¥å‘ŠåŒ…å·²ç”Ÿæˆï¼š<span class="subst">&#123;è¾“å‡ºç›®å½•&#125;</span>/&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  ğŸ“Š å›¾è¡¨æ–‡ä»¶ï¼š<span class="subst">&#123;å›¾è¡¨æ–‡ä»¶&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  ğŸ“ˆ Excelæ–‡ä»¶ï¼š<span class="subst">&#123;Excelæ–‡ä»¶&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  ğŸ“„ PDFæ–‡ä»¶ï¼š<span class="subst">&#123;PDFæ–‡ä»¶&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  ğŸ“ æ–‡æœ¬æ–‡ä»¶ï¼š<span class="subst">&#123;æ–‡æœ¬æ–‡ä»¶&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  ğŸ“ Markdownæ–‡ä»¶ï¼š<span class="subst">&#123;Markdownæ–‡ä»¶&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">&#x27;å›¾è¡¨&#x27;</span>: å›¾è¡¨æ–‡ä»¶,</span><br><span class="line">            <span class="string">&#x27;Excel&#x27;</span>: Excelæ–‡ä»¶,</span><br><span class="line">            <span class="string">&#x27;PDF&#x27;</span>: PDFæ–‡ä»¶,</span><br><span class="line">            <span class="string">&#x27;æ–‡æœ¬&#x27;</span>: æ–‡æœ¬æ–‡ä»¶,</span><br><span class="line">            <span class="string">&#x27;Markdown&#x27;</span>: Markdownæ–‡ä»¶</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ç”ŸæˆExcelæŠ¥å‘Š</span>(<span class="params">self, æ–‡ä»¶å</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç”ŸæˆExcelæ ¼å¼çš„è¯¦ç»†æŠ¥å‘Š&quot;&quot;&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ğŸ“Š ç”ŸæˆExcelæŠ¥å‘Šï¼š<span class="subst">&#123;æ–‡ä»¶å&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">with</span> pd.ExcelWriter(æ–‡ä»¶å, engine=<span class="string">&#x27;openpyxl&#x27;</span>) <span class="keyword">as</span> writer:</span><br><span class="line">            <span class="comment"># æ•°æ®è¡¨</span></span><br><span class="line">            self.å¹´åº¦æ”¶å…¥.to_excel(writer, sheet_name=<span class="string">&#x27;å¹´åº¦æ”¶å…¥&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">            self.å¹´åº¦æ”¯å‡º.to_excel(writer, sheet_name=<span class="string">&#x27;å¹´åº¦æ”¯å‡º&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">            self.å¹´åº¦ç»“ä½™.to_excel(writer, sheet_name=<span class="string">&#x27;å¹´åº¦ç»“ä½™&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æ±‡æ€»è¡¨</span></span><br><span class="line">            æ±‡æ€»è¡¨ = pd.DataFrame(&#123;</span><br><span class="line">                <span class="string">&#x27;é¡¹ç›®&#x27;</span>: [<span class="string">&#x27;å¹´åº¦æ€»æ”¶å…¥&#x27;</span>, <span class="string">&#x27;å¹´åº¦æ€»æ”¯å‡º&#x27;</span>, <span class="string">&#x27;å¹´åº¦æ€»ç»“ä½™&#x27;</span>, <span class="string">&#x27;å¹³å‡æœˆç»“ä½™&#x27;</span>, <span class="string">&#x27;å¹³å‡ç»“ä½™ç‡&#x27;</span>, <span class="string">&#x27;è´¢åŠ¡å¥åº·ç­‰çº§&#x27;</span>, <span class="string">&#x27;å¥åº·åº¦å¾—åˆ†&#x27;</span>],</span><br><span class="line">                <span class="string">&#x27;æ•°å€¼&#x27;</span>: [self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹´åº¦æ€»æ”¶å…¥&quot;</span>], self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹´åº¦æ€»æ”¯å‡º&quot;</span>], </span><br><span class="line">                        self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹´åº¦æ€»ç»“ä½™&quot;</span>], self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹³å‡æœˆç»“ä½™&quot;</span>],</span><br><span class="line">                        self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹³å‡ç»“ä½™ç‡&quot;</span>], self.å¥åº·ç­‰çº§, self.å¥åº·å¾—åˆ†],</span><br><span class="line">                <span class="string">&#x27;å•ä½&#x27;</span>: [<span class="string">&#x27;å…ƒ&#x27;</span>, <span class="string">&#x27;å…ƒ&#x27;</span>, <span class="string">&#x27;å…ƒ&#x27;</span>, <span class="string">&#x27;å…ƒ&#x27;</span>, <span class="string">&#x27;%&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;åˆ†&#x27;</span>]</span><br><span class="line">            &#125;)</span><br><span class="line">            æ±‡æ€»è¡¨.to_excel(writer, sheet_name=<span class="string">&#x27;å¹´åº¦æ±‡æ€»&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ†æç»“æœè¡¨</span></span><br><span class="line">            åˆ†æç»“æœ = pd.DataFrame(&#123;</span><br><span class="line">                <span class="string">&#x27;æŒ‡æ ‡&#x27;</span>: [<span class="string">&#x27;æ”¶å…¥æœ€é«˜æœˆä»½&#x27;</span>, <span class="string">&#x27;æ”¯å‡ºæœ€é«˜æœˆä»½&#x27;</span>, <span class="string">&#x27;ç»“ä½™æœ€é«˜æœˆä»½&#x27;</span>, <span class="string">&#x27;æ”¶å…¥è¶‹åŠ¿&#x27;</span>, <span class="string">&#x27;æ”¯å‡ºè¶‹åŠ¿&#x27;</span>, <span class="string">&#x27;ç»“ä½™è¶‹åŠ¿&#x27;</span>],</span><br><span class="line">                <span class="string">&#x27;æ•°å€¼&#x27;</span>: [self.æœˆåº¦æ’å[<span class="string">&quot;æ”¶å…¥æœ€é«˜æœˆä»½&quot;</span>], self.æœˆåº¦æ’å[<span class="string">&quot;æ”¯å‡ºæœ€é«˜æœˆä»½&quot;</span>], </span><br><span class="line">                        self.æœˆåº¦æ’å[<span class="string">&quot;ç»“ä½™æœ€é«˜æœˆä»½&quot;</span>], self.è¶‹åŠ¿åˆ†æ[<span class="string">&quot;æ”¶å…¥è¶‹åŠ¿&quot;</span>],</span><br><span class="line">                        self.è¶‹åŠ¿åˆ†æ[<span class="string">&quot;æ”¯å‡ºè¶‹åŠ¿&quot;</span>], self.è¶‹åŠ¿åˆ†æ[<span class="string">&quot;ç»“ä½™è¶‹åŠ¿&quot;</span>]]</span><br><span class="line">            &#125;)</span><br><span class="line">            åˆ†æç»“æœ.to_excel(writer, sheet_name=<span class="string">&#x27;åˆ†æç»“æœ&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># å¥åº·æŒ‡æ ‡è¡¨</span></span><br><span class="line">            å¥åº·æŒ‡æ ‡è¡¨ = pd.DataFrame(&#123;</span><br><span class="line">                <span class="string">&#x27;å¥åº·æŒ‡æ ‡&#x27;</span>: <span class="built_in">list</span>(self.å¥åº·æŒ‡æ ‡.keys()),</span><br><span class="line">                <span class="string">&#x27;å¾—åˆ†&#x27;</span>: <span class="built_in">list</span>(self.å¥åº·æŒ‡æ ‡.values()),</span><br><span class="line">                <span class="string">&#x27;æƒé‡&#x27;</span>: [<span class="number">1</span>/<span class="built_in">len</span>(self.å¥åº·æŒ‡æ ‡)] * <span class="built_in">len</span>(self.å¥åº·æŒ‡æ ‡)</span><br><span class="line">            &#125;)</span><br><span class="line">            å¥åº·æŒ‡æ ‡è¡¨.to_excel(writer, sheet_name=<span class="string">&#x27;å¥åº·æŒ‡æ ‡&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> æ–‡ä»¶å</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ç”ŸæˆPDFæŠ¥å‘Š</span>(<span class="params">self, æ–‡ä»¶å</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç”ŸæˆPDFæ ¼å¼çš„ä¸“ä¸šæŠ¥å‘Š&quot;&quot;&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ğŸ“„ ç”ŸæˆPDFæŠ¥å‘Šï¼š<span class="subst">&#123;æ–‡ä»¶å&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">from</span> matplotlib.backends.backend_pdf <span class="keyword">import</span> PdfPages</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">with</span> PdfPages(æ–‡ä»¶å) <span class="keyword">as</span> pdf:</span><br><span class="line">            <span class="comment"># å°é¢é¡µ</span></span><br><span class="line">            self._ç”ŸæˆPDFå°é¢(pdf)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æ€»è§ˆé¡µ</span></span><br><span class="line">            self._ç”ŸæˆPDFæ€»è§ˆ(pdf)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># è¯¦ç»†åˆ†æé¡µ</span></span><br><span class="line">            self._ç”ŸæˆPDFè¯¦ç»†åˆ†æ(pdf)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># å¥åº·åº¦è¯„ä¼°é¡µ</span></span><br><span class="line">            self._ç”ŸæˆPDFå¥åº·è¯„ä¼°(pdf)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># å»ºè®®é¡µ</span></span><br><span class="line">            self._ç”ŸæˆPDFå»ºè®®(pdf)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> æ–‡ä»¶å</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_ç”ŸæˆPDFå°é¢</span>(<span class="params">self, pdf</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç”ŸæˆPDFå°é¢&quot;&quot;&quot;</span></span><br><span class="line">        fig = plt.figure(figsize=(<span class="number">8.27</span>, <span class="number">11.69</span>))  <span class="comment"># A4å°ºå¯¸</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ä¸»æ ‡é¢˜</span></span><br><span class="line">        plt.text(<span class="number">0.5</span>, <span class="number">0.8</span>, <span class="string">&#x27;ä¸ªäººç†è´¢å¹´åº¦æŠ¥å‘Š&#x27;</span>, ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;center&#x27;</span>, </span><br><span class="line">                transform=fig.transFigure, fontsize=<span class="number">36</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å‰¯æ ‡é¢˜</span></span><br><span class="line">        plt.text(<span class="number">0.5</span>, <span class="number">0.65</span>, <span class="string">&#x27;2024å¹´åº¦è´¢åŠ¡åˆ†ææŠ¥å‘Š&#x27;</span>, ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;center&#x27;</span>, </span><br><span class="line">                transform=fig.transFigure, fontsize=<span class="number">24</span>, style=<span class="string">&#x27;italic&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å…³é”®æ•°æ®</span></span><br><span class="line">        plt.text(<span class="number">0.5</span>, <span class="number">0.45</span>, <span class="string">f&#x27;å¹´åº¦æ€»ç»“ä½™ï¼š<span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹´åº¦æ€»ç»“ä½™&quot;</span>]:,<span class="number">.0</span>f&#125;</span>å…ƒ&#x27;</span>, </span><br><span class="line">                ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;center&#x27;</span>, transform=fig.transFigure, </span><br><span class="line">                fontsize=<span class="number">20</span>, color=<span class="string">&#x27;#2ECC71&#x27;</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>,</span><br><span class="line">                bbox=<span class="built_in">dict</span>(boxstyle=<span class="string">&#x27;round&#x27;</span>, facecolor=<span class="string">&#x27;lightgreen&#x27;</span>, alpha=<span class="number">0.8</span>))</span><br><span class="line">        </span><br><span class="line">        plt.text(<span class="number">0.5</span>, <span class="number">0.35</span>, <span class="string">f&#x27;å¹³å‡ç»“ä½™ç‡ï¼š<span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹³å‡ç»“ä½™ç‡&quot;</span>]:<span class="number">.1</span>f&#125;</span>%&#x27;</span>, </span><br><span class="line">                ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;center&#x27;</span>, transform=fig.transFigure, </span><br><span class="line">                fontsize=<span class="number">18</span>, color=<span class="string">&#x27;#3498DB&#x27;</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>,</span><br><span class="line">                bbox=<span class="built_in">dict</span>(boxstyle=<span class="string">&#x27;round&#x27;</span>, facecolor=<span class="string">&#x27;lightblue&#x27;</span>, alpha=<span class="number">0.8</span>))</span><br><span class="line">        </span><br><span class="line">        plt.text(<span class="number">0.5</span>, <span class="number">0.25</span>, <span class="string">f&#x27;è´¢åŠ¡å¥åº·åº¦ï¼š<span class="subst">&#123;self.å¥åº·ç­‰çº§&#125;</span>&#x27;</span>, </span><br><span class="line">                ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;center&#x27;</span>, transform=fig.transFigure, </span><br><span class="line">                fontsize=<span class="number">18</span>, color=<span class="string">&#x27;#DC143C&#x27;</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>,</span><br><span class="line">                bbox=<span class="built_in">dict</span>(boxstyle=<span class="string">&#x27;round&#x27;</span>, facecolor=<span class="string">&#x27;lightcoral&#x27;</span>, alpha=<span class="number">0.8</span>))</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç”Ÿæˆæ—¶é—´</span></span><br><span class="line">        plt.text(<span class="number">0.5</span>, <span class="number">0.1</span>, <span class="string">f&#x27;ç”Ÿæˆæ—¶é—´ï¼š<span class="subst">&#123;datetime.now().strftime(<span class="string">&quot;%Yå¹´%mæœˆ%dæ—¥&quot;</span>)&#125;</span>&#x27;</span>, </span><br><span class="line">                ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;center&#x27;</span>, transform=fig.transFigure, fontsize=<span class="number">14</span>)</span><br><span class="line">        </span><br><span class="line">        plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">        pdf.savefig(fig, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br><span class="line">        plt.close()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_ç”ŸæˆPDFæ€»è§ˆ</span>(<span class="params">self, pdf</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç”ŸæˆPDFæ€»è§ˆé¡µ&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># ä½¿ç”¨ä¹‹å‰ç”Ÿæˆçš„å›¾è¡¨é›†</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(self, <span class="string">&#x27;å›¾è¡¨é›†&#x27;</span>):</span><br><span class="line">            pdf.savefig(self.å›¾è¡¨é›†, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># å¦‚æœæ²¡æœ‰å›¾è¡¨é›†ï¼Œç”Ÿæˆç®€åŒ–ç‰ˆ</span></span><br><span class="line">            fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(<span class="number">2</span>, <span class="number">2</span>, figsize=(<span class="number">11.69</span>, <span class="number">8.27</span>))</span><br><span class="line">            self._ç»˜åˆ¶å¹´åº¦æ€»è§ˆ(ax1)</span><br><span class="line">            self._ç»˜åˆ¶æ”¶å…¥ç»“æ„(ax2)</span><br><span class="line">            self._ç»˜åˆ¶æ”¯å‡ºç»“æ„(ax3)</span><br><span class="line">            self._ç»˜åˆ¶æœˆåº¦è¶‹åŠ¿(ax4)</span><br><span class="line">            plt.suptitle(<span class="string">&#x27;å¹´åº¦è´¢åŠ¡æ€»è§ˆ&#x27;</span>, fontsize=<span class="number">18</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">            plt.tight_layout()</span><br><span class="line">            pdf.savefig(fig, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br><span class="line">            plt.close()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_ç”ŸæˆPDFè¯¦ç»†åˆ†æ</span>(<span class="params">self, pdf</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç”ŸæˆPDFè¯¦ç»†åˆ†æé¡µ&quot;&quot;&quot;</span></span><br><span class="line">        fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(<span class="number">2</span>, <span class="number">2</span>, figsize=(<span class="number">11.69</span>, <span class="number">8.27</span>))</span><br><span class="line">        </span><br><span class="line">        self._ç»˜åˆ¶ç»“ä½™ç‡åˆ†æ(ax1)</span><br><span class="line">        self._ç»˜åˆ¶æ”¶å…¥å¯¹æ¯”(ax2)</span><br><span class="line">        self._ç»˜åˆ¶æ”¯å‡ºå¯¹æ¯”(ax3)</span><br><span class="line">        self._ç»˜åˆ¶çƒ­åŠ›å›¾(ax4)</span><br><span class="line">        </span><br><span class="line">        plt.suptitle(<span class="string">&#x27;è¯¦ç»†è´¢åŠ¡åˆ†æ&#x27;</span>, fontsize=<span class="number">18</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">        plt.tight_layout()</span><br><span class="line">        pdf.savefig(fig, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br><span class="line">        plt.close()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_ç”ŸæˆPDFå¥åº·è¯„ä¼°</span>(<span class="params">self, pdf</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç”ŸæˆPDFå¥åº·åº¦è¯„ä¼°é¡µ&quot;&quot;&quot;</span></span><br><span class="line">        fig, (ax1, ax2) = plt.subplots(<span class="number">1</span>, <span class="number">2</span>, figsize=(<span class="number">11.69</span>, <span class="number">8.27</span>))</span><br><span class="line">        </span><br><span class="line">        self._ç»˜åˆ¶å¥åº·åº¦é›·è¾¾å›¾(ax1)</span><br><span class="line">        self._ç»˜åˆ¶å…³é”®æŒ‡æ ‡(ax2)</span><br><span class="line">        </span><br><span class="line">        plt.suptitle(<span class="string">&#x27;è´¢åŠ¡å¥åº·åº¦è¯„ä¼°&#x27;</span>, fontsize=<span class="number">18</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">        plt.tight_layout()</span><br><span class="line">        pdf.savefig(fig, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br><span class="line">        plt.close()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_ç”ŸæˆPDFå»ºè®®</span>(<span class="params">self, pdf</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç”ŸæˆPDFå»ºè®®é¡µ&quot;&quot;&quot;</span></span><br><span class="line">        fig = plt.figure(figsize=(<span class="number">8.27</span>, <span class="number">11.69</span>))</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å»ºè®®å†…å®¹</span></span><br><span class="line">        å»ºè®®å†…å®¹ = <span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        ä¸ªäººç†è´¢å»ºè®®ä¸è§„åˆ’</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        ä¸€ã€å½“å‰è´¢åŠ¡çŠ¶å†µæ€»ç»“</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        1. æ€»ä½“è¯„ä»·</span></span><br><span class="line"><span class="string">           â€¢ è´¢åŠ¡å¥åº·ç­‰çº§ï¼š<span class="subst">&#123;self.å¥åº·ç­‰çº§&#125;</span></span></span><br><span class="line"><span class="string">           â€¢ å¥åº·åº¦è¯„åˆ†ï¼š<span class="subst">&#123;self.å¥åº·å¾—åˆ†&#125;</span>åˆ†</span></span><br><span class="line"><span class="string">           â€¢ å¹³å‡ç»“ä½™ç‡ï¼š<span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹³å‡ç»“ä½™ç‡&quot;</span>]:<span class="number">.1</span>f&#125;</span>%</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        2. ä¸»è¦äº®ç‚¹</span></span><br><span class="line"><span class="string">           â€¢ å¹´åº¦æ€»ç»“ä½™ï¼š<span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹´åº¦æ€»ç»“ä½™&quot;</span>]:,<span class="number">.0</span>f&#125;</span>å…ƒ</span></span><br><span class="line"><span class="string">           â€¢ æ”¶å…¥ç»“æ„ï¼šå·¥èµ„æ”¶å…¥å æ¯”<span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;æ”¶å…¥ç»“æ„&quot;</span>][<span class="string">&quot;å·¥èµ„æ”¶å…¥&quot;</span>]/self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹´åº¦æ€»æ”¶å…¥&quot;</span>]*<span class="number">100</span>:<span class="number">.1</span>f&#125;</span>%</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        3. éœ€è¦å…³æ³¨çš„é—®é¢˜</span></span><br><span class="line"><span class="string">           â€¢ æ”¯å‡ºé›†ä¸­åº¦ï¼š<span class="subst">&#123;<span class="built_in">list</span>(self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;æ”¯å‡ºç»“æ„&quot;</span>].keys())[<span class="number">0</span>]&#125;</span>å æ¯”æœ€é«˜</span></span><br><span class="line"><span class="string">           â€¢ ç»“ä½™ç‡æ³¢åŠ¨ï¼š<span class="subst">&#123;self.å¹´åº¦ç»“ä½™[<span class="string">&quot;ç»“ä½™ç‡&quot;</span>].std():<span class="number">.1</span>f&#125;</span>%</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        äºŒã€æ˜å¹´ç†è´¢ç›®æ ‡</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        1. ç»“ä½™ç›®æ ‡</span></span><br><span class="line"><span class="string">           â€¢ ç›®æ ‡ç»“ä½™ç‡ï¼šâ‰¥25%</span></span><br><span class="line"><span class="string">           â€¢ ç›®æ ‡æœˆç»“ä½™ï¼šâ‰¥<span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹³å‡æœˆç»“ä½™&quot;</span>]*<span class="number">1.2</span>:,<span class="number">.0</span>f&#125;</span>å…ƒ</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        2. æ”¶å…¥ç›®æ ‡</span></span><br><span class="line"><span class="string">           â€¢ å¢åŠ æŠ•èµ„æ”¶å…¥å æ¯”è‡³10%ä»¥ä¸Š</span></span><br><span class="line"><span class="string">           â€¢ æ¢ç´¢å¤šå…ƒåŒ–æ”¶å…¥æ¥æº</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        3. æ”¯å‡ºæ§åˆ¶ç›®æ ‡</span></span><br><span class="line"><span class="string">           â€¢ é™ä½éå¿…è¦æ”¯å‡ºå æ¯”</span></span><br><span class="line"><span class="string">           â€¢ å»ºç«‹åº”æ€¥åŸºé‡‘ï¼ˆ6ä¸ªæœˆç”Ÿæ´»è´¹ï¼‰</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        ä¸‰ã€å…·ä½“è¡ŒåŠ¨è®¡åˆ’</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        1. çŸ­æœŸè¡ŒåŠ¨ï¼ˆ1-3ä¸ªæœˆï¼‰</span></span><br><span class="line"><span class="string">           â€¢ åˆ¶å®šè¯¦ç»†çš„æœˆåº¦é¢„ç®—</span></span><br><span class="line"><span class="string">           â€¢ å»ºç«‹æ”¯å‡ºè¿½è¸ªç³»ç»Ÿ</span></span><br><span class="line"><span class="string">           â€¢ å¼€å§‹å»ºç«‹åº”æ€¥åŸºé‡‘</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        2. ä¸­æœŸè¡ŒåŠ¨ï¼ˆ3-12ä¸ªæœˆï¼‰</span></span><br><span class="line"><span class="string">           â€¢ å­¦ä¹ æŠ•èµ„ç†è´¢çŸ¥è¯†</span></span><br><span class="line"><span class="string">           â€¢ ä¼˜åŒ–æŠ•èµ„ç»„åˆ</span></span><br><span class="line"><span class="string">           â€¢ å®šæœŸå›é¡¾å’Œè°ƒæ•´è®¡åˆ’</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        3. é•¿æœŸè¡ŒåŠ¨ï¼ˆ1å¹´ä»¥ä¸Šï¼‰</span></span><br><span class="line"><span class="string">           â€¢ å®ç°è´¢åŠ¡ç›®æ ‡å¤šå…ƒåŒ–</span></span><br><span class="line"><span class="string">           â€¢ å»ºç«‹è¢«åŠ¨æ”¶å…¥æ¥æº</span></span><br><span class="line"><span class="string">           â€¢ è§„åˆ’é€€ä¼‘ç†è´¢æ–¹æ¡ˆ</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        </span><br><span class="line">        plt.text(<span class="number">0.1</span>, <span class="number">0.9</span>, å»ºè®®å†…å®¹, transform=fig.transFigure, fontsize=<span class="number">12</span>, </span><br><span class="line">                verticalalignment=<span class="string">&#x27;top&#x27;</span>, fontfamily=<span class="string">&#x27;monospace&#x27;</span>,</span><br><span class="line">                bbox=<span class="built_in">dict</span>(boxstyle=<span class="string">&#x27;round,pad=0.5&#x27;</span>, facecolor=<span class="string">&#x27;lightyellow&#x27;</span>, alpha=<span class="number">0.8</span>))</span><br><span class="line">        </span><br><span class="line">        plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">        plt.suptitle(<span class="string">&#x27;ä¸ªäººç†è´¢å»ºè®®ä¸è§„åˆ’&#x27;</span>, fontsize=<span class="number">20</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>, y=<span class="number">0.98</span>)</span><br><span class="line">        pdf.savefig(fig, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br><span class="line">        plt.close()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ç”Ÿæˆæ–‡æœ¬æŠ¥å‘Š</span>(<span class="params">self, æ–‡ä»¶å</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç”Ÿæˆæ–‡æœ¬æ ¼å¼çš„æŠ¥å‘Šæ‘˜è¦&quot;&quot;&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ğŸ“ ç”Ÿæˆæ–‡æœ¬æŠ¥å‘Šï¼š<span class="subst">&#123;æ–‡ä»¶å&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        æŠ¥å‘Šå†…å®¹ = <span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span><br><span class="line"><span class="string">                            ä¸ªäººç†è´¢å¹´åº¦æŠ¥å‘Šæ‘˜è¦</span></span><br><span class="line"><span class="string">                                2024å¹´åº¦</span></span><br><span class="line"><span class="string">        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        ğŸ“Š å¹´åº¦è´¢åŠ¡æ¦‚å†µ</span></span><br><span class="line"><span class="string">        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span><br><span class="line"><span class="string">        â€¢ å¹´åº¦æ€»æ”¶å…¥ï¼š<span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹´åº¦æ€»æ”¶å…¥&quot;</span>]:,&#125;</span>å…ƒ</span></span><br><span class="line"><span class="string">        â€¢ å¹´åº¦æ€»æ”¯å‡ºï¼š<span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹´åº¦æ€»æ”¯å‡º&quot;</span>]:,&#125;</span>å…ƒ  </span></span><br><span class="line"><span class="string">        â€¢ å¹´åº¦æ€»ç»“ä½™ï¼š<span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹´åº¦æ€»ç»“ä½™&quot;</span>]:,&#125;</span>å…ƒ</span></span><br><span class="line"><span class="string">        â€¢ å¹³å‡æœˆç»“ä½™ï¼š<span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹³å‡æœˆç»“ä½™&quot;</span>]:,<span class="number">.2</span>f&#125;</span>å…ƒ</span></span><br><span class="line"><span class="string">        â€¢ å¹³å‡ç»“ä½™ç‡ï¼š<span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹³å‡ç»“ä½™ç‡&quot;</span>]:<span class="number">.1</span>f&#125;</span>%</span></span><br><span class="line"><span class="string">        â€¢ è´¢åŠ¡å¥åº·ç­‰çº§ï¼š<span class="subst">&#123;self.å¥åº·ç­‰çº§&#125;</span>ï¼ˆ<span class="subst">&#123;self.å¥åº·å¾—åˆ†&#125;</span>åˆ†ï¼‰</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        ğŸ“ˆ è¶‹åŠ¿åˆ†æ</span></span><br><span class="line"><span class="string">        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span><br><span class="line"><span class="string">        â€¢ æ”¶å…¥è¶‹åŠ¿ï¼š<span class="subst">&#123;self.è¶‹åŠ¿åˆ†æ[<span class="string">&quot;æ”¶å…¥è¶‹åŠ¿&quot;</span>]&#125;</span></span></span><br><span class="line"><span class="string">        â€¢ æ”¯å‡ºè¶‹åŠ¿ï¼š<span class="subst">&#123;self.è¶‹åŠ¿åˆ†æ[<span class="string">&quot;æ”¯å‡ºè¶‹åŠ¿&quot;</span>]&#125;</span></span></span><br><span class="line"><span class="string">        â€¢ ç»“ä½™è¶‹åŠ¿ï¼š<span class="subst">&#123;self.è¶‹åŠ¿åˆ†æ[<span class="string">&quot;ç»“ä½™è¶‹åŠ¿&quot;</span>]&#125;</span></span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        ğŸ† å¹´åº¦ä¹‹æœ€</span></span><br><span class="line"><span class="string">        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span><br><span class="line"><span class="string">        â€¢ æ”¶å…¥æœ€é«˜æœˆä»½ï¼š<span class="subst">&#123;self.æœˆåº¦æ’å[<span class="string">&quot;æ”¶å…¥æœ€é«˜æœˆä»½&quot;</span>]&#125;</span></span></span><br><span class="line"><span class="string">        â€¢ æ”¯å‡ºæœ€é«˜æœˆä»½ï¼š<span class="subst">&#123;self.æœˆåº¦æ’å[<span class="string">&quot;æ”¯å‡ºæœ€é«˜æœˆä»½&quot;</span>]&#125;</span></span></span><br><span class="line"><span class="string">        â€¢ ç»“ä½™æœ€é«˜æœˆä»½ï¼š<span class="subst">&#123;self.æœˆåº¦æ’å[<span class="string">&quot;ç»“ä½™æœ€é«˜æœˆä»½&quot;</span>]&#125;</span></span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        ğŸ’¡ ç†è´¢å»ºè®®</span></span><br><span class="line"><span class="string">        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span><br><span class="line"><span class="string">        <span class="subst">&#123;self.å¥åº·å»ºè®®&#125;</span></span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        ğŸ“… æŠ¥å‘Šç”Ÿæˆæ—¶é—´ï¼š<span class="subst">&#123;datetime.now().strftime(<span class="string">&quot;%Yå¹´%mæœˆ%dæ—¥ %H:%M&quot;</span>)&#125;</span></span></span><br><span class="line"><span class="string">        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(æ–‡ä»¶å, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(æŠ¥å‘Šå†…å®¹)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> æ–‡ä»¶å</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ç”ŸæˆMarkdownæŠ¥å‘Š</span>(<span class="params">self, æ–‡ä»¶å</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç”ŸæˆMarkdownæ ¼å¼çš„æŠ¥å‘Š&quot;&quot;&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ğŸ“ ç”ŸæˆMarkdownæŠ¥å‘Šï¼š<span class="subst">&#123;æ–‡ä»¶å&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        Markdownå†…å®¹ = <span class="string">f&quot;&quot;&quot;# ä¸ªäººç†è´¢å¹´åº¦æŠ¥å‘Š 2024</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        ## ğŸ“Š å¹´åº¦è´¢åŠ¡æ¦‚å†µ</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        ### å…³é”®æŒ‡æ ‡</span></span><br><span class="line"><span class="string">        | æŒ‡æ ‡ | æ•°å€¼ | å•ä½ |</span></span><br><span class="line"><span class="string">        |------|------|------|</span></span><br><span class="line"><span class="string">        | å¹´åº¦æ€»æ”¶å…¥ | <span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹´åº¦æ€»æ”¶å…¥&quot;</span>]:,<span class="number">.0</span>f&#125;</span> | å…ƒ |</span></span><br><span class="line"><span class="string">        | å¹´åº¦æ€»æ”¯å‡º | <span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹´åº¦æ€»æ”¯å‡º&quot;</span>]:,<span class="number">.0</span>f&#125;</span> | å…ƒ |</span></span><br><span class="line"><span class="string">        | å¹´åº¦æ€»ç»“ä½™ | <span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹´åº¦æ€»ç»“ä½™&quot;</span>]:,<span class="number">.0</span>f&#125;</span> | å…ƒ |</span></span><br><span class="line"><span class="string">        | å¹³å‡æœˆç»“ä½™ | <span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹³å‡æœˆç»“ä½™&quot;</span>]:,<span class="number">.2</span>f&#125;</span> | å…ƒ |</span></span><br><span class="line"><span class="string">        | å¹³å‡ç»“ä½™ç‡ | <span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;å¹³å‡ç»“ä½™ç‡&quot;</span>]:<span class="number">.1</span>f&#125;</span> | % |</span></span><br><span class="line"><span class="string">        | è´¢åŠ¡å¥åº·ç­‰çº§ | <span class="subst">&#123;self.å¥åº·ç­‰çº§&#125;</span> | - |</span></span><br><span class="line"><span class="string">        | å¥åº·åº¦å¾—åˆ† | <span class="subst">&#123;self.å¥åº·å¾—åˆ†&#125;</span> | åˆ† |</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        ### æ”¶å…¥ç»“æ„</span></span><br><span class="line"><span class="string">        <span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;æ”¶å…¥ç»“æ„&quot;</span>].to_markdown()&#125;</span></span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        ### æ”¯å‡ºç»“æ„  </span></span><br><span class="line"><span class="string">        <span class="subst">&#123;self.å¹´åº¦æ±‡æ€»[<span class="string">&quot;æ”¯å‡ºç»“æ„&quot;</span>].to_markdown()&#125;</span></span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        ## ğŸ“ˆ è¶‹åŠ¿åˆ†æ</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        ### æœˆåº¦è¶‹åŠ¿</span></span><br><span class="line"><span class="string">        <span class="subst">&#123;self.å¹´åº¦ç»“ä½™[[<span class="string">&quot;æœˆä»½&quot;</span>, <span class="string">&quot;æœˆåº¦ç»“ä½™&quot;</span>, <span class="string">&quot;ç»“ä½™ç‡&quot;</span>]].to_markdown()&#125;</span></span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        ### å…³é”®æ’å</span></span><br><span class="line"><span class="string">        - æ”¶å…¥æœ€é«˜æœˆä»½ï¼š<span class="subst">&#123;self.æœˆåº¦æ’å[<span class="string">&quot;æ”¶å…¥æœ€é«˜æœˆä»½&quot;</span>]&#125;</span></span></span><br><span class="line"><span class="string">        - æ”¯å‡ºæœ€é«˜æœˆä»½ï¼š<span class="subst">&#123;self.æœˆåº¦æ’å[<span class="string">&quot;æ”¯å‡ºæœ€é«˜æœˆä»½&quot;</span>]&#125;</span></span></span><br><span class="line"><span class="string">        - ç»“ä½™æœ€é«˜æœˆä»½ï¼š<span class="subst">&#123;self.æœˆåº¦æ’å[<span class="string">&quot;ç»“ä½™æœ€é«˜æœˆä»½&quot;</span>]&#125;</span></span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        ## ğŸ’¡ ç†è´¢å»ºè®®</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        <span class="subst">&#123;self.å¥åº·å»ºè®®&#125;</span></span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        ## ğŸ“Š å¥åº·æŒ‡æ ‡è¯¦æƒ…</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        <span class="subst">&#123;pd.DataFrame(<span class="built_in">list</span>(self.å¥åº·æŒ‡æ ‡.items()), columns=[<span class="string">&#x27;æŒ‡æ ‡&#x27;</span>, <span class="string">&#x27;å¾—åˆ†&#x27;</span>]).to_markdown()&#125;</span></span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        --- </span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        *æŠ¥å‘Šç”Ÿæˆæ—¶é—´ï¼š<span class="subst">&#123;datetime.now().strftime(<span class="string">&quot;%Yå¹´%mæœˆ%dæ—¥ %H:%M&quot;</span>)&#125;</span>*</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(æ–‡ä»¶å, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(Markdownå†…å®¹)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> æ–‡ä»¶å</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ä¸“ä¸šå¹´åº¦æŠ¥å‘Šç”Ÿæˆå™¨</span></span><br><span class="line">ä¸“ä¸šç”Ÿæˆå™¨ = å¹´åº¦æŠ¥å‘Šç”Ÿæˆå™¨()</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½æ•°æ®</span></span><br><span class="line">ä¸“ä¸šç”Ÿæˆå™¨.åŠ è½½æ•°æ®(æœˆåº¦æ”¶å…¥, æœˆåº¦æ”¯å‡º, æœˆåº¦ç»“ä½™)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆå®Œæ•´æŠ¥å‘ŠåŒ…</span></span><br><span class="line">æŠ¥å‘Šæ–‡ä»¶ = ä¸“ä¸šç”Ÿæˆå™¨.ç”Ÿæˆå®Œæ•´æŠ¥å‘Š(<span class="string">&quot;ä¸ªäººç†è´¢å¹´åº¦æŠ¥å‘Š_ä¸“ä¸šç‰ˆ&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nğŸ‰ æ‰€æœ‰æŠ¥å‘Šå·²ç”Ÿæˆå®Œæˆï¼&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æ‚¨å¯ä»¥æŸ¥çœ‹ä»¥ä¸‹æ–‡ä»¶ï¼š&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> ç±»å‹, æ–‡ä»¶ <span class="keyword">in</span> æŠ¥å‘Šæ–‡ä»¶.items():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;ç±»å‹&#125;</span>ï¼š<span class="subst">&#123;æ–‡ä»¶&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure></details><hr><h3 id="ğŸƒâ€â™€ï¸-è¿›é˜¶å°æŒ‘æˆ˜"><a href="#ğŸƒâ€â™€ï¸-è¿›é˜¶å°æŒ‘æˆ˜" class="headerlink" title="ğŸƒâ€â™€ï¸ è¿›é˜¶å°æŒ‘æˆ˜"></a>ğŸƒâ€â™€ï¸ è¿›é˜¶å°æŒ‘æˆ˜</h3><details><summary>æŒ‘æˆ˜1ï¼šæŠ•èµ„ç»„åˆåˆ†ææŠ¥å‘Š</summary><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŠ•èµ„ç»„åˆåˆ†ææŠ¥å‘ŠæŒ‘æˆ˜</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=== æŠ•èµ„ç»„åˆåˆ†ææŠ¥å‘ŠæŒ‘æˆ˜ ===&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºæŠ•èµ„ç»„åˆæ•°æ®</span></span><br><span class="line">æŠ•èµ„ç»„åˆæ•°æ® = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;æ—¥æœŸ&#x27;</span>: pd.date_range(<span class="string">&#x27;2024-01-01&#x27;</span>, periods=<span class="number">250</span>, freq=<span class="string">&#x27;D&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;è‚¡ç¥¨A&#x27;</span>: np.random.normal(<span class="number">100</span>, <span class="number">5</span>, <span class="number">250</span>).cumsum() + <span class="number">100</span>,</span><br><span class="line">    <span class="string">&#x27;è‚¡ç¥¨B&#x27;</span>: np.random.normal(<span class="number">95</span>, <span class="number">8</span>, <span class="number">250</span>).cumsum() + <span class="number">95</span>,</span><br><span class="line">    <span class="string">&#x27;å€ºåˆ¸A&#x27;</span>: np.random.normal(<span class="number">102</span>, <span class="number">2</span>, <span class="number">250</span>).cumsum() + <span class="number">102</span>,</span><br><span class="line">    <span class="string">&#x27;åŸºé‡‘A&#x27;</span>: np.random.normal(<span class="number">98</span>, <span class="number">6</span>, <span class="number">250</span>).cumsum() + <span class="number">98</span>,</span><br><span class="line">    <span class="string">&#x27;é»„é‡‘&#x27;</span>: np.random.normal(<span class="number">105</span>, <span class="number">4</span>, <span class="number">250</span>).cumsum() + <span class="number">105</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ æ”¶ç›Šç‡</span></span><br><span class="line"><span class="keyword">for</span> åˆ— <span class="keyword">in</span> æŠ•èµ„ç»„åˆæ•°æ®.columns[<span class="number">1</span>:]:</span><br><span class="line">    æŠ•èµ„ç»„åˆæ•°æ®[<span class="string">f&#x27;<span class="subst">&#123;åˆ—&#125;</span>_æ”¶ç›Šç‡&#x27;</span>] = æŠ•èµ„ç»„åˆæ•°æ®[åˆ—].pct_change()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ç”ŸæˆæŠ•èµ„ç»„åˆæŠ¥å‘Š</span>(<span class="params">æŠ•èµ„ç»„åˆdf</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ç”Ÿæˆä¸“ä¸šçš„æŠ•èµ„ç»„åˆåˆ†ææŠ¥å‘Š&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ğŸ“Š ç”ŸæˆæŠ•èµ„ç»„åˆåˆ†ææŠ¥å‘Š...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 1. åŸºç¡€ç»Ÿè®¡åˆ†æ</span></span><br><span class="line">    æ”¶ç›Šç»Ÿè®¡ = æŠ•èµ„ç»„åˆæ•°æ®[[<span class="string">&#x27;è‚¡ç¥¨A_æ”¶ç›Šç‡&#x27;</span>, <span class="string">&#x27;è‚¡ç¥¨B_æ”¶ç›Šç‡&#x27;</span>, <span class="string">&#x27;å€ºåˆ¸A_æ”¶ç›Šç‡&#x27;</span>, <span class="string">&#x27;åŸºé‡‘A_æ”¶ç›Šç‡&#x27;</span>, <span class="string">&#x27;é»„é‡‘_æ”¶ç›Šç‡&#x27;</span>]].describe()</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nğŸ“ˆ æ”¶ç›Šç‡ç»Ÿè®¡åˆ†æï¼š&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(æ”¶ç›Šç»Ÿè®¡)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. é£é™©æ”¶ç›Šåˆ†æ</span></span><br><span class="line">    é£é™©æ”¶ç›Šåˆ†æ = pd.DataFrame(&#123;</span><br><span class="line">        <span class="string">&#x27;å¹³å‡æ”¶ç›Šç‡&#x27;</span>: æŠ•èµ„ç»„åˆæ•°æ®[[<span class="string">&#x27;è‚¡ç¥¨A_æ”¶ç›Šç‡&#x27;</span>, <span class="string">&#x27;è‚¡ç¥¨B_æ”¶ç›Šç‡&#x27;</span>, <span class="string">&#x27;å€ºåˆ¸A_æ”¶ç›Šç‡&#x27;</span>, <span class="string">&#x27;åŸºé‡‘A_æ”¶ç›Šç‡&#x27;</span>, <span class="string">&#x27;é»„é‡‘_æ”¶ç›Šç‡&#x27;</span>]].mean(),</span><br><span class="line">        <span class="string">&#x27;æ”¶ç›Šç‡æ ‡å‡†å·®&#x27;</span>: æŠ•èµ„ç»„åˆæ•°æ®[[<span class="string">&#x27;è‚¡ç¥¨A_æ”¶ç›Šç‡&#x27;</span>, <span class="string">&#x27;è‚¡ç¥¨B_æ”¶ç›Šç‡&#x27;</span>, <span class="string">&#x27;å€ºåˆ¸A_æ”¶ç›Šç‡&#x27;</span>, <span class="string">&#x27;åŸºé‡‘A_æ”¶ç›Šç‡&#x27;</span>, <span class="string">&#x27;é»„é‡‘_æ”¶ç›Šç‡&#x27;</span>]].std(),</span><br><span class="line">        <span class="string">&#x27;å¤æ™®æ¯”ç‡&#x27;</span>: <span class="number">0</span>  <span class="comment"># å¾…è®¡ç®—</span></span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è®¡ç®—å¤æ™®æ¯”ç‡ï¼ˆå‡è®¾æ— é£é™©åˆ©ç‡ä¸º3%ï¼‰</span></span><br><span class="line">    æ— é£é™©åˆ©ç‡ = <span class="number">0.03</span> / <span class="number">250</span>  <span class="comment"># æ—¥åŒ–æ”¶ç›Šç‡</span></span><br><span class="line">    é£é™©æ”¶ç›Šåˆ†æ[<span class="string">&#x27;å¤æ™®æ¯”ç‡&#x27;</span>] = (é£é™©æ”¶ç›Šåˆ†æ[<span class="string">&#x27;å¹³å‡æ”¶ç›Šç‡&#x27;</span>] - æ— é£é™©åˆ©ç‡) / é£é™©æ”¶ç›Šåˆ†æ[<span class="string">&#x27;æ”¶ç›Šç‡æ ‡å‡†å·®&#x27;</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nğŸ’° é£é™©æ”¶ç›Šåˆ†æï¼š&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(é£é™©æ”¶ç›Šåˆ†æ.<span class="built_in">round</span>(<span class="number">4</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. ç›¸å…³æ€§åˆ†æ</span></span><br><span class="line">    ç›¸å…³æ€§çŸ©é˜µ = æŠ•èµ„ç»„åˆæ•°æ®[[<span class="string">&#x27;è‚¡ç¥¨A_æ”¶ç›Šç‡&#x27;</span>, <span class="string">&#x27;è‚¡ç¥¨B_æ”¶ç›Šç‡&#x27;</span>, <span class="string">&#x27;å€ºåˆ¸A_æ”¶ç›Šç‡&#x27;</span>, <span class="string">&#x27;åŸºé‡‘A_æ”¶ç›Šç‡&#x27;</span>, <span class="string">&#x27;é»„é‡‘_æ”¶ç›Šç‡&#x27;</span>]].corr()</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nğŸ”— èµ„äº§ç›¸å…³æ€§åˆ†æï¼š&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(ç›¸å…³æ€§çŸ©é˜µ.<span class="built_in">round</span>(<span class="number">3</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 4. ç”Ÿæˆä¸“ä¸šå›¾è¡¨</span></span><br><span class="line">    fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(<span class="number">2</span>, <span class="number">2</span>, figsize=(<span class="number">15</span>, <span class="number">10</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ä»·æ ¼èµ°åŠ¿å›¾</span></span><br><span class="line">    æŠ•èµ„ç»„åˆæ•°æ®.set_index(<span class="string">&#x27;æ—¥æœŸ&#x27;</span>)[[<span class="string">&#x27;è‚¡ç¥¨A&#x27;</span>, <span class="string">&#x27;è‚¡ç¥¨B&#x27;</span>, <span class="string">&#x27;å€ºåˆ¸A&#x27;</span>, <span class="string">&#x27;åŸºé‡‘A&#x27;</span>, <span class="string">&#x27;é»„é‡‘&#x27;</span>]].plot(ax=ax1, linewidth=<span class="number">2</span>)</span><br><span class="line">    ax1.set_title(<span class="string">&#x27;æŠ•èµ„ç»„åˆä»·æ ¼èµ°åŠ¿&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">    ax1.set_ylabel(<span class="string">&#x27;ä»·æ ¼&#x27;</span>)</span><br><span class="line">    ax1.legend()</span><br><span class="line">    ax1.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ”¶ç›Šç‡åˆ†å¸ƒå›¾</span></span><br><span class="line">    æŠ•èµ„ç»„åˆæ•°æ®[[<span class="string">&#x27;è‚¡ç¥¨A_æ”¶ç›Šç‡&#x27;</span>, <span class="string">&#x27;è‚¡ç¥¨B_æ”¶ç›Šç‡&#x27;</span>, <span class="string">&#x27;å€ºåˆ¸A_æ”¶ç›Šç‡&#x27;</span>, <span class="string">&#x27;åŸºé‡‘A_æ”¶ç›Šç‡&#x27;</span>, <span class="string">&#x27;é»„é‡‘_æ”¶ç›Šç‡&#x27;</span>]].plot(kind=<span class="string">&#x27;hist&#x27;</span>, bins=<span class="number">30</span>, alpha=<span class="number">0.7</span>, ax=ax2)</span><br><span class="line">    ax2.set_title(<span class="string">&#x27;æ—¥æ”¶ç›Šç‡åˆ†å¸ƒ&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">    ax2.set_xlabel(<span class="string">&#x27;æ”¶ç›Šç‡&#x27;</span>)</span><br><span class="line">    ax2.legend()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ç›¸å…³æ€§çƒ­åŠ›å›¾</span></span><br><span class="line">    sns.heatmap(ç›¸å…³æ€§çŸ©é˜µ, annot=<span class="literal">True</span>, cmap=<span class="string">&#x27;coolwarm&#x27;</span>, center=<span class="number">0</span>, ax=ax3)</span><br><span class="line">    ax3.set_title(<span class="string">&#x27;èµ„äº§æ”¶ç›Šç‡ç›¸å…³æ€§&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># é£é™©æ”¶ç›Šæ•£ç‚¹å›¾</span></span><br><span class="line">    æ•£ç‚¹æ•°æ® = é£é™©æ”¶ç›Šåˆ†æ.reset_index()</span><br><span class="line">    æ•£ç‚¹æ•°æ®[<span class="string">&#x27;èµ„äº§åç§°&#x27;</span>] = æ•£ç‚¹_data[<span class="string">&#x27;index&#x27;</span>].<span class="built_in">str</span>.replace(<span class="string">&#x27;_æ”¶ç›Šç‡&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    colors = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>, <span class="string">&#x27;green&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>, <span class="string">&#x27;purple&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> i, (èµ„äº§, æ•°æ®) <span class="keyword">in</span> <span class="built_in">enumerate</span>(æ•£ç‚¹æ•°æ®.iterrows()):</span><br><span class="line">        ax4.scatter(æ•°æ®[<span class="string">&#x27;æ”¶ç›Šç‡æ ‡å‡†å·®&#x27;</span>], æ•°æ®[<span class="string">&#x27;å¹³å‡æ”¶ç›Šç‡&#x27;</span>], </span><br><span class="line">                   s=<span class="number">200</span>, c=colors[i], alpha=<span class="number">0.7</span>, label=æ•°æ®[<span class="string">&#x27;èµ„äº§åç§°&#x27;</span>])</span><br><span class="line">    </span><br><span class="line">    ax4.set_xlabel(<span class="string">&#x27;é£é™©ï¼ˆæ ‡å‡†å·®ï¼‰&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">    ax4.set_ylabel(<span class="string">&#x27;æ”¶ç›Šç‡&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">    ax4.set_title(<span class="string">&#x27;é£é™©æ”¶ç›Šåˆ†æ&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">    ax4.legend()</span><br><span class="line">    ax4.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line">    </span><br><span class="line">    plt.suptitle(<span class="string">&#x27;æŠ•èµ„ç»„åˆåˆ†ææŠ¥å‘Š&#x27;</span>, fontsize=<span class="number">18</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">    plt.tight_layout()</span><br><span class="line">    plt.savefig(<span class="string">&#x27;æŠ•èµ„ç»„åˆåˆ†ææŠ¥å‘Š.png&#x27;</span>, dpi=<span class="number">300</span>, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br><span class="line">    plt.close()</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;âœ… æŠ•èµ„ç»„åˆåˆ†ææŠ¥å‘Šå·²ç”Ÿæˆï¼&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 5. ç”ŸæˆæŠ•èµ„å»ºè®®</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nğŸ’¡ æŠ•èµ„å»ºè®®ï¼š&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åŸºäºåˆ†æç»“æœç”Ÿæˆå»ºè®®</span></span><br><span class="line">    æœ€ä½³å¤æ™® = é£é™©æ”¶ç›Šåˆ†æ[<span class="string">&#x27;å¤æ™®æ¯”ç‡&#x27;</span>].idxmax()</span><br><span class="line">    æœ€å·®å¤æ™® = é£é™©æ”¶ç›Šåˆ†æ[<span class="string">&#x27;å¤æ™®æ¯”ç‡&#x27;</span>].idxmin()</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;  â€¢ æœ€ä½³é£é™©è°ƒæ•´åæ”¶ç›Šï¼š<span class="subst">&#123;æœ€ä½³å¤æ™®.replace(<span class="string">&#x27;_æ”¶ç›Šç‡&#x27;</span>, <span class="string">&#x27;&#x27;</span>)&#125;</span>ï¼ˆå¤æ™®æ¯”ç‡ï¼š<span class="subst">&#123;é£é™©æ”¶ç›Šåˆ†æ.loc[æœ€ä½³å¤æ™®, <span class="string">&#x27;å¤æ™®æ¯”ç‡&#x27;</span>]:<span class="number">.3</span>f&#125;</span>ï¼‰&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;  â€¢ éœ€è¦å…³æ³¨çš„èµ„äº§ï¼š<span class="subst">&#123;æœ€å·®å¤æ™®.replace(<span class="string">&#x27;_æ”¶ç›Šç‡&#x27;</span>, <span class="string">&#x27;&#x27;</span>)&#125;</span>ï¼ˆå¤æ™®æ¯”ç‡ï¼š<span class="subst">&#123;é£é™©æ”¶ç›Šåˆ†æ.loc[æœ€å·®å¤æ™®, <span class="string">&#x27;å¤æ™®æ¯”ç‡&#x27;</span>]:<span class="number">.3</span>f&#125;</span>ï¼‰&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åŸºäºç›¸å…³æ€§ç»™å‡ºå»ºè®®</span></span><br><span class="line">    é«˜ç›¸å…³æ€§ = ç›¸å…³æ€§çŸ©é˜µ[ç›¸å…³æ€§çŸ©é˜µ &gt; <span class="number">0.7</span>].count().<span class="built_in">sum</span>() - <span class="built_in">len</span>(ç›¸å…³æ€§çŸ©é˜µ)</span><br><span class="line">    <span class="keyword">if</span> é«˜ç›¸å…³æ€§ &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  â€¢ å‘ç°<span class="subst">&#123;é«˜ç›¸å…³æ€§&#125;</span>å¯¹é«˜ç›¸å…³æ€§èµ„äº§ï¼Œå»ºè®®é€‚å½“åˆ†æ•£æŠ•èµ„&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;  â€¢ å»ºè®®å®šæœŸå›é¡¾å’Œè°ƒæ•´æŠ•èµ„ç»„åˆ&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;  â€¢ è€ƒè™‘å¢åŠ ä½ç›¸å…³æ€§èµ„äº§ä»¥é™ä½æ•´ä½“é£é™©&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”ŸæˆæŠ•èµ„ç»„åˆæŠ¥å‘Š</span></span><br><span class="line">ç”ŸæˆæŠ•èµ„ç»„åˆæŠ¥å‘Š(æŠ•èµ„ç»„åˆæ•°æ®)</span><br></pre></td></tr></table></figure></details><details><summary>æŒ‘æˆ˜2ï¼šä¼ä¸šè´¢åŠ¡åˆ†ææŠ¥å‘Š</summary><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¼ä¸šè´¢åŠ¡åˆ†ææŠ¥å‘ŠæŒ‘æˆ˜</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=== ä¼ä¸šè´¢åŠ¡åˆ†ææŠ¥å‘ŠæŒ‘æˆ˜ ===&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¼ä¸šè´¢åŠ¡æ•°æ®</span></span><br><span class="line">ä¼ä¸šè´¢åŠ¡æ•°æ® = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;å¹´ä»½&#x27;</span>: [<span class="number">2021</span>, <span class="number">2022</span>, <span class="number">2023</span>, <span class="number">2024</span>],</span><br><span class="line">    <span class="string">&#x27;è¥ä¸šæ”¶å…¥&#x27;</span>: [<span class="number">5000000</span>, <span class="number">6000000</span>, <span class="number">7200000</span>, <span class="number">8500000</span>],</span><br><span class="line">    <span class="string">&#x27;è¥ä¸šæˆæœ¬&#x27;</span>: [<span class="number">3000000</span>, <span class="number">3600000</span>, <span class="number">4300000</span>, <span class="number">5000000</span>],</span><br><span class="line">    <span class="string">&#x27;è¥ä¸šåˆ©æ¶¦&#x27;</span>: [<span class="number">800000</span>, <span class="number">1000000</span>, <span class="number">1200000</span>, <span class="number">1500000</span>],</span><br><span class="line">    <span class="string">&#x27;å‡€åˆ©æ¶¦&#x27;</span>: [<span class="number">600000</span>, <span class="number">750000</span>, <span class="number">900000</span>, <span class="number">1100000</span>],</span><br><span class="line">    <span class="string">&#x27;æ€»èµ„äº§&#x27;</span>: [<span class="number">8000000</span>, <span class="number">9500000</span>, <span class="number">11000000</span>, <span class="number">13000000</span>],</span><br><span class="line">    <span class="string">&#x27;æ€»è´Ÿå€º&#x27;</span>: [<span class="number">4000000</span>, <span class="number">4500000</span>, <span class="number">5000000</span>, <span class="number">6000000</span>],</span><br><span class="line">    <span class="string">&#x27;æµåŠ¨èµ„äº§&#x27;</span>: [<span class="number">5000000</span>, <span class="number">6000000</span>, <span class="number">7000000</span>, <span class="number">8500000</span>],</span><br><span class="line">    <span class="string">&#x27;æµåŠ¨è´Ÿå€º&#x27;</span>: [<span class="number">2500000</span>, <span class="number">3000000</span>, <span class="number">3500000</span>, <span class="number">4000000</span>],</span><br><span class="line">    <span class="string">&#x27;åº”æ”¶è´¦æ¬¾&#x27;</span>: [<span class="number">1500000</span>, <span class="number">1800000</span>, <span class="number">2100000</span>, <span class="number">2500000</span>],</span><br><span class="line">    <span class="string">&#x27;å­˜è´§&#x27;</span>: [<span class="number">2000000</span>, <span class="number">2400000</span>, <span class="number">2800000</span>, <span class="number">3200000</span>],</span><br><span class="line">    <span class="string">&#x27;å›ºå®šèµ„äº§&#x27;</span>: [<span class="number">3000000</span>, <span class="number">3500000</span>, <span class="number">4000000</span>, <span class="number">4500000</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ç”Ÿæˆä¼ä¸šè´¢åŠ¡æŠ¥å‘Š</span>(<span class="params">ä¼ä¸šæ•°æ®</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ç”Ÿæˆä¼ä¸šè´¢åŠ¡åˆ†ææŠ¥å‘Š&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ğŸ“Š ç”Ÿæˆä¼ä¸šè´¢åŠ¡åˆ†ææŠ¥å‘Š...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 1. è®¡ç®—è´¢åŠ¡æ¯”ç‡</span></span><br><span class="line">    è´¢åŠ¡æ¯”ç‡ = pd.DataFrame()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ç›ˆåˆ©èƒ½åŠ›æ¯”ç‡</span></span><br><span class="line">    è´¢åŠ¡æ¯”ç‡[<span class="string">&#x27;é”€å”®æ¯›åˆ©ç‡&#x27;</span>] = (ä¼ä¸šæ•°æ®[<span class="string">&#x27;è¥ä¸šæ”¶å…¥&#x27;</span>] - ä¼ä¸šæ•°æ®[<span class="string">&#x27;è¥ä¸šæˆæœ¬&#x27;</span>]) / ä¼ä¸šæ•°æ®[<span class="string">&#x27;è¥ä¸šæ”¶å…¥&#x27;</span>] * <span class="number">100</span></span><br><span class="line">    è´¢åŠ¡æ¯”ç‡[<span class="string">&#x27;é”€å”®å‡€åˆ©ç‡&#x27;</span>] = ä¼ä¸šæ•°æ®[<span class="string">&#x27;å‡€åˆ©æ¶¦&#x27;</span>] / ä¼ä¸šæ•°æ®[<span class="string">&#x27;è¥ä¸šæ”¶å…¥&#x27;</span>] * <span class="number">100</span></span><br><span class="line">    è´¢åŠ¡æ¯”ç‡[<span class="string">&#x27;èµ„äº§å‡€åˆ©ç‡&#x27;</span>] = ä¼ä¸šæ•°æ®[<span class="string">&#x27;å‡€åˆ©æ¶¦&#x27;</span>] / ä¼ä¸šæ•°æ®[<span class="string">&#x27;æ€»èµ„äº§&#x27;</span>] * <span class="number">100</span></span><br><span class="line">    è´¢åŠ¡æ¯”ç‡[<span class="string">&#x27;å‡€èµ„äº§æ”¶ç›Šç‡&#x27;</span>] = ä¼ä¸šæ•°æ®[<span class="string">&#x27;å‡€åˆ©æ¶¦&#x27;</span>] / (ä¼ä¸šæ•°æ®[<span class="string">&#x27;æ€»èµ„äº§&#x27;</span>] - ä¼ä¸šæ•°æ®[<span class="string">&#x27;æ€»è´Ÿå€º&#x27;</span>]) * <span class="number">100</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å¿å€ºèƒ½åŠ›æ¯”ç‡</span></span><br><span class="line">    è´¢åŠ¡æ¯”ç‡[<span class="string">&#x27;æµåŠ¨æ¯”ç‡&#x27;</span>] = ä¼ä¸šæ•°æ®[<span class="string">&#x27;æµåŠ¨èµ„äº§&#x27;</span>] / ä¼ä¸šæ•°æ®[<span class="string">&#x27;æµåŠ¨è´Ÿå€º&#x27;</span>]</span><br><span class="line">    è´¢åŠ¡æ¯”ç‡[<span class="string">&#x27;é€ŸåŠ¨æ¯”ç‡&#x27;</span>] = (ä¼ä¸šæ•°æ®[<span class="string">&#x27;æµåŠ¨èµ„äº§&#x27;</span>] - ä¼ä¸šæ•°æ®[<span class="string">&#x27;å­˜è´§&#x27;</span>]) / ä¼ä¸šæ•°æ®[<span class="string">&#x27;æµåŠ¨è´Ÿå€º&#x27;</span>]</span><br><span class="line">    è´¢åŠ¡æ¯”ç‡[<span class="string">&#x27;èµ„äº§è´Ÿå€ºç‡&#x27;</span>] = ä¼ä¸šæ•°æ®[<span class="string">&#x27;æ€»è´Ÿå€º&#x27;</span>] / ä¼ä¸šæ•°æ®[<span class="string">&#x27;æ€»èµ„äº§&#x27;</span>] * <span class="number">100</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è¥è¿èƒ½åŠ›æ¯”ç‡</span></span><br><span class="line">    è´¢åŠ¡æ¯”ç‡[<span class="string">&#x27;åº”æ”¶è´¦æ¬¾å‘¨è½¬ç‡&#x27;</span>] = ä¼ä¸šæ•°æ®[<span class="string">&#x27;è¥ä¸šæ”¶å…¥&#x27;</span>] / ä¼ä¸šæ•°æ®[<span class="string">&#x27;åº”æ”¶è´¦æ¬¾&#x27;</span>]</span><br><span class="line">    è´¢åŠ¡æ¯”ç‡[<span class="string">&#x27;å­˜è´§å‘¨è½¬ç‡&#x27;</span>] = ä¼ä¸šæ•°æ®[<span class="string">&#x27;è¥ä¸šæˆæœ¬&#x27;</span>] / ä¼ä¸šæ•°æ®[<span class="string">&#x27;å­˜è´§&#x27;</span>]</span><br><span class="line">    è´¢åŠ¡æ¯”ç‡[<span class="string">&#x27;æ€»èµ„äº§å‘¨è½¬ç‡&#x27;</span>] = ä¼ä¸šæ•°æ®[<span class="string">&#x27;è¥ä¸šæ”¶å…¥&#x27;</span>] / ä¼ä¸šæ•°æ®[<span class="string">&#x27;æ€»èµ„äº§&#x27;</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ğŸ“Š è´¢åŠ¡æ¯”ç‡è®¡ç®—å®Œæˆï¼š&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(è´¢åŠ¡æ¯”ç‡.<span class="built_in">round</span>(<span class="number">2</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. è¶‹åŠ¿åˆ†æ</span></span><br><span class="line">    è¶‹åŠ¿åˆ†æ = pd.DataFrame()</span><br><span class="line">    <span class="keyword">for</span> åˆ— <span class="keyword">in</span> [<span class="string">&#x27;è¥ä¸šæ”¶å…¥&#x27;</span>, <span class="string">&#x27;å‡€åˆ©æ¶¦&#x27;</span>, <span class="string">&#x27;æ€»èµ„äº§&#x27;</span>]:</span><br><span class="line">        è¶‹åŠ¿åˆ†æ[<span class="string">f&#x27;<span class="subst">&#123;åˆ—&#125;</span>_å¢é•¿ç‡&#x27;</span>] = ä¼ä¸šæ•°æ®[åˆ—].pct_change() * <span class="number">100</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nğŸ“ˆ å¢é•¿è¶‹åŠ¿åˆ†æï¼š&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(è¶‹åŠ¿åˆ†æ.<span class="built_in">round</span>(<span class="number">2</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. ç”Ÿæˆä¸“ä¸šå›¾è¡¨</span></span><br><span class="line">    fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(<span class="number">2</span>, <span class="number">2</span>, figsize=(<span class="number">15</span>, <span class="number">10</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è¥ä¸šæ”¶å…¥å’Œåˆ©æ¶¦è¶‹åŠ¿</span></span><br><span class="line">    ax1_twin = ax1.twinx()</span><br><span class="line">    ax1.bar(ä¼ä¸šæ•°æ®[<span class="string">&#x27;å¹´ä»½&#x27;</span>], ä¼ä¸šæ•°æ®[<span class="string">&#x27;è¥ä¸šæ”¶å…¥&#x27;</span>], alpha=<span class="number">0.7</span>, color=<span class="string">&#x27;skyblue&#x27;</span>, label=<span class="string">&#x27;è¥ä¸šæ”¶å…¥&#x27;</span>)</span><br><span class="line">    ax1_twin.plot(ä¼ä¸šæ•°æ®[<span class="string">&#x27;å¹´ä»½&#x27;</span>], ä¼ä¸šæ•°æ®[<span class="string">&#x27;å‡€åˆ©æ¶¦&#x27;</span>], color=<span class="string">&#x27;red&#x27;</span>, marker=<span class="string">&#x27;o&#x27;</span>, linewidth=<span class="number">3</span>, label=<span class="string">&#x27;å‡€åˆ©æ¶¦&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    ax1.set_xlabel(<span class="string">&#x27;å¹´ä»½&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">    ax1.set_ylabel(<span class="string">&#x27;è¥ä¸šæ”¶å…¥ï¼ˆå…ƒï¼‰&#x27;</span>, fontsize=<span class="number">12</span>, color=<span class="string">&#x27;blue&#x27;</span>)</span><br><span class="line">    ax1_twin.set_ylabel(<span class="string">&#x27;å‡€åˆ©æ¶¦ï¼ˆå…ƒï¼‰&#x27;</span>, fontsize=<span class="number">12</span>, color=<span class="string">&#x27;red&#x27;</span>)</span><br><span class="line">    ax1.set_title(<span class="string">&#x27;è¥ä¸šæ”¶å…¥ä¸å‡€åˆ©æ¶¦è¶‹åŠ¿&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">    ax1.legend(loc=<span class="string">&#x27;upper left&#x27;</span>)</span><br><span class="line">    ax1_twin.legend(loc=<span class="string">&#x27;upper right&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è´¢åŠ¡æ¯”ç‡è¶‹åŠ¿</span></span><br><span class="line">    è´¢åŠ¡æ¯”ç‡[[<span class="string">&#x27;é”€å”®æ¯›åˆ©ç‡&#x27;</span>, <span class="string">&#x27;é”€å”®å‡€åˆ©ç‡&#x27;</span>, <span class="string">&#x27;å‡€èµ„äº§æ”¶ç›Šç‡&#x27;</span>]].plot(ax=ax2, marker=<span class="string">&#x27;o&#x27;</span>, linewidth=<span class="number">2</span>)</span><br><span class="line">    ax2.set_title(<span class="string">&#x27;ç›ˆåˆ©èƒ½åŠ›æ¯”ç‡è¶‹åŠ¿&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">    ax2.set_xlabel(<span class="string">&#x27;å¹´ä»½&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">    ax2.set_ylabel(<span class="string">&#x27;æ¯”ç‡ï¼ˆ%ï¼‰&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">    ax2.legend()</span><br><span class="line">    ax2.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å¿å€ºèƒ½åŠ›æ¯”ç‡</span></span><br><span class="line">    è´¢åŠ¡æ¯”ç‡[[<span class="string">&#x27;æµåŠ¨æ¯”ç‡&#x27;</span>, <span class="string">&#x27;é€ŸåŠ¨æ¯”ç‡&#x27;</span>]].plot(ax=ax3, marker=<span class="string">&#x27;s&#x27;</span>, linewidth=<span class="number">2</span>)</span><br><span class="line">    ax3.axhline(y=<span class="number">2</span>, color=<span class="string">&#x27;green&#x27;</span>, linestyle=<span class="string">&#x27;--&#x27;</span>, alpha=<span class="number">0.7</span>, label=<span class="string">&#x27;æ ‡å‡†æµåŠ¨æ¯”ç‡&#x27;</span>)</span><br><span class="line">    ax3.axhline(y=<span class="number">1</span>, color=<span class="string">&#x27;orange&#x27;</span>, linestyle=<span class="string">&#x27;--&#x27;</span>, alpha=<span class="number">0.7</span>, label=<span class="string">&#x27;æ ‡å‡†é€ŸåŠ¨æ¯”ç‡&#x27;</span>)</span><br><span class="line">    ax3.set_title(<span class="string">&#x27;å¿å€ºèƒ½åŠ›æ¯”ç‡è¶‹åŠ¿&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">    ax3.set_xlabel(<span class="string">&#x27;å¹´ä»½&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">    ax3.set_ylabel(<span class="string">&#x27;æ¯”ç‡&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">    ax3.legend()</span><br><span class="line">    ax3.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è¥è¿èƒ½åŠ›æ¯”ç‡</span></span><br><span class="line">    è´¢åŠ¡æ¯”ç‡[[<span class="string">&#x27;åº”æ”¶è´¦æ¬¾å‘¨è½¬ç‡&#x27;</span>, <span class="string">&#x27;å­˜è´§å‘¨è½¬ç‡&#x27;</span>, <span class="string">&#x27;æ€»èµ„äº§å‘¨è½¬ç‡&#x27;</span>]].plot(ax=ax4, marker=<span class="string">&#x27;^&#x27;</span>, linewidth=<span class="number">2</span>)</span><br><span class="line">    ax4.set_title(<span class="string">&#x27;è¥è¿èƒ½åŠ›æ¯”ç‡è¶‹åŠ¿&#x27;</span>, fontsize=<span class="number">14</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">    ax4.set_xlabel(<span class="string">&#x27;å¹´ä»½&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">    ax4.set_ylabel(<span class="string">&#x27;å‘¨è½¬ç‡ï¼ˆæ¬¡ï¼‰&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">    ax4.legend()</span><br><span class="line">    ax4.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line">    </span><br><span class="line">    plt.suptitle(<span class="string">&#x27;ä¼ä¸šè´¢åŠ¡åˆ†ææŠ¥å‘Š&#x27;</span>, fontsize=<span class="number">18</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">    plt.tight_layout()</span><br><span class="line">    plt.savefig(<span class="string">&#x27;ä¼ä¸šè´¢åŠ¡åˆ†ææŠ¥å‘Š.png&#x27;</span>, dpi=<span class="number">300</span>, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br><span class="line">    plt.close()</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;âœ… ä¼ä¸šè´¢åŠ¡åˆ†ææŠ¥å‘Šå·²ç”Ÿæˆï¼&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 4. ç”ŸæˆæŠ•èµ„å»ºè®®</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nğŸ’¡ ä¼ä¸šè´¢åŠ¡å»ºè®®ï¼š&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åŸºäºåˆ†æç»“æœç»™å‡ºå»ºè®®</span></span><br><span class="line">    æœ€æ–°å¹´ä»½ = ä¼ä¸šæ•°æ®[<span class="string">&#x27;å¹´ä»½&#x27;</span>].iloc[-<span class="number">1</span>]</span><br><span class="line">    æœ€æ–°æ•°æ® = ä¼ä¸šæ•°æ®.iloc[-<span class="number">1</span>]</span><br><span class="line">    æœ€æ–°æ¯”ç‡ = è´¢åŠ¡æ¯”ç‡.iloc[-<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n  <span class="subst">&#123;æœ€æ–°å¹´ä»½&#125;</span>å¹´åº¦è´¢åŠ¡è¡¨ç°ï¼š&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;  â€¢ è¥ä¸šæ”¶å…¥ï¼š<span class="subst">&#123;æœ€æ–°æ•°æ®[<span class="string">&#x27;è¥ä¸šæ”¶å…¥&#x27;</span>]:,&#125;</span>å…ƒ&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;  â€¢ å‡€åˆ©æ¶¦ï¼š<span class="subst">&#123;æœ€æ–°æ•°æ®[<span class="string">&#x27;å‡€åˆ©æ¶¦&#x27;</span>]:,&#125;</span>å…ƒ&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;  â€¢ å‡€èµ„äº§æ”¶ç›Šç‡ï¼š<span class="subst">&#123;æœ€æ–°æ¯”ç‡[<span class="string">&#x27;å‡€èµ„äº§æ”¶ç›Šç‡&#x27;</span>]:<span class="number">.2</span>f&#125;</span>%&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;  â€¢ èµ„äº§è´Ÿå€ºç‡ï¼š<span class="subst">&#123;æœ€æ–°æ¯”ç‡[<span class="string">&#x27;èµ„äº§è´Ÿå€ºç‡&#x27;</span>]:<span class="number">.2</span>f&#125;</span>%&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åŸºäºæ¯”ç‡ç»™å‡ºå»ºè®®</span></span><br><span class="line">    <span class="keyword">if</span> æœ€æ–°æ¯”ç‡[<span class="string">&#x27;å‡€èµ„äº§æ”¶ç›Šç‡&#x27;</span>] &gt; <span class="number">15</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  âœ… ç›ˆåˆ©èƒ½åŠ›è‰¯å¥½ï¼Œå‡€èµ„äº§æ”¶ç›Šç‡è¶…è¿‡15%&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  âš ï¸ ç›ˆåˆ©èƒ½åŠ›éœ€è¦æå‡ï¼Œå»ºè®®ä¼˜åŒ–æˆæœ¬ç»“æ„&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> æœ€æ–°æ¯”ç‡[<span class="string">&#x27;èµ„äº§è´Ÿå€ºç‡&#x27;</span>] &lt; <span class="number">50</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  âœ… è´¢åŠ¡é£é™©è¾ƒä½ï¼Œèµ„äº§è´Ÿå€ºç‡æ§åˆ¶åœ¨50%ä»¥ä¸‹&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  âš ï¸ è´¢åŠ¡æ æ†è¾ƒé«˜ï¼Œå»ºè®®æ§åˆ¶è´Ÿå€ºè§„æ¨¡&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> æœ€æ–°æ¯”ç‡[<span class="string">&#x27;æµåŠ¨æ¯”ç‡&#x27;</span>] &gt; <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  âœ… çŸ­æœŸå¿å€ºèƒ½åŠ›å¼ºï¼ŒæµåŠ¨æ¯”ç‡è¶…è¿‡2å€&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  âš ï¸ çŸ­æœŸå¿å€ºèƒ½åŠ›éœ€è¦å…³æ³¨ï¼Œå»ºè®®å¢åŠ æµåŠ¨èµ„äº§&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;  â€¢ å»ºè®®å®šæœŸç›‘æ§è´¢åŠ¡æ¯”ç‡å˜åŒ–&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;  â€¢ å»ºè®®ä¸åŒè¡Œä¸šä¼ä¸šè¿›è¡Œå¯¹æ¯”åˆ†æ&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;  â€¢ å»ºè®®åˆ¶å®šé•¿æœŸçš„è´¢åŠ¡æˆ˜ç•¥è§„åˆ’&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆä¼ä¸šè´¢åŠ¡æŠ¥å‘Š</span></span><br><span class="line">ç”Ÿæˆä¼ä¸šè´¢åŠ¡æŠ¥å‘Š(ä¼ä¸šè´¢åŠ¡æ•°æ®)</span><br></pre></td></tr></table></figure></details><hr><h3 id="ğŸ’­-ä»Šæ—¥æ€è€ƒ"><a href="#ğŸ’­-ä»Šæ—¥æ€è€ƒ" class="headerlink" title="ğŸ’­ ä»Šæ—¥æ€è€ƒ"></a>ğŸ’­ ä»Šæ—¥æ€è€ƒ</h3><p>é€šè¿‡ä»Šå¤©çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å‘ç°ï¼š</p><ul><li>Pythonå¯ä»¥ç”Ÿæˆæ¯”Excelæ›´ä¸“ä¸šã€æ›´ç¾è§‚çš„å›¾è¡¨</li><li>ä¸€æ¬¡ç¼–å†™ä»£ç ï¼Œå¯ä»¥é‡å¤ä½¿ç”¨ç”ŸæˆæŠ¥å‘Š</li><li>å¯ä»¥å¯¼å‡ºå¤šç§æ ¼å¼ï¼Œæ»¡è¶³ä¸åŒéœ€æ±‚</li><li>ä¸“ä¸šçš„æ•°æ®æŠ¥å‘Šèƒ½å¤§å¤§æå‡å·¥ä½œæ•ˆç‡</li></ul><hr><h3 id="ğŸ“-è¯¾åå°ç»“"><a href="#ğŸ“-è¯¾åå°ç»“" class="headerlink" title="ğŸ“ è¯¾åå°ç»“"></a>ğŸ“ è¯¾åå°ç»“</h3><ul><li>âœ… å­¦ä¼šäº†ç”¨matplotlibç”Ÿæˆå„ç§ä¸“ä¸šå›¾è¡¨</li><li>âœ… æŒæ¡äº†seaborné«˜çº§ç»˜å›¾æŠ€å·§</li><li>âœ… å­¦ä¼šäº†å¯¼å‡ºExcelã€CSVã€PDFç­‰å¤šç§æ ¼å¼</li><li>âœ… å®Œæˆäº†ä¸“ä¸šçš„ä¸ªäººç†è´¢å¹´åº¦æŠ¥å‘Š</li></ul><hr><h3 id="ğŸ’¡-å°è´´å£«"><a href="#ğŸ’¡-å°è´´å£«" class="headerlink" title="ğŸ’¡ å°è´´å£«"></a>ğŸ’¡ å°è´´å£«</h3><ul><li>å¤šç»ƒä¹ çœŸå®é¡¹ç›®ï¼Œç†è®ºç»“åˆå®è·µ</li><li>å…³æ³¨Pythonå’Œæ•°æ®åˆ†æçš„æœ€æ–°å‘å±•</li><li>åŠ å…¥ç›¸å…³çš„æŠ€æœ¯ç¤¾åŒºï¼Œä¸ä»–äººäº¤æµå­¦ä¹ </li><li>ä¿æŒå­¦ä¹ çš„çƒ­æƒ…ï¼ŒæŠ€æœ¯æ°¸è¿œåœ¨è¿›æ­¥</li></ul><hr><blockquote><p>ğŸ¤– Powered by Kimi K2 0905 ğŸ’» å†…å®¹ç»è‘µè‘µğŸŒ»å®¡æ ¸ä¸ä¿®æ”¹</p></blockquote><hr></div><footer class="post-footer"><div class="post-nav"><div class="post-nav-item"><a href="/4b71c371.html" rel="prev" title="Python-ç¬¬11ç¯‡ã€Šç®€å•çš„æ•°æ®åˆ†æã€‹"><i class="fa fa-chevron-left"></i> Python-ç¬¬11ç¯‡ã€Šç®€å•çš„æ•°æ®åˆ†æã€‹</a></div><div class="post-nav-item"><a href="/8dfcbd79.html" rel="next" title="Python-ç¬¬13ç¯‡ã€Šè‚¡ç¥¨æ•°æ®ç›‘æ§å™¨ã€‹">Python-ç¬¬13ç¯‡ã€Šè‚¡ç¥¨æ•°æ®ç›‘æ§å™¨ã€‹ <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="valine-comments"></div><script>window.addEventListener("tabs:register",()=>{let t=CONFIG.comments["activeClass"];var e;(t=CONFIG.comments.storage?localStorage.getItem("comments_active")||t:t)&&(e=document.querySelector(`a[href="#comment-${t}"]`))&&e.click()}),CONFIG.comments.storage&&window.addEventListener("tabs:click",t=>{t.target.matches(".tabs-comment .tab-content .tab-pane")&&(t=t.target.classList[1],localStorage.setItem("comments_active",t))})</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">æ–‡ç« ç›®å½•</li><li class="sidebar-nav-overview">ç«™ç‚¹æ¦‚è§ˆ</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%93%96-%E5%BC%80%E7%AF%87%E8%AF%AD"><span class="nav-number">1.</span> <span class="nav-text">ğŸ“– å¼€ç¯‡è¯­</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%8E%AF-%E4%BB%8A%E6%97%A5%E5%AD%A6%E4%B9%A0%E7%9B%AE%E6%A0%87"><span class="nav-number">2.</span> <span class="nav-text">ğŸ¯ ä»Šæ—¥å­¦ä¹ ç›®æ ‡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%93%8A-%E5%9B%BE%E8%A1%A8%E7%94%9F%E6%88%90%EF%BC%9A%E8%AE%A9%E6%95%B0%E6%8D%AE%E2%80%9C%E5%8F%AF%E8%A7%86%E5%8C%96%E2%80%9D"><span class="nav-number">3.</span> <span class="nav-text">ğŸ“Š å›¾è¡¨ç”Ÿæˆï¼šè®©æ•°æ®â€œå¯è§†åŒ–â€</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%92%BE-%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%87%BA%EF%BC%9A%E5%A4%9A%E7%A7%8D%E6%A0%BC%E5%BC%8F%E8%BE%93%E5%87%BA"><span class="nav-number">4.</span> <span class="nav-text">ğŸ’¾ æ•°æ®å¯¼å‡ºï¼šå¤šç§æ ¼å¼è¾“å‡º</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">5.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%8F%83%E2%80%8D%E2%99%80%EF%B8%8F-%E8%BF%9B%E9%98%B6%E5%B0%8F%E6%8C%91%E6%88%98"><span class="nav-number">6.</span> <span class="nav-text">ğŸƒâ€â™€ï¸ è¿›é˜¶å°æŒ‘æˆ˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%92%AD-%E4%BB%8A%E6%97%A5%E6%80%9D%E8%80%83"><span class="nav-number">7.</span> <span class="nav-text">ğŸ’­ ä»Šæ—¥æ€è€ƒ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%93%9D-%E8%AF%BE%E5%90%8E%E5%B0%8F%E7%BB%93"><span class="nav-number">8.</span> <span class="nav-text">ğŸ“ è¯¾åå°ç»“</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%92%A1-%E5%B0%8F%E8%B4%B4%E5%A3%AB"><span class="nav-number">9.</span> <span class="nav-text">ğŸ’¡ å°è´´å£«</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Aisaka Aoi" src="/images/manatsu.jpg"><p class="site-author-name" itemprop="name">Aisaka Aoi</p><div class="site-description" itemprop="description">é€¢å‚è‘µçš„ä¸ªäººåšå®¢</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">1023</span> <span class="site-state-item-name">æ—¥å¿—</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">20</span> <span class="site-state-item-name">åˆ†ç±»</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/AisakaAoi" title="GitHub ğŸ‘¨â€ğŸ’» â†’ https:&#x2F;&#x2F;github.com&#x2F;AisakaAoi" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub ğŸ‘¨â€ğŸ’»</a> </span><span class="links-of-author-item"><a href="https://github.com/Aisakaorz" title="GitHub ğŸ‘©â€ğŸ’» â†’ https:&#x2F;&#x2F;github.com&#x2F;Aisakaorz" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub ğŸ‘©â€ğŸ’»</a> </span><span class="links-of-author-item"><a href="mailto:aisakaaoi@qq.com" title="E-Mail ğŸ“§ â†’ mailto:aisakaaoi@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail ğŸ“§</a> </span><span class="links-of-author-item"><a href="mailto:chenzongnan@m.scnu.edu.cn" title="E-Mail ğŸ« â†’ mailto:chenzongnan@m.scnu.edu.cn" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail ğŸ«</a> </span><span class="links-of-author-item"><a href="https://space.bilibili.com/91560309" title="Bilibili ğŸ“º â†’ https:&#x2F;&#x2F;space.bilibili.com&#x2F;91560309" rel="noopener" target="_blank"><i class="fab fa-bilibili fa-fw"></i>Bilibili ğŸ“º</a> </span><span class="links-of-author-item"><a href="https://space.bilibili.com/198562921" title="Bilibili ğŸ® â†’ https:&#x2F;&#x2F;space.bilibili.com&#x2F;198562921" rel="noopener" target="_blank"><i class="fab fa-bilibili fa-fw"></i>Bilibili ğŸ®</a> </span><span class="links-of-author-item"><a href="https://www.youtube.com/channel/UCALvyn5Cl76GCotO9pczvjg" title="YouTube ğŸ“º â†’ https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCALvyn5Cl76GCotO9pczvjg" rel="noopener" target="_blank"><i class="fab fa-youtube fa-fw"></i>YouTube ğŸ“º</a></span></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2026</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Aisaka Aoi</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span class="post-meta-item-text">ç«™ç‚¹æ€»å­—æ•°ï¼š</span> <span title="ç«™ç‚¹æ€»å­—æ•°">4m</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span class="post-meta-item-text">ç«™ç‚¹é˜…è¯»æ—¶é•¿ &asymp;</span> <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">164:56</span></div><div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨</div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script>document.querySelectorAll(".pdfobject-container").forEach(e=>{var t=e.dataset.target,a="#"+Object.entries({navpanes:0,toolbar:0,statusbar:0,pagemode:"thumbs",view:"FitH"}).map(([e,t])=>e+"="+encodeURIComponent(t)).join("&"),r="/lib/pdf/web/viewer.html?file="+encodeURIComponent(t)+a;NexT.utils.supportsPDFs()?e.innerHTML=`<embed class="pdfobject" src="${t+a}" type="application/pdf" style="height: ${e.dataset.height};">`:e.innerHTML=`<iframe src="${r}" style="height: ${e.dataset.height};" frameborder="0"></iframe>`})</script><script>NexT.utils.loadComments(document.querySelector("#valine-comments"),()=>{NexT.utils.getScript("//unpkg.com/valine/dist/Valine.min.js",()=>{var i=["nick","mail","link"],e="nick,mail,link".split(",").filter(e=>i.includes(e));new Valine({el:"#valine-comments",verify:!0,notify:!0,appId:"UqjWdRYbIUEUQRXhBUUIh1QE-gzGzoHsz",appKey:"gj89JXC485PFbpdHLKVkz6dm",placeholder:"è¿™é‡Œå¯ä»¥å‘é€è¯„è®º~ï¼ˆä¸Šé¢å¯ä»¥è¾“å…¥æ˜µç§°ã€é‚®ç®±ï¼‰",avatar:"mm",meta:e,pageSize:"10",visitor:!0,lang:"zh-cn",path:location.pathname,recordIP:!1,serverURLs:""})},window.Valine)})</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/assets/haru02.model.json"},display:{position:"right",width:208,height:520},mobile:{show:!1},log:!1})</script></body></html>