<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0"><meta name="baidu-site-verification" content="code-KCMz4b3cnd"><meta name="google-site-verification" content="MTp8U7dJ1uzrfz8Mu6rgqX1CIm3HjqPWd0xaRcv1tFg"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="mask-icon" href="/images/favicon.png" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"aisakaaoi.github.io",root:"/",scheme:"Pisces",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:"valine",storage:!0,lazyload:!1,nav:null,activeClass:"valine"},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="ğŸ“– å¼€ç¯‡è¯­è¿˜è®°å¾—ä½ ç¬¬ä¸€æ¬¡æ”¶åˆ°å®¢æˆ·ä¿¡æ¯è¡¨çš„æƒ…æ™¯å—ï¼Ÿ  æ‰‹æœºå·æœ‰çš„æ˜¯13800138000ï¼Œæœ‰çš„æ˜¯138-0013-8000ï¼Œè¿˜æœ‰çš„æ˜¯ç©ºç€çš„æ—¥æœŸæ ¼å¼äº”èŠ±å…«é—¨ï¼š2024&#x2F;1&#x2F;1ã€2024-01-01ã€1-Jan-2024å®¢æˆ·åç§°å‰åæœ‰ç©ºæ ¼ï¼Œæœ‰çš„è¿˜å¤šäº†ä¸ªâ€œæœ‰é™å…¬å¸â€é‚®ç®±åœ°å€æ˜æ˜¾å†™é”™äº†ï¼šzhangsan@emailã€lisi123@comè¿™å°±æ˜¯â€œè„æ•°æ®â€â€”â€”ç°å®ä¸–ç•Œä¸­çš„æ•°æ®ä»æ¥éƒ½ä¸æ˜¯å®Œ"><meta property="og:type" content="article"><meta property="og:title" content="Python-ç¬¬10ç¯‡ã€Šæ•°æ®æ¸…æ´—ï¼šè®©è„æ•°æ®å˜å¹²å‡€ã€‹"><meta property="og:url" content="https://aisakaaoi.github.io/805a0f35.html"><meta property="og:site_name" content="é€¢å‚è‘µçš„ä¸ªäººåšå®¢"><meta property="og:description" content="ğŸ“– å¼€ç¯‡è¯­è¿˜è®°å¾—ä½ ç¬¬ä¸€æ¬¡æ”¶åˆ°å®¢æˆ·ä¿¡æ¯è¡¨çš„æƒ…æ™¯å—ï¼Ÿ  æ‰‹æœºå·æœ‰çš„æ˜¯13800138000ï¼Œæœ‰çš„æ˜¯138-0013-8000ï¼Œè¿˜æœ‰çš„æ˜¯ç©ºç€çš„æ—¥æœŸæ ¼å¼äº”èŠ±å…«é—¨ï¼š2024&#x2F;1&#x2F;1ã€2024-01-01ã€1-Jan-2024å®¢æˆ·åç§°å‰åæœ‰ç©ºæ ¼ï¼Œæœ‰çš„è¿˜å¤šäº†ä¸ªâ€œæœ‰é™å…¬å¸â€é‚®ç®±åœ°å€æ˜æ˜¾å†™é”™äº†ï¼šzhangsan@emailã€lisi123@comè¿™å°±æ˜¯â€œè„æ•°æ®â€â€”â€”ç°å®ä¸–ç•Œä¸­çš„æ•°æ®ä»æ¥éƒ½ä¸æ˜¯å®Œ"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2026-01-30T19:38:05.000Z"><meta property="article:modified_time" content="2026-01-30T21:43:03.962Z"><meta property="article:author" content="Aisaka Aoi"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://aisakaaoi.github.io/805a0f35.html"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>Python-ç¬¬10ç¯‡ã€Šæ•°æ®æ¸…æ´—ï¼šè®©è„æ•°æ®å˜å¹²å‡€ã€‹ | é€¢å‚è‘µçš„ä¸ªäººåšå®¢</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?7308ed05421777c301eefa3754da1b42",document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="é€¢å‚è‘µçš„ä¸ªäººåšå®¢" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ "><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">aoiå­¦é™¢</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">Aisaka's Blog, School of Aoi, Aisaka University</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»<span class="badge">20</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£<span class="badge">1023</span></a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="æœç´¢..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="reading-progress-bar"></div><a href="https://github.com/AisakaAoi" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://aisakaaoi.github.io/805a0f35.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/manatsu.jpg"><meta itemprop="name" content="Aisaka Aoi"><meta itemprop="description" content="Aisaka's Blog, School of Aoi, Aisaka University"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="é€¢å‚è‘µçš„ä¸ªäººåšå®¢"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Python-ç¬¬10ç¯‡ã€Šæ•°æ®æ¸…æ´—ï¼šè®©è„æ•°æ®å˜å¹²å‡€ã€‹</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">å‘è¡¨äº</span> <time title="åˆ›å»ºæ—¶é—´ï¼š2026-01-31 03:38:05" itemprop="dateCreated datePublished" datetime="2026-01-31T03:38:05+08:00">2026-01-31</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">åˆ†ç±»äº</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%F0%9F%8C%99%E9%80%A2%E5%9D%82%E6%9D%82%E8%B0%88%E4%B8%8E%E6%90%AC%E8%BF%90/" itemprop="url" rel="index"><span itemprop="name">ğŸŒ™é€¢å‚æ‚è°ˆä¸æ¬è¿</span></a> </span>ï¼Œ <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%F0%9F%8C%99%E9%80%A2%E5%9D%82%E6%9D%82%E8%B0%88%E4%B8%8E%E6%90%AC%E8%BF%90/%E2%AD%90%E6%9E%9C%E6%9E%9C%E8%AF%BE%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">â­æœæœè¯¾ç¨‹</span></a> </span></span><span id="/805a0f35.html" class="post-meta-item leancloud_visitors" data-flag-title="Python-ç¬¬10ç¯‡ã€Šæ•°æ®æ¸…æ´—ï¼šè®©è„æ•°æ®å˜å¹²å‡€ã€‹" title="é˜…è¯»æ¬¡æ•°"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span> <span class="leancloud-visitors-count"></span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Valineï¼š</span> <a title="valine" href="/805a0f35.html#valine-comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/805a0f35.html" itemprop="commentCount"></span></a></span><br><span class="post-meta-item" title="æœ¬æ–‡å­—æ•°"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span> <span>51k</span> </span><span class="post-meta-item" title="é˜…è¯»æ—¶é•¿"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span> <span>2:08</span></span></div></header><div class="post-body" itemprop="articleBody"><h3 id="ğŸ“–-å¼€ç¯‡è¯­"><a href="#ğŸ“–-å¼€ç¯‡è¯­" class="headerlink" title="ğŸ“– å¼€ç¯‡è¯­"></a>ğŸ“– å¼€ç¯‡è¯­</h3><p>è¿˜è®°å¾—ä½ ç¬¬ä¸€æ¬¡æ”¶åˆ°å®¢æˆ·ä¿¡æ¯è¡¨çš„æƒ…æ™¯å—ï¼Ÿ</p><blockquote><p>æ‰‹æœºå·æœ‰çš„æ˜¯13800138000ï¼Œæœ‰çš„æ˜¯138-0013-8000ï¼Œè¿˜æœ‰çš„æ˜¯ç©ºç€çš„<br>æ—¥æœŸæ ¼å¼äº”èŠ±å…«é—¨ï¼š2024&#x2F;1&#x2F;1ã€2024-01-01ã€1-Jan-2024<br>å®¢æˆ·åç§°å‰åæœ‰ç©ºæ ¼ï¼Œæœ‰çš„è¿˜å¤šäº†ä¸ªâ€œæœ‰é™å…¬å¸â€<br>é‚®ç®±åœ°å€æ˜æ˜¾å†™é”™äº†ï¼šzhangsan@emailã€lisi123@com<br>è¿™å°±æ˜¯â€œè„æ•°æ®â€â€”â€”ç°å®ä¸–ç•Œä¸­çš„æ•°æ®ä»æ¥éƒ½ä¸æ˜¯å®Œç¾çš„ï¼</p></blockquote><p>ä»Šå¤©æˆ‘ä»¬è¦å­¦çš„ï¼Œå°±æ˜¯è®©Pythonå¸®ä½ æŠŠè¿™äº›â€œè„æ•°æ®â€å˜æˆâ€œå¹²å‡€æ•°æ®â€ã€‚<br>å°±åƒè´¢åŠ¡åšè´¦å‰çš„æ•´ç†å·¥ä½œä¸€æ ·ï¼Œæ•°æ®æ¸…æ´—æ˜¯æ•°æ®åˆ†æçš„ç¬¬ä¸€æ­¥ï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„ä¸€æ­¥ï¼</p><span id="more"></span><hr><h3 id="ğŸ¯-ä»Šæ—¥å­¦ä¹ ç›®æ ‡"><a href="#ğŸ¯-ä»Šæ—¥å­¦ä¹ ç›®æ ‡" class="headerlink" title="ğŸ¯ ä»Šæ—¥å­¦ä¹ ç›®æ ‡"></a>ğŸ¯ ä»Šæ—¥å­¦ä¹ ç›®æ ‡</h3><ul><li>è¯†åˆ«å’Œå¤„ç†ç¼ºå¤±å€¼ï¼ˆç©ºå€¼ã€NaNï¼‰</li><li>ç»Ÿä¸€æ•°æ®æ ¼å¼ï¼ˆæ—¥æœŸã€æ•°å­—ã€æ–‡æœ¬ï¼‰</li><li>å®æˆ˜æ¸…ç†å®¢æˆ·ä¿¡æ¯è¡¨ï¼ˆæ¯”æ‰‹å·¥æ¸…æ´—å¿«100å€ï¼‰</li></ul><hr><h3 id="ğŸ§¹-ä»€ä¹ˆæ˜¯æ•°æ®æ¸…æ´—ï¼Ÿ"><a href="#ğŸ§¹-ä»€ä¹ˆæ˜¯æ•°æ®æ¸…æ´—ï¼Ÿ" class="headerlink" title="ğŸ§¹ ä»€ä¹ˆæ˜¯æ•°æ®æ¸…æ´—ï¼Ÿ"></a>ğŸ§¹ ä»€ä¹ˆæ˜¯æ•°æ®æ¸…æ´—ï¼Ÿ</h3><p><strong>è„æ•°æ®çš„å¸¸è§ç±»å‹</strong></p><table><thead><tr><th>è„æ•°æ®ç±»å‹</th><th>ç¤ºä¾‹</th><th>æ¸…æ´—æ–¹æ³•</th></tr></thead><tbody><tr><td>ç¼ºå¤±å€¼</td><td>æ‰‹æœºå·ï¼šç©ºå€¼</td><td>å¡«å……æˆ–åˆ é™¤</td></tr><tr><td>æ ¼å¼ä¸ç»Ÿä¸€</td><td>æ—¥æœŸï¼š2024&#x2F;1&#x2F;1 vs 2024-01-01</td><td>æ ‡å‡†åŒ–æ ¼å¼</td></tr><tr><td>æ•°æ®é”™è¯¯</td><td>é‚®ç®±ï¼šzhangsan@email</td><td>æ ¡éªŒå’Œä¿®æ­£</td></tr><tr><td>é‡å¤æ•°æ®</td><td>åŒä¸€ä¸ªå®¢æˆ·å½•å…¥ä¸¤æ¬¡</td><td>å»é‡</td></tr><tr><td>å¤šä½™ç©ºæ ¼</td><td>â€œ å¼ ä¸‰ â€</td><td>å»é™¤ç©ºæ ¼</td></tr><tr><td>æ•°æ®ç±»å‹é”™è¯¯</td><td>â€œ123.45å…ƒâ€ï¼ˆæ–‡æœ¬ï¼‰</td><td>è½¬æ¢ä¸ºæ•°å­—</td></tr></tbody></table><p><strong>ä¸ºä»€ä¹ˆæ•°æ®æ¸…æ´—å¾ˆé‡è¦ï¼Ÿ</strong></p><p><strong>ä¸¾ä¸ªè´¢åŠ¡çš„ä¾‹å­ğŸŒ°ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">åŸå§‹æ•°æ®ï¼šåº”æ”¶è´¦æ¬¾</span><br><span class="line">- å®¢æˆ·Aï¼š15,000å…ƒ âœ…</span><br><span class="line">- å®¢æˆ·Bï¼šç©ºå€¼ âŒï¼ˆæ˜¯0å…ƒè¿˜æ˜¯æœªç»Ÿè®¡ï¼Ÿï¼‰</span><br><span class="line">- å®¢æˆ·Cï¼š&quot;12,500å…ƒ&quot;ï¼ˆæ–‡æœ¬ï¼‰âŒï¼ˆæ— æ³•è®¡ç®—ï¼‰</span><br><span class="line">- å®¢æˆ·Dï¼š12,500.00 âœ…</span><br><span class="line"></span><br><span class="line">æ¸…æ´—åï¼š</span><br><span class="line">- å®¢æˆ·Aï¼š15000.00 âœ…</span><br><span class="line">- å®¢æˆ·Bï¼š0.00 âœ…ï¼ˆæ˜ç¡®ä¸º0ï¼‰</span><br><span class="line">- å®¢æˆ·Cï¼š12500.00 âœ…ï¼ˆè½¬æ¢ä¸ºæ•°å­—ï¼‰</span><br><span class="line">- å®¢æˆ·Dï¼š12500.00 âœ…</span><br><span class="line"></span><br><span class="line">æ€»è®¡ï¼š15000 + 0 + 12500 + 12500 = 50000å…ƒ</span><br><span class="line">ï¼ˆæ¸…æ´—å‰æ— æ³•å‡†ç¡®è®¡ç®—æ€»è®¡ï¼ï¼‰</span><br></pre></td></tr></table></figure><hr><h3 id="ğŸ”-è¯†åˆ«è„æ•°æ®ï¼šå…ˆå‘ç°é—®é¢˜"><a href="#ğŸ”-è¯†åˆ«è„æ•°æ®ï¼šå…ˆå‘ç°é—®é¢˜" class="headerlink" title="ğŸ” è¯†åˆ«è„æ•°æ®ï¼šå…ˆå‘ç°é—®é¢˜"></a>ğŸ” è¯†åˆ«è„æ•°æ®ï¼šå…ˆå‘ç°é—®é¢˜</h3><p><strong>åˆ›å»ºç¤ºä¾‹å®¢æˆ·ä¿¡æ¯è¡¨</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ª&quot;è„å…®å…®&quot;çš„å®¢æˆ·ä¿¡æ¯è¡¨</span></span><br><span class="line">å®¢æˆ·ä¿¡æ¯ = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;å®¢æˆ·ID&#x27;</span>: [<span class="string">&#x27;C001&#x27;</span>, <span class="string">&#x27;C002&#x27;</span>, <span class="string">&#x27;C003&#x27;</span>, <span class="string">&#x27;C004&#x27;</span>, <span class="string">&#x27;C005&#x27;</span>, <span class="string">&#x27;C006&#x27;</span>, <span class="string">&#x27;C007&#x27;</span>, <span class="string">&#x27;C008&#x27;</span>, <span class="string">&#x27;C009&#x27;</span>, <span class="string">&#x27;C010&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;å®¢æˆ·åç§°&#x27;</span>: [<span class="string">&#x27;  å¼ ä¸‰  &#x27;</span>, <span class="string">&#x27;æå››&#x27;</span>, <span class="string">&#x27;ç‹äº”&#x27;</span>, <span class="literal">None</span>, <span class="string">&#x27;èµµå…­&#x27;</span>, <span class="string">&#x27;é’±ä¸ƒ&#x27;</span>, <span class="string">&#x27;å­™å…«&#x27;</span>, <span class="string">&#x27;å‘¨ä¹&#x27;</span>, <span class="string">&#x27;å´å&#x27;</span>, <span class="string">&#x27;éƒ‘åä¸€&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;è”ç³»ç”µè¯&#x27;</span>: [<span class="string">&#x27;13800138000&#x27;</span>, <span class="string">&#x27;138-0013-8001&#x27;</span>, <span class="literal">None</span>, <span class="string">&#x27;1381234567&#x27;</span>, <span class="string">&#x27;13800138004&#x27;</span>, <span class="string">&#x27;not-a-phone&#x27;</span>, <span class="string">&#x27;13800138005&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;138-0013-8006&#x27;</span>, <span class="string">&#x27;13800138007&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;é‚®ç®±&#x27;</span>: [<span class="string">&#x27;zhangsan@email.com&#x27;</span>, <span class="string">&#x27;lisi@company&#x27;</span>, <span class="literal">None</span>, <span class="string">&#x27;wangwu123@&#x27;</span>, <span class="string">&#x27;zhaoliu@email.com&#x27;</span>, <span class="string">&#x27;qianqi@email.com&#x27;</span>, <span class="string">&#x27;sunba@email.com&#x27;</span>, <span class="string">&#x27;zhoujiu@&#x27;</span>, <span class="string">&#x27;wushi@email.com&#x27;</span>, <span class="string">&#x27;zhengshiyi@email.com&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;æ³¨å†Œæ—¥æœŸ&#x27;</span>: [<span class="string">&#x27;2024-01-01&#x27;</span>, <span class="string">&#x27;2024/01/02&#x27;</span>, <span class="string">&#x27;2024.01.03&#x27;</span>, <span class="literal">None</span>, <span class="string">&#x27;2024-01-05&#x27;</span>, <span class="string">&#x27;2024-01-06&#x27;</span>, <span class="string">&#x27;2024-01-07&#x27;</span>, <span class="string">&#x27;2024-01-08&#x27;</span>, <span class="string">&#x27;2024-01-09&#x27;</span>, <span class="string">&#x27;2024-01-10&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;ä¿¡ç”¨ç­‰çº§&#x27;</span>: [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="literal">None</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;A&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;åº”æ”¶è´¦æ¬¾&#x27;</span>: [<span class="string">&#x27;15000.50&#x27;</span>, <span class="string">&#x27;25000&#x27;</span>, <span class="literal">None</span>, <span class="string">&#x27;18000.75&#x27;</span>, <span class="string">&#x27;not-a-number&#x27;</span>, <span class="string">&#x27;22000&#x27;</span>, <span class="string">&#x27;19500.25&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;16500&#x27;</span>, <span class="string">&#x27;21000.80&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;çŠ¶æ€&#x27;</span>: [<span class="string">&#x27;æ´»è·ƒ&#x27;</span>, <span class="string">&#x27;æ´»è·ƒ&#x27;</span>, <span class="string">&#x27;  ä¸æ´»è·ƒ  &#x27;</span>, <span class="string">&#x27;æ´»è·ƒ&#x27;</span>, <span class="string">&#x27;æ´»è·ƒ&#x27;</span>, <span class="string">&#x27;ä¸æ´»è·ƒ&#x27;</span>, <span class="string">&#x27;æ´»è·ƒ&#x27;</span>, <span class="string">&#x27;æ´»è·ƒ&#x27;</span>, <span class="string">&#x27;ä¸æ´»è·ƒ&#x27;</span>, <span class="string">&#x27;æ´»è·ƒ&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;åŸå§‹å®¢æˆ·ä¿¡æ¯è¡¨ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(å®¢æˆ·ä¿¡æ¯)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;\næ•°æ®å½¢çŠ¶ï¼š<span class="subst">&#123;å®¢æˆ·ä¿¡æ¯.shape&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æ•°æ®ç±»å‹ï¼š\n<span class="subst">&#123;å®¢æˆ·ä¿¡æ¯.dtypes&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p><strong>æ•°æ®è´¨é‡æ£€æŸ¥</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">æ•°æ®è´¨é‡æŠ¥å‘Š</span>(<span class="params">df, è¡¨å=<span class="string">&quot;æ•°æ®è¡¨&quot;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ç”Ÿæˆæ•°æ®è´¨é‡æ£€æŸ¥æŠ¥å‘Š&quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n<span class="subst">&#123;<span class="string">&#x27;=&#x27;</span>*<span class="number">50</span>&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;è¡¨å&#125;</span> - æ•°æ®è´¨é‡æ£€æŸ¥æŠ¥å‘Š&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;<span class="string">&#x27;=&#x27;</span>*<span class="number">50</span>&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;æ•°æ®å½¢çŠ¶ï¼š<span class="subst">&#123;df.shape&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;åˆ—åï¼š<span class="subst">&#123;df.columns.tolist()&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\nç¼ºå¤±å€¼ç»Ÿè®¡ï¼š&quot;</span>)</span><br><span class="line">    ç¼ºå¤±ç»Ÿè®¡ = df.isnull().<span class="built_in">sum</span>()</span><br><span class="line">    <span class="keyword">for</span> åˆ—å, ç¼ºå¤±æ•° <span class="keyword">in</span> ç¼ºå¤±ç»Ÿè®¡.items():</span><br><span class="line">        ç¼ºå¤±ç‡ = ç¼ºå¤±æ•° / <span class="built_in">len</span>(df) * <span class="number">100</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;åˆ—å&#125;</span>ï¼š<span class="subst">&#123;ç¼ºå¤±æ•°&#125;</span>ä¸ª (<span class="subst">&#123;ç¼ºå¤±ç‡:<span class="number">.1</span>f&#125;</span>%)&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\né‡å¤æ•°æ®ï¼š<span class="subst">&#123;df.duplicated().<span class="built_in">sum</span>()&#125;</span>è¡Œ&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\næ•°æ®ç±»å‹æ£€æŸ¥ï¼š&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> åˆ—å <span class="keyword">in</span> df.columns:</span><br><span class="line">        æ•°æ®ç±»å‹ = df[åˆ—å].dtype</span><br><span class="line">        å”¯ä¸€å€¼æ•°é‡ = df[åˆ—å].nunique()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;åˆ—å&#125;</span>ï¼š<span class="subst">&#123;æ•°æ®ç±»å‹&#125;</span>ï¼Œå”¯ä¸€å€¼ï¼š<span class="subst">&#123;å”¯ä¸€å€¼æ•°é‡&#125;</span>ä¸ª&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ˜¾ç¤ºå‰5ä¸ªå”¯ä¸€å€¼</span></span><br><span class="line">        å”¯ä¸€å€¼ = df[åˆ—å].dropna().unique()[:<span class="number">5</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;    ç¤ºä¾‹å€¼ï¼š<span class="subst">&#123;å”¯ä¸€å€¼.tolist()&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆæ•°æ®è´¨é‡æŠ¥å‘Š</span></span><br><span class="line">æ•°æ®è´¨é‡æŠ¥å‘Š(å®¢æˆ·ä¿¡æ¯, <span class="string">&quot;å®¢æˆ·ä¿¡æ¯è¡¨&quot;</span>)</span><br></pre></td></tr></table></figure><hr><h3 id="ğŸ§½-å¤„ç†ç¼ºå¤±å€¼ï¼šæŠŠâ€œç©ºâ€å˜æˆâ€œæ»¡â€"><a href="#ğŸ§½-å¤„ç†ç¼ºå¤±å€¼ï¼šæŠŠâ€œç©ºâ€å˜æˆâ€œæ»¡â€" class="headerlink" title="ğŸ§½ å¤„ç†ç¼ºå¤±å€¼ï¼šæŠŠâ€œç©ºâ€å˜æˆâ€œæ»¡â€"></a>ğŸ§½ å¤„ç†ç¼ºå¤±å€¼ï¼šæŠŠâ€œç©ºâ€å˜æˆâ€œæ»¡â€</h3><p><strong>è¯†åˆ«ç¼ºå¤±å€¼</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹ç¼ºå¤±å€¼åˆ†å¸ƒ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ç¼ºå¤±å€¼åˆ†å¸ƒï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(å®¢æˆ·ä¿¡æ¯.isnull().<span class="built_in">sum</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹åŒ…å«ç¼ºå¤±å€¼çš„è¡Œ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nåŒ…å«ç¼ºå¤±å€¼çš„è¡Œï¼š&quot;</span>)</span><br><span class="line">ç¼ºå¤±è¡Œ = å®¢æˆ·ä¿¡æ¯[å®¢æˆ·ä¿¡æ¯.isnull().<span class="built_in">any</span>(axis=<span class="number">1</span>)]</span><br><span class="line"><span class="built_in">print</span>(ç¼ºå¤±è¡Œ)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç‰¹å®šåˆ—çš„ç¼ºå¤±å€¼</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\né‚®ç®±åœ°å€ç¼ºå¤±çš„è¡Œï¼š&quot;</span>)</span><br><span class="line">é‚®ç®±ç¼ºå¤± = å®¢æˆ·ä¿¡æ¯[å®¢æˆ·ä¿¡æ¯[<span class="string">&#x27;é‚®ç®±&#x27;</span>].isnull()]</span><br><span class="line"><span class="built_in">print</span>(é‚®ç®±ç¼ºå¤±[[<span class="string">&#x27;å®¢æˆ·ID&#x27;</span>, <span class="string">&#x27;å®¢æˆ·åç§°&#x27;</span>, <span class="string">&#x27;é‚®ç®±&#x27;</span>]])</span><br></pre></td></tr></table></figure><p><strong>æ–¹æ³•1ï¼šåˆ é™¤ç¼ºå¤±å€¼ï¼ˆé€‚åˆç¼ºå¤±æ¯”ä¾‹å°çš„æ•°æ®ï¼‰</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ–¹æ³•1.1ï¼šåˆ é™¤åŒ…å«ç¼ºå¤±å€¼çš„è¡Œ</span></span><br><span class="line">å®¢æˆ·ä¿¡æ¯_åˆ é™¤ç¼ºå¤± = å®¢æˆ·ä¿¡æ¯.dropna()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;åˆ é™¤ç¼ºå¤±å€¼åï¼š<span class="subst">&#123;å®¢æˆ·ä¿¡æ¯_åˆ é™¤ç¼ºå¤±.shape&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹æ³•1.2ï¼šåˆ é™¤ç‰¹å®šåˆ—ç¼ºå¤±çš„è¡Œ</span></span><br><span class="line">å®¢æˆ·ä¿¡æ¯_åˆ é™¤é‚®ç®±ç¼ºå¤± = å®¢æˆ·ä¿¡æ¯.dropna(subset=[<span class="string">&#x27;é‚®ç®±&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;åˆ é™¤é‚®ç®±ç¼ºå¤±åï¼š<span class="subst">&#123;å®¢æˆ·ä¿¡æ¯_åˆ é™¤é‚®ç®±ç¼ºå¤±.shape&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹æ³•1.3ï¼šåˆ é™¤ç¼ºå¤±æ¯”ä¾‹é«˜çš„åˆ—</span></span><br><span class="line">ç¼ºå¤±æ¯”ä¾‹ = å®¢æˆ·ä¿¡æ¯.isnull().<span class="built_in">sum</span>() / <span class="built_in">len</span>(å®¢æˆ·ä¿¡æ¯)</span><br><span class="line">é«˜ç¼ºå¤±åˆ— = ç¼ºå¤±æ¯”ä¾‹[ç¼ºå¤±æ¯”ä¾‹ &gt; <span class="number">0.3</span>].index  <span class="comment"># ç¼ºå¤±è¶…è¿‡30%çš„åˆ—</span></span><br><span class="line">å®¢æˆ·ä¿¡æ¯_åˆ é™¤é«˜ç¼ºå¤±åˆ— = å®¢æˆ·ä¿¡æ¯.drop(columns=é«˜ç¼ºå¤±åˆ—)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;åˆ é™¤é«˜ç¼ºå¤±åˆ—åï¼š<span class="subst">&#123;å®¢æˆ·ä¿¡æ¯_åˆ é™¤é«˜ç¼ºå¤±åˆ—.shape&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p><strong>æ–¹æ³•2ï¼šå¡«å……ç¼ºå¤±å€¼ï¼ˆæ›´å¸¸ç”¨çš„æ–¹æ³•ï¼‰</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ–¹æ³•2.1ï¼šç”¨å›ºå®šå€¼å¡«å……</span></span><br><span class="line">å®¢æˆ·ä¿¡æ¯_å¡«å……<span class="number">1</span> = å®¢æˆ·ä¿¡æ¯.copy()</span><br><span class="line">å®¢æˆ·ä¿¡æ¯_å¡«å……<span class="number">1</span>[<span class="string">&#x27;ä¿¡ç”¨ç­‰çº§&#x27;</span>] = å®¢æˆ·ä¿¡æ¯_å¡«å……<span class="number">1</span>[<span class="string">&#x27;ä¿¡ç”¨ç­‰çº§&#x27;</span>].fillna(<span class="string">&#x27;C&#x27;</span>)  <span class="comment"># é»˜è®¤Cçº§</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹æ³•2.2ï¼šç”¨å‰ä¸€ä¸ªå€¼æˆ–åä¸€ä¸ªå€¼å¡«å……</span></span><br><span class="line">å®¢æˆ·ä¿¡æ¯_å¡«å……<span class="number">2</span> = å®¢æˆ·ä¿¡æ¯.copy()</span><br><span class="line">å®¢æˆ·ä¿¡æ¯_å¡«å……<span class="number">2</span>[<span class="string">&#x27;ä¿¡ç”¨ç­‰çº§&#x27;</span>] = å®¢æˆ·ä¿¡æ¯_å¡«å……<span class="number">2</span>[<span class="string">&#x27;ä¿¡ç”¨ç­‰çº§&#x27;</span>].fillna(method=<span class="string">&#x27;ffill&#x27;</span>)  <span class="comment"># å‰å‘å¡«å……</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹æ³•2.3ï¼šç”¨å¹³å‡å€¼å¡«å……ï¼ˆé€‚åˆæ•°å€¼å‹ï¼‰</span></span><br><span class="line">å®¢æˆ·ä¿¡æ¯_å¡«å……<span class="number">3</span> = å®¢æˆ·ä¿¡æ¯.copy()</span><br><span class="line"><span class="comment"># å…ˆè½¬æ¢åº”æ”¶è´¦æ¬¾ä¸ºæ•°å€¼ç±»å‹</span></span><br><span class="line">å®¢æˆ·ä¿¡æ¯_å¡«å……<span class="number">3</span>[<span class="string">&#x27;åº”æ”¶è´¦æ¬¾&#x27;</span>] = pd.to_numeric(å®¢æˆ·ä¿¡æ¯_å¡«å……<span class="number">3</span>[<span class="string">&#x27;åº”æ”¶è´¦æ¬¾&#x27;</span>], errors=<span class="string">&#x27;coerce&#x27;</span>)</span><br><span class="line">å®¢æˆ·ä¿¡æ¯_å¡«å……<span class="number">3</span>[<span class="string">&#x27;åº”æ”¶è´¦æ¬¾&#x27;</span>] = å®¢æˆ·ä¿¡æ¯_å¡«å……<span class="number">3</span>[<span class="string">&#x27;åº”æ”¶è´¦æ¬¾&#x27;</span>].fillna(å®¢æˆ·ä¿¡æ¯_å¡«å……<span class="number">3</span>[<span class="string">&#x27;åº”æ”¶è´¦æ¬¾&#x27;</span>].mean())</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹æ³•2.4ï¼šæ™ºèƒ½å¡«å……ï¼ˆæ ¹æ®å…¶ä»–åˆ—æ¨æ–­ï¼‰</span></span><br><span class="line">å®¢æˆ·ä¿¡æ¯_æ™ºèƒ½å¡«å…… = å®¢æˆ·ä¿¡æ¯.copy()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¹æ®é”€å”®å‘˜æ¨æ–­ä¿¡ç”¨ç­‰çº§ï¼ˆåŒçº§åˆ«çš„é”€å”®å‘˜ä¿¡ç”¨ç­‰çº§ç›¸åŒï¼‰</span></span><br><span class="line">ä¿¡ç”¨ç­‰çº§æ˜ å°„ = å®¢æˆ·ä¿¡æ¯_æ™ºèƒ½å¡«å…….groupby(<span class="string">&#x27;é”€å”®å‘˜&#x27;</span>)[<span class="string">&#x27;ä¿¡ç”¨ç­‰çº§&#x27;</span>].first().to_dict()</span><br><span class="line">å®¢æˆ·ä¿¡æ¯_æ™ºèƒ½å¡«å……[<span class="string">&#x27;ä¿¡ç”¨ç­‰çº§&#x27;</span>] = å®¢æˆ·ä¿¡æ¯_æ™ºèƒ½å¡«å…….apply(</span><br><span class="line">    <span class="keyword">lambda</span> row: row[<span class="string">&#x27;ä¿¡ç”¨ç­‰çº§&#x27;</span>] <span class="keyword">if</span> pd.notna(row[<span class="string">&#x27;ä¿¡ç”¨ç­‰çº§&#x27;</span>]) <span class="keyword">else</span> </span><br><span class="line">                ä¿¡ç”¨ç­‰çº§æ˜ å°„.get(row[<span class="string">&#x27;é”€å”®å‘˜&#x27;</span>], <span class="string">&#x27;C&#x27;</span>), axis=<span class="number">1</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æ™ºèƒ½å¡«å……åçš„ä¿¡ç”¨ç­‰çº§ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(å®¢æˆ·ä¿¡æ¯_æ™ºèƒ½å¡«å……[[<span class="string">&#x27;é”€å”®å‘˜&#x27;</span>, <span class="string">&#x27;ä¿¡ç”¨ç­‰çº§&#x27;</span>]])</span><br></pre></td></tr></table></figure><p><strong>æ–¹æ³•3ï¼šæ’å€¼å¡«å……ï¼ˆé€‚åˆæ—¶é—´åºåˆ—ï¼‰</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºæ—¶é—´åºåˆ—æ•°æ®</span></span><br><span class="line">æ—¶é—´åºåˆ—æ•°æ® = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;æ—¥æœŸ&#x27;</span>: pd.date_range(<span class="string">&#x27;2024-01-01&#x27;</span>, periods=<span class="number">10</span>),</span><br><span class="line">    <span class="string">&#x27;é”€å”®é¢&#x27;</span>: [<span class="number">10000</span>, <span class="number">12000</span>, np.nan, <span class="number">15000</span>, <span class="number">18000</span>, np.nan, <span class="number">22000</span>, <span class="number">25000</span>, <span class="number">28000</span>, <span class="number">30000</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;åŸå§‹æ—¶é—´åºåˆ—ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(æ—¶é—´åºåˆ—æ•°æ®)</span><br><span class="line"></span><br><span class="line"><span class="comment"># çº¿æ€§æ’å€¼å¡«å……</span></span><br><span class="line">æ—¶é—´åºåˆ—_æ’å€¼ = æ—¶é—´åºåˆ—æ•°æ®.copy()</span><br><span class="line">æ—¶é—´åºåˆ—_æ’å€¼[<span class="string">&#x27;é”€å”®é¢&#x27;</span>] = æ—¶é—´åºåˆ—_æ’å€¼[<span class="string">&#x27;é”€å”®é¢&#x27;</span>].interpolate(method=<span class="string">&#x27;linear&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\næ’å€¼å¡«å……åï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(æ—¶é—´åºåˆ—_æ’å€¼)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯è§†åŒ–æ’å€¼æ•ˆæœ</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">6</span>))</span><br><span class="line">plt.plot(æ—¶é—´åºåˆ—æ•°æ®[<span class="string">&#x27;æ—¥æœŸ&#x27;</span>], æ—¶é—´åºåˆ—æ•°æ®[<span class="string">&#x27;é”€å”®é¢&#x27;</span>], <span class="string">&#x27;ro-&#x27;</span>, label=<span class="string">&#x27;åŸå§‹æ•°æ®ï¼ˆå«ç¼ºå¤±ï¼‰&#x27;</span>)</span><br><span class="line">plt.plot(æ—¶é—´åºåˆ—_æ’å€¼[<span class="string">&#x27;æ—¥æœŸ&#x27;</span>], æ—¶é—´åºåˆ—_æ’å€¼[<span class="string">&#x27;é”€å”®é¢&#x27;</span>], <span class="string">&#x27;bo-&#x27;</span>, label=<span class="string">&#x27;æ’å€¼å¡«å……å&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;æ—¶é—´åºåˆ—æ•°æ®æ’å€¼å¡«å……&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;æ—¥æœŸ&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;é”€å”®é¢&#x27;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.grid(<span class="literal">True</span>)</span><br><span class="line">plt.xticks(rotation=<span class="number">45</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.savefig(<span class="string">&#x27;æ—¶é—´åºåˆ—æ’å€¼.png&#x27;</span>, dpi=<span class="number">300</span>, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br><span class="line">plt.close()</span><br></pre></td></tr></table></figure><hr><h3 id="ğŸ”„-ç»Ÿä¸€æ•°æ®æ ¼å¼ï¼šè®©æ•°æ®â€œæ•´é½åˆ’ä¸€â€"><a href="#ğŸ”„-ç»Ÿä¸€æ•°æ®æ ¼å¼ï¼šè®©æ•°æ®â€œæ•´é½åˆ’ä¸€â€" class="headerlink" title="ğŸ”„ ç»Ÿä¸€æ•°æ®æ ¼å¼ï¼šè®©æ•°æ®â€œæ•´é½åˆ’ä¸€â€"></a>ğŸ”„ ç»Ÿä¸€æ•°æ®æ ¼å¼ï¼šè®©æ•°æ®â€œæ•´é½åˆ’ä¸€â€</h3><p><strong>æ–‡æœ¬æ•°æ®æ¸…æ´—</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºç¤ºä¾‹æ–‡æœ¬æ•°æ®</span></span><br><span class="line">æ–‡æœ¬æ•°æ® = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;å®¢æˆ·åç§°&#x27;</span>: [<span class="string">&#x27;  å¼ ä¸‰  &#x27;</span>, <span class="string">&#x27;æå››&#x27;</span>, <span class="string">&#x27;ç‹äº”&#x27;</span>, <span class="string">&#x27;  èµµå…­  &#x27;</span>, <span class="string">&#x27;é’±ä¸ƒ&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;äº§å“åç§°&#x27;</span>: [<span class="string">&#x27;  äº§å“A  &#x27;</span>, <span class="string">&#x27;äº§å“B  &#x27;</span>, <span class="string">&#x27;  äº§å“C&#x27;</span>, <span class="string">&#x27;äº§å“D&#x27;</span>, <span class="string">&#x27;  äº§å“E  &#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;çŠ¶æ€&#x27;</span>: [<span class="string">&#x27;  æ´»è·ƒ  &#x27;</span>, <span class="string">&#x27;æ´»è·ƒ&#x27;</span>, <span class="string">&#x27;  ä¸æ´»è·ƒ&#x27;</span>, <span class="string">&#x27;æ´»è·ƒ  &#x27;</span>, <span class="string">&#x27;  æ´»è·ƒ  &#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;åŸå§‹æ–‡æœ¬æ•°æ®ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(æ–‡æœ¬æ•°æ®)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å»é™¤å‰åç©ºæ ¼</span></span><br><span class="line">æ–‡æœ¬æ•°æ®_æ¸…æ´— = æ–‡æœ¬æ•°æ®.copy()</span><br><span class="line">æ–‡æœ¬æ•°æ®_æ¸…æ´— = æ–‡æœ¬æ•°æ®_æ¸…æ´—.apply(<span class="keyword">lambda</span> x: x.<span class="built_in">str</span>.strip() <span class="keyword">if</span> x.dtype == <span class="string">&#x27;object&#x27;</span> <span class="keyword">else</span> x)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nå»é™¤ç©ºæ ¼åï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(æ–‡æœ¬æ•°æ®_æ¸…æ´—)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»Ÿä¸€å¤§å°å†™</span></span><br><span class="line">æ–‡æœ¬æ•°æ®_å¤§å°å†™ = æ–‡æœ¬æ•°æ®_æ¸…æ´—.copy()</span><br><span class="line">æ–‡æœ¬æ•°æ®_å¤§å°å†™[<span class="string">&#x27;çŠ¶æ€&#x27;</span>] = æ–‡æœ¬æ•°æ®_å¤§å°å†™[<span class="string">&#x27;çŠ¶æ€&#x27;</span>].<span class="built_in">str</span>.upper()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nç»Ÿä¸€ä¸ºå¤§å†™åï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(æ–‡æœ¬æ•°æ®_å¤§å°å†™)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ›¿æ¢ç‰¹å®šæ–‡æœ¬</span></span><br><span class="line">æ–‡æœ¬æ•°æ®_æ›¿æ¢ = æ–‡æœ¬æ•°æ®_æ¸…æ´—.copy()</span><br><span class="line">æ–‡æœ¬æ•°æ®_æ›¿æ¢[<span class="string">&#x27;çŠ¶æ€&#x27;</span>] = æ–‡æœ¬æ•°æ®_æ›¿æ¢[<span class="string">&#x27;çŠ¶æ€&#x27;</span>].replace(<span class="string">&#x27;ä¸æ´»è·ƒ&#x27;</span>, <span class="string">&#x27;Inactive&#x27;</span>)</span><br><span class="line">æ–‡æœ¬æ•°æ®_æ›¿æ¢[<span class="string">&#x27;çŠ¶æ€&#x27;</span>] = æ–‡æœ¬æ•°æ®_æ›¿æ¢[<span class="string">&#x27;çŠ¶æ€&#x27;</span>].replace(<span class="string">&#x27;æ´»è·ƒ&#x27;</span>, <span class="string">&#x27;Active&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\næ–‡æœ¬æ›¿æ¢åï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(æ–‡æœ¬æ•°æ®_æ›¿æ¢)</span><br></pre></td></tr></table></figure><p><strong>æ•°å­—æ•°æ®æ¸…æ´—</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºæ··åˆæ ¼å¼çš„æ•°å­—æ•°æ®</span></span><br><span class="line">æ•°å­—æ•°æ® = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;é‡‘é¢&#x27;</span>: [<span class="string">&#x27;15000.50&#x27;</span>, <span class="string">&#x27;25000&#x27;</span>, <span class="literal">None</span>, <span class="string">&#x27;18,000.75&#x27;</span>, <span class="string">&#x27;not-a-number&#x27;</span>, <span class="string">&#x27;22000&#x27;</span>, <span class="string">&#x27;19500.25&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;16500&#x27;</span>, <span class="string">&#x27;21000.80å…ƒ&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;æ•°é‡&#x27;</span>: [<span class="string">&#x27;100&#x27;</span>, <span class="string">&#x27;150ä»¶&#x27;</span>, <span class="string">&#x27;200ä¸ª&#x27;</span>, <span class="string">&#x27;180&#x27;</span>, <span class="string">&#x27;not-a-number&#x27;</span>, <span class="string">&#x27;220&#x27;</span>, <span class="string">&#x27;195&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;165&#x27;</span>, <span class="string">&#x27;210å°&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;å•ä»·&#x27;</span>: [<span class="string">&#x27;150.50å…ƒ&#x27;</span>, <span class="string">&#x27;166.67&#x27;</span>, <span class="string">&#x27;152.50&#x27;</span>, <span class="string">&#x27;158.33&#x27;</span>, <span class="string">&#x27;not-a-number&#x27;</span>, <span class="string">&#x27;157.50&#x27;</span>, <span class="string">&#x27;156.25&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;160.00&#x27;</span>, <span class="string">&#x27;157.50å…ƒ/ä»¶&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;åŸå§‹æ•°å­—æ•°æ®ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(æ•°å­—æ•°æ®)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;\næ•°æ®ç±»å‹ï¼š\n<span class="subst">&#123;æ•°å­—æ•°æ®.dtypes&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¸…æ´—æ•°å­—æ•°æ®å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">æ¸…æ´—æ•°å­—åˆ—</span>(<span class="params">ç³»åˆ—, åˆ—å=<span class="string">&quot;æ•°å­—åˆ—&quot;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ¸…æ´—åŒ…å«éæ•°å­—å­—ç¬¦çš„æ•°å­—åˆ—&quot;&quot;&quot;</span></span><br><span class="line">    æ¸…æ´—åçš„ç³»åˆ— = ç³»åˆ—.astype(<span class="built_in">str</span>)  <span class="comment"># å…ˆè½¬æ¢ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ç§»é™¤å¸¸è§çš„éæ•°å­—å­—ç¬¦</span></span><br><span class="line">    æ¸…æ´—åçš„ç³»åˆ— = æ¸…æ´—åçš„ç³»åˆ—.<span class="built_in">str</span>.replace(<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;&#x27;</span>)  <span class="comment"># ç§»é™¤åƒåˆ†ä½é€—å·</span></span><br><span class="line">    æ¸…æ´—åçš„ç³»åˆ— = æ¸…æ´—åçš„ç³»åˆ—.<span class="built_in">str</span>.replace(<span class="string">&#x27;å…ƒ&#x27;</span>, <span class="string">&#x27;&#x27;</span>)  <span class="comment"># ç§»é™¤è´§å¸ç¬¦å·</span></span><br><span class="line">    æ¸…æ´—åçš„ç³»åˆ— = æ¸…æ´—åçš„ç³»åˆ—.<span class="built_in">str</span>.replace(<span class="string">&#x27;ä»¶&#x27;</span>, <span class="string">&#x27;&#x27;</span>)  <span class="comment"># ç§»é™¤å•ä½</span></span><br><span class="line">    æ¸…æ´—åçš„ç³»åˆ— = æ¸…æ´—åçš„ç³»åˆ—.<span class="built_in">str</span>.replace(<span class="string">&#x27;ä¸ª&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    æ¸…æ´—åçš„ç³»åˆ— = æ¸…æ´—åçš„ç³»åˆ—.<span class="built_in">str</span>.replace(<span class="string">&#x27;å°&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    æ¸…æ´—åçš„ç³»åˆ— = æ¸…æ´—åçš„ç³»åˆ—.<span class="built_in">str</span>.replace(<span class="string">&#x27;/ä»¶&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    æ¸…æ´—åçš„ç³»åˆ— = æ¸…æ´—åçš„ç³»åˆ—.<span class="built_in">str</span>.strip()  <span class="comment"># å»é™¤ç©ºæ ¼</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å°†æ— æ³•è½¬æ¢çš„å€¼è®¾ä¸ºNaN</span></span><br><span class="line">    æ¸…æ´—åçš„ç³»åˆ— = pd.to_numeric(æ¸…æ´—åçš„ç³»åˆ—, errors=<span class="string">&#x27;coerce&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> æ¸…æ´—åçš„ç³»åˆ—</span><br><span class="line"></span><br><span class="line"><span class="comment"># åº”ç”¨æ•°å­—æ¸…æ´—</span></span><br><span class="line">æ•°å­—æ•°æ®_æ¸…æ´— = æ•°å­—æ•°æ®.copy()</span><br><span class="line"><span class="keyword">for</span> åˆ—å <span class="keyword">in</span> æ•°å­—æ•°æ®.columns:</span><br><span class="line">    æ•°å­—æ•°æ®_æ¸…æ´—[åˆ—å] = æ¸…æ´—æ•°å­—åˆ—(æ•°å­—æ•°æ®[åˆ—å], åˆ—å)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\næ¸…æ´—åçš„æ•°å­—æ•°æ®ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(æ•°å­—æ•°æ®_æ¸…æ´—)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;\næ¸…æ´—åæ•°æ®ç±»å‹ï¼š\n<span class="subst">&#123;æ•°å­—æ•°æ®_æ¸…æ´—.dtypes&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤„ç†æ¸…æ´—åçš„ç¼ºå¤±å€¼</span></span><br><span class="line">æ•°å­—æ•°æ®_æœ€ç»ˆ = æ•°å­—æ•°æ®_æ¸…æ´—.copy()</span><br><span class="line">æ•°å­—æ•°æ®_æœ€ç»ˆ = æ•°å­—æ•°æ®_æœ€ç»ˆ.fillna(<span class="number">0</span>)  <span class="comment"># å°†æ— æ³•è½¬æ¢çš„å€¼è®¾ä¸º0</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\næœ€ç»ˆæ¸…æ´—ç»“æœï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(æ•°å­—æ•°æ®_æœ€ç»ˆ)</span><br></pre></td></tr></table></figure><p><strong>æ—¥æœŸæ•°æ®æ¸…æ´—</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºæ··ä¹±çš„æ—¥æœŸæ•°æ®</span></span><br><span class="line">æ—¥æœŸæ•°æ® = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;åŸå§‹æ—¥æœŸ&#x27;</span>: [<span class="string">&#x27;2024-01-01&#x27;</span>, <span class="string">&#x27;2024/01/02&#x27;</span>, <span class="string">&#x27;2024.01.03&#x27;</span>, <span class="string">&#x27;01-Jan-2024&#x27;</span>, <span class="string">&#x27;20240104&#x27;</span>, </span><br><span class="line">                <span class="string">&#x27;2024å¹´1æœˆ5æ—¥&#x27;</span>, <span class="string">&#x27;1/6/2024&#x27;</span>, <span class="string">&#x27;Jan 7, 2024&#x27;</span>, <span class="literal">None</span>, <span class="string">&#x27;not-a-date&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;äº‹ä»¶&#x27;</span>: [<span class="string">&#x27;è®¢å•1&#x27;</span>, <span class="string">&#x27;è®¢å•2&#x27;</span>, <span class="string">&#x27;è®¢å•3&#x27;</span>, <span class="string">&#x27;è®¢å•4&#x27;</span>, <span class="string">&#x27;è®¢å•5&#x27;</span>, <span class="string">&#x27;è®¢å•6&#x27;</span>, <span class="string">&#x27;è®¢å•7&#x27;</span>, <span class="string">&#x27;è®¢å•8&#x27;</span>, <span class="string">&#x27;è®¢å•9&#x27;</span>, <span class="string">&#x27;è®¢å•10&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;åŸå§‹æ—¥æœŸæ•°æ®ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(æ—¥æœŸæ•°æ®)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ™ºèƒ½æ—¥æœŸæ¸…æ´—å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">æ™ºèƒ½æ—¥æœŸæ¸…æ´—</span>(<span class="params">æ—¥æœŸç³»åˆ—</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ™ºèƒ½è¯†åˆ«å’Œæ¸…æ´—å„ç§æ ¼å¼çš„æ—¥æœŸ&quot;&quot;&quot;</span></span><br><span class="line">    æ¸…æ´—åçš„æ—¥æœŸ = pd.to_datetime(æ—¥æœŸç³»åˆ—, errors=<span class="string">&#x27;coerce&#x27;</span>, infer_datetime_format=<span class="literal">True</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å¦‚æœè¿˜æœ‰æ— æ³•è¯†åˆ«çš„ï¼Œå°è¯•æ‰‹åŠ¨å¤„ç†</span></span><br><span class="line">    æ— æ³•è¯†åˆ« = æ¸…æ´—åçš„æ—¥æœŸ.isnull() &amp; æ—¥æœŸç³»åˆ—.notnull()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> æ— æ³•è¯†åˆ«.<span class="built_in">sum</span>() &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å‘ç°<span class="subst">&#123;æ— æ³•è¯†åˆ«.<span class="built_in">sum</span>()&#125;</span>ä¸ªæ— æ³•è¯†åˆ«çš„æ—¥æœŸæ ¼å¼&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å°è¯•å…¶ä»–æ ¼å¼</span></span><br><span class="line">        <span class="keyword">for</span> i, åŸå§‹å€¼ <span class="keyword">in</span> <span class="built_in">enumerate</span>(æ—¥æœŸç³»åˆ—[æ— æ³•è¯†åˆ«]):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="comment"># ç§»é™¤ä¸­æ–‡å’Œç‰¹æ®Šå­—ç¬¦</span></span><br><span class="line">                æ¸…ç†å€¼ = <span class="built_in">str</span>(åŸå§‹å€¼).replace(<span class="string">&#x27;å¹´&#x27;</span>, <span class="string">&#x27;-&#x27;</span>).replace(<span class="string">&#x27;æœˆ&#x27;</span>, <span class="string">&#x27;-&#x27;</span>).replace(<span class="string">&#x27;æ—¥&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">                æ¸…ç†å€¼ = æ¸…ç†å€¼.replace(<span class="string">&#x27;Jan&#x27;</span>, <span class="string">&#x27;01&#x27;</span>).replace(<span class="string">&#x27;Feb&#x27;</span>, <span class="string">&#x27;02&#x27;</span>).replace(<span class="string">&#x27;Mar&#x27;</span>, <span class="string">&#x27;03&#x27;</span>)</span><br><span class="line">                æ¸…ç†å€¼ = æ¸…ç†å€¼.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># å°è¯•è§£æ</span></span><br><span class="line">                è§£ææ—¥æœŸ = pd.to_datetime(æ¸…ç†å€¼, errors=<span class="string">&#x27;coerce&#x27;</span>)</span><br><span class="line">                <span class="keyword">if</span> pd.notna(è§£ææ—¥æœŸ):</span><br><span class="line">                    æ¸…æ´—åçš„æ—¥æœŸ.loc[æ¸…æ´—åçš„æ—¥æœŸ.index[æ— æ³•è¯†åˆ«][i]] = è§£ææ—¥æœŸ</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> æ¸…æ´—åçš„æ—¥æœŸ</span><br><span class="line"></span><br><span class="line"><span class="comment"># åº”ç”¨æ—¥æœŸæ¸…æ´—</span></span><br><span class="line">æ—¥æœŸæ•°æ®_æ¸…æ´— = æ—¥æœŸæ•°æ®.copy()</span><br><span class="line">æ—¥æœŸæ•°æ®_æ¸…æ´—[<span class="string">&#x27;æ ‡å‡†æ—¥æœŸ&#x27;</span>] = æ™ºèƒ½æ—¥æœŸæ¸…æ´—(æ—¥æœŸæ•°æ®[<span class="string">&#x27;åŸå§‹æ—¥æœŸ&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\næ—¥æœŸæ¸…æ´—ç»“æœï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(æ—¥æœŸæ•°æ®_æ¸…æ´—)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æå–æ—¥æœŸç»„ä»¶</span></span><br><span class="line">æ—¥æœŸæ•°æ®_å¢å¼º = æ—¥æœŸæ•°æ®_æ¸…æ´—.copy()</span><br><span class="line">æ—¥æœŸæ•°æ®_å¢å¼º[<span class="string">&#x27;å¹´&#x27;</span>] = æ—¥æœŸæ•°æ®_å¢å¼º[<span class="string">&#x27;æ ‡å‡†æ—¥æœŸ&#x27;</span>].dt.year</span><br><span class="line">æ—¥æœŸæ•°æ®_å¢å¼º[<span class="string">&#x27;æœˆ&#x27;</span>] = æ—¥æœŸ_data_å¢å¼º[<span class="string">&#x27;æ ‡å‡†æ—¥æœŸ&#x27;</span>].dt.month</span><br><span class="line">æ—¥æœŸæ•°æ®_å¢å¼º[<span class="string">&#x27;æ—¥&#x27;</span>] = æ—¥æœŸ_data_å¢å¼º[<span class="string">&#x27;æ ‡å‡†æ—¥æœŸ&#x27;</span>].dt.day</span><br><span class="line">æ—¥æœŸæ•°æ®_å¢å¼º[<span class="string">&#x27;æ˜ŸæœŸ&#x27;</span>] = æ—¥æœŸ_data_å¢å¼º[<span class="string">&#x27;æ ‡å‡†æ—¥æœŸ&#x27;</span>].dt.day_name()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nå¢å¼ºåçš„æ—¥æœŸæ•°æ®ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(æ—¥æœŸæ•°æ®_å¢å¼º)</span><br></pre></td></tr></table></figure><hr><h3 id="ğŸ§ª-æ•°æ®éªŒè¯ï¼šç¡®ä¿æ¸…æ´—è´¨é‡"><a href="#ğŸ§ª-æ•°æ®éªŒè¯ï¼šç¡®ä¿æ¸…æ´—è´¨é‡" class="headerlink" title="ğŸ§ª æ•°æ®éªŒè¯ï¼šç¡®ä¿æ¸…æ´—è´¨é‡"></a>ğŸ§ª æ•°æ®éªŒè¯ï¼šç¡®ä¿æ¸…æ´—è´¨é‡</h3><p><strong>åˆ›å»ºæ•°æ®éªŒè¯å‡½æ•°</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">æ•°æ®æ¸…æ´—è´¨é‡æ£€æŸ¥</span>(<span class="params">åŸå§‹æ•°æ®, æ¸…æ´—åæ•°æ®</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ£€æŸ¥æ•°æ®æ¸…æ´—çš„è´¨é‡&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">60</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ•°æ®æ¸…æ´—è´¨é‡æ£€æŸ¥æŠ¥å‘Š&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">60</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;åŸå§‹æ•°æ®å½¢çŠ¶ï¼š<span class="subst">&#123;åŸå§‹æ•°æ®.shape&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;æ¸…æ´—åæ•°æ®å½¢çŠ¶ï¼š<span class="subst">&#123;æ¸…æ´—å_data.shape&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ç¼ºå¤±å€¼æ£€æŸ¥</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\nç¼ºå¤±å€¼å¯¹æ¯”ï¼š&quot;</span>)</span><br><span class="line">    åŸå§‹ç¼ºå¤± = åŸå§‹æ•°æ®.isnull().<span class="built_in">sum</span>()</span><br><span class="line">    æ¸…æ´—ç¼ºå¤± = æ¸…æ´—åæ•°æ®.isnull().<span class="built_in">sum</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> åˆ—å <span class="keyword">in</span> åŸå§‹æ•°æ®.columns:</span><br><span class="line">        åŸå§‹ç¼ºå¤±æ•° = åŸå§‹ç¼ºå¤±[åˆ—å]</span><br><span class="line">        æ¸…æ´—ç¼ºå¤±æ•° = æ¸…æ´—ç¼ºå¤±[åˆ—å]</span><br><span class="line">        æ”¹å–„ = åŸå§‹ç¼ºå¤±æ•° - æ¸…æ´—ç¼ºå¤±æ•°</span><br><span class="line">        <span class="keyword">if</span> æ”¹å–„ &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;åˆ—å&#125;</span>ï¼š<span class="subst">&#123;åŸå§‹ç¼ºå¤±æ•°&#125;</span> â†’ <span class="subst">&#123;æ¸…æ´—ç¼ºå¤±æ•°&#125;</span>ï¼ˆæ”¹å–„<span class="subst">&#123;æ”¹å–„&#125;</span>ä¸ªï¼‰&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> æ”¹å–„ &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;åˆ—å&#125;</span>ï¼š<span class="subst">&#123;åŸå§‹ç¼ºå¤±æ•°&#125;</span> â†’ <span class="subst">&#123;æ¸…æ´—ç¼ºå¤±æ•°&#125;</span>ï¼ˆæ–°å¢<span class="subst">&#123;<span class="built_in">abs</span>(æ”¹å–„)&#125;</span>ä¸ªï¼‰âš ï¸&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;åˆ—å&#125;</span>ï¼š<span class="subst">&#123;åŸå§‹ç¼ºå¤±æ•°&#125;</span> â†’ <span class="subst">&#123;æ¸…æ´—ç¼ºå¤±æ•°&#125;</span>ï¼ˆæ— å˜åŒ–ï¼‰&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ•°æ®ç±»å‹æ£€æŸ¥</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\næ•°æ®ç±»å‹å˜åŒ–ï¼š&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> åˆ—å <span class="keyword">in</span> åŸå§‹æ•°æ®.columns:</span><br><span class="line">        <span class="keyword">if</span> åˆ—å <span class="keyword">in</span> æ¸…æ´—å_data.columns:</span><br><span class="line">            åŸå§‹ç±»å‹ = åŸå§‹æ•°æ®[åˆ—å].dtype</span><br><span class="line">            æ¸…æ´—ç±»å‹ = æ¸…æ´—å_data[åˆ—å].dtype</span><br><span class="line">            <span class="keyword">if</span> åŸå§‹ç±»å‹ != æ¸…æ´—ç±»å‹:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;åˆ—å&#125;</span>ï¼š<span class="subst">&#123;åŸå§‹ç±»å‹&#125;</span> â†’ <span class="subst">&#123;æ¸…æ´—_<span class="built_in">type</span>&#125;</span> âœ…&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ•°æ®èŒƒå›´æ£€æŸ¥</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\næ•°æ®èŒƒå›´æ£€æŸ¥ï¼š&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> åˆ—å <span class="keyword">in</span> æ¸…æ´—å_data.select_dtypes(include=[np.number]).columns:</span><br><span class="line">        æœ€å°å€¼ = æ¸…æ´—å_data[åˆ—å].<span class="built_in">min</span>()</span><br><span class="line">        æœ€å¤§å€¼ = æ¸…æ´—å_data[åˆ—å].<span class="built_in">max</span>()</span><br><span class="line">        å¹³å‡å€¼ = æ¸…æ´—å_data[åˆ—å].mean()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;åˆ—å&#125;</span>ï¼šèŒƒå›´[<span class="subst">&#123;æœ€å°å€¼:<span class="number">.2</span>f&#125;</span>, <span class="subst">&#123;æœ€å¤§å€¼:<span class="number">.2</span>f&#125;</span>]ï¼Œå¹³å‡å€¼<span class="subst">&#123;å¹³å‡å€¼:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨è´¨é‡æ£€æŸ¥å‡½æ•°</span></span><br><span class="line">æ•°æ®æ¸…æ´—è´¨é‡æ£€æŸ¥(å®¢æˆ·ä¿¡æ¯, å®¢æˆ·ä¿¡æ¯_æ™ºèƒ½å¡«å……)</span><br></pre></td></tr></table></figure><hr><h3 id="ğŸ’¼-å®æˆ˜é¡¹ç›®ï¼šæ¸…ç†å®¢æˆ·ä¿¡æ¯è¡¨"><a href="#ğŸ’¼-å®æˆ˜é¡¹ç›®ï¼šæ¸…ç†å®¢æˆ·ä¿¡æ¯è¡¨" class="headerlink" title="ğŸ’¼ å®æˆ˜é¡¹ç›®ï¼šæ¸…ç†å®¢æˆ·ä¿¡æ¯è¡¨"></a>ğŸ’¼ å®æˆ˜é¡¹ç›®ï¼šæ¸…ç†å®¢æˆ·ä¿¡æ¯è¡¨</h3><details><summary>ç‰ˆæœ¬1.0ï¼šåŸºç¡€æ¸…æ´—</summary><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®¢æˆ·ä¿¡æ¯æ¸…æ´— - åŸºç¡€ç‰ˆ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=== å®¢æˆ·ä¿¡æ¯æ¸…æ´—ç³»ç»Ÿ ===&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">åŸºç¡€å®¢æˆ·ä¿¡æ¯æ¸…æ´—</span>(<span class="params">df</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;åŸºç¡€ç‰ˆå®¢æˆ·ä¿¡æ¯æ¸…æ´—&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ğŸ” å¼€å§‹åŸºç¡€æ•°æ®æ¸…æ´—...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 1. å»é™¤æ–‡æœ¬å‰åç©ºæ ¼</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;1. å»é™¤æ–‡æœ¬ç©ºæ ¼...&quot;</span>)</span><br><span class="line">    æ–‡æœ¬åˆ— = [<span class="string">&#x27;å®¢æˆ·åç§°&#x27;</span>, <span class="string">&#x27;çŠ¶æ€&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> åˆ—å <span class="keyword">in</span> æ–‡æœ¬åˆ—:</span><br><span class="line">        <span class="keyword">if</span> åˆ—å <span class="keyword">in</span> df.columns:</span><br><span class="line">            df[åˆ—å] = df[åˆ—å].<span class="built_in">str</span>.strip()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. ç»Ÿä¸€å¤§å°å†™</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;2. ç»Ÿä¸€çŠ¶æ€å¤§å°å†™...&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;çŠ¶æ€&#x27;</span> <span class="keyword">in</span> df.columns:</span><br><span class="line">        df[<span class="string">&#x27;çŠ¶æ€&#x27;</span>] = df[<span class="string">&#x27;çŠ¶æ€&#x27;</span>].<span class="built_in">str</span>.title()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. å¤„ç†ç¼ºå¤±å€¼</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;3. å¤„ç†ç¼ºå¤±å€¼...&quot;</span>)</span><br><span class="line">    <span class="comment"># å®¢æˆ·åç§°ç¼ºå¤±ï¼šæ ‡è®°ä¸º&quot;å¾…è¡¥å……&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;å®¢æˆ·åç§°&#x27;</span> <span class="keyword">in</span> df.columns:</span><br><span class="line">        df[<span class="string">&#x27;å®¢æˆ·åç§°&#x27;</span>] = df[<span class="string">&#x27;å®¢æˆ·åç§°&#x27;</span>].fillna(<span class="string">&#x27;å¾…è¡¥å……&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ä¿¡ç”¨ç­‰çº§ç¼ºå¤±ï¼šé»˜è®¤ä¸ºCçº§</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;ä¿¡ç”¨ç­‰çº§&#x27;</span> <span class="keyword">in</span> df.columns:</span><br><span class="line">        df[<span class="string">&#x27;ä¿¡ç”¨ç­‰çº§&#x27;</span>] = df[<span class="string">&#x27;ä¿¡ç”¨ç­‰çº§&#x27;</span>].fillna(<span class="string">&#x27;C&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 4. æ¸…æ´—æ•°å­—æ•°æ®</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;4. æ¸…æ´—åº”æ”¶è´¦æ¬¾æ•°æ®...&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;åº”æ”¶è´¦æ¬¾&#x27;</span> <span class="keyword">in</span> df.columns:</span><br><span class="line">        df[<span class="string">&#x27;åº”æ”¶è´¦æ¬¾&#x27;</span>] = pd.to_numeric(df[<span class="string">&#x27;åº”æ”¶è´¦æ¬¾&#x27;</span>], errors=<span class="string">&#x27;coerce&#x27;</span>)</span><br><span class="line">        df[<span class="string">&#x27;åº”æ”¶è´¦æ¬¾&#x27;</span>] = df[<span class="string">&#x27;åº”æ”¶è´¦æ¬¾&#x27;</span>].fillna(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 5. æ¸…æ´—ç”µè¯å·ç </span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;5. æ¸…æ´—ç”µè¯å·ç ...&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;è”ç³»ç”µè¯&#x27;</span> <span class="keyword">in</span> df.columns:</span><br><span class="line">        <span class="comment"># ç§»é™¤æ‰€æœ‰éæ•°å­—å­—ç¬¦</span></span><br><span class="line">        df[<span class="string">&#x27;è”ç³»ç”µè¯_æ¸…æ´—&#x27;</span>] = df[<span class="string">&#x27;è”ç³»ç”µè¯&#x27;</span>].astype(<span class="built_in">str</span>).<span class="built_in">str</span>.replace(<span class="string">r&#x27;[^0-9]&#x27;</span>, <span class="string">&#x27;&#x27;</span>, regex=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># éªŒè¯æ‰‹æœºå·é•¿åº¦ï¼ˆ11ä½ï¼‰</span></span><br><span class="line">        df[<span class="string">&#x27;ç”µè¯æœ‰æ•ˆæ€§&#x27;</span>] = df[<span class="string">&#x27;è”ç³»ç”µè¯_æ¸…æ´—&#x27;</span>].<span class="built_in">str</span>.<span class="built_in">len</span>() == <span class="number">11</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 6. æ¸…æ´—é‚®ç®±åœ°å€</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;6. æ¸…æ´—é‚®ç®±åœ°å€...&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;é‚®ç®±&#x27;</span> <span class="keyword">in</span> df.columns:</span><br><span class="line">        <span class="comment"># åŸºæœ¬é‚®ç®±æ ¼å¼éªŒè¯</span></span><br><span class="line">        df[<span class="string">&#x27;é‚®ç®±æœ‰æ•ˆæ€§&#x27;</span>] = df[<span class="string">&#x27;é‚®ç®±&#x27;</span>].<span class="built_in">str</span>.contains(<span class="string">&#x27;@&#x27;</span>, na=<span class="literal">False</span>)</span><br><span class="line">        <span class="comment"># å¡«å……æ— æ•ˆé‚®ç®±</span></span><br><span class="line">        df.loc[~df[<span class="string">&#x27;é‚®ç®±æœ‰æ•ˆæ€§&#x27;</span>], <span class="string">&#x27;é‚®ç®±&#x27;</span>] = <span class="string">&#x27;å¾…è¡¥å……@company.com&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;âœ… åŸºç¡€æ¸…æ´—å®Œæˆï¼&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> df</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨åŸºç¡€æ¸…æ´—</span></span><br><span class="line">å®¢æˆ·ä¿¡æ¯_åŸºç¡€æ¸…æ´— = åŸºç¡€å®¢æˆ·ä¿¡æ¯æ¸…æ´—(å®¢æˆ·ä¿¡æ¯.copy())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nåŸºç¡€æ¸…æ´—ç»“æœï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(å®¢æˆ·ä¿¡æ¯_åŸºç¡€æ¸…æ´—.head())</span><br></pre></td></tr></table></figure></details><details><summary>ç‰ˆæœ¬2.0ï¼šé«˜çº§æ¸…æ´—</summary><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®¢æˆ·ä¿¡æ¯æ¸…æ´— - é«˜çº§ç‰ˆ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n=== é«˜çº§å®¢æˆ·ä¿¡æ¯æ¸…æ´—ç³»ç»Ÿ ===&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">é«˜çº§å®¢æˆ·ä¿¡æ¯æ¸…æ´—å™¨</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.æ¸…æ´—è§„åˆ™ = &#123;</span><br><span class="line">            <span class="string">&#x27;æ‰‹æœºå·è§„åˆ™&#x27;</span>: <span class="string">r&#x27;^1[3-9]\d&#123;9&#125;$&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;é‚®ç®±è§„åˆ™&#x27;</span>: <span class="string">r&#x27;^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]&#123;2,&#125;$&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;æ—¥æœŸè§„åˆ™&#x27;</span>: <span class="string">r&#x27;^\d&#123;4&#125;-\d&#123;2&#125;-\d&#123;2&#125;$&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">æ¸…æ´—å®¢æˆ·ä¿¡æ¯</span>(<span class="params">self, df</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;é«˜çº§å®¢æˆ·ä¿¡æ¯æ¸…æ´—&quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ğŸ” å¼€å§‹é«˜çº§æ•°æ®æ¸…æ´—...&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        df_æ¸…æ´— = df.copy()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 1. æ™ºèƒ½æ–‡æœ¬æ¸…æ´—</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;1. æ™ºèƒ½æ–‡æœ¬æ¸…æ´—...&quot;</span>)</span><br><span class="line">        df_æ¸…æ´— = self._æ™ºèƒ½æ–‡æœ¬æ¸…æ´—(df_æ¸…æ´—)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 2. ç”µè¯å·ç æ ‡å‡†åŒ–</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;2. ç”µè¯å·ç æ ‡å‡†åŒ–...&quot;</span>)</span><br><span class="line">        df_æ¸…æ´— = self._ç”µè¯å·ç æ ‡å‡†åŒ–(df_æ¸…æ´—)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 3. é‚®ç®±åœ°å€éªŒè¯å’Œä¿®æ­£</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;3. é‚®ç®±åœ°å€éªŒè¯å’Œä¿®æ­£...&quot;</span>)</span><br><span class="line">        df_æ¸…æ´— = self._é‚®ç®±åœ°å€æ¸…æ´—(df_æ¸…æ´—)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 4. æ—¥æœŸæ ¼å¼ç»Ÿä¸€</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;4. æ—¥æœŸæ ¼å¼ç»Ÿä¸€...&quot;</span>)</span><br><span class="line">        df_æ¸…æ´— = self._æ—¥æœŸæ ¼å¼ç»Ÿä¸€(df_æ¸…æ´—)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 5. ä¿¡ç”¨ç­‰çº§æ ‡å‡†åŒ–</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;5. ä¿¡ç”¨ç­‰çº§æ ‡å‡†åŒ–...&quot;</span>)</span><br><span class="line">        df_æ¸…æ´— = self._ä¿¡ç”¨ç­‰çº§æ ‡å‡†åŒ–(df_æ¸…æ´—)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 6. åº”æ”¶è´¦æ¬¾æ ‡å‡†åŒ–</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;6. åº”æ”¶è´¦æ¬¾æ ‡å‡†åŒ–...&quot;</span>)</span><br><span class="line">        df_æ¸…æ´— = self._åº”æ”¶è´¦æ¬¾æ ‡å‡†åŒ–(df_æ¸…æ´—)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 7. æ•°æ®éªŒè¯</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;7. æ•°æ®éªŒè¯...&quot;</span>)</span><br><span class="line">        df_æ¸…æ´— = self._æ•°æ®éªŒè¯(df_æ¸…æ´—)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;âœ… é«˜çº§æ¸…æ´—å®Œæˆï¼&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> df_æ¸…æ´—</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_æ™ºèƒ½æ–‡æœ¬æ¸…æ´—</span>(<span class="params">self, df</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æ™ºèƒ½æ–‡æœ¬æ¸…æ´—&quot;&quot;&quot;</span></span><br><span class="line">        æ–‡æœ¬åˆ— = [<span class="string">&#x27;å®¢æˆ·åç§°&#x27;</span>, <span class="string">&#x27;çŠ¶æ€&#x27;</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> åˆ—å <span class="keyword">in</span> æ–‡æœ¬åˆ—:</span><br><span class="line">            <span class="keyword">if</span> åˆ—å <span class="keyword">in</span> df.columns:</span><br><span class="line">                <span class="comment"># å»é™¤å„ç§ç©ºç™½å­—ç¬¦</span></span><br><span class="line">                df[åˆ—å] = df[åˆ—å].astype(<span class="built_in">str</span>).<span class="built_in">str</span>.strip()</span><br><span class="line">                <span class="comment"># å»é™¤å¤šä½™ç©ºæ ¼</span></span><br><span class="line">                df[åˆ—å] = df[åˆ—å].<span class="built_in">str</span>.replace(<span class="string">r&#x27;\s+&#x27;</span>, <span class="string">&#x27; &#x27;</span>, regex=<span class="literal">True</span>)</span><br><span class="line">                <span class="comment"># ç»Ÿä¸€å¤§å°å†™æ ¼å¼</span></span><br><span class="line">                <span class="keyword">if</span> åˆ—å == <span class="string">&#x27;çŠ¶æ€&#x27;</span>:</span><br><span class="line">                    df[åˆ—å] = df[åˆ—å].<span class="built_in">str</span>.title()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> df</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_ç”µè¯å·ç æ ‡å‡†åŒ–</span>(<span class="params">self, df</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç”µè¯å·ç æ ‡å‡†åŒ–&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;è”ç³»ç”µè¯&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> df.columns:</span><br><span class="line">            <span class="keyword">return</span> df</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åˆ›å»ºæ–°åˆ—ä¿å­˜æ¸…æ´—ç»“æœ</span></span><br><span class="line">        df[<span class="string">&#x27;è”ç³»ç”µè¯_æ ‡å‡†åŒ–&#x27;</span>] = df[<span class="string">&#x27;è”ç³»ç”µè¯&#x27;</span>].astype(<span class="built_in">str</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç§»é™¤éæ•°å­—å­—ç¬¦</span></span><br><span class="line">        df[<span class="string">&#x27;è”ç³»ç”µè¯_æ ‡å‡†åŒ–&#x27;</span>] = df[<span class="string">&#x27;è”ç³»ç”µè¯_æ ‡å‡†åŒ–&#x27;</span>].<span class="built_in">str</span>.replace(<span class="string">r&#x27;[^0-9]&#x27;</span>, <span class="string">&#x27;&#x27;</span>, regex=<span class="literal">True</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># éªŒè¯æ‰‹æœºå·æ ¼å¼</span></span><br><span class="line">        df[<span class="string">&#x27;ç”µè¯æœ‰æ•ˆæ€§&#x27;</span>] = df[<span class="string">&#x27;è”ç³»ç”µè¯_æ ‡å‡†åŒ–&#x27;</span>].<span class="built_in">str</span>.<span class="keyword">match</span>(self.æ¸…æ´—è§„åˆ™[<span class="string">&#x27;æ‰‹æœºå·è§„åˆ™&#x27;</span>])</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¯¹æ— æ•ˆç”µè¯è¿›è¡Œåˆ†ç±»å¤„ç†</span></span><br><span class="line">        æ— æ•ˆç”µè¯ = ~df[<span class="string">&#x27;ç”µè¯æœ‰æ•ˆæ€§&#x27;</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># é•¿åº¦ä¸å¯¹çš„</span></span><br><span class="line">        é•¿åº¦ä¸å¯¹ = æ— æ•ˆç”µè¯ &amp; (df[<span class="string">&#x27;è”ç³»ç”µè¯_æ ‡å‡†åŒ–&#x27;</span>].<span class="built_in">str</span>.<span class="built_in">len</span>() != <span class="number">11</span>)</span><br><span class="line">        df.loc[é•¿åº¦ä¸å¯¹, <span class="string">&#x27;ç”µè¯é”™è¯¯ç±»å‹&#x27;</span>] = <span class="string">&#x27;é•¿åº¦é”™è¯¯&#x27;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ ¼å¼ä¸å¯¹çš„</span></span><br><span class="line">        æ ¼å¼ä¸å¯¹ = æ— æ•ˆç”µè¯ &amp; (df[<span class="string">&#x27;è”ç³»ç”µè¯_æ ‡å‡†åŒ–&#x27;</span>].<span class="built_in">str</span>.<span class="built_in">len</span>() == <span class="number">11</span>) &amp; \</span><br><span class="line">                   (~df[<span class="string">&#x27;è”ç³»ç”µè¯_æ ‡å‡†åŒ–&#x27;</span>].<span class="built_in">str</span>.startswith((<span class="string">&#x27;13&#x27;</span>, <span class="string">&#x27;14&#x27;</span>, <span class="string">&#x27;15&#x27;</span>, <span class="string">&#x27;16&#x27;</span>, <span class="string">&#x27;17&#x27;</span>, <span class="string">&#x27;18&#x27;</span>, <span class="string">&#x27;19&#x27;</span>)))</span><br><span class="line">        df.loc[æ ¼å¼ä¸å¯¹, <span class="string">&#x27;ç”µè¯é”™è¯¯ç±»å‹&#x27;</span>] = <span class="string">&#x27;æ ¼å¼é”™è¯¯&#x27;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç¼ºå¤±å€¼</span></span><br><span class="line">        ç¼ºå¤±å€¼ = æ— æ•ˆç”µè¯ &amp; (df[<span class="string">&#x27;è”ç³»ç”µè¯&#x27;</span>].isnull() | (df[<span class="string">&#x27;è”ç³»ç”µè¯&#x27;</span>] == <span class="string">&#x27;nan&#x27;</span>))</span><br><span class="line">        df.loc[ç¼ºå¤±å€¼, <span class="string">&#x27;ç”µè¯é”™è¯¯ç±»å‹&#x27;</span>] = <span class="string">&#x27;ç¼ºå¤±&#x27;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç‰¹æ®Šå€¼</span></span><br><span class="line">        ç‰¹æ®Šå€¼ = æ— æ•ˆç”µè¯ &amp; df[<span class="string">&#x27;è”ç³»ç”µè¯&#x27;</span>].astype(<span class="built_in">str</span>).<span class="built_in">str</span>.contains(<span class="string">&#x27;not-a-phone&#x27;</span>, na=<span class="literal">False</span>)</span><br><span class="line">        df.loc[ç‰¹æ®Šå€¼, <span class="string">&#x27;ç”µè¯é”™è¯¯ç±»å‹&#x27;</span>] = <span class="string">&#x27;æ— æ•ˆæ•°æ®&#x27;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¯¹ä¸åŒç±»å‹çš„é”™è¯¯è¿›è¡Œå¤„ç†</span></span><br><span class="line">        <span class="comment"># ç¼ºå¤±å€¼ï¼šæ ‡è®°ä¸ºå¾…è¡¥å……</span></span><br><span class="line">        df.loc[ç¼ºå¤±å€¼, <span class="string">&#x27;è”ç³»ç”µè¯_æ ‡å‡†åŒ–&#x27;</span>] = <span class="string">&#x27;å¾…è¡¥å……&#x27;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ ¼å¼é”™è¯¯ä½†é•¿åº¦æ­£ç¡®ï¼šå°è¯•ä¿®æ­£</span></span><br><span class="line">        å¯ä¿®æ­£ = æ ¼å¼ä¸å¯¹ &amp; (df[<span class="string">&#x27;è”ç³»ç”µè¯_æ ‡å‡†åŒ–&#x27;</span>].<span class="built_in">str</span>.<span class="built_in">len</span>() == <span class="number">11</span>)</span><br><span class="line">        <span class="comment"># è¿™é‡Œå¯ä»¥æ·»åŠ æ›´å¤æ‚çš„ä¿®æ­£é€»è¾‘</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> df</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_é‚®ç®±åœ°å€æ¸…æ´—</span>(<span class="params">self, df</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;é‚®ç®±åœ°å€éªŒè¯å’Œä¿®æ­£&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;é‚®ç®±&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> df.columns:</span><br><span class="line">            <span class="keyword">return</span> df</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># é‚®ç®±æœ‰æ•ˆæ€§éªŒè¯</span></span><br><span class="line">        df[<span class="string">&#x27;é‚®ç®±æœ‰æ•ˆæ€§&#x27;</span>] = df[<span class="string">&#x27;é‚®ç®±&#x27;</span>].<span class="built_in">str</span>.<span class="keyword">match</span>(self.æ¸…æ´—è§„åˆ™[<span class="string">&#x27;é‚®ç®±è§„åˆ™&#x27;</span>], na=<span class="literal">False</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è¯†åˆ«å¸¸è§é‚®ç®±é”™è¯¯</span></span><br><span class="line">        æ— æ•ˆé‚®ç®± = ~df[<span class="string">&#x27;é‚®ç®±æœ‰æ•ˆæ€§&#x27;</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç¼ºå¤±@ç¬¦å·</span></span><br><span class="line">        ç¼ºå°‘at = æ— æ•ˆé‚®ç®± &amp; (~df[<span class="string">&#x27;é‚®ç®±&#x27;</span>].<span class="built_in">str</span>.contains(<span class="string">&#x27;@&#x27;</span>, na=<span class="literal">False</span>))</span><br><span class="line">        df.loc[ç¼ºå°‘at, <span class="string">&#x27;é‚®ç®±é”™è¯¯ç±»å‹&#x27;</span>] = <span class="string">&#x27;ç¼ºå°‘@ç¬¦å·&#x27;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åŸŸåä¸å®Œæ•´</span></span><br><span class="line">        åŸŸåä¸å®Œæ•´ = æ— æ•ˆé‚®ç®± &amp; df[<span class="string">&#x27;é‚®ç®±&#x27;</span>].<span class="built_in">str</span>.contains(<span class="string">&#x27;@&#x27;</span>, na=<span class="literal">False</span>) &amp; \</span><br><span class="line">                     (~df[<span class="string">&#x27;é‚®ç®±&#x27;</span>].<span class="built_in">str</span>.contains(<span class="string">&#x27;.&#x27;</span>, na=<span class="literal">False</span>))</span><br><span class="line">        df.loc[åŸŸåä¸å®Œæ•´, <span class="string">&#x27;é‚®ç®±é”™è¯¯ç±»å‹&#x27;</span>] = <span class="string">&#x27;åŸŸåä¸å®Œæ•´&#x27;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¸¸è§åŸŸåä¿®æ­£</span></span><br><span class="line">        å¸¸è§åŸŸåä¿®æ­£ = &#123;</span><br><span class="line">            <span class="string">&#x27;@email&#x27;</span>: <span class="string">&#x27;@email.com&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;@company&#x27;</span>: <span class="string">&#x27;@company.com&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;@gmail&#x27;</span>: <span class="string">&#x27;@gmail.com&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;@qq&#x27;</span>: <span class="string">&#x27;@qq.com&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;@163&#x27;</span>: <span class="string">&#x27;@163.com&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> é”™è¯¯åŸŸå, æ­£ç¡®åŸŸå <span class="keyword">in</span> å¸¸è§åŸŸåä¿®æ­£.items():</span><br><span class="line">            éœ€è¦ä¿®æ­£ = df[<span class="string">&#x27;é‚®ç®±&#x27;</span>].<span class="built_in">str</span>.contains(é”™è¯¯åŸŸå, na=<span class="literal">False</span>)</span><br><span class="line">            df.loc[éœ€è¦ä¿®æ­£, <span class="string">&#x27;é‚®ç®±&#x27;</span>] = df.loc[éœ€è¦ä¿®æ­£, <span class="string">&#x27;é‚®ç®±&#x27;</span>].<span class="built_in">str</span>.replace(é”™è¯¯åŸŸå, æ­£ç¡®åŸŸå)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¯¹æ— æ³•ä¿®æ­£çš„é‚®ç®±æä¾›é»˜è®¤å€¼</span></span><br><span class="line">        ä»ç„¶æ— æ•ˆ = ~df[<span class="string">&#x27;é‚®ç®±&#x27;</span>].<span class="built_in">str</span>.<span class="keyword">match</span>(self.æ¸…æ´—è§„åˆ™[<span class="string">&#x27;é‚®ç®±è§„åˆ™&#x27;</span>], na=<span class="literal">False</span>)</span><br><span class="line">        df.loc[ä»ç„¶æ— æ•ˆ, <span class="string">&#x27;é‚®ç®±&#x27;</span>] = df.loc[ä»ç„¶æ— æ•ˆ, <span class="string">&#x27;å®¢æˆ·ID&#x27;</span>] + <span class="string">&#x27;@company.com&#x27;</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> df</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_æ—¥æœŸæ ¼å¼ç»Ÿä¸€</span>(<span class="params">self, df</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æ—¥æœŸæ ¼å¼ç»Ÿä¸€&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;æ³¨å†Œæ—¥æœŸ&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> df.columns:</span><br><span class="line">            <span class="keyword">return</span> df</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å°è¯•å¤šç§æ—¥æœŸæ ¼å¼</span></span><br><span class="line">        æ—¥æœŸæ ¼å¼åˆ—è¡¨ = [</span><br><span class="line">            <span class="string">&#x27;%Y-%m-%d&#x27;</span>,      <span class="comment"># 2024-01-01</span></span><br><span class="line">            <span class="string">&#x27;%Y/%m/%d&#x27;</span>,      <span class="comment"># 2024/01/01</span></span><br><span class="line">            <span class="string">&#x27;%Y.%m.%d&#x27;</span>,      <span class="comment"># 2024.01.01</span></span><br><span class="line">            <span class="string">&#x27;%d-%b-%Y&#x27;</span>,      <span class="comment"># 01-Jan-2024</span></span><br><span class="line">            <span class="string">&#x27;%d %b %Y&#x27;</span>,      <span class="comment"># 01 Jan 2024</span></span><br><span class="line">            <span class="string">&#x27;%Yå¹´%mæœˆ%dæ—¥&#x27;</span>,   <span class="comment"># 2024å¹´1æœˆ1æ—¥</span></span><br><span class="line">            <span class="string">&#x27;%m/%d/%Y&#x27;</span>,      <span class="comment"># 01/01/2024</span></span><br><span class="line">            <span class="string">&#x27;%Y%m%d&#x27;</span>         <span class="comment"># 20240101</span></span><br><span class="line">        ]</span><br><span class="line">        </span><br><span class="line">        df[<span class="string">&#x27;æ³¨å†Œæ—¥æœŸ_æ ‡å‡†åŒ–&#x27;</span>] = pd.NaT</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> æ—¥æœŸæ ¼å¼ <span class="keyword">in</span> æ—¥æœŸæ ¼å¼åˆ—è¡¨:</span><br><span class="line">            æœªè§£æ = df[<span class="string">&#x27;æ³¨å†Œæ—¥æœŸ_æ ‡å‡†åŒ–&#x27;</span>].isnull()</span><br><span class="line">            <span class="keyword">if</span> æœªè§£æ.<span class="built_in">sum</span>() == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">                </span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                è§£ææ—¥æœŸ = pd.to_datetime(df.loc[æœªè§£æ, <span class="string">&#x27;æ³¨å†Œæ—¥æœŸ&#x27;</span>], <span class="built_in">format</span>=æ—¥æœŸæ ¼å¼, errors=<span class="string">&#x27;coerce&#x27;</span>)</span><br><span class="line">                df.loc[æœªè§£æ &amp; è§£ææ—¥æœŸ.notnull(), <span class="string">&#x27;æ³¨å†Œæ—¥æœŸ_æ ‡å‡†åŒ–&#x27;</span>] = è§£ææ—¥æœŸ[è§£ææ—¥æœŸ.notnull()]</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¯¹ä»ç„¶æ— æ³•è§£æçš„æ—¥æœŸä½¿ç”¨æ™ºèƒ½è§£æ</span></span><br><span class="line">        ä»ç„¶æœªè§£æ = df[<span class="string">&#x27;æ³¨å†Œæ—¥æœŸ_æ ‡å‡†åŒ–&#x27;</span>].isnull() &amp; df[<span class="string">&#x27;æ³¨å†Œæ—¥æœŸ&#x27;</span>].notnull()</span><br><span class="line">        <span class="keyword">if</span> ä»ç„¶æœªè§£æ.<span class="built_in">sum</span>() &gt; <span class="number">0</span>:</span><br><span class="line">            æ™ºèƒ½è§£æ = pd.to_datetime(df.loc[ä»ç„¶æœªè§£æ, <span class="string">&#x27;æ³¨å†Œæ—¥æœŸ&#x27;</span>], errors=<span class="string">&#x27;coerce&#x27;</span>)</span><br><span class="line">            df.loc[ä»ç„¶æœªè§£æ, <span class="string">&#x27;æ³¨å†Œæ—¥æœŸ_æ ‡å‡†åŒ–&#x27;</span>] = æ™ºèƒ½è§£æ</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¯¹ä»ç„¶æ— æ•ˆçš„æ—¥æœŸæä¾›é»˜è®¤å€¼</span></span><br><span class="line">        æœ€ç»ˆæ— æ•ˆ = df[<span class="string">&#x27;æ³¨å†Œæ—¥æœŸ_æ ‡å‡†åŒ–&#x27;</span>].isnull() &amp; (df[<span class="string">&#x27;æ³¨å†Œæ—¥æœŸ&#x27;</span>].notnull())</span><br><span class="line">        <span class="keyword">if</span> æœ€ç»ˆæ— æ•ˆ.<span class="built_in">sum</span>() &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="comment"># ä½¿ç”¨å½“å‰æ—¥æœŸä½œä¸ºé»˜è®¤å€¼</span></span><br><span class="line">            df.loc[æœ€ç»ˆæ— æ•ˆ, <span class="string">&#x27;æ³¨å†Œæ—¥æœŸ_æ ‡å‡†åŒ–&#x27;</span>] = datetime.now().date()</span><br><span class="line">            df.loc[æœ€ç»ˆæ— æ•ˆ, <span class="string">&#x27;æ—¥æœŸé”™è¯¯æ ‡è®°&#x27;</span>] = <span class="string">&#x27;ä½¿ç”¨é»˜è®¤å€¼&#x27;</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> df</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_ä¿¡ç”¨ç­‰çº§æ ‡å‡†åŒ–</span>(<span class="params">self, df</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ä¿¡ç”¨ç­‰çº§æ ‡å‡†åŒ–&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;ä¿¡ç”¨ç­‰çº§&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> df.columns:</span><br><span class="line">            <span class="keyword">return</span> df</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å®šä¹‰æ ‡å‡†ä¿¡ç”¨ç­‰çº§</span></span><br><span class="line">        æ ‡å‡†ç­‰çº§ = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç»Ÿä¸€æ ¼å¼</span></span><br><span class="line">        df[<span class="string">&#x27;ä¿¡ç”¨ç­‰çº§&#x27;</span>] = df[<span class="string">&#x27;ä¿¡ç”¨ç­‰çº§&#x27;</span>].astype(<span class="built_in">str</span>).<span class="built_in">str</span>.upper().<span class="built_in">str</span>.strip()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¤„ç†éæ ‡å‡†ç­‰çº§</span></span><br><span class="line">        éæ ‡å‡†ç­‰çº§ = ~df[<span class="string">&#x27;ä¿¡ç”¨ç­‰çº§&#x27;</span>].isin(æ ‡å‡†ç­‰çº§)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ ¹æ®å®¢æˆ·å†å²æ¨æ–­ç­‰çº§ï¼ˆè¿™é‡Œç®€åŒ–å¤„ç†ï¼‰</span></span><br><span class="line">        <span class="comment"># åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¯ä»¥åŸºäºå®¢æˆ·çš„å†å²äº¤æ˜“æ•°æ®æ¨æ–­</span></span><br><span class="line">        df.loc[éæ ‡å‡†ç­‰çº§, <span class="string">&#x27;ä¿¡ç”¨ç­‰çº§&#x27;</span>] = <span class="string">&#x27;C&#x27;</span>  <span class="comment"># é»˜è®¤Cçº§</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> df</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_åº”æ”¶è´¦æ¬¾æ ‡å‡†åŒ–</span>(<span class="params">self, df</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;åº”æ”¶è´¦æ¬¾æ ‡å‡†åŒ–&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;åº”æ”¶è´¦æ¬¾&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> df.columns:</span><br><span class="line">            <span class="keyword">return</span> df</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è½¬æ¢ä¸ºæ•°å€¼ç±»å‹</span></span><br><span class="line">        df[<span class="string">&#x27;åº”æ”¶è´¦æ¬¾_æ•°å€¼&#x27;</span>] = pd.to_numeric(df[<span class="string">&#x27;åº”æ”¶è´¦æ¬¾&#x27;</span>], errors=<span class="string">&#x27;coerce&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¤„ç†å¼‚å¸¸å€¼</span></span><br><span class="line">        <span class="comment"># è´Ÿæ•°åº”æ”¶è´¦æ¬¾ï¼ˆé¢„æ”¶è´¦æ¬¾ï¼‰</span></span><br><span class="line">        è´Ÿæ•° = df[<span class="string">&#x27;åº”æ”¶è´¦æ¬¾_æ•°å€¼&#x27;</span>] &lt; <span class="number">0</span></span><br><span class="line">        df.loc[è´Ÿæ•°, <span class="string">&#x27;è´¦æ¬¾ç±»å‹&#x27;</span>] = <span class="string">&#x27;é¢„æ”¶è´¦æ¬¾&#x27;</span></span><br><span class="line">        df.loc[è´Ÿæ•°, <span class="string">&#x27;åº”æ”¶è´¦æ¬¾_æ ‡å‡†åŒ–&#x27;</span>] = <span class="built_in">abs</span>(df.loc[è´Ÿæ•°, <span class="string">&#x27;åº”æ”¶è´¦æ¬¾_æ•°å€¼&#x27;</span>])</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è¿‡å¤§çš„æ•°å€¼ï¼ˆå¯èƒ½éœ€è¦éªŒè¯ï¼‰</span></span><br><span class="line">        è¿‡å¤§æ•°å€¼ = df[<span class="string">&#x27;åº”æ”¶è´¦æ¬¾_æ•°å€¼&#x27;</span>] &gt; <span class="number">1000000</span>  <span class="comment"># è¶…è¿‡100ä¸‡</span></span><br><span class="line">        df.loc[è¿‡å¤§æ•°å€¼, <span class="string">&#x27;æ•°å€¼å¼‚å¸¸æ ‡è®°&#x27;</span>] = <span class="string">&#x27;é‡‘é¢è¿‡å¤§éœ€æ ¸å®&#x27;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ­£å¸¸åº”æ”¶è´¦æ¬¾</span></span><br><span class="line">        æ­£å¸¸æ•°å€¼ = (df[<span class="string">&#x27;åº”æ”¶è´¦æ¬¾_æ•°å€¼&#x27;</span>] &gt;= <span class="number">0</span>) &amp; (df[<span class="string">&#x27;åº”æ”¶è´¦æ¬¾_æ•°å€¼&#x27;</span>] &lt;= <span class="number">1000000</span>)</span><br><span class="line">        df.loc[æ­£å¸¸æ•°å€¼, <span class="string">&#x27;åº”æ”¶è´¦æ¬¾_æ ‡å‡†åŒ–&#x27;</span>] = df.loc[æ­£å¸¸æ•°å€¼, <span class="string">&#x27;åº”æ”¶è´¦æ¬¾_æ•°å€¼&#x27;</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç¼ºå¤±å€¼å¤„ç†</span></span><br><span class="line">        ç¼ºå¤±å€¼ = df[<span class="string">&#x27;åº”æ”¶è´¦æ¬¾_æ•°å€¼&#x27;</span>].isnull()</span><br><span class="line">        df.loc[ç¼ºå¤±å€¼, <span class="string">&#x27;åº”æ”¶è´¦æ¬¾_æ ‡å‡†åŒ–&#x27;</span>] = <span class="number">0</span></span><br><span class="line">        df.loc[ç¼ºå¤±å€¼, <span class="string">&#x27;è´¦æ¬¾ç±»å‹&#x27;</span>] = <span class="string">&#x27;æ— åº”æ”¶è´¦æ¬¾&#x27;</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> df</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_æ•°æ®éªŒè¯</span>(<span class="params">self, df</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æ•°æ®éªŒè¯&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># åˆ›å»ºéªŒè¯ç»“æœåˆ—</span></span><br><span class="line">        df[<span class="string">&#x27;æ•°æ®è´¨é‡è¯„åˆ†&#x27;</span>] = <span class="number">100</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç”µè¯æœ‰æ•ˆæ€§æ‰£åˆ†</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;ç”µè¯æœ‰æ•ˆæ€§&#x27;</span> <span class="keyword">in</span> df.columns:</span><br><span class="line">            æ— æ•ˆç”µè¯ = ~df[<span class="string">&#x27;ç”µè¯æœ‰æ•ˆæ€§&#x27;</span>]</span><br><span class="line">            df.loc[æ— æ•ˆç”µè¯, <span class="string">&#x27;æ•°æ®è´¨é‡è¯„åˆ†&#x27;</span>] -= <span class="number">20</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># é‚®ç®±æœ‰æ•ˆæ€§æ‰£åˆ†</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;é‚®ç®±æœ‰æ•ˆæ€§&#x27;</span> <span class="keyword">in</span> df.columns:</span><br><span class="line">            æ— æ•ˆé‚®ç®± = ~df[<span class="string">&#x27;é‚®ç®±æœ‰æ•ˆæ€§&#x27;</span>]</span><br><span class="line">            df.loc[æ— æ•ˆé‚®ç®±, <span class="string">&#x27;æ•°æ®è´¨é‡è¯„åˆ†&#x27;</span>] -= <span class="number">15</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ—¥æœŸæœ‰æ•ˆæ€§æ‰£åˆ†</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;æ—¥æœŸé”™è¯¯æ ‡è®°&#x27;</span> <span class="keyword">in</span> df.columns:</span><br><span class="line">            æ—¥æœŸé”™è¯¯ = df[<span class="string">&#x27;æ—¥æœŸé”™è¯¯æ ‡è®°&#x27;</span>].notnull()</span><br><span class="line">            df.loc[æ—¥æœŸé”™è¯¯, <span class="string">&#x27;æ•°æ®è´¨é‡è¯„åˆ†&#x27;</span>] -= <span class="number">10</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ•°æ®è´¨é‡åˆ†çº§</span></span><br><span class="line">        df[<span class="string">&#x27;æ•°æ®è´¨é‡ç­‰çº§&#x27;</span>] = pd.cut(df[<span class="string">&#x27;æ•°æ®è´¨é‡è¯„åˆ†&#x27;</span>], </span><br><span class="line">                                    bins=[<span class="number">0</span>, <span class="number">60</span>, <span class="number">80</span>, <span class="number">90</span>, <span class="number">100</span>], </span><br><span class="line">                                    labels=[<span class="string">&#x27;å·®&#x27;</span>, <span class="string">&#x27;ä¸€èˆ¬&#x27;</span>, <span class="string">&#x27;è‰¯å¥½&#x27;</span>, <span class="string">&#x27;ä¼˜ç§€&#x27;</span>])</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> df</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨é«˜çº§æ¸…æ´—å™¨</span></span><br><span class="line">é«˜çº§æ¸…æ´—å™¨ = é«˜çº§å®¢æˆ·ä¿¡æ¯æ¸…æ´—å™¨()</span><br><span class="line">å®¢æˆ·ä¿¡æ¯_é«˜çº§æ¸…æ´— = é«˜çº§æ¸…æ´—å™¨.æ¸…æ´—å®¢æˆ·ä¿¡æ¯(å®¢æˆ·ä¿¡æ¯.copy())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\né«˜çº§æ¸…æ´—ç»“æœç¤ºä¾‹ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(å®¢æˆ·ä¿¡æ¯_é«˜çº§æ¸…æ´—[[<span class="string">&#x27;å®¢æˆ·ID&#x27;</span>, <span class="string">&#x27;å®¢æˆ·åç§°&#x27;</span>, <span class="string">&#x27;è”ç³»ç”µè¯_æ ‡å‡†åŒ–&#x27;</span>, <span class="string">&#x27;ç”µè¯æœ‰æ•ˆæ€§&#x27;</span>, <span class="string">&#x27;é‚®ç®±æœ‰æ•ˆæ€§&#x27;</span>, <span class="string">&#x27;æ•°æ®è´¨é‡è¯„åˆ†&#x27;</span>]].head())</span><br></pre></td></tr></table></figure></details><details><summary>ç‰ˆæœ¬3.0ï¼šä¸“ä¸šæ•°æ®æ¸…æ´—ç³»ç»Ÿ</summary><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸“ä¸šæ•°æ®æ¸…æ´—ç³»ç»Ÿ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n=== ä¸“ä¸šæ•°æ®æ¸…æ´—ç³»ç»Ÿ ===&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.impute <span class="keyword">import</span> SimpleImputer</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler, LabelEncoder</span><br><span class="line"><span class="keyword">import</span> joblib</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ä¸“ä¸šæ•°æ®æ¸…æ´—ç³»ç»Ÿ</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.æ¸…æ´—è§„åˆ™ = &#123;&#125;</span><br><span class="line">        self.æ¸…æ´—æ¨¡å‹ = &#123;&#125;</span><br><span class="line">        self.æ¸…æ´—å†å² = []</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">åˆ†ææ•°æ®è´¨é‡</span>(<span class="params">self, df</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;å…¨é¢åˆ†ææ•°æ®è´¨é‡&quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ğŸ” åˆ†ææ•°æ®è´¨é‡...&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        è´¨é‡æŠ¥å‘Š = &#123;</span><br><span class="line">            <span class="string">&#x27;æ€»ä½“æƒ…å†µ&#x27;</span>: &#123;&#125;,</span><br><span class="line">            <span class="string">&#x27;ç¼ºå¤±å€¼åˆ†æ&#x27;</span>: &#123;&#125;,</span><br><span class="line">            <span class="string">&#x27;å¼‚å¸¸å€¼åˆ†æ&#x27;</span>: &#123;&#125;,</span><br><span class="line">            <span class="string">&#x27;æ ¼å¼ä¸€è‡´æ€§&#x27;</span>: &#123;&#125;,</span><br><span class="line">            <span class="string">&#x27;é‡å¤æ•°æ®&#x27;</span>: &#123;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ€»ä½“æƒ…å†µ</span></span><br><span class="line">        è´¨é‡æŠ¥å‘Š[<span class="string">&#x27;æ€»ä½“æƒ…å†µ&#x27;</span>] = &#123;</span><br><span class="line">            <span class="string">&#x27;æ•°æ®å½¢çŠ¶&#x27;</span>: df.shape,</span><br><span class="line">            <span class="string">&#x27;åˆ—æ•°&#x27;</span>: <span class="built_in">len</span>(df.columns),</span><br><span class="line">            <span class="string">&#x27;è¡Œæ•°&#x27;</span>: <span class="built_in">len</span>(df),</span><br><span class="line">            <span class="string">&#x27;å†…å­˜ä½¿ç”¨&#x27;</span>: df.memory_usage(deep=<span class="literal">True</span>).<span class="built_in">sum</span>()</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç¼ºå¤±å€¼åˆ†æ</span></span><br><span class="line">        ç¼ºå¤±ç»Ÿè®¡ = df.isnull().<span class="built_in">sum</span>()</span><br><span class="line">        ç¼ºå¤±æ¯”ä¾‹ = (ç¼ºå¤±ç»Ÿè®¡ / <span class="built_in">len</span>(df) * <span class="number">100</span>).<span class="built_in">round</span>(<span class="number">2</span>)</span><br><span class="line">        </span><br><span class="line">        è´¨é‡æŠ¥å‘Š[<span class="string">&#x27;ç¼ºå¤±å€¼åˆ†æ&#x27;</span>] = &#123;</span><br><span class="line">            <span class="string">&#x27;æ€»ç¼ºå¤±å€¼&#x27;</span>: ç¼ºå¤±ç»Ÿè®¡.<span class="built_in">sum</span>(),</span><br><span class="line">            <span class="string">&#x27;ç¼ºå¤±å€¼æ¯”ä¾‹&#x27;</span>: ç¼ºå¤±æ¯”ä¾‹.to_dict(),</span><br><span class="line">            <span class="string">&#x27;å®Œå…¨ç¼ºå¤±çš„è¡Œ&#x27;</span>: df.isnull().<span class="built_in">all</span>(axis=<span class="number">1</span>).<span class="built_in">sum</span>(),</span><br><span class="line">            <span class="string">&#x27;ä»»ä½•ç¼ºå¤±çš„è¡Œ&#x27;</span>: df.isnull().<span class="built_in">any</span>(axis=<span class="number">1</span>).<span class="built_in">sum</span>()</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¼‚å¸¸å€¼åˆ†æï¼ˆä½¿ç”¨IQRæ–¹æ³•ï¼‰</span></span><br><span class="line">        æ•°å€¼åˆ— = df.select_dtypes(include=[np.number]).columns</span><br><span class="line">        å¼‚å¸¸å€¼ç»Ÿè®¡ = &#123;&#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> åˆ—å <span class="keyword">in</span> æ•°å€¼åˆ—:</span><br><span class="line">            Q1 = df[åˆ—å].quantile(<span class="number">0.25</span>)</span><br><span class="line">            Q3 = df[åˆ—å].quantile(<span class="number">0.75</span>)</span><br><span class="line">            IQR = Q3 - Q1</span><br><span class="line">            ä¸‹é™ = Q1 - <span class="number">1.5</span> * IQR</span><br><span class="line">            ä¸Šé™ = Q3 + <span class="number">1.5</span> * IQR</span><br><span class="line">            </span><br><span class="line">            å¼‚å¸¸å€¼ = df[(df[åˆ—å] &lt; ä¸‹é™) | (df[åˆ—å] &gt; ä¸Šé™)][åˆ—å]</span><br><span class="line">            å¼‚å¸¸å€¼ç»Ÿè®¡[åˆ—å] = &#123;</span><br><span class="line">                <span class="string">&#x27;å¼‚å¸¸å€¼æ•°é‡&#x27;</span>: <span class="built_in">len</span>(å¼‚å¸¸å€¼),</span><br><span class="line">                <span class="string">&#x27;å¼‚å¸¸å€¼æ¯”ä¾‹&#x27;</span>: <span class="built_in">len</span>(å¼‚å¸¸å€¼) / <span class="built_in">len</span>(df) * <span class="number">100</span>,</span><br><span class="line">                <span class="string">&#x27;ä¸‹é™&#x27;</span>: ä¸‹é™,</span><br><span class="line">                <span class="string">&#x27;ä¸Šé™&#x27;</span>: ä¸Šé™</span><br><span class="line">            &#125;</span><br><span class="line">        </span><br><span class="line">        è´¨é‡æŠ¥å‘Š[<span class="string">&#x27;å¼‚å¸¸å€¼åˆ†æ&#x27;</span>] = å¼‚å¸¸å€¼ç»Ÿè®¡</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># é‡å¤æ•°æ®</span></span><br><span class="line">        å®Œå…¨é‡å¤ = df.duplicated().<span class="built_in">sum</span>()</span><br><span class="line">        éƒ¨åˆ†é‡å¤ = df.duplicated(subset=df.columns[:<span class="number">3</span>]).<span class="built_in">sum</span>()  <span class="comment"># æ£€æŸ¥å‰3åˆ—</span></span><br><span class="line">        </span><br><span class="line">        è´¨é‡æŠ¥å‘Š[<span class="string">&#x27;é‡å¤æ•°æ®&#x27;</span>] = &#123;</span><br><span class="line">            <span class="string">&#x27;å®Œå…¨é‡å¤è¡Œ&#x27;</span>: å®Œå…¨é‡å¤,</span><br><span class="line">            <span class="string">&#x27;éƒ¨åˆ†é‡å¤è¡Œ&#x27;</span>: éƒ¨åˆ†é‡å¤ - å®Œå…¨é‡å¤,</span><br><span class="line">            <span class="string">&#x27;é‡å¤ç‡&#x27;</span>: (å®Œå…¨é‡å¤ + <span class="built_in">max</span>(<span class="number">0</span>, éƒ¨åˆ†é‡å¤ - å®Œå…¨é‡å¤)) / <span class="built_in">len</span>(df) * <span class="number">100</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> è´¨é‡æŠ¥å‘Š</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">æ™ºèƒ½æ¸…æ´—</span>(<span class="params">self, df, æ¸…æ´—é…ç½®=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æ™ºèƒ½æ•°æ®æ¸…æ´—&quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ğŸ¤– å¼€å§‹æ™ºèƒ½æ•°æ®æ¸…æ´—...&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> æ¸…æ´—é…ç½® <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            æ¸…æ´—é…ç½® = self._ç”Ÿæˆé»˜è®¤æ¸…æ´—é…ç½®(df)</span><br><span class="line">        </span><br><span class="line">        df_æ¸…æ´— = df.copy()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 1. æ ¹æ®æ•°æ®ç±»å‹è‡ªåŠ¨é€‰æ‹©æ¸…æ´—ç­–ç•¥</span></span><br><span class="line">        <span class="keyword">for</span> åˆ—å <span class="keyword">in</span> df.columns:</span><br><span class="line">            æ•°æ®ç±»å‹ = df[åˆ—å].dtype</span><br><span class="line">            å”¯ä¸€å€¼æ•°é‡ = df[åˆ—å].nunique()</span><br><span class="line">            ç¼ºå¤±æ¯”ä¾‹ = df[åˆ—å].isnull().<span class="built_in">sum</span>() / <span class="built_in">len</span>(df)</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  å¤„ç†åˆ—ï¼š<span class="subst">&#123;åˆ—å&#125;</span>ï¼ˆç±»å‹ï¼š<span class="subst">&#123;æ•°æ®ç±»å‹&#125;</span>ï¼Œç¼ºå¤±ç‡ï¼š<span class="subst">&#123;ç¼ºå¤±æ¯”ä¾‹:<span class="number">.1</span>%&#125;</span>ï¼‰&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> pd.api.types.is_numeric_dtype(df[åˆ—å]):</span><br><span class="line">                df_æ¸…æ´— = self._æ¸…æ´—æ•°å€¼åˆ—(df_æ¸…æ´—, åˆ—å, ç¼ºå¤±æ¯”ä¾‹)</span><br><span class="line">            <span class="keyword">elif</span> pd.api.types.is_datetime64_dtype(df[åˆ—å]):</span><br><span class="line">                df_æ¸…æ´— = self._æ¸…æ´—æ—¥æœŸåˆ—(df_æ¸…æ´—, åˆ—å, ç¼ºå¤±æ¯”ä¾‹)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                df_æ¸…æ´— = self._æ¸…æ´—æ–‡æœ¬åˆ—(df_æ¸…æ´—, åˆ—å, å”¯ä¸€å€¼æ•°é‡, ç¼ºå¤±æ¯”ä¾‹)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 2. é«˜çº§æ¸…æ´—æŠ€æœ¯</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  åº”ç”¨é«˜çº§æ¸…æ´—æŠ€æœ¯...&quot;</span>)</span><br><span class="line">        df_æ¸…æ´— = self._é«˜çº§æ¸…æ´—æŠ€æœ¯(df_æ¸…æ´—)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 3. æ•°æ®éªŒè¯</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  éªŒè¯æ¸…æ´—ç»“æœ...&quot;</span>)</span><br><span class="line">        éªŒè¯ç»“æœ = self._éªŒè¯æ¸…æ´—ç»“æœ(df, df_æ¸…æ´—)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;âœ… æ™ºèƒ½æ¸…æ´—å®Œæˆï¼&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> df_æ¸…æ´—, éªŒè¯ç»“æœ</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_ç”Ÿæˆé»˜è®¤æ¸…æ´—é…ç½®</span>(<span class="params">self, df</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æ ¹æ®æ•°æ®ç‰¹å¾ç”Ÿæˆé»˜è®¤æ¸…æ´—é…ç½®&quot;&quot;&quot;</span></span><br><span class="line">        é…ç½® = &#123;&#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> åˆ—å <span class="keyword">in</span> df.columns:</span><br><span class="line">            ç¼ºå¤±æ¯”ä¾‹ = df[åˆ—å].isnull().<span class="built_in">sum</span>() / <span class="built_in">len</span>(df)</span><br><span class="line">            æ•°æ®ç±»å‹ = df[åˆ—å].dtype</span><br><span class="line">            </span><br><span class="line">            é…ç½®[åˆ—å] = &#123;</span><br><span class="line">                <span class="string">&#x27;ç¼ºå¤±å€¼å¤„ç†&#x27;</span>: <span class="string">&#x27;æ™ºèƒ½å¡«å……&#x27;</span> <span class="keyword">if</span> ç¼ºå¤±æ¯”ä¾‹ &lt; <span class="number">0.3</span> <span class="keyword">else</span> <span class="string">&#x27;åˆ é™¤è¡Œ&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;å¼‚å¸¸å€¼å¤„ç†&#x27;</span>: <span class="string">&#x27;æ ‡è®°&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;æ ¼å¼æ ‡å‡†åŒ–&#x27;</span>: <span class="literal">True</span>,</span><br><span class="line">                <span class="string">&#x27;æ•°æ®éªŒè¯&#x27;</span>: <span class="literal">True</span></span><br><span class="line">            &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> é…ç½®</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_æ¸…æ´—æ•°å€¼åˆ—</span>(<span class="params">self, df, åˆ—å, ç¼ºå¤±æ¯”ä¾‹</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æ¸…æ´—æ•°å€¼åˆ—&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># è½¬æ¢ä¸ºæ•°å€¼ç±»å‹</span></span><br><span class="line">        df[åˆ—å] = pd.to_numeric(df[åˆ—å], errors=<span class="string">&#x27;coerce&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¤„ç†ç¼ºå¤±å€¼</span></span><br><span class="line">        <span class="keyword">if</span> ç¼ºå¤±æ¯”ä¾‹ &lt; <span class="number">0.1</span>:  <span class="comment"># ç¼ºå¤±ç‡å°äº10%ï¼Œç”¨ä¸­ä½æ•°å¡«å……</span></span><br><span class="line">            ä¸­ä½æ•° = df[åˆ—å].median()</span><br><span class="line">            df[åˆ—å] = df[åˆ—å].fillna(ä¸­ä½æ•°)</span><br><span class="line">        <span class="keyword">elif</span> ç¼ºå¤±æ¯”ä¾‹ &lt; <span class="number">0.3</span>:  <span class="comment"># ç¼ºå¤±ç‡10-30%ï¼Œç”¨å‡å€¼å¡«å……</span></span><br><span class="line">            å‡å€¼ = df[åˆ—å].mean()</span><br><span class="line">            df[åˆ—å] = df[åˆ—å].fillna(å‡å€¼)</span><br><span class="line">        <span class="keyword">else</span>:  <span class="comment"># ç¼ºå¤±ç‡å¤§äº30%ï¼Œåˆ›å»ºæŒ‡ç¤ºå˜é‡</span></span><br><span class="line">            df[<span class="string">f&#x27;<span class="subst">&#123;åˆ—å&#125;</span>_æ˜¯å¦ç¼ºå¤±&#x27;</span>] = df[åˆ—å].isnull()</span><br><span class="line">            df[åˆ—å] = df[åˆ—å].fillna(<span class="number">0</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¤„ç†å¼‚å¸¸å€¼</span></span><br><span class="line">        Q1 = df[åˆ—å].quantile(<span class="number">0.25</span>)</span><br><span class="line">        Q3 = df[åˆ—å].quantile(<span class="number">0.75</span>)</span><br><span class="line">        IQR = Q3 - Q1</span><br><span class="line">        ä¸‹é™ = Q1 - <span class="number">1.5</span> * IQR</span><br><span class="line">        ä¸Šé™ = Q3 + <span class="number">1.5</span> * IQR</span><br><span class="line">        </span><br><span class="line">        å¼‚å¸¸å€¼ = (df[åˆ—å] &lt; ä¸‹é™) | (df[åˆ—å] &gt; ä¸Šé™)</span><br><span class="line">        <span class="keyword">if</span> å¼‚å¸¸å€¼.<span class="built_in">sum</span>() &gt; <span class="number">0</span>:</span><br><span class="line">            df[<span class="string">f&#x27;<span class="subst">&#123;åˆ—å&#125;</span>_å¼‚å¸¸æ ‡è®°&#x27;</span>] = å¼‚å¸¸å€¼</span><br><span class="line">            <span class="comment"># ç”¨è¾¹ç•Œå€¼æ›¿æ¢å¼‚å¸¸å€¼</span></span><br><span class="line">            df.loc[df[åˆ—å] &lt; ä¸‹é™, åˆ—å] = ä¸‹é™</span><br><span class="line">            df.loc[df[åˆ—å] &gt; ä¸Šé™, åˆ—å] = ä¸Šé™</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> df</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_æ¸…æ´—æ—¥æœŸåˆ—</span>(<span class="params">self, df, åˆ—å, ç¼ºå¤±æ¯”ä¾‹</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æ¸…æ´—æ—¥æœŸåˆ—&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># å°è¯•å¤šç§æ—¥æœŸæ ¼å¼</span></span><br><span class="line">        æ—¥æœŸæ ¼å¼åˆ—è¡¨ = [</span><br><span class="line">            <span class="string">&#x27;%Y-%m-%d&#x27;</span>, <span class="string">&#x27;%Y/%m/%d&#x27;</span>, <span class="string">&#x27;%Y.%m.%d&#x27;</span>, <span class="string">&#x27;%d-%b-%Y&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;%d %b %Y&#x27;</span>, <span class="string">&#x27;%Yå¹´%mæœˆ%dæ—¥&#x27;</span>, <span class="string">&#x27;%m/%d/%Y&#x27;</span>, <span class="string">&#x27;%Y%m%d&#x27;</span></span><br><span class="line">        ]</span><br><span class="line">        </span><br><span class="line">        æˆåŠŸè§£æ = pd.Series([<span class="literal">False</span>] * <span class="built_in">len</span>(df))</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> æ—¥æœŸæ ¼å¼ <span class="keyword">in</span> æ—¥æœŸæ ¼å¼åˆ—è¡¨:</span><br><span class="line">            æœªè§£æ = ~æˆåŠŸè§£æ &amp; df[åˆ—å].notnull()</span><br><span class="line">            <span class="keyword">if</span> æœªè§£æ.<span class="built_in">sum</span>() == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                è§£æç»“æœ = pd.to_datetime(df.loc[æœªè§£æ, åˆ—å], <span class="built_in">format</span>=æ—¥æœŸæ ¼å¼, errors=<span class="string">&#x27;coerce&#x27;</span>)</span><br><span class="line">                æœ‰æ•ˆè§£æ = è§£æç»“æœ.notnull()</span><br><span class="line">                df.loc[æœªè§£æ &amp; æœ‰æ•ˆè§£æ, åˆ—å] = è§£æç»“æœ[æœ‰æ•ˆè§£æ]</span><br><span class="line">                æˆåŠŸè§£æ |= æœ‰æ•ˆè§£æ</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¯¹æ— æ³•è§£æçš„ä½¿ç”¨æ™ºèƒ½è§£æ</span></span><br><span class="line">        ä»ç„¶æœªè§£æ = ~æˆåŠŸè§£æ &amp; df[åˆ—å].notnull()</span><br><span class="line">        <span class="keyword">if</span> ä»ç„¶æœªè§£æ.<span class="built_in">sum</span>() &gt; <span class="number">0</span>:</span><br><span class="line">            æ™ºèƒ½ç»“æœ = pd.to_datetime(df.loc[ä»ç„¶æœªè§£æ, åˆ—å], errors=<span class="string">&#x27;coerce&#x27;</span>)</span><br><span class="line">            df.loc[ä»ç„¶æœªè§£æ, åˆ—å] = æ™ºèƒ½ç»“æœ</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¤„ç†ç¼ºå¤±å€¼</span></span><br><span class="line">        <span class="keyword">if</span> ç¼ºå¤±æ¯”ä¾‹ &lt; <span class="number">0.2</span>:</span><br><span class="line">            <span class="comment"># ç”¨ä¸­ä½æ•°æ—¥æœŸå¡«å……ï¼ˆå¯¹äºæ—¶é—´åºåˆ—ï¼‰</span></span><br><span class="line">            df[åˆ—å] = pd.to_datetime(df[åˆ—å])</span><br><span class="line">            ä¸­ä½æ•°æ—¥æœŸ = df[åˆ—å].dropna().quantile(<span class="number">0.5</span>)</span><br><span class="line">            df[åˆ—å] = df[åˆ—å].fillna(ä¸­ä½æ•°æ—¥æœŸ)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># ç”¨å½“å‰æ—¥æœŸå¡«å……</span></span><br><span class="line">            df[åˆ—å] = pd.to_datetime(df[åˆ—å])</span><br><span class="line">            df[åˆ—å] = df[åˆ—å].fillna(datetime.now())</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> df</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_æ¸…æ´—æ–‡æœ¬åˆ—</span>(<span class="params">self, df, åˆ—å, å”¯ä¸€å€¼æ•°é‡, ç¼ºå¤±æ¯”ä¾‹</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æ¸…æ´—æ–‡æœ¬åˆ—&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># å»é™¤ç©ºç™½å­—ç¬¦</span></span><br><span class="line">        df[åˆ—å] = df[åˆ—å].astype(<span class="built_in">str</span>).<span class="built_in">str</span>.strip()</span><br><span class="line">        df[åˆ—å] = df[åˆ—å].<span class="built_in">str</span>.replace(<span class="string">r&#x27;\s+&#x27;</span>, <span class="string">&#x27; &#x27;</span>, regex=<span class="literal">True</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¤„ç†ç¼ºå¤±å€¼</span></span><br><span class="line">        <span class="keyword">if</span> ç¼ºå¤±æ¯”ä¾‹ &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> å”¯ä¸€å€¼æ•°é‡ &lt; <span class="number">20</span>:  <span class="comment"># åˆ†ç±»å˜é‡</span></span><br><span class="line">                <span class="comment"># ç”¨ä¼—æ•°å¡«å……</span></span><br><span class="line">                ä¼—æ•° = df[åˆ—å].mode()[<span class="number">0</span>] <span class="keyword">if</span> <span class="built_in">len</span>(df[åˆ—å].mode()) &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;æœªçŸ¥&#x27;</span></span><br><span class="line">                df[åˆ—å] = df[åˆ—å].fillna(ä¼—æ•°)</span><br><span class="line">            <span class="keyword">else</span>:  <span class="comment"># æ–‡æœ¬å˜é‡</span></span><br><span class="line">                df[åˆ—å] = df[åˆ—å].fillna(<span class="string">&#x27;å¾…è¡¥å……&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ ‡å‡†åŒ–å¤„ç†</span></span><br><span class="line">        <span class="keyword">if</span> åˆ—å == <span class="string">&#x27;çŠ¶æ€&#x27;</span>:</span><br><span class="line">            df[åˆ—å] = df[åˆ—å].<span class="built_in">str</span>.title()</span><br><span class="line">        <span class="keyword">elif</span> åˆ—å == <span class="string">&#x27;ä¿¡ç”¨ç­‰çº§&#x27;</span>:</span><br><span class="line">            <span class="comment"># æ ‡å‡†åŒ–ä¿¡ç”¨ç­‰çº§</span></span><br><span class="line">            æœ‰æ•ˆç­‰çº§ = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>]</span><br><span class="line">            æ— æ•ˆç­‰çº§ = ~df[åˆ—å].isin(æœ‰æ•ˆç­‰çº§)</span><br><span class="line">            df.loc[æ— æ•ˆç­‰çº§, åˆ—å] = <span class="string">&#x27;C&#x27;</span>  <span class="comment"># é»˜è®¤Cçº§</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> df</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_é«˜çº§æ¸…æ´—æŠ€æœ¯</span>(<span class="params">self, df</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;é«˜çº§æ¸…æ´—æŠ€æœ¯&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 1. é‡å¤æ•°æ®å¤„ç†</span></span><br><span class="line">        é‡å¤æ©ç  = df.duplicated()</span><br><span class="line">        <span class="keyword">if</span> é‡å¤æ©ç .<span class="built_in">sum</span>() &gt; <span class="number">0</span>:</span><br><span class="line">            df[<span class="string">&#x27;æ˜¯å¦é‡å¤&#x27;</span>] = é‡å¤æ©ç </span><br><span class="line">            df = df.drop_duplicates()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 2. åŸºäºæœºå™¨å­¦ä¹ çš„ç¼ºå¤±å€¼å¡«å……ï¼ˆç®€åŒ–ç‰ˆï¼‰</span></span><br><span class="line">        <span class="comment"># ä½¿ç”¨ç›¸å…³åˆ—é¢„æµ‹ç¼ºå¤±å€¼</span></span><br><span class="line">        æ•°å€¼åˆ— = df.select_dtypes(include=[np.number]).columns</span><br><span class="line">        <span class="keyword">for</span> åˆ—å <span class="keyword">in</span> æ•°å€¼åˆ—:</span><br><span class="line">            <span class="keyword">if</span> df[åˆ—å].isnull().<span class="built_in">sum</span>() &gt; <span class="number">0</span>:</span><br><span class="line">                <span class="comment"># ä½¿ç”¨å…¶ä»–æ•°å€¼åˆ—çš„å‡å€¼è¿›è¡Œé¢„æµ‹</span></span><br><span class="line">                å…¶ä»–åˆ— = [col <span class="keyword">for</span> col <span class="keyword">in</span> æ•°å€¼åˆ— <span class="keyword">if</span> col != åˆ—å]</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(å…¶ä»–åˆ—) &gt; <span class="number">0</span>:</span><br><span class="line">                    ç¼ºå¤±ç´¢å¼• = df[åˆ—å].isnull()</span><br><span class="line">                    é¢„æµ‹å€¼ = df.loc[ç¼ºå¤±ç´¢å¼•, å…¶ä»–åˆ—].mean(axis=<span class="number">1</span>)</span><br><span class="line">                    df.loc[ç¼ºå¤±ç´¢å¼•, åˆ—å] = é¢„æµ‹å€¼</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> df</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_éªŒè¯æ¸…æ´—ç»“æœ</span>(<span class="params">self, åŸå§‹æ•°æ®, æ¸…æ´—åæ•°æ®</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;éªŒè¯æ¸…æ´—ç»“æœ&quot;&quot;&quot;</span></span><br><span class="line">        éªŒè¯æŠ¥å‘Š = &#123;</span><br><span class="line">            <span class="string">&#x27;æ¸…æ´—æ•ˆæœ&#x27;</span>: &#123;&#125;,</span><br><span class="line">            <span class="string">&#x27;æ•°æ®è´¨é‡æå‡&#x27;</span>: &#123;&#125;,</span><br><span class="line">            <span class="string">&#x27;å»ºè®®&#x27;</span>: []</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ¸…æ´—æ•ˆæœè¯„ä¼°</span></span><br><span class="line">        åŸå§‹ç¼ºå¤±ç‡ = åŸå§‹æ•°æ®.isnull().<span class="built_in">sum</span>().<span class="built_in">sum</span>() / (åŸå§‹æ•°æ®.shape[<span class="number">0</span>] * åŸå§‹æ•°æ®.shape[<span class="number">1</span>])</span><br><span class="line">        æ¸…æ´—ç¼ºå¤±ç‡ = æ¸…æ´—å_data.isnull().<span class="built_in">sum</span>().<span class="built_in">sum</span>() / (æ¸…æ´—å_data.shape[<span class="number">0</span>] * æ¸…æ´—å_data.shape[<span class="number">1</span>])</span><br><span class="line">        </span><br><span class="line">        éªŒè¯æŠ¥å‘Š[<span class="string">&#x27;æ¸…æ´—æ•ˆæœ&#x27;</span>] = &#123;</span><br><span class="line">            <span class="string">&#x27;åŸå§‹ç¼ºå¤±ç‡&#x27;</span>: <span class="string">f&quot;<span class="subst">&#123;åŸå§‹ç¼ºå¤±ç‡:<span class="number">.2</span>%&#125;</span>&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;æ¸…æ´—ç¼ºå¤±ç‡&#x27;</span>: <span class="string">f&quot;<span class="subst">&#123;æ¸…æ´—ç¼ºå¤±ç‡:<span class="number">.2</span>%&#125;</span>&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;ç¼ºå¤±ç‡é™ä½&#x27;</span>: <span class="string">f&quot;<span class="subst">&#123;(åŸå§‹ç¼ºå¤±ç‡ - æ¸…æ´—ç¼ºå¤±ç‡):<span class="number">.2</span>%&#125;</span>&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ•°æ®è´¨é‡æå‡</span></span><br><span class="line">        åŸå§‹é‡å¤ç‡ = åŸå§‹æ•°æ®.duplicated().<span class="built_in">sum</span>() / <span class="built_in">len</span>(åŸå§‹æ•°æ®)</span><br><span class="line">        æ¸…æ´—é‡å¤ç‡ = æ¸…æ´—å_data.duplicated().<span class="built_in">sum</span>() / <span class="built_in">len</span>(æ¸…æ´—å_data)</span><br><span class="line">        </span><br><span class="line">        éªŒè¯æŠ¥å‘Š[<span class="string">&#x27;æ•°æ®è´¨é‡æå‡&#x27;</span>] = &#123;</span><br><span class="line">            <span class="string">&#x27;é‡å¤ç‡é™ä½&#x27;</span>: <span class="string">f&quot;<span class="subst">&#123;(åŸå§‹é‡å¤ç‡ - æ¸…æ´—é‡å¤ç‡):<span class="number">.2</span>%&#125;</span>&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;æ•°æ®å®Œæ•´æ€§&#x27;</span>: <span class="string">f&quot;<span class="subst">&#123;(<span class="number">1</span> - æ¸…æ´—ç¼ºå¤±ç‡):<span class="number">.2</span>%&#125;</span>&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å»ºè®®</span></span><br><span class="line">        <span class="keyword">if</span> æ¸…æ´—ç¼ºå¤±ç‡ &gt; <span class="number">0.1</span>:</span><br><span class="line">            éªŒè¯æŠ¥å‘Š[<span class="string">&#x27;å»ºè®®&#x27;</span>].append(<span class="string">&quot;ç¼ºå¤±ç‡ä»ç„¶è¾ƒé«˜ï¼Œå»ºè®®æ£€æŸ¥æ•°æ®æºè´¨é‡&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> æ¸…æ´—å_data.select_dtypes(include=[np.number]).empty:</span><br><span class="line">            éªŒè¯æŠ¥å‘Š[<span class="string">&#x27;å»ºè®®&#x27;</span>].append(<span class="string">&quot;æ²¡æœ‰æ•°å€¼å‹æ•°æ®ï¼Œå¯èƒ½ç±»å‹è½¬æ¢æœ‰é—®é¢˜&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        éªŒè¯æŠ¥å‘Š[<span class="string">&#x27;å»ºè®®&#x27;</span>].append(<span class="string">&quot;å»ºè®®å®šæœŸæ‰§è¡Œæ•°æ®æ¸…æ´—æµç¨‹&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> éªŒè¯æŠ¥å‘Š</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ä¸“ä¸šæ¸…æ´—ç³»ç»Ÿ</span></span><br><span class="line">ä¸“ä¸šç³»ç»Ÿ = ä¸“ä¸šæ•°æ®æ¸…æ´—ç³»ç»Ÿ()</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ†æåŸå§‹æ•°æ®è´¨é‡</span></span><br><span class="line">è´¨é‡æŠ¥å‘Š = ä¸“ä¸šç³»ç»Ÿ.åˆ†ææ•°æ®è´¨é‡(å®¢æˆ·ä¿¡æ¯)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ğŸ“Š æ•°æ®è´¨é‡åˆ†ææŠ¥å‘Šï¼š&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> åˆ†ç±», æ•°æ® <span class="keyword">in</span> è´¨é‡æŠ¥å‘Š.items():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n<span class="subst">&#123;åˆ†ç±»&#125;</span>ï¼š&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> é¡¹ç›®, å€¼ <span class="keyword">in</span> æ•°æ®.items():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;é¡¹ç›®&#125;</span>ï¼š<span class="subst">&#123;å€¼&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œæ™ºèƒ½æ¸…æ´—</span></span><br><span class="line">å®¢æˆ·ä¿¡æ¯_ä¸“ä¸šæ¸…æ´—, éªŒè¯ç»“æœ = ä¸“ä¸šç³»ç»Ÿ.æ™ºèƒ½æ¸…æ´—(å®¢æˆ·ä¿¡æ¯)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;\nâœ… ä¸“ä¸šæ¸…æ´—å®Œæˆï¼&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æ¸…æ´—æ•ˆæœï¼šç¼ºå¤±ç‡ä»<span class="subst">&#123;éªŒè¯ç»“æœ[<span class="string">&#x27;æ¸…æ´—æ•ˆæœ&#x27;</span>][<span class="string">&#x27;åŸå§‹ç¼ºå¤±ç‡&#x27;</span>]&#125;</span>é™ä½åˆ°<span class="subst">&#123;éªŒè¯ç»“æœ[<span class="string">&#x27;æ¸…æ´—æ•ˆæœ&#x27;</span>][<span class="string">&#x27;æ¸…æ´—ç¼ºå¤±ç‡&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿å­˜æ¸…æ´—æ¨¡å‹</span></span><br><span class="line">joblib.dump(ä¸“ä¸šç³»ç»Ÿ, <span class="string">&#x27;å®¢æˆ·ä¿¡æ¯æ¸…æ´—æ¨¡å‹.pkl&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;âœ… æ¸…æ´—æ¨¡å‹å·²ä¿å­˜ï¼&quot;</span>)</span><br></pre></td></tr></table></figure></details><hr><h3 id="ğŸƒâ€â™€ï¸-è¿›é˜¶å°æŒ‘æˆ˜"><a href="#ğŸƒâ€â™€ï¸-è¿›é˜¶å°æŒ‘æˆ˜" class="headerlink" title="ğŸƒâ€â™€ï¸ è¿›é˜¶å°æŒ‘æˆ˜"></a>ğŸƒâ€â™€ï¸ è¿›é˜¶å°æŒ‘æˆ˜</h3><details><summary>æŒ‘æˆ˜1ï¼šå‘ç¥¨æ•°æ®æ¸…æ´—</summary><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‘ç¥¨æ•°æ®æ¸…æ´—æŒ‘æˆ˜</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=== å‘ç¥¨æ•°æ®æ¸…æ´—æŒ‘æˆ˜ ===&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå¤æ‚çš„å‘ç¥¨æ•°æ®</span></span><br><span class="line">å‘ç¥¨æ•°æ® = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;å‘ç¥¨å·ç &#x27;</span>: [<span class="string">&#x27;12345678&#x27;</span>, <span class="string">&#x27;87654321&#x27;</span>, <span class="string">&#x27;ABCD1234&#x27;</span>, <span class="string">&#x27;1234567&#x27;</span>, <span class="string">&#x27;1234567890123&#x27;</span>, <span class="literal">None</span>, <span class="string">&#x27;12345678&#x27;</span>, <span class="string">&#x27;87654322&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;å¼€ç¥¨æ—¥æœŸ&#x27;</span>: [<span class="string">&#x27;2024-01-01&#x27;</span>, <span class="string">&#x27;2024/01/02&#x27;</span>, <span class="string">&#x27;2024.01.03&#x27;</span>, <span class="string">&#x27;01-Jan-2024&#x27;</span>, <span class="string">&#x27;20240105&#x27;</span>, <span class="string">&#x27;2024å¹´1æœˆ6æ—¥&#x27;</span>, <span class="literal">None</span>, <span class="string">&#x27;2024-01-08&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;è´­ä¹°æ–¹åç§°&#x27;</span>: [<span class="string">&#x27;  å¼ ä¸‰å…¬å¸  &#x27;</span>, <span class="string">&#x27;æå››ä¼ä¸š&#x27;</span>, <span class="string">&#x27;ç‹äº”é›†å›¢  &#x27;</span>, <span class="string">&#x27;  èµµå…­æœ‰é™å…¬å¸&#x27;</span>, <span class="literal">None</span>, <span class="string">&#x27;é’±ä¸ƒè‚¡ä»½&#x27;</span>, <span class="string">&#x27;å­™å…«å®ä¸š&#x27;</span>, <span class="string">&#x27;å‘¨ä¹é›†å›¢&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;é‡‘é¢&#x27;</span>: [<span class="string">&#x27;15000.50&#x27;</span>, <span class="string">&#x27;25,000.00&#x27;</span>, <span class="string">&#x27;18000.75å…ƒ&#x27;</span>, <span class="string">&#x27;not-a-number&#x27;</span>, <span class="string">&#x27;22000&#x27;</span>, <span class="literal">None</span>, <span class="string">&#x27;19500.25&#x27;</span>, <span class="string">&#x27;21000.80&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;ç¨é¢&#x27;</span>: [<span class="string">&#x27;1950.07&#x27;</span>, <span class="string">&#x27;3,250.00&#x27;</span>, <span class="string">&#x27;2,340.10&#x27;</span>, <span class="string">&#x27;invalid&#x27;</span>, <span class="string">&#x27;2,860.00&#x27;</span>, <span class="literal">None</span>, <span class="string">&#x27;2,535.03&#x27;</span>, <span class="string">&#x27;2,730.10&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;ç¨ç‡&#x27;</span>: [<span class="string">&#x27;13%&#x27;</span>, <span class="string">&#x27;13%&#x27;</span>, <span class="string">&#x27;13%&#x27;</span>, <span class="string">&#x27;not-a-rate&#x27;</span>, <span class="string">&#x27;13%&#x27;</span>, <span class="literal">None</span>, <span class="string">&#x27;13%&#x27;</span>, <span class="string">&#x27;13%&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;å‘ç¥¨ç±»å‹&#x27;</span>: [<span class="string">&#x27;ä¸“ç”¨å‘ç¥¨&#x27;</span>, <span class="string">&#x27;  æ™®é€šå‘ç¥¨  &#x27;</span>, <span class="string">&#x27;ä¸“ç”¨å‘ç¥¨&#x27;</span>, <span class="literal">None</span>, <span class="string">&#x27;ç”µå­å‘ç¥¨&#x27;</span>, <span class="string">&#x27;ä¸“ç”¨å‘ç¥¨&#x27;</span>, <span class="string">&#x27;æ™®é€šå‘ç¥¨&#x27;</span>, <span class="string">&#x27;ä¸“ç”¨å‘ç¥¨&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;å‘ç¥¨çŠ¶æ€&#x27;</span>: [<span class="string">&#x27;æ­£å¸¸&#x27;</span>, <span class="string">&#x27;æ­£å¸¸&#x27;</span>, <span class="string">&#x27;  ä½œåºŸ  &#x27;</span>, <span class="string">&#x27;æ­£å¸¸&#x27;</span>, <span class="literal">None</span>, <span class="string">&#x27;æ­£å¸¸&#x27;</span>, <span class="string">&#x27;æ­£å¸¸&#x27;</span>, <span class="string">&#x27;æ­£å¸¸&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">æ¸…æ´—å‘ç¥¨æ•°æ®</span>(<span class="params">å‘ç¥¨df</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ä¸“ä¸šå‘ç¥¨æ•°æ®æ¸…æ´—&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ğŸ” å¼€å§‹æ¸…æ´—å‘ç¥¨æ•°æ®...&quot;</span>)</span><br><span class="line">    df = å‘ç¥¨df.copy()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 1. å‘ç¥¨å·ç æ ‡å‡†åŒ–</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;1. å‘ç¥¨å·ç æ ‡å‡†åŒ–...&quot;</span>)</span><br><span class="line">    <span class="comment"># ç§»é™¤æ‰€æœ‰éæ•°å­—å­—ç¬¦</span></span><br><span class="line">    df[<span class="string">&#x27;å‘ç¥¨å·ç _æ¸…æ´—&#x27;</span>] = df[<span class="string">&#x27;å‘ç¥¨å·ç &#x27;</span>].astype(<span class="built_in">str</span>).<span class="built_in">str</span>.replace(<span class="string">r&#x27;[^0-9]&#x27;</span>, <span class="string">&#x27;&#x27;</span>, regex=<span class="literal">True</span>)</span><br><span class="line">    <span class="comment"># éªŒè¯å‘ç¥¨å·ç é•¿åº¦ï¼ˆ8ä½ï¼‰</span></span><br><span class="line">    df[<span class="string">&#x27;å‘ç¥¨å·ç æœ‰æ•ˆæ€§&#x27;</span>] = (df[<span class="string">&#x27;å‘ç¥¨å·ç _æ¸…æ´—&#x27;</span>].<span class="built_in">str</span>.<span class="built_in">len</span>() == <span class="number">8</span>) &amp; (df[<span class="string">&#x27;å‘ç¥¨å·ç _æ¸…æ´—&#x27;</span>] != <span class="string">&#x27;nan&#x27;</span>)</span><br><span class="line">    <span class="comment"># å¤„ç†æ— æ•ˆå‘ç¥¨å·ç </span></span><br><span class="line">    df.loc[~df[<span class="string">&#x27;å‘ç¥¨å·ç æœ‰æ•ˆæ€§&#x27;</span>], <span class="string">&#x27;å‘ç¥¨å·ç _æ¸…æ´—&#x27;</span>] = <span class="string">&#x27;INVALID&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. å¼€ç¥¨æ—¥æœŸæ ‡å‡†åŒ–</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;2. å¼€ç¥¨æ—¥æœŸæ ‡å‡†åŒ–...&quot;</span>)</span><br><span class="line">    df[<span class="string">&#x27;å¼€ç¥¨æ—¥æœŸ_æ ‡å‡†&#x27;</span>] = pd.to_datetime(df[<span class="string">&#x27;å¼€ç¥¨æ—¥æœŸ&#x27;</span>], errors=<span class="string">&#x27;coerce&#x27;</span>)</span><br><span class="line">    <span class="comment"># å¤„ç†è¶…å‡ºåˆç†èŒƒå›´çš„æ—¥æœŸ</span></span><br><span class="line">    å½“å‰æ—¥æœŸ = pd.Timestamp.now()</span><br><span class="line">    æœªæ¥æ—¥æœŸ = df[<span class="string">&#x27;å¼€ç¥¨æ—¥æœŸ_æ ‡å‡†&#x27;</span>] &gt; å½“å‰æ—¥æœŸ</span><br><span class="line">    è¿‡æ—©æ—¥æœŸ = df[<span class="string">&#x27;å¼€ç¥¨æ—¥æœŸ_æ ‡å‡†&#x27;</span>] &lt; pd.Timestamp(<span class="string">&#x27;2020-01-01&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    df.loc[æœªæ¥æ—¥æœŸ, <span class="string">&#x27;æ—¥æœŸå¼‚å¸¸æ ‡è®°&#x27;</span>] = <span class="string">&#x27;æœªæ¥æ—¥æœŸ&#x27;</span></span><br><span class="line">    df.loc[è¿‡æ—©æ—¥æœŸ, <span class="string">&#x27;æ—¥æœŸå¼‚å¸¸æ ‡è®°&#x27;</span>] = <span class="string">&#x27;è¿‡æ—©æ—¥æœŸ&#x27;</span></span><br><span class="line">    df.loc[df[<span class="string">&#x27;å¼€ç¥¨æ—¥æœŸ_æ ‡å‡†&#x27;</span>].isnull(), <span class="string">&#x27;æ—¥æœŸå¼‚å¸¸æ ‡è®°&#x27;</span>] = <span class="string">&#x27;æ— æ•ˆæ—¥æœŸ&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. è´­ä¹°æ–¹åç§°æ¸…æ´—</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;3. è´­ä¹°æ–¹åç§°æ¸…æ´—...&quot;</span>)</span><br><span class="line">    df[<span class="string">&#x27;è´­ä¹°æ–¹åç§°_æ¸…æ´—&#x27;</span>] = df[<span class="string">&#x27;è´­ä¹°æ–¹åç§°&#x27;</span>].astype(<span class="built_in">str</span>).<span class="built_in">str</span>.strip()</span><br><span class="line">    <span class="comment"># ç»Ÿä¸€æœ‰é™å…¬å¸æ ¼å¼</span></span><br><span class="line">    df[<span class="string">&#x27;è´­ä¹°æ–¹åç§°_æ¸…æ´—&#x27;</span>] = df[<span class="string">&#x27;è´­ä¹°æ–¹åç§°_æ¸…æ´—&#x27;</span>].<span class="built_in">str</span>.replace(<span class="string">&#x27;æœ‰é™å…¬å¸&#x27;</span>, <span class="string">&#x27;æœ‰é™å…¬å¸&#x27;</span>, regex=<span class="literal">False</span>)</span><br><span class="line">    df[<span class="string">&#x27;è´­ä¹°æ–¹åç§°_æ¸…æ´—&#x27;</span>] = df[<span class="string">&#x27;è´­ä¹°æ–¹åç§°_æ¸…æ´—&#x27;</span>].<span class="built_in">str</span>.replace(<span class="string">&#x27;æœ‰é™è´£ä»»&#x27;</span>, <span class="string">&#x27;æœ‰é™å…¬å¸&#x27;</span>, regex=<span class="literal">False</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 4. é‡‘é¢å’Œç¨é¢æ¸…æ´—</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;4. é‡‘é¢å’Œç¨é¢æ¸…æ´—...&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> åˆ—å <span class="keyword">in</span> [<span class="string">&#x27;é‡‘é¢&#x27;</span>, <span class="string">&#x27;ç¨é¢&#x27;</span>]:</span><br><span class="line">        <span class="comment"># ç§»é™¤è´§å¸ç¬¦å·å’Œåƒåˆ†ä½</span></span><br><span class="line">        df[<span class="string">f&#x27;<span class="subst">&#123;åˆ—å&#125;</span>_æ•°å€¼&#x27;</span>] = df[åˆ—å].astype(<span class="built_in">str</span>).<span class="built_in">str</span>.replace(<span class="string">r&#x27;[,\å…ƒ]&#x27;</span>, <span class="string">&#x27;&#x27;</span>, regex=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># è½¬æ¢ä¸ºæ•°å€¼</span></span><br><span class="line">        df[<span class="string">f&#x27;<span class="subst">&#123;åˆ—å&#125;</span>_æ•°å€¼&#x27;</span>] = pd.to_numeric(df[<span class="string">f&#x27;<span class="subst">&#123;åˆ—å&#125;</span>_æ•°å€¼&#x27;</span>], errors=<span class="string">&#x27;coerce&#x27;</span>)</span><br><span class="line">        <span class="comment"># å¤„ç†å¼‚å¸¸å€¼</span></span><br><span class="line">        df[<span class="string">f&#x27;<span class="subst">&#123;åˆ—å&#125;</span>_æ•°å€¼&#x27;</span>] = df[<span class="string">f&#x27;<span class="subst">&#123;åˆ—å&#125;</span>_æ•°å€¼&#x27;</span>].fillna(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 5. ç¨ç‡æ ‡å‡†åŒ–</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;5. ç¨ç‡æ ‡å‡†åŒ–...&quot;</span>)</span><br><span class="line">    df[<span class="string">&#x27;ç¨ç‡_æ•°å€¼&#x27;</span>] = df[<span class="string">&#x27;ç¨ç‡&#x27;</span>].astype(<span class="built_in">str</span>).<span class="built_in">str</span>.replace(<span class="string">&#x27;%&#x27;</span>, <span class="string">&#x27;&#x27;</span>).<span class="built_in">str</span>.strip()</span><br><span class="line">    df[<span class="string">&#x27;ç¨ç‡_æ•°å€¼&#x27;</span>] = pd.to_numeric(df[<span class="string">&#x27;ç¨ç‡_æ•°å€¼&#x27;</span>], errors=<span class="string">&#x27;coerce&#x27;</span>)</span><br><span class="line">    <span class="comment"># æ ‡å‡†åŒ–ä¸ºç™¾åˆ†æ¯”å½¢å¼</span></span><br><span class="line">    df[<span class="string">&#x27;ç¨ç‡_æ ‡å‡†&#x27;</span>] = df[<span class="string">&#x27;ç¨ç‡_æ•°å€¼&#x27;</span>] / <span class="number">100</span></span><br><span class="line">    <span class="comment"># å¤„ç†å¼‚å¸¸ç¨ç‡</span></span><br><span class="line">    å¼‚å¸¸ç¨ç‡ = (df[<span class="string">&#x27;ç¨ç‡_æ ‡å‡†&#x27;</span>] &lt; <span class="number">0</span>) | (df[<span class="string">&#x27;ç¨ç‡_æ ‡å‡†&#x27;</span>] &gt; <span class="number">0.2</span>)  <span class="comment"># å‡è®¾ç¨ç‡ä¸è¶…è¿‡20%</span></span><br><span class="line">    df.loc[å¼‚å¸¸ç¨ç‡, <span class="string">&#x27;ç¨ç‡å¼‚å¸¸æ ‡è®°&#x27;</span>] = <span class="string">&#x27;ç¨ç‡è¶…å‡ºæ­£å¸¸èŒƒå›´&#x27;</span></span><br><span class="line">    df.loc[å¼‚å¸¸ç¨ç‡, <span class="string">&#x27;ç¨ç‡_æ ‡å‡†&#x27;</span>] = <span class="number">0.13</span>  <span class="comment"># é»˜è®¤13%</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 6. å‘ç¥¨ç±»å‹æ ‡å‡†åŒ–</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;6. å‘ç¥¨ç±»å‹æ ‡å‡†åŒ–...&quot;</span>)</span><br><span class="line">    df[<span class="string">&#x27;å‘ç¥¨ç±»å‹_æ ‡å‡†&#x27;</span>] = df[<span class="string">&#x27;å‘ç¥¨ç±»å‹&#x27;</span>].astype(<span class="built_in">str</span>).<span class="built_in">str</span>.strip()</span><br><span class="line">    <span class="comment"># ç»Ÿä¸€å‘½å</span></span><br><span class="line">    ç±»å‹æ˜ å°„ = &#123;</span><br><span class="line">        <span class="string">&#x27;ä¸“ç”¨å‘ç¥¨&#x27;</span>: <span class="string">&#x27;å¢å€¼ç¨ä¸“ç”¨å‘ç¥¨&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;æ™®é€šå‘ç¥¨&#x27;</span>: <span class="string">&#x27;å¢å€¼ç¨æ™®é€šå‘ç¥¨&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;ç”µå­å‘ç¥¨&#x27;</span>: <span class="string">&#x27;å¢å€¼ç¨ç”µå­æ™®é€šå‘ç¥¨&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> åŸå§‹, æ ‡å‡† <span class="keyword">in</span> ç±»å‹æ˜ å°„.items():</span><br><span class="line">        df[<span class="string">&#x27;å‘ç¥¨ç±»å‹_æ ‡å‡†&#x27;</span>] = df[<span class="string">&#x27;å‘ç¥¨ç±»å‹_æ ‡å‡†&#x27;</span>].<span class="built_in">str</span>.replace(åŸå§‹, æ ‡å‡†, regex=<span class="literal">False</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 7. å‘ç¥¨çŠ¶æ€æ ‡å‡†åŒ–</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;7. å‘ç¥¨çŠ¶æ€æ ‡å‡†åŒ–...&quot;</span>)</span><br><span class="line">    df[<span class="string">&#x27;å‘ç¥¨çŠ¶æ€_æ ‡å‡†&#x27;</span>] = df[<span class="string">&#x27;å‘ç¥¨çŠ¶æ€&#x27;</span>].astype(<span class="built_in">str</span>).<span class="built_in">str</span>.strip().<span class="built_in">str</span>.title()</span><br><span class="line">    <span class="comment"># ç»Ÿä¸€çŠ¶æ€åç§°</span></span><br><span class="line">    çŠ¶æ€æ˜ å°„ = &#123;</span><br><span class="line">        <span class="string">&#x27;æ­£å¸¸&#x27;</span>: <span class="string">&#x27;æœ‰æ•ˆ&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;ä½œåºŸ&#x27;</span>: <span class="string">&#x27;æ— æ•ˆ&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;å†²çº¢&#x27;</span>: <span class="string">&#x27;å·²å†²çº¢&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> åŸå§‹, æ ‡å‡† <span class="keyword">in</span> çŠ¶æ€æ˜ å°„.items():</span><br><span class="line">        df[<span class="string">&#x27;å‘ç¥¨çŠ¶æ€_æ ‡å‡†&#x27;</span>] = df[<span class="string">&#x27;å‘ç¥¨çŠ¶æ€_æ ‡å‡†&#x27;</span>].<span class="built_in">str</span>.replace(åŸå§‹, æ ‡å‡†, regex=<span class="literal">False</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 8. æ•°æ®éªŒè¯</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;8. æ•°æ®éªŒè¯...&quot;</span>)</span><br><span class="line">    <span class="comment"># éªŒè¯ç¨é¢è®¡ç®—</span></span><br><span class="line">    df[<span class="string">&#x27;è®¡ç®—ç¨é¢&#x27;</span>] = df[<span class="string">&#x27;é‡‘é¢_æ•°å€¼&#x27;</span>] * df[<span class="string">&#x27;ç¨ç‡_æ ‡å‡†&#x27;</span>]</span><br><span class="line">    df[<span class="string">&#x27;ç¨é¢å·®å¼‚&#x27;</span>] = <span class="built_in">abs</span>(df[<span class="string">&#x27;ç¨é¢_æ•°å€¼&#x27;</span>] - df[<span class="string">&#x27;è®¡ç®—ç¨é¢&#x27;</span>])</span><br><span class="line">    ç¨é¢ä¸åŒ¹é… = df[<span class="string">&#x27;ç¨é¢å·®å¼‚&#x27;</span>] &gt; <span class="number">0.01</span>  <span class="comment"># å·®å¼‚è¶…è¿‡1åˆ†é’±</span></span><br><span class="line">    df.loc[ç¨é¢ä¸åŒ¹é…, <span class="string">&#x27;ç¨é¢éªŒè¯æ ‡è®°&#x27;</span>] = <span class="string">&#x27;ç¨é¢è®¡ç®—ä¸åŒ¹é…&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># éªŒè¯å‘ç¥¨çŠ¶æ€ä¸€è‡´æ€§</span></span><br><span class="line">    ä½œåºŸå‘ç¥¨æœ‰é‡‘é¢ = (df[<span class="string">&#x27;å‘ç¥¨çŠ¶æ€_æ ‡å‡†&#x27;</span>] == <span class="string">&#x27;æ— æ•ˆ&#x27;</span>) &amp; (df[<span class="string">&#x27;é‡‘é¢_æ•°å€¼&#x27;</span>] &gt; <span class="number">0</span>)</span><br><span class="line">    df.loc[ä½œåºŸå‘ç¥¨æœ‰é‡‘é¢, <span class="string">&#x27;çŠ¶æ€ä¸€è‡´æ€§æ ‡è®°&#x27;</span>] = <span class="string">&#x27;ä½œåºŸå‘ç¥¨ä¸åº”æœ‰é‡‘é¢&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;âœ… å‘ç¥¨æ•°æ®æ¸…æ´—å®Œæˆï¼&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> df</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¸…æ´—å‘ç¥¨æ•°æ®</span></span><br><span class="line">å‘ç¥¨_æ¸…æ´—ç»“æœ = æ¸…æ´—å‘ç¥¨æ•°æ®(å‘ç¥¨æ•°æ®)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\næ¸…æ´—ç»“æœæ‘˜è¦ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æœ‰æ•ˆå‘ç¥¨å·ç ï¼š<span class="subst">&#123;å‘ç¥¨_æ¸…æ´—ç»“æœ[<span class="string">&#x27;å‘ç¥¨å·ç æœ‰æ•ˆæ€§&#x27;</span>].<span class="built_in">sum</span>()&#125;</span>ä¸ª&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æœ‰æ•ˆæ—¥æœŸï¼š<span class="subst">&#123;å‘ç¥¨_æ¸…æ´—ç»“æœ[<span class="string">&#x27;å¼€ç¥¨æ—¥æœŸ_æ ‡å‡†&#x27;</span>].notnull().<span class="built_in">sum</span>()&#125;</span>ä¸ª&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;ç¨é¢éªŒè¯é€šè¿‡ï¼š<span class="subst">&#123;(~å‘ç¥¨_æ¸…æ´—ç»“æœ[<span class="string">&#x27;ç¨é¢éªŒè¯æ ‡è®°&#x27;</span>].notnull()).<span class="built_in">sum</span>()&#125;</span>ä¸ª&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;çŠ¶æ€ä¸€è‡´ï¼š<span class="subst">&#123;(~å‘ç¥¨_æ¸…æ´—ç»“æœ[<span class="string">&#x27;çŠ¶æ€ä¸€è‡´æ€§æ ‡è®°&#x27;</span>].notnull()).<span class="built_in">sum</span>()&#125;</span>ä¸ª&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºå¼‚å¸¸æ•°æ®</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nâš ï¸ å‘ç°çš„æ•°æ®å¼‚å¸¸ï¼š&quot;</span>)</span><br><span class="line">å¼‚å¸¸åˆ— = [col <span class="keyword">for</span> col <span class="keyword">in</span> å‘ç¥¨_æ¸…æ´—ç»“æœ.columns <span class="keyword">if</span> <span class="string">&#x27;å¼‚å¸¸&#x27;</span> <span class="keyword">in</span> col <span class="keyword">or</span> <span class="string">&#x27;é”™è¯¯&#x27;</span> <span class="keyword">in</span> col <span class="keyword">or</span> <span class="string">&#x27;æ— æ•ˆ&#x27;</span> <span class="keyword">in</span> col]</span><br><span class="line"><span class="keyword">for</span> å¼‚å¸¸åˆ—å <span class="keyword">in</span> å¼‚å¸¸åˆ—:</span><br><span class="line">    å¼‚å¸¸æ•°é‡ = å‘ç¥¨_æ¸…æ´—ç»“æœ[å¼‚å¸¸åˆ—å].notnull().<span class="built_in">sum</span>()</span><br><span class="line">    <span class="keyword">if</span> å¼‚å¸¸æ•°é‡ &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;å¼‚å¸¸åˆ—å&#125;</span>ï¼š<span class="subst">&#123;å¼‚å¸¸æ•°é‡&#125;</span>ä¸ª&quot;</span>)</span><br></pre></td></tr></table></figure></details><details><summary>æŒ‘æˆ˜2ï¼šé“¶è¡Œæµæ°´æ™ºèƒ½åˆ†ç±»</summary><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é“¶è¡Œæµæ°´æ™ºèƒ½åˆ†ç±»ç³»ç»Ÿ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=== é“¶è¡Œæµæ°´æ™ºèƒ½åˆ†ç±»ç³»ç»Ÿ ===&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºé“¶è¡Œæµæ°´æ•°æ®</span></span><br><span class="line">é“¶è¡Œæµæ°´ = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;äº¤æ˜“æ—¥æœŸ&#x27;</span>: [<span class="string">&#x27;2024-01-01&#x27;</span>, <span class="string">&#x27;2024-01-02&#x27;</span>, <span class="string">&#x27;2024-01-03&#x27;</span>, <span class="string">&#x27;2024-01-04&#x27;</span>, <span class="string">&#x27;2024-01-05&#x27;</span>, <span class="string">&#x27;2024-01-06&#x27;</span>, <span class="string">&#x27;2024-01-07&#x27;</span>, <span class="string">&#x27;2024-01-08&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;æ‘˜è¦&#x27;</span>: [<span class="string">&#x27;å·¥èµ„æ”¶å…¥-å¼ ä¸‰&#x27;</span>, <span class="string">&#x27;æ”¯ä»˜å®è½¬è´¦-èŠ±å‘—è¿˜æ¬¾&#x27;</span>, <span class="string">&#x27;å¾®ä¿¡æ”¯ä»˜-è¶…å¸‚è´­ç‰©&#x27;</span>, <span class="string">&#x27;è·¨è¡Œè½¬è´¦-å®¢æˆ·Aè´§æ¬¾&#x27;</span>, </span><br><span class="line">            <span class="string">&#x27;ATMå–æ¬¾&#x27;</span>, <span class="string">&#x27;ä¿¡ç”¨å¡è¿˜æ¬¾&#x27;</span>, <span class="string">&#x27;å¾®ä¿¡çº¢åŒ…-æ–°å¹´çº¢åŒ…&#x27;</span>, <span class="string">&#x27;å¯¹å…¬è½¬è´¦-ä¾›åº”å•†Bè´§æ¬¾&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;é‡‘é¢&#x27;</span>: [<span class="number">15000.00</span>, -<span class="number">2500.00</span>, -<span class="number">156.50</span>, <span class="number">35000.00</span>, -<span class="number">3000.00</span>, -<span class="number">5800.00</span>, <span class="number">88.88</span>, -<span class="number">45000.00</span>],</span><br><span class="line">    <span class="string">&#x27;å¯¹æ–¹è´¦æˆ·&#x27;</span>: [<span class="string">&#x27;å·¥èµ„ä¸“æˆ·&#x27;</span>, <span class="string">&#x27;æ”¯ä»˜å®(ä¸­å›½)ç½‘ç»œæŠ€æœ¯æœ‰é™å…¬å¸&#x27;</span>, <span class="string">&#x27;è´¢ä»˜é€šæ”¯ä»˜ç§‘æŠ€æœ‰é™å…¬å¸&#x27;</span>, <span class="string">&#x27;å¼ ä¸‰&#x27;</span>, </span><br><span class="line">                <span class="string">&#x27;ATMæœº&#x27;</span>, <span class="string">&#x27;ä¸­å›½å·¥å•†é“¶è¡Œä¿¡ç”¨å¡ä¸­å¿ƒ&#x27;</span>, <span class="string">&#x27;å¾®ä¿¡çº¢åŒ…&#x27;</span>, <span class="string">&#x27;ABCæœ‰é™å…¬å¸&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;äº¤æ˜“ç±»å‹&#x27;</span>: [<span class="string">&#x27;è½¬å…¥&#x27;</span>, <span class="string">&#x27;è½¬å‡º&#x27;</span>, <span class="string">&#x27;è½¬å‡º&#x27;</span>, <span class="string">&#x27;è½¬å…¥&#x27;</span>, <span class="string">&#x27;è½¬å‡º&#x27;</span>, <span class="string">&#x27;è½¬å‡º&#x27;</span>, <span class="string">&#x27;è½¬å…¥&#x27;</span>, <span class="string">&#x27;è½¬å‡º&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">æ™ºèƒ½æµæ°´åˆ†ç±»</span>(<span class="params">æµæ°´df</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ™ºèƒ½é“¶è¡Œæµæ°´åˆ†ç±»&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ğŸ¤– å¼€å§‹æ™ºèƒ½æµæ°´åˆ†ç±»...&quot;</span>)</span><br><span class="line">    df = æµæ°´df.copy()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å®šä¹‰åˆ†ç±»å…³é”®è¯</span></span><br><span class="line">    åˆ†ç±»è§„åˆ™ = &#123;</span><br><span class="line">        <span class="string">&#x27;å·¥èµ„æ”¶å…¥&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;å…³é”®è¯&#x27;</span>: [<span class="string">&#x27;å·¥èµ„&#x27;</span>, <span class="string">&#x27;è–ªèµ„&#x27;</span>, <span class="string">&#x27;å¥–é‡‘&#x27;</span>, <span class="string">&#x27;æ´¥è´´&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;é‡‘é¢ç‰¹å¾&#x27;</span>: <span class="string">&#x27;&gt;0&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;ä¼˜å…ˆçº§&#x27;</span>: <span class="number">1</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;æŠ•èµ„ç†è´¢&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;å…³é”®è¯&#x27;</span>: [<span class="string">&#x27;ç†è´¢&#x27;</span>, <span class="string">&#x27;åŸºé‡‘&#x27;</span>, <span class="string">&#x27;è‚¡ç¥¨&#x27;</span>, <span class="string">&#x27;è¯åˆ¸&#x27;</span>, <span class="string">&#x27;æŠ•èµ„&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;é‡‘é¢ç‰¹å¾&#x27;</span>: <span class="string">&#x27;ä»»æ„&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;ä¼˜å…ˆçº§&#x27;</span>: <span class="number">2</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;ç”Ÿæ´»æ¶ˆè´¹&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;å…³é”®è¯&#x27;</span>: [<span class="string">&#x27;æ”¯ä»˜å®&#x27;</span>, <span class="string">&#x27;å¾®ä¿¡&#x27;</span>, <span class="string">&#x27;è´­ç‰©&#x27;</span>, <span class="string">&#x27;é¤é¥®&#x27;</span>, <span class="string">&#x27;è¶…å¸‚&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;é‡‘é¢ç‰¹å¾&#x27;</span>: <span class="string">&#x27;&lt;0&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;ä¼˜å…ˆçº§&#x27;</span>: <span class="number">3</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;ä¿¡ç”¨å¡è¿˜æ¬¾&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;å…³é”®è¯&#x27;</span>: [<span class="string">&#x27;ä¿¡ç”¨å¡&#x27;</span>, <span class="string">&#x27;è¿˜æ¬¾&#x27;</span>, <span class="string">&#x27;creditcard&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;é‡‘é¢ç‰¹å¾&#x27;</span>: <span class="string">&#x27;&lt;0&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;ä¼˜å…ˆçº§&#x27;</span>: <span class="number">1</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;è½¬è´¦æ±‡æ¬¾&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;å…³é”®è¯&#x27;</span>: [<span class="string">&#x27;è½¬è´¦&#x27;</span>, <span class="string">&#x27;æ±‡æ¬¾&#x27;</span>, <span class="string">&#x27;è·¨è¡Œ&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;é‡‘é¢ç‰¹å¾&#x27;</span>: <span class="string">&#x27;ä»»æ„&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;ä¼˜å…ˆçº§&#x27;</span>: <span class="number">4</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;ç°é‡‘ä¸šåŠ¡&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;å…³é”®è¯&#x27;</span>: [<span class="string">&#x27;ATM&#x27;</span>, <span class="string">&#x27;å–æ¬¾&#x27;</span>, <span class="string">&#x27;å­˜æ¬¾&#x27;</span>, <span class="string">&#x27;ç°é‡‘&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;é‡‘é¢ç‰¹å¾&#x27;</span>: <span class="string">&#x27;ä»»æ„&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;ä¼˜å…ˆçº§&#x27;</span>: <span class="number">5</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;å…¶ä»–æ”¶å…¥&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;å…³é”®è¯&#x27;</span>: [<span class="string">&#x27;çº¢åŒ…&#x27;</span>, <span class="string">&#x27;é€€æ¬¾&#x27;</span>, <span class="string">&#x27;è¿”åˆ©&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;é‡‘é¢ç‰¹å¾&#x27;</span>: <span class="string">&#x27;&gt;0&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;ä¼˜å…ˆçº§&#x27;</span>: <span class="number">6</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;å…¶ä»–æ”¯å‡º&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;å…³é”®è¯&#x27;</span>: [],</span><br><span class="line">            <span class="string">&#x27;é‡‘é¢ç‰¹å¾&#x27;</span>: <span class="string">&#x27;&lt;0&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;ä¼˜å…ˆçº§&#x27;</span>: <span class="number">7</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åˆ›å»ºåˆ†ç±»åˆ—</span></span><br><span class="line">    df[<span class="string">&#x27;åˆ†ç±»ç»“æœ&#x27;</span>] = <span class="string">&#x27;æœªåˆ†ç±»&#x27;</span></span><br><span class="line">    df[<span class="string">&#x27;åˆ†ç±»ç½®ä¿¡åº¦&#x27;</span>] = <span class="number">0.0</span></span><br><span class="line">    df[<span class="string">&#x27;åˆ†ç±»ä¾æ®&#x27;</span>] = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">è®¡ç®—ç½®ä¿¡åº¦</span>(<span class="params">å…³é”®è¯åŒ¹é…æ•°, æ€»å…³é”®è¯æ•°, é‡‘é¢åŒ¹é…, è§„åˆ™ä¼˜å…ˆçº§</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;è®¡ç®—åˆ†ç±»ç½®ä¿¡åº¦&quot;&quot;&quot;</span></span><br><span class="line">        å…³é”®è¯ç½®ä¿¡åº¦ = å…³é”®è¯åŒ¹é…æ•° / <span class="built_in">max</span>(æ€»å…³é”®è¯æ•°, <span class="number">1</span>)</span><br><span class="line">        é‡‘é¢ç½®ä¿¡åº¦ = <span class="number">1.0</span> <span class="keyword">if</span> é‡‘é¢åŒ¹é… <span class="keyword">else</span> <span class="number">0.5</span></span><br><span class="line">        ä¼˜å…ˆçº§æƒé‡ = <span class="number">1.0</span> / è§„åˆ™ä¼˜å…ˆçº§</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> (å…³é”®è¯ç½®ä¿¡åº¦ * <span class="number">0.6</span> + é‡‘é¢ç½®ä¿¡åº¦ * <span class="number">0.3</span> + ä¼˜å…ˆçº§æƒé‡ * <span class="number">0.1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># é€è¡Œåˆ†æ</span></span><br><span class="line">    <span class="keyword">for</span> ç´¢å¼•, è¡Œ <span class="keyword">in</span> df.iterrows():</span><br><span class="line">        æ‘˜è¦ = <span class="built_in">str</span>(è¡Œ[<span class="string">&#x27;æ‘˜è¦&#x27;</span>]).lower()</span><br><span class="line">        å¯¹æ–¹è´¦æˆ· = <span class="built_in">str</span>(è¡Œ[<span class="string">&#x27;å¯¹æ–¹è´¦æˆ·&#x27;</span>]).lower()</span><br><span class="line">        é‡‘é¢ = è¡Œ[<span class="string">&#x27;é‡‘é¢&#x27;</span>]</span><br><span class="line">        äº¤æ˜“ç±»å‹ = è¡Œ[<span class="string">&#x27;äº¤æ˜“ç±»å‹&#x27;</span>]</span><br><span class="line">        </span><br><span class="line">        æœ€ä½³åˆ†ç±» = <span class="literal">None</span></span><br><span class="line">        æœ€é«˜ç½®ä¿¡åº¦ = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ£€æŸ¥æ¯ä¸ªåˆ†ç±»è§„åˆ™</span></span><br><span class="line">        <span class="keyword">for</span> åˆ†ç±»å, è§„åˆ™ <span class="keyword">in</span> åˆ†ç±»è§„åˆ™.items():</span><br><span class="line">            å…³é”®è¯ = è§„åˆ™[<span class="string">&#x27;å…³é”®è¯&#x27;</span>]</span><br><span class="line">            é‡‘é¢ç‰¹å¾ = è§„åˆ™[<span class="string">&#x27;é‡‘é¢ç‰¹å¾&#x27;</span>]</span><br><span class="line">            ä¼˜å…ˆçº§ = è§„åˆ™[<span class="string">&#x27;ä¼˜å…ˆçº§&#x27;</span>]</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># å…³é”®è¯åŒ¹é…</span></span><br><span class="line">            å…³é”®è¯åŒ¹é…æ•° = <span class="number">0</span></span><br><span class="line">            åŒ¹é…å…³é”®è¯ = []</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span> å…³é”®è¯é¡¹ <span class="keyword">in</span> å…³é”®è¯:</span><br><span class="line">                <span class="keyword">if</span> å…³é”®è¯é¡¹ <span class="keyword">in</span> æ‘˜è¦ <span class="keyword">or</span> å…³é”®è¯é¡¹ <span class="keyword">in</span> å¯¹æ–¹è´¦æˆ·:</span><br><span class="line">                    å…³é”®è¯åŒ¹é…æ•° += <span class="number">1</span></span><br><span class="line">                    åŒ¹é…å…³é”®è¯.append(å…³é”®è¯é¡¹)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># é‡‘é¢ç‰¹å¾åŒ¹é…</span></span><br><span class="line">            é‡‘é¢åŒ¹é… = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">if</span> é‡‘é¢ç‰¹å¾ == <span class="string">&#x27;ä»»æ„&#x27;</span>:</span><br><span class="line">                é‡‘é¢åŒ¹é… = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">elif</span> é‡‘é¢ç‰¹å¾ == <span class="string">&#x27;&gt;0&#x27;</span> <span class="keyword">and</span> é‡‘é¢ &gt; <span class="number">0</span>:</span><br><span class="line">                é‡‘é¢åŒ¹é… = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">elif</span> é‡‘é¢ç‰¹å¾ == <span class="string">&#x27;&lt;0&#x27;</span> <span class="keyword">and</span> é‡‘é¢ &lt; <span class="number">0</span>:</span><br><span class="line">                é‡‘é¢åŒ¹é… = <span class="literal">True</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># è®¡ç®—ç½®ä¿¡åº¦</span></span><br><span class="line">            ç½®ä¿¡åº¦ = è®¡ç®—ç½®ä¿¡åº¦(å…³é”®è¯åŒ¹é…æ•°, <span class="built_in">len</span>(å…³é”®è¯), é‡‘é¢åŒ¹é…, ä¼˜å…ˆçº§)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> ç½®ä¿¡åº¦ &gt; æœ€é«˜ç½®ä¿¡åº¦:</span><br><span class="line">                æœ€é«˜ç½®ä¿¡åº¦ = ç½®ä¿¡åº¦</span><br><span class="line">                æœ€ä½³åˆ†ç±» = åˆ†ç±»å</span><br><span class="line">                åˆ†ç±»ä¾æ® = <span class="string">f&quot;å…³é”®è¯ï¼š<span class="subst">&#123;åŒ¹é…å…³é”®è¯&#125;</span>ï¼Œé‡‘é¢ï¼š<span class="subst">&#123;é‡‘é¢&#125;</span>ï¼Œä¼˜å…ˆçº§ï¼š<span class="subst">&#123;ä¼˜å…ˆçº§&#125;</span>&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è®°å½•æœ€ä½³åˆ†ç±»ç»“æœ</span></span><br><span class="line">        <span class="keyword">if</span> æœ€ä½³åˆ†ç±» <span class="keyword">and</span> æœ€é«˜ç½®ä¿¡åº¦ &gt; <span class="number">0.3</span>:  <span class="comment"># ç½®ä¿¡åº¦é˜ˆå€¼</span></span><br><span class="line">            df.loc[ç´¢å¼•, <span class="string">&#x27;åˆ†ç±»ç»“æœ&#x27;</span>] = æœ€ä½³åˆ†ç±»</span><br><span class="line">            df.loc[ç´¢å¼•, <span class="string">&#x27;åˆ†ç±»ç½®ä¿¡åº¦&#x27;</span>] = æœ€é«˜ç½®ä¿¡åº¦</span><br><span class="line">            df.loc[ç´¢å¼•, <span class="string">&#x27;åˆ†ç±»ä¾æ®&#x27;</span>] = åˆ†ç±»ä¾æ®</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># ä½¿ç”¨é»˜è®¤åˆ†ç±»</span></span><br><span class="line">            <span class="keyword">if</span> é‡‘é¢ &gt; <span class="number">0</span>:</span><br><span class="line">                df.loc[ç´¢å¼•, <span class="string">&#x27;åˆ†ç±»ç»“æœ&#x27;</span>] = <span class="string">&#x27;å…¶ä»–æ”¶å…¥&#x27;</span></span><br><span class="line">                df.loc[ç´¢å¼•, <span class="string">&#x27;åˆ†ç±»ç½®ä¿¡åº¦&#x27;</span>] = <span class="number">0.3</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                df.loc[ç´¢å¼•, <span class="string">&#x27;åˆ†ç±»ç»“æœ&#x27;</span>] = <span class="string">&#x27;å…¶ä»–æ”¯å‡º&#x27;</span></span><br><span class="line">                df.loc[ç´¢å¼•, <span class="string">&#x27;åˆ†ç±»ç½®ä¿¡åº¦&#x27;</span>] = <span class="number">0.3</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># é«˜çº§åˆ†æ</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ğŸ“Š æ‰§è¡Œé«˜çº§åˆ†æ...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è®¡ç®—å„ç±»åˆ«çš„ç»Ÿè®¡ä¿¡æ¯</span></span><br><span class="line">    åˆ†ç±»ç»Ÿè®¡ = df.groupby(<span class="string">&#x27;åˆ†ç±»ç»“æœ&#x27;</span>).agg(&#123;</span><br><span class="line">        <span class="string">&#x27;é‡‘é¢&#x27;</span>: [<span class="string">&#x27;count&#x27;</span>, <span class="string">&#x27;sum&#x27;</span>, <span class="string">&#x27;mean&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;åˆ†ç±»ç½®ä¿¡åº¦&#x27;</span>: <span class="string">&#x27;mean&#x27;</span></span><br><span class="line">    &#125;).<span class="built_in">round</span>(<span class="number">2</span>)</span><br><span class="line">    </span><br><span class="line">    åˆ†ç±»ç»Ÿè®¡.columns = [<span class="string">&#x27;ç¬”æ•°&#x27;</span>, <span class="string">&#x27;æ€»é‡‘é¢&#x27;</span>, <span class="string">&#x27;å¹³å‡é‡‘é¢&#x27;</span>, <span class="string">&#x27;å¹³å‡ç½®ä¿¡åº¦&#x27;</span>]</span><br><span class="line">    åˆ†ç±»ç»Ÿè®¡ = åˆ†ç±»ç»Ÿè®¡.sort_values(<span class="string">&#x27;æ€»é‡‘é¢&#x27;</span>, ascending=<span class="literal">False</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nåˆ†ç±»ç»Ÿè®¡ç»“æœï¼š&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(åˆ†ç±»ç»Ÿè®¡)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å¼‚å¸¸æ£€æµ‹</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nğŸ” å¼‚å¸¸æ£€æµ‹ï¼š&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å¤§é¢å¼‚å¸¸æ£€æµ‹</span></span><br><span class="line">    å¤§é¢é˜ˆå€¼ = df[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">abs</span>().quantile(<span class="number">0.95</span>)</span><br><span class="line">    å¤§é¢äº¤æ˜“ = df[df[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">abs</span>() &gt; å¤§é¢é˜ˆå€¼]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(å¤§é¢äº¤æ˜“) &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å‘ç°<span class="subst">&#123;<span class="built_in">len</span>(å¤§é¢äº¤æ˜“)&#125;</span>ç¬”å¤§é¢äº¤æ˜“ï¼ˆ&gt;<span class="subst">&#123;å¤§é¢é˜ˆå€¼:<span class="number">.2</span>f&#125;</span>å…ƒï¼‰ï¼š&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> _, äº¤æ˜“ <span class="keyword">in</span> å¤§é¢äº¤æ˜“.iterrows():</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;äº¤æ˜“[<span class="string">&#x27;äº¤æ˜“æ—¥æœŸ&#x27;</span>]&#125;</span>ï¼š<span class="subst">&#123;äº¤æ˜“[<span class="string">&#x27;åˆ†ç±»ç»“æœ&#x27;</span>]&#125;</span> - <span class="subst">&#123;äº¤æ˜“[<span class="string">&#x27;é‡‘é¢&#x27;</span>]:,<span class="number">.2</span>f&#125;</span>å…ƒ&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ä½ç½®ä¿¡åº¦æ£€æµ‹</span></span><br><span class="line">    ä½ç½®ä¿¡åº¦é˜ˆå€¼ = <span class="number">0.5</span></span><br><span class="line">    ä½ç½®ä¿¡åº¦äº¤æ˜“ = df[df[<span class="string">&#x27;åˆ†ç±»ç½®ä¿¡åº¦&#x27;</span>] &lt; ä½ç½®ä¿¡åº¦é˜ˆå€¼]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(ä½ç½®ä¿¡åº¦äº¤æ˜“) &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\nå‘ç°<span class="subst">&#123;<span class="built_in">len</span>(ä½ç½®ä¿¡åº¦äº¤æ˜“)&#125;</span>ç¬”ä½ç½®ä¿¡åº¦åˆ†ç±»ï¼š&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> _, äº¤æ˜“ <span class="keyword">in</span> ä½ç½®ä¿¡åº¦äº¤æ˜“.iterrows():</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;äº¤æ˜“[<span class="string">&#x27;äº¤æ˜“æ—¥æœŸ&#x27;</span>]&#125;</span>ï¼š<span class="subst">&#123;äº¤æ˜“[<span class="string">&#x27;åˆ†ç±»ç»“æœ&#x27;</span>]&#125;</span>ï¼ˆç½®ä¿¡åº¦ï¼š<span class="subst">&#123;äº¤æ˜“[<span class="string">&#x27;åˆ†ç±»ç½®ä¿¡åº¦&#x27;</span>]:<span class="number">.2</span>f&#125;</span>ï¼‰&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;âœ… æ™ºèƒ½åˆ†ç±»å®Œæˆï¼&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> df</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œæ™ºèƒ½åˆ†ç±»</span></span><br><span class="line">æµæ°´_åˆ†ç±»ç»“æœ = æ™ºèƒ½æµæ°´åˆ†ç±»(é“¶è¡Œæµæ°´)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆåˆ†ç±»æŠ¥å‘Š</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;\nğŸ“ˆ åˆ†ç±»ç»“æœæ‘˜è¦ï¼š&quot;</span>)</span><br><span class="line">åˆ†ç±»æ±‡æ€» = æµæ°´_åˆ†ç±»ç»“æœ[<span class="string">&#x27;åˆ†ç±»ç»“æœ&#x27;</span>].value_counts()</span><br><span class="line"><span class="keyword">for</span> åˆ†ç±», æ•°é‡ <span class="keyword">in</span> åˆ†ç±»æ±‡æ€».items():</span><br><span class="line">    å¹³å‡ç½®ä¿¡åº¦ = æµæ°´_åˆ†ç±»ç»“æœ[æµæ°´_åˆ†ç±»ç»“æœ[<span class="string">&#x27;åˆ†ç±»ç»“æœ&#x27;</span>] == åˆ†ç±»][<span class="string">&#x27;åˆ†ç±»ç½®ä¿¡åº¦&#x27;</span>].mean()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;åˆ†ç±»&#125;</span>ï¼š<span class="subst">&#123;æ•°é‡&#125;</span>ç¬”ï¼ˆå¹³å‡ç½®ä¿¡åº¦ï¼š<span class="subst">&#123;å¹³å‡ç½®ä¿¡åº¦:<span class="number">.2</span>f&#125;</span>ï¼‰&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯è§†åŒ–åˆ†ç±»ç»“æœ</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­å›¾1ï¼šåˆ†ç±»é¥¼å›¾</span></span><br><span class="line">plt.subplot(<span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">åˆ†ç±»ç»Ÿè®¡ = æµæ°´_åˆ†ç±»ç»“æœ[<span class="string">&#x27;åˆ†ç±»ç»“æœ&#x27;</span>].value_counts()</span><br><span class="line">plt.pie(åˆ†ç±»ç»Ÿè®¡.values, labels=åˆ†ç±»ç»Ÿè®¡.index, autopct=<span class="string">&#x27;%1.1f%%&#x27;</span>, startangle=<span class="number">90</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;äº¤æ˜“åˆ†ç±»åˆ†å¸ƒ&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­å›¾2ï¼šæ”¶å…¥vsæ”¯å‡º</span></span><br><span class="line">plt.subplot(<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">æ”¶æ”¯å¯¹æ¯” = æµæ°´_åˆ†ç±»ç»“æœ.groupby([<span class="string">&#x27;åˆ†ç±»ç»“æœ&#x27;</span>, æµæ°´_åˆ†ç±»ç»“æœ[<span class="string">&#x27;é‡‘é¢&#x27;</span>] &gt; <span class="number">0</span>])[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">sum</span>().unstack(fill_value=<span class="number">0</span>)</span><br><span class="line">æ”¶æ”¯å¯¹æ¯”.plot(kind=<span class="string">&#x27;bar&#x27;</span>, stacked=<span class="literal">True</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;å„ç±»åˆ«æ”¶å…¥vsæ”¯å‡º&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;åˆ†ç±»&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;é‡‘é¢&#x27;</span>)</span><br><span class="line">plt.xticks(rotation=<span class="number">45</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­å›¾3ï¼šæ—¶é—´åºåˆ—</span></span><br><span class="line">plt.subplot(<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">æ—¥åˆ†ç±»é‡‘é¢ = æµæ°´_åˆ†ç±»ç»“æœ.groupby([<span class="string">&#x27;äº¤æ˜“æ—¥æœŸ&#x27;</span>, <span class="string">&#x27;åˆ†ç±»ç»“æœ&#x27;</span>])[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">sum</span>().unstack(fill_value=<span class="number">0</span>)</span><br><span class="line">æ—¥åˆ†ç±»é‡‘é¢.plot(kind=<span class="string">&#x27;line&#x27;</span>, marker=<span class="string">&#x27;o&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;å„ç±»åˆ«é‡‘é¢æ—¶é—´åºåˆ—&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;æ—¥æœŸ&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;é‡‘é¢&#x27;</span>)</span><br><span class="line">plt.xticks(rotation=<span class="number">45</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­å›¾4ï¼šç½®ä¿¡åº¦åˆ†å¸ƒ</span></span><br><span class="line">plt.subplot(<span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line">plt.hist(æµæ°´_åˆ†ç±»ç»“æœ[<span class="string">&#x27;åˆ†ç±»ç½®ä¿¡åº¦&#x27;</span>], bins=<span class="number">10</span>, edgecolor=<span class="string">&#x27;black&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;åˆ†ç±»ç½®ä¿¡åº¦åˆ†å¸ƒ&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;ç½®ä¿¡åº¦&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;é¢‘æ•°&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.savefig(<span class="string">&#x27;é“¶è¡Œæµæ°´æ™ºèƒ½åˆ†ç±»åˆ†æ.png&#x27;</span>, dpi=<span class="number">300</span>, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br><span class="line">plt.close()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;âœ… å¯è§†åŒ–åˆ†æå›¾è¡¨å·²ç”Ÿæˆï¼&quot;</span>)</span><br></pre></td></tr></table></figure></details><hr><h3 id="ğŸ’­-ä»Šæ—¥æ€è€ƒ"><a href="#ğŸ’­-ä»Šæ—¥æ€è€ƒ" class="headerlink" title="ğŸ’­ ä»Šæ—¥æ€è€ƒ"></a>ğŸ’­ ä»Šæ—¥æ€è€ƒ</h3><p>é€šè¿‡ä»Šå¤©çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å‘ç°ï¼š</p><ul><li>ç°å®ä¸–ç•Œçš„æ•°æ®æ€»æ˜¯â€œè„â€çš„ï¼Œéœ€è¦æ¸…æ´—æ‰èƒ½ä½¿ç”¨</li><li>Pythonå¯ä»¥è‡ªåŠ¨è¯†åˆ«å’Œå¤„ç†å„ç§æ•°æ®è´¨é‡é—®é¢˜</li><li>æ•°æ®æ¸…æ´—æ¯”æ‰‹å·¥æ¸…æ´—æ›´å¿«ã€æ›´å‡†ç¡®ã€æ›´ä¸€è‡´</li><li>ä¸“ä¸šçš„æ•°æ®æ¸…æ´—ç³»ç»Ÿèƒ½å¤§å¹…æå‡æ•°æ®è´¨é‡</li></ul><hr><h3 id="ğŸ“-è¯¾åå°ç»“"><a href="#ğŸ“-è¯¾åå°ç»“" class="headerlink" title="ğŸ“ è¯¾åå°ç»“"></a>ğŸ“ è¯¾åå°ç»“</h3><ul><li>âœ… å­¦ä¼šäº†è¯†åˆ«å’Œå¤„ç†ç¼ºå¤±å€¼</li><li>âœ… æŒæ¡äº†ç»Ÿä¸€æ•°æ®æ ¼å¼çš„æ–¹æ³•</li><li>âœ… èƒ½å¤Ÿå¤„ç†æ–‡æœ¬ã€æ•°å­—ã€æ—¥æœŸç­‰å„ç§æ•°æ®ç±»å‹</li><li>âœ… å®Œæˆäº†ä¸“ä¸šçš„å®¢æˆ·ä¿¡æ¯æ¸…æ´—ç³»ç»Ÿ</li></ul><hr><h3 id="ğŸ¯-ä¸‹èŠ‚é¢„å‘Š"><a href="#ğŸ¯-ä¸‹èŠ‚é¢„å‘Š" class="headerlink" title="ğŸ¯ ä¸‹èŠ‚é¢„å‘Š"></a>ğŸ¯ ä¸‹èŠ‚é¢„å‘Š</h3><p>ä¸‹èŠ‚æˆ‘ä»¬å°†å­¦ä¹ <strong>ç®€å•çš„æ•°æ®åˆ†æ</strong>ï¼ŒæŒæ¡åŸºç¡€ç»Ÿè®¡è¿ç®—ã€å­¦ä¼šåˆ†ç»„ç»Ÿè®¡ï¼Œç”¨Pythonåšäº›â€œç®€å•â€çš„æ•°æ®åˆ†æï¼Œè®©è€æ¿å¯¹ä½ çš„åˆ†æèƒ½åŠ›åˆ®ç›®ç›¸çœ‹ï¼</p><hr><h3 id="ğŸ’¡-å°è´´å£«"><a href="#ğŸ’¡-å°è´´å£«" class="headerlink" title="ğŸ’¡ å°è´´å£«"></a>ğŸ’¡ å°è´´å£«</h3><ul><li>æ•°æ®æ¸…æ´—æ˜¯æ•°æ®åˆ†æçš„åŸºç¡€ï¼Œä¸€å®šè¦é‡è§†</li><li>ä¸åŒçš„æ•°æ®ç±»å‹è¦ç”¨ä¸åŒçš„æ¸…æ´—æ–¹æ³•</li><li>æ¸…æ´—åè¦éªŒè¯æ•°æ®è´¨é‡ï¼Œç¡®ä¿æ¸…æ´—æ•ˆæœ</li><li>å»ºç«‹æ ‡å‡†åŒ–çš„æ¸…æ´—æµç¨‹ï¼Œæé«˜å·¥ä½œæ•ˆç‡</li></ul><hr><blockquote><p>ğŸ¤– Powered by Kimi K2 0905 ğŸ’» å†…å®¹ç»è‘µè‘µğŸŒ»å®¡æ ¸ä¸ä¿®æ”¹</p></blockquote><hr></div><footer class="post-footer"><div class="post-nav"><div class="post-nav-item"><a href="/889621e3.html" rel="prev" title="Python-ç¬¬9ç¯‡ã€Špandaså…¥é—¨ï¼šæ•°æ®å¤„ç†çš„ç‘å£«å†›åˆ€ã€‹"><i class="fa fa-chevron-left"></i> Python-ç¬¬9ç¯‡ã€Špandaså…¥é—¨ï¼šæ•°æ®å¤„ç†çš„ç‘å£«å†›åˆ€ã€‹</a></div><div class="post-nav-item"><a href="/4b71c371.html" rel="next" title="Python-ç¬¬11ç¯‡ã€Šç®€å•çš„æ•°æ®åˆ†æã€‹">Python-ç¬¬11ç¯‡ã€Šç®€å•çš„æ•°æ®åˆ†æã€‹ <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="valine-comments"></div><script>window.addEventListener("tabs:register",()=>{let t=CONFIG.comments["activeClass"];var e;(t=CONFIG.comments.storage?localStorage.getItem("comments_active")||t:t)&&(e=document.querySelector(`a[href="#comment-${t}"]`))&&e.click()}),CONFIG.comments.storage&&window.addEventListener("tabs:click",t=>{t.target.matches(".tabs-comment .tab-content .tab-pane")&&(t=t.target.classList[1],localStorage.setItem("comments_active",t))})</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">æ–‡ç« ç›®å½•</li><li class="sidebar-nav-overview">ç«™ç‚¹æ¦‚è§ˆ</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%93%96-%E5%BC%80%E7%AF%87%E8%AF%AD"><span class="nav-number">1.</span> <span class="nav-text">ğŸ“– å¼€ç¯‡è¯­</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%8E%AF-%E4%BB%8A%E6%97%A5%E5%AD%A6%E4%B9%A0%E7%9B%AE%E6%A0%87"><span class="nav-number">2.</span> <span class="nav-text">ğŸ¯ ä»Šæ—¥å­¦ä¹ ç›®æ ‡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%A7%B9-%E4%BB%80%E4%B9%88%E6%98%AF%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97%EF%BC%9F"><span class="nav-number">3.</span> <span class="nav-text">ğŸ§¹ ä»€ä¹ˆæ˜¯æ•°æ®æ¸…æ´—ï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%94%8D-%E8%AF%86%E5%88%AB%E8%84%8F%E6%95%B0%E6%8D%AE%EF%BC%9A%E5%85%88%E5%8F%91%E7%8E%B0%E9%97%AE%E9%A2%98"><span class="nav-number">4.</span> <span class="nav-text">ğŸ” è¯†åˆ«è„æ•°æ®ï¼šå…ˆå‘ç°é—®é¢˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%A7%BD-%E5%A4%84%E7%90%86%E7%BC%BA%E5%A4%B1%E5%80%BC%EF%BC%9A%E6%8A%8A%E2%80%9C%E7%A9%BA%E2%80%9D%E5%8F%98%E6%88%90%E2%80%9C%E6%BB%A1%E2%80%9D"><span class="nav-number">5.</span> <span class="nav-text">ğŸ§½ å¤„ç†ç¼ºå¤±å€¼ï¼šæŠŠâ€œç©ºâ€å˜æˆâ€œæ»¡â€</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%94%84-%E7%BB%9F%E4%B8%80%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F%EF%BC%9A%E8%AE%A9%E6%95%B0%E6%8D%AE%E2%80%9C%E6%95%B4%E9%BD%90%E5%88%92%E4%B8%80%E2%80%9D"><span class="nav-number">6.</span> <span class="nav-text">ğŸ”„ ç»Ÿä¸€æ•°æ®æ ¼å¼ï¼šè®©æ•°æ®â€œæ•´é½åˆ’ä¸€â€</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%A7%AA-%E6%95%B0%E6%8D%AE%E9%AA%8C%E8%AF%81%EF%BC%9A%E7%A1%AE%E4%BF%9D%E6%B8%85%E6%B4%97%E8%B4%A8%E9%87%8F"><span class="nav-number">7.</span> <span class="nav-text">ğŸ§ª æ•°æ®éªŒè¯ï¼šç¡®ä¿æ¸…æ´—è´¨é‡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%92%BC-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%EF%BC%9A%E6%B8%85%E7%90%86%E5%AE%A2%E6%88%B7%E4%BF%A1%E6%81%AF%E8%A1%A8"><span class="nav-number">8.</span> <span class="nav-text">ğŸ’¼ å®æˆ˜é¡¹ç›®ï¼šæ¸…ç†å®¢æˆ·ä¿¡æ¯è¡¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%8F%83%E2%80%8D%E2%99%80%EF%B8%8F-%E8%BF%9B%E9%98%B6%E5%B0%8F%E6%8C%91%E6%88%98"><span class="nav-number">9.</span> <span class="nav-text">ğŸƒâ€â™€ï¸ è¿›é˜¶å°æŒ‘æˆ˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%92%AD-%E4%BB%8A%E6%97%A5%E6%80%9D%E8%80%83"><span class="nav-number">10.</span> <span class="nav-text">ğŸ’­ ä»Šæ—¥æ€è€ƒ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%93%9D-%E8%AF%BE%E5%90%8E%E5%B0%8F%E7%BB%93"><span class="nav-number">11.</span> <span class="nav-text">ğŸ“ è¯¾åå°ç»“</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%8E%AF-%E4%B8%8B%E8%8A%82%E9%A2%84%E5%91%8A"><span class="nav-number">12.</span> <span class="nav-text">ğŸ¯ ä¸‹èŠ‚é¢„å‘Š</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%92%A1-%E5%B0%8F%E8%B4%B4%E5%A3%AB"><span class="nav-number">13.</span> <span class="nav-text">ğŸ’¡ å°è´´å£«</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Aisaka Aoi" src="/images/manatsu.jpg"><p class="site-author-name" itemprop="name">Aisaka Aoi</p><div class="site-description" itemprop="description">é€¢å‚è‘µçš„ä¸ªäººåšå®¢</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">1023</span> <span class="site-state-item-name">æ—¥å¿—</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">20</span> <span class="site-state-item-name">åˆ†ç±»</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/AisakaAoi" title="GitHub ğŸ‘¨â€ğŸ’» â†’ https:&#x2F;&#x2F;github.com&#x2F;AisakaAoi" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub ğŸ‘¨â€ğŸ’»</a> </span><span class="links-of-author-item"><a href="https://github.com/Aisakaorz" title="GitHub ğŸ‘©â€ğŸ’» â†’ https:&#x2F;&#x2F;github.com&#x2F;Aisakaorz" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub ğŸ‘©â€ğŸ’»</a> </span><span class="links-of-author-item"><a href="mailto:aisakaaoi@qq.com" title="E-Mail ğŸ“§ â†’ mailto:aisakaaoi@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail ğŸ“§</a> </span><span class="links-of-author-item"><a href="mailto:chenzongnan@m.scnu.edu.cn" title="E-Mail ğŸ« â†’ mailto:chenzongnan@m.scnu.edu.cn" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail ğŸ«</a> </span><span class="links-of-author-item"><a href="https://space.bilibili.com/91560309" title="Bilibili ğŸ“º â†’ https:&#x2F;&#x2F;space.bilibili.com&#x2F;91560309" rel="noopener" target="_blank"><i class="fab fa-bilibili fa-fw"></i>Bilibili ğŸ“º</a> </span><span class="links-of-author-item"><a href="https://space.bilibili.com/198562921" title="Bilibili ğŸ® â†’ https:&#x2F;&#x2F;space.bilibili.com&#x2F;198562921" rel="noopener" target="_blank"><i class="fab fa-bilibili fa-fw"></i>Bilibili ğŸ®</a> </span><span class="links-of-author-item"><a href="https://www.youtube.com/channel/UCALvyn5Cl76GCotO9pczvjg" title="YouTube ğŸ“º â†’ https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCALvyn5Cl76GCotO9pczvjg" rel="noopener" target="_blank"><i class="fab fa-youtube fa-fw"></i>YouTube ğŸ“º</a></span></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2026</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Aisaka Aoi</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span class="post-meta-item-text">ç«™ç‚¹æ€»å­—æ•°ï¼š</span> <span title="ç«™ç‚¹æ€»å­—æ•°">4m</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span class="post-meta-item-text">ç«™ç‚¹é˜…è¯»æ—¶é•¿ &asymp;</span> <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">164:56</span></div><div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨</div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script>document.querySelectorAll(".pdfobject-container").forEach(e=>{var t=e.dataset.target,a="#"+Object.entries({navpanes:0,toolbar:0,statusbar:0,pagemode:"thumbs",view:"FitH"}).map(([e,t])=>e+"="+encodeURIComponent(t)).join("&"),r="/lib/pdf/web/viewer.html?file="+encodeURIComponent(t)+a;NexT.utils.supportsPDFs()?e.innerHTML=`<embed class="pdfobject" src="${t+a}" type="application/pdf" style="height: ${e.dataset.height};">`:e.innerHTML=`<iframe src="${r}" style="height: ${e.dataset.height};" frameborder="0"></iframe>`})</script><script>NexT.utils.loadComments(document.querySelector("#valine-comments"),()=>{NexT.utils.getScript("//unpkg.com/valine/dist/Valine.min.js",()=>{var i=["nick","mail","link"],e="nick,mail,link".split(",").filter(e=>i.includes(e));new Valine({el:"#valine-comments",verify:!0,notify:!0,appId:"UqjWdRYbIUEUQRXhBUUIh1QE-gzGzoHsz",appKey:"gj89JXC485PFbpdHLKVkz6dm",placeholder:"è¿™é‡Œå¯ä»¥å‘é€è¯„è®º~ï¼ˆä¸Šé¢å¯ä»¥è¾“å…¥æ˜µç§°ã€é‚®ç®±ï¼‰",avatar:"mm",meta:e,pageSize:"10",visitor:!0,lang:"zh-cn",path:location.pathname,recordIP:!1,serverURLs:""})},window.Valine)})</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/assets/haru02.model.json"},display:{position:"right",width:208,height:520},mobile:{show:!1},log:!1})</script></body></html>