<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0"><meta name="baidu-site-verification" content="code-KCMz4b3cnd"><meta name="google-site-verification" content="MTp8U7dJ1uzrfz8Mu6rgqX1CIm3HjqPWd0xaRcv1tFg"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="mask-icon" href="/images/favicon.png" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"aisakaaoi.top",root:"/",scheme:"Pisces",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:"valine",storage:!0,lazyload:!1,nav:null,activeClass:"valine"},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="今天分享一下李沐大神团队带来的对比学习串烧。该 talking 讲述的是对比学习在计算机视觉领域的发展历程。"><meta property="og:type" content="article"><meta property="og:title" content="论文阅读-对比学习论文综述-总结再整理"><meta property="og:url" content="https://aisakaaoi.top/f08f0e17.html"><meta property="og:site_name" content="逢坂葵的个人博客"><meta property="og:description" content="今天分享一下李沐大神团队带来的对比学习串烧。该 talking 讲述的是对比学习在计算机视觉领域的发展历程。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/1.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/2.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/3.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/4.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/5.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/6.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/7.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/8.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/9.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/10.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/11.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/12.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/13.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/14.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/15.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/16.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/17.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/18.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/19.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/20.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/21.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/22.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/23.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/24.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/25.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/26.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/27.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/28.webp"><meta property="og:image" content="https://aisakaaoi.top/f08f0e17/29.webp"><meta property="article:published_time" content="2022-06-02T17:00:30.000Z"><meta property="article:modified_time" content="2023-06-18T20:02:58.900Z"><meta property="article:author" content="Aisaka Aoi"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://aisakaaoi.top/f08f0e17/1.webp"><link rel="canonical" href="https://aisakaaoi.top/f08f0e17.html"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>论文阅读-对比学习论文综述-总结再整理 | 逢坂葵的个人博客</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?7308ed05421777c301eefa3754da1b42",document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="逢坂葵的个人博客" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">逢坂葵葵</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">Aisaka's Blog</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">51</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">558</span></a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="reading-progress-bar"></div><a href="https://github.com/AisakaAoi" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://aisakaaoi.top/f08f0e17.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/manatsu.jpg"><meta itemprop="name" content="Aisaka Aoi"><meta itemprop="description" content="Aisaka's Blog"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="逢坂葵的个人博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">论文阅读-对比学习论文综述-总结再整理</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-06-03 01:00:30" itemprop="dateCreated datePublished" datetime="2022-06-03T01:00:30+08:00">2022-06-03</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%F0%9F%8C%99%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">🌙进阶学习</span></a> </span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%F0%9F%8C%99%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0/%E2%AD%90%E8%AE%BA%E6%96%87%E5%B8%A6%E8%AF%BB/" itemprop="url" rel="index"><span itemprop="name">⭐论文带读</span></a> </span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%F0%9F%8C%99%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0/%E2%AD%90%E8%AE%BA%E6%96%87%E5%B8%A6%E8%AF%BB/%F0%9F%92%AB%E7%B2%BE%E8%AF%BB%E7%BB%8F%E5%85%B8/" itemprop="url" rel="index"><span itemprop="name">💫精读经典</span></a> </span></span><span id="/f08f0e17.html" class="post-meta-item leancloud_visitors" data-flag-title="论文阅读-对比学习论文综述-总结再整理" title="阅读次数"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span class="leancloud-visitors-count"></span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Valine：</span> <a title="valine" href="/f08f0e17.html#valine-comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/f08f0e17.html" itemprop="commentCount"></span></a></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>7.1k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>18 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><p>今天分享一下李沐大神团队带来的对比学习串烧。该 talking 讲述的是对比学习在计算机视觉领域的发展历程。</p><iframe src="//player.bilibili.com/player.html?aid=680170801&bvid=BV19S4y1M7hm&cid=472587940&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen></iframe><span id="more"></span> <img src="/f08f0e17/1.webp"><hr><h3 id="第一阶段：百花齐放"><a href="#第一阶段：百花齐放" class="headerlink" title="第一阶段：百花齐放"></a>第一阶段：百花齐放</h3><p>方法、模型都没有统一，目标函数，代理任务也没有统一，所以说是一个百花齐放的年代。</p><h4 id="InstDise"><a href="#InstDise" class="headerlink" title="InstDise"></a>InstDise</h4><p><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/1805.01978.pdf">InstDise 论文传送门</a></p><img src="/f08f0e17/2.webp"><p>举个例子，将一张豹子的图片输入到一个有监督数据分类的分类器中，与其相似度较高的图片都是美洲虎或者猎豹，倒不是因为他们之间的语义相似性很高，主要是因为他们的图片之间实在太相似了。因此，作者将这种有监督的任务发挥到极致，提出了个体判别任务，作者将每一张图片都看作是一个类别，希望模型可以学习图片的表征，从而把各种图片都区分出来。</p><img src="/f08f0e17/3.webp"><p>作者的方法就是使用一个卷积神经网络，将图片作为输入，获得图片的低纬向量表征，让这些向量可以表示这些图片，因为作者将每一个图片都视为是单独的类别，因此，向量的表征应该尽可能的分散开来。</p><p>训练这个神经网络的方法是对比学习，所以需要有正样本，需要有负样本。正样本就是图像本身，可能经过数据增强，负样本就是数据集中其余的所有图片，该文章使用一个 memory bank 存储这些负样本，imagenet 中有 128w 的数据，意味着 memory bank 有 128w 行，因为负样本太多了，如果使用较高的维度表示图片的话，对于负样本的存储代价过高，因此作者让向量维度为 128 维。</p><p>让我们简单的走一下这个前向传播的过程，假设模型的 batchsize 是 256，有 256 张图片进入 CNN 网络，将 256 张图片编码为 128 维的向量。因为 batchsize 是 256，因此有 256 个正样本。负样本来自 memory bank，每次从 memory bank 中随机采样出 4096 个负数样本，利用 infoNCE loss 去更新 CNN 的参数。本次更新结束后，会将 CNN 编码得到的向量替换掉 memory bank 中原有的存储。就这样循环往复的更新 CNN 和 memory bank，最后让模型收敛，就训练好一个 CNN encoder 了。</p><p>InstDise 提出了个体判别这个代理任务，而且用这个代理任务和 nce loss 去做对比学习取得了不错的无监督表征学习的结果，同时提出了用别的结构存储这些大量的负样本，以及如何进行动量的更新，为后续的对比学习的工作产生了推进的作用。</p><hr><h4 id="InvaSpread"><a href="#InvaSpread" class="headerlink" title="InvaSpread"></a>InvaSpread</h4><p><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/1904.03436.pdf">InvaSpread 论文传送门</a></p><p>可以理解为是 SimeCLR 的前身。InvaSpread 并没有用额外的数据结构存储大量的负样本，他就是用 mini batch 中的数据作为负样本，而且使用一个编码器进行端到端的学习。</p><img src="/f08f0e17/4.webp"><p>该工作的思路就是对比学习。相同的图片所提取的特征应该比较类似，不同图片所提取的特征应该不类似。</p><p>该文章的代理任务也是实体判别任务，这里着重讲一下该文章中正例和负例的选择。</p><img src="/f08f0e17/5.webp"><p>该文章设置的 batchsize 是 256。首先利用数据增广，将每个图片增广一次，也就是将 256 张图片变为 512 个图片了。之后将 512 张图片通过 CNN 编码为向量，并使用一个全连接层将数据的维度降低。之后将图片 xi 和其经过增广后的图片 xi’ 作为正样本，其余的 512-2 张图片都认为是负样本。所以总计有 256 个正例，有 2×(256-1) 张负例。之后让正例之间的距离拉近，让正例与负例之间的距离拉远。</p><p>该文章的思路和 SimCLR 的思路差不多，都设计用 batch 中的数据作为正例和负例，但是该文章取得的效果没有 SimCLR 的效果那般炸裂。主要是因为本文所选取的字典长度不够大，batchsize 仅为 256，本文也没有设计 SimCLR 那种投影函数和多样的数据增广方法，因此本文取得的效果不如 SimCLR 那么好。</p><p>以上两篇工作都是使用实例检测作为代理任务的，接下来介绍的这篇文章是利用其他代理任务进行对比学习的。</p><hr><h4 id="CPC"><a href="#CPC" class="headerlink" title="CPC"></a>CPC</h4><p><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/1807.03748.pdf">CPC 论文传送门</a></p><img src="/f08f0e17/6.webp"><p>该模型是一个普适任务的模型，可以将音频，视频，文本等序列作为输入，利用生成的方式进行对比学习。该模型将序列的一部分输入到一个 encoder genc 中得到对应的向量表征，再将这些向量表征输入到一个自回归器 gar 中，从而得到对序列的预测序列。作者认为一个好的 encoder 是可以编码出序列的特征，并且可以通过自回归模型得到未来的预测。这个过程是如何应用对比学习的呢？</p><p>作者将真正的未来序列放入到 encoder genc 中，将得到的嵌入表示作为正例，将其他的序列作为负例，进行对比学习的训练。</p><p>CPC 利用预测的特征进行对比学习，这样的方法可以用在各种以序列为输入的任务上，可以用在音频、视频、文本、以及图片的 patch 序列中，都可以使用这种生成的任务。</p><hr><h4 id="CMC"><a href="#CMC" class="headerlink" title="CMC"></a>CMC</h4><p>在 CPC 利用预测的部分做对比学习后，CMC 使用了更为广泛的负例产生的机制，进行学习。</p><p><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/1906.05849.pdf">CMC 论文传送门</a></p><img src="/f08f0e17/7.webp"><p>CMC 定义正负样本的方式：CMC 使用的数据集是 NYU RGBD 数据集，该数据集包含一张图片的四种 view 数据增强结果。该文章将多 view 作为正例，将其他图片以及其他图片的 views 作为负例子，进行训练。</p><p>CMC 的成功，让我们认识到对比学习可以如此的灵活，Open AI 团队的工作 CLIP 将图片-文本对作为输入，将互相匹配的图像-文本对作为正例，将不匹配的作为负例。同时 CMC 的原班人马利用对比学习做知识蒸馏，他们认为相同的样本在不同的编码器下得到的结果应该尽可能的相似，因此设计的 teacher 和 student 编码得到的相同图片的向量互为正例，不同图片得到的输出作为负例，利用对比学习的思路进行知识蒸馏。</p><p>但是问题在于 multi view 的工作可能需要多个编码器进行编码，训练代价可能有点高。比如 CLIP，就是用大型的语言编码器 BERT 对语言模型进行编码，用视觉模型 VIT 对视觉信息进行编码。</p><p>第一阶段介绍以上四篇工作，可以看到以上的工作代理任务不尽相同，其中有个体判别，有预测未来，还有多视角多模态。使用的目标函数也不尽相同，有 NCE，infoNCE 以及其变体。使用的模型也可以是不同的，比如 InvaSpread 使用的是相同的编码器对 key 和 query 进行编码，CMC 对 key 和 query 使用的是不同的编码，是百花齐放的。</p><hr><h3 id="第二阶段：MOCO和simCLR双雄"><a href="#第二阶段：MOCO和simCLR双雄" class="headerlink" title="第二阶段：MOCO和simCLR双雄"></a>第二阶段：MOCO和simCLR双雄</h3><h4 id="MOCO-v1"><a href="#MOCO-v1" class="headerlink" title="MOCO v1"></a>MOCO v1</h4><p><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/1911.05722.pdf">MOCO v1 论文传送门</a></p><p>主要贡献就是把之前对比学习的一些方法归纳为一个字典查询问题。提出了一个队列，一个动量编码器，从而形成一个又大又一致的字典，帮助更好的进行对比学习。</p><img src="/f08f0e17/8.webp"><p>MOCO 和 InstDise 有很多类似的地方，但是 MOCO 对 InstDise 的改进可以说是简单又有效，其提出用队列替换 memory bank 以及提出了动量更新的方式，对效果有显著的提升，同时对后续工作也产生了深远的影响。</p><hr><h4 id="simCLR-v1"><a href="#simCLR-v1" class="headerlink" title="simCLR v1"></a>simCLR v1</h4><p><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2002.05709.pdf">simCLR v1 论文传送门</a></p><img src="/f08f0e17/9.webp"><p>假如有一个 minibatch 的图片，对整个 minibatch 的所有图片做数据增强，对图片 x 做不同的数据增强就会得到 xi 和 xj。同一个图片延申得到的两个图片就是正样本，比如 batchsize 是 n 的话，那么正样本就是 n，这个 batchsize 剩下的所有的样本以及其经过数据增强后得到的都是负样本，也就是 2(n-1)。有了正负样本之后，对其进行编码，通过一个编码器 f(·) 得到正负样本的编码结果 h。simCLR 的创新点就是在得到数据的编码之后在后面加了一个编码层 g(·) 函数，就是一个 MLP 层，得到较低维度的特征 zi 和 zj，用其进行对比学习，拉近正例之间的距离，拉远负例之间的距离。但是需要注意的一点就是投影函数仅仅在训练的时候才使用，在测试的时候是不使用的，测试的时候仅仅使用编码器 f(·)。加上投影函数的目的也仅仅是想让模型训练的更好。</p><p>SimCLR 和 InvaSpread 非常接近，不同之处在于：</p><ol><li>SimCLR 使用了更多的数据增强</li><li>加入了投影的 g(·) 函数</li><li>就是 SimCLR 用了更大的 batchsize，且训练的时间更久</li></ol><img src="/f08f0e17/10.webp"><p>SimCLR 使用了以上的数据增强的方式</p><img src="/f08f0e17/11.webp"><p>同时对各种数据增强方式进行了详细的消融实验</p><img src="/f08f0e17/12.webp"><p>作者还对这个投影层做了一些实验，可以看到使用非线性变化的效果是十分显著的，同时对于对比学习维度变化，似乎并不会对效果产生影响。</p><hr><h4 id="MOCO-v2"><a href="#MOCO-v2" class="headerlink" title="MOCO v2"></a>MOCO v2</h4><p><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2003.04297.pdf">MOCO v2 论文传送门</a></p><img src="/f08f0e17/13.webp"> <img src="/f08f0e17/14.webp"><p>MOCO v2 相当于是把 SimCLR 中值得借鉴的地方拿来借鉴。</p><p>比如其中 MLP 的投影层，更多的数据增强方式，cosine learning rate schedule，以及更多的迭代 epoch。其中 supervised 是 backbone 在有监督训练中进行训练的结果。在加入了 SimCLR 的一些改进点后，确实取得了模型性能的进步。</p><img src="/f08f0e17/15.webp"><p>作者对比了 MOCO v2 和 SimCLR 在相同的 epoch 和 batch 下的效果对比，在较小的 batch 和 epoch 下，MOCO v2 取得了较好的效果，在较大的 batch 和 epoch 下，也取得了较好的效果。</p><img src="/f08f0e17/16.webp"><p>作者将 MOCO v2 和 SimCLR 的算力作对比，发现 SimCLR 在 batch 较少的情况下无法发挥效果，在 batch 多的情况下才可以出效果，但是算力要求太高了。所以 MOCO 是一个对于计算资源要求不是很高，但是却很有效的模型。</p><hr><h4 id="SimCLR-v2"><a href="#SimCLR-v2" class="headerlink" title="SimCLR v2"></a>SimCLR v2</h4><p><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2006.10029.pdf">SimCLR v2 论文传送门</a></p><img src="/f08f0e17/17.webp"><p>SimCLR v2 文章提出了一套用自监督网络作半监督训练的流程，该流程是用大网络（SimCLR v2）作自监督的预训练，预训练部分是没有特定下游任务的，因此不具备下游任务知识；之后使用少部分有标注的数据对模型进行微调，从而让模型学习下游任务的特定知识；让微调的模型作为 teacher 模型，为更多的数据打伪标签，从而实现自学习。</p><p>SimCLR v1 是如何升级到 SimCLR v2 的呢？</p><ol><li>如果使用更大的模型，则无监督训练就会训练的更好，所以 SimCLR v2 使用了 ResNet-152 并且使用了 selective kernels，从而让骨干网络更加强悍</li><li>原来的非线性投影层是十分有效的，那么更深的非线性层会不会更加有效呢？于是作者尝试使用 2 层，3 层，最后发现 2 层的效果是最好的</li><li>作者尝试了 MOCO 的动量编码器，发现效果是有提升的，但是提升的不是非常显著，大概是一个百分点，原因是 SimCLR v2 已经有很大的 batchsize 了，所以不需要太多的动量以及队列的负样本了</li></ol><hr><h4 id="SwAV"><a href="#SwAV" class="headerlink" title="SwAV"></a>SwAV</h4><p><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2006.09882.pdf">SwAV 论文传送门</a></p><img src="/f08f0e17/18.webp"><p>以往的基于对比学习的方法都是将一个实例 x 通过两次数据增强变为 x1 和 x2，之后利用编码器对其进行编码，从而得到嵌入向量 z1 和 z2，之后使用对比学习的 loss 更新这个 encoder。</p><p>即使以往的工作是非常有效并且简洁的，但是因为负样本太多了，从而造成资源的浪费，即使是 MOCO 这样用近似的方式用 6w 个负样本，但是总共还是有 128w 个负样本的，所以 SwAV 的作者去想，能不能不做近似呢？可不可以使用先验信息，不去和大量的负样本对比，而是和一些更加简洁的东西去比呢？所以 SwAV 的作者想，可以和聚类的中心进行对比，这个聚类中心就是 C ，维度是 3000 × 向量维度，3000 表示聚类中心的数量。</p><p>前向过程依旧是一个样例 x 经过两个数据增强转化为 x1 和 x2，之后经过编码器得到 z1 和 z2，让 z1 和 z2 和聚类中心 C 进行聚类，从而得到 ground truth 的标签 Q1 和 Q2，模型让 z1 和 C 预测 Q2，让 z2 和 C 预测 Q1。通过这种交叉预测的方式对模型进行更新。</p><p>SwAV 的优势在于：</p><ol><li>如果是和负例进行对比的话，需要和成千上万个负例进行对比，即使是 MOCO 中 6w 个负例，也只是一个近似的值，但是聚类的话，就仅仅需要和 3000 个聚类核心即可</li><li>这些聚类中心是有含义的，而如果像之前一样用负样本进行对比学习的话，有的负样本不均衡，有的还可能是正样本，不如聚类中心有效</li></ol><img src="/f08f0e17/19.webp"><p>第二个贡献就是 multi-crop 的思想，以往的对比学习方法都是在一张 256 × 256 的图片上用两个 224 × 224 的 crop 求两个正样本，但是因为 crop 过大了，所选取的 crop 都是基于全局特征的。但是可能很多局部特征才是非常有价值的，SwAV 使用了一种 multi-crop 的思路进行操作，即选择了两个 160 × 160 的 crop 去搞定全局特征，选择 4 个 96 × 96 的 crop 去搞定局部特征。这样在计算量变化不大的情况下，可以获取更多的正样本。</p><img src="/f08f0e17/20.webp"><p>到了第二阶段，其实很多细节都趋于统一了，比如目标函数都是使用 infoNCE，模型都归一为用一个 encoder + projection head 了，大家都采用了一个更强的数据增强，都想用一个动量编码器，也都尝试训练更久。</p><hr><h3 id="第三阶段：不用负样本的对比学习"><a href="#第三阶段：不用负样本的对比学习" class="headerlink" title="第三阶段：不用负样本的对比学习"></a>第三阶段：不用负样本的对比学习</h3><p>其实SwAV已经是不用负样本了，但是他还是和一个聚类的中心这样明确的对比对象进行比较，一下介绍的 BYOL 和 SimSiam 就是正样本自己在和自己玩，已经没有正样本，或者聚类中心这样明确的对比对象了。</p><h4 id="BYOL"><a href="#BYOL" class="headerlink" title="BYOL"></a>BYOL</h4><p><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2006.07733.pdf">BYOL 论文传送门</a></p><p>其实之前使用负样本的学习方法相当于给模型提供一个约束。如果模型的输入只有正样本，那么模型需要让正样本之间的距离尽量的缩小，那么模型可能会想到一个捷径从而很好的解决这个问题，就是模型直接对所有样本的数据都是一致的，这样所有正样本之间的距离无限接近，但是模型这样躺平是学习不到实例的特征的，是无效的。因此添加了负样本对模型造成一个约束，就是让正样本之间的距离接近，让负样本之间的距离拉远，这样可以对模型进行约束，不让模型躺平，所以负样本在模型中是一个必须的东西，可以防止模型躺平，学到这个捷径解。但是 BYOL 的神奇之处在于模型没有使用负样本，仅仅是模型自己和自己去学，但是也实现了很不错的效果。</p><img src="/f08f0e17/21.webp"><p>让我们看看 BYOL 的前向过程，一个实例 x 经过两次数据增强得到 v 和 v’，之后经过两个编码器 fθ 和 fξ，得到啷个嵌入向量 yθ 和 y’ξ ，其中两个编码器的模型架构一样，但是参数并不相同，fξ 通过动量更新，而不是反向传播更新。得到的向量再经过两个投影层 gθ 和 gξ，同样的两个投影层也是架构一样，但是参数不一致，前者是通过梯度下降进行更新，后者是通过动量更新，得到两个嵌入向量 zθ 和 z’ξ。之后将 zθ 输入到一个预测层 qθ 中，得到 qθ(zθ)，让 qθ(zθ) 和 z’ξ 无限接近，使用 mean squared error 进行参数更新，利用正样本对正样本的预测，实现模型的学习。</p><hr><h4 id="Siamese"><a href="#Siamese" class="headerlink" title="Siamese"></a>Siamese</h4><p><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2011.10566.pdf">Siamese 论文传送门</a></p><p>Siamese 不需要用负样本，不需要大的 batchsize，不需要动量编码器，即使在这种条件下，Siamese 不仅没有模型谈谈，反而取得了很好的模型效果。</p><img src="/f08f0e17/22.webp"> <img src="/f08f0e17/23.webp"><p>前向过程是一个实例 x 经过数据增强变为 x1 和 x2，之后经过孪生的 encoder f，得到嵌入 z1 和 z2，之后经过预测层得到 p1 和 p2，之后让 p1 预测 z2，用 p2 去预测 z1，进行模型的训练。</p><img src="/f08f0e17/24.webp"><p>对比了不同的基于孪生网络的学习例子。SimCLR 使用的是端到端的训练，两个 encoder，SwAV 是和聚类中心进行对比的，BYOL 是一个预测任务，其使用的是动量编码器，SimSiam 也是预测任务，但是使用的是 stop gradiant 的方式进行预测的。</p><hr><h3 id="第四阶段：transformer"><a href="#第四阶段：transformer" class="headerlink" title="第四阶段：transformer"></a>第四阶段：transformer</h3><p>在 vision transformer 之后，因为其大大提升了 encoder 的效果，所以很多对比学习任务打算使用 vision transformer 作为 backbone 进行对比学习，涌现出了两篇工作，分别是 MOCO v3 和 DINO。</p><h4 id="MOCO-V3"><a href="#MOCO-V3" class="headerlink" title="MOCO V3"></a>MOCO V3</h4><p><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2104.02057.pdf">MOCO V3 论文传送门</a></p><img src="/f08f0e17/25.webp"><p>MOCO v3 有点像 MOCO v2 和 SimSiam 的结合。使用对比学习，还有对称的 loss。</p><img src="/f08f0e17/26.webp"><p>作者发现当把 backbone 从 ResNET 换为 VIT 后，虽然较小的 batch 效果还可以，但是一旦 batch 变大，模型就出现了不稳定的情况。</p><p>作者观察了一下模型梯度回传时候的梯度情况。当每次 loss 有大幅的震动，导致准确度大幅下降的时候，梯度也会有一个波峰，波峰发生在第一层，在作 patch projection 的时候，因为这一层经常出现问题，所以作者尝试将这一层 fix 住，之后再进行训练，得到了很平滑的 loss 曲线。</p><hr><h4 id="DINO"><a href="#DINO" class="headerlink" title="DINO"></a>DINO</h4><p><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2104.14294.pdf">DINO 论文传送门</a></p><img src="/f08f0e17/27.webp"><p>为了避免模型坍塌，其在 teacher 中使用了一个 centering 操作，即对 batch 求均值，之后让 batch 中的所有实例减去这个均值，对 batch 中的样本求归一化的操作。</p><img src="/f08f0e17/28.webp"> <img src="/f08f0e17/29.webp"><p>最后就是整体的过一遍。</p><hr><h3 id="原文链接"><a href="#原文链接" class="headerlink" title="原文链接"></a>原文链接</h3><blockquote><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/452087382">https://zhuanlan.zhihu.com/p/452087382</a></p></blockquote></div><footer class="post-footer"><div class="post-nav"><div class="post-nav-item"><a href="/a48553aa.html" rel="prev" title="论文阅读-对比学习论文综述-4Transformer+总结"><i class="fa fa-chevron-left"></i> 论文阅读-对比学习论文综述-4Transformer+总结</a></div><div class="post-nav-item"><a href="/b87a48d6.html" rel="next" title="跟李沐学AI-读论文-Megatron LM 论文精读">跟李沐学AI-读论文-Megatron LM 论文精读 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="valine-comments"></div><script>window.addEventListener("tabs:register",()=>{let t=CONFIG.comments["activeClass"];var e;(t=CONFIG.comments.storage?localStorage.getItem("comments_active")||t:t)&&(e=document.querySelector(`a[href="#comment-${t}"]`))&&e.click()}),CONFIG.comments.storage&&window.addEventListener("tabs:click",t=>{t.target.matches(".tabs-comment .tab-content .tab-pane")&&(t=t.target.classList[1],localStorage.setItem("comments_active",t))})</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E9%98%B6%E6%AE%B5%EF%BC%9A%E7%99%BE%E8%8A%B1%E9%BD%90%E6%94%BE"><span class="nav-number">1.</span> <span class="nav-text">第一阶段：百花齐放</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#InstDise"><span class="nav-number">1.1.</span> <span class="nav-text">InstDise</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#InvaSpread"><span class="nav-number">1.2.</span> <span class="nav-text">InvaSpread</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CPC"><span class="nav-number">1.3.</span> <span class="nav-text">CPC</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CMC"><span class="nav-number">1.4.</span> <span class="nav-text">CMC</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E9%98%B6%E6%AE%B5%EF%BC%9AMOCO%E5%92%8CsimCLR%E5%8F%8C%E9%9B%84"><span class="nav-number">2.</span> <span class="nav-text">第二阶段：MOCO和simCLR双雄</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#MOCO-v1"><span class="nav-number">2.1.</span> <span class="nav-text">MOCO v1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#simCLR-v1"><span class="nav-number">2.2.</span> <span class="nav-text">simCLR v1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MOCO-v2"><span class="nav-number">2.3.</span> <span class="nav-text">MOCO v2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SimCLR-v2"><span class="nav-number">2.4.</span> <span class="nav-text">SimCLR v2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SwAV"><span class="nav-number">2.5.</span> <span class="nav-text">SwAV</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E4%B8%89%E9%98%B6%E6%AE%B5%EF%BC%9A%E4%B8%8D%E7%94%A8%E8%B4%9F%E6%A0%B7%E6%9C%AC%E7%9A%84%E5%AF%B9%E6%AF%94%E5%AD%A6%E4%B9%A0"><span class="nav-number">3.</span> <span class="nav-text">第三阶段：不用负样本的对比学习</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#BYOL"><span class="nav-number">3.1.</span> <span class="nav-text">BYOL</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Siamese"><span class="nav-number">3.2.</span> <span class="nav-text">Siamese</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E5%9B%9B%E9%98%B6%E6%AE%B5%EF%BC%9Atransformer"><span class="nav-number">4.</span> <span class="nav-text">第四阶段：transformer</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#MOCO-V3"><span class="nav-number">4.1.</span> <span class="nav-text">MOCO V3</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DINO"><span class="nav-number">4.2.</span> <span class="nav-text">DINO</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%9F%E6%96%87%E9%93%BE%E6%8E%A5"><span class="nav-number">5.</span> <span class="nav-text">原文链接</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Aisaka Aoi" src="/images/manatsu.jpg"><p class="site-author-name" itemprop="name">Aisaka Aoi</p><div class="site-description" itemprop="description">逢坂葵的个人博客</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">558</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">51</span> <span class="site-state-item-name">分类</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/AisakaAoi" title="GitHub 👨‍💻 → https:&#x2F;&#x2F;github.com&#x2F;AisakaAoi" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub 👨‍💻</a> </span><span class="links-of-author-item"><a href="https://github.com/AisakaManatsu" title="GitHub 👩‍💻 → https:&#x2F;&#x2F;github.com&#x2F;AisakaManatsu" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub 👩‍💻</a> </span><span class="links-of-author-item"><a href="mailto:chenzongnan@m.scnu.edu.cn" title="E-Mail 🏫 → mailto:chenzongnan@m.scnu.edu.cn" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail 🏫</a> </span><span class="links-of-author-item"><a href="mailto:aisakaaoi@qq.com" title="E-Mail 📧 → mailto:aisakaaoi@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail 📧</a> </span><span class="links-of-author-item"><a href="https://space.bilibili.com/91560309" title="Bilibili 📺 → https:&#x2F;&#x2F;space.bilibili.com&#x2F;91560309" rel="noopener" target="_blank"><i class="fab fa-bilibili fa-fw"></i>Bilibili 📺</a> </span><span class="links-of-author-item"><a href="https://space.bilibili.com/198562921" title="Bilibili 🎮 → https:&#x2F;&#x2F;space.bilibili.com&#x2F;198562921" rel="noopener" target="_blank"><i class="fab fa-bilibili fa-fw"></i>Bilibili 🎮</a> </span><span class="links-of-author-item"><a href="https://www.youtube.com/channel/UCALvyn5Cl76GCotO9pczvjg" title="YouTube 📺 → https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCALvyn5Cl76GCotO9pczvjg" rel="noopener" target="_blank"><i class="fab fa-youtube fa-fw"></i>YouTube 📺</a></span></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Aisaka Aoi</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span class="post-meta-item-text">站点总字数：</span> <span title="站点总字数">1.8m</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span class="post-meta-item-text">站点阅读时长 &asymp;</span> <span title="站点阅读时长">76:01</span></div><div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动</div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script>document.querySelectorAll(".pdfobject-container").forEach(e=>{var t=e.dataset.target,a="#"+Object.entries({navpanes:0,toolbar:0,statusbar:0,pagemode:"thumbs",view:"FitH"}).map(([e,t])=>e+"="+encodeURIComponent(t)).join("&"),r="/lib/pdf/web/viewer.html?file="+encodeURIComponent(t)+a;NexT.utils.supportsPDFs()?e.innerHTML=`<embed class="pdfobject" src="${t+a}" type="application/pdf" style="height: ${e.dataset.height};">`:e.innerHTML=`<iframe src="${r}" style="height: ${e.dataset.height};" frameborder="0"></iframe>`})</script><script>NexT.utils.loadComments(document.querySelector("#valine-comments"),()=>{NexT.utils.getScript("//unpkg.com/valine/dist/Valine.min.js",()=>{var i=["nick","mail","link"],e="nick,mail,link".split(",").filter(e=>i.includes(e));new Valine({el:"#valine-comments",verify:!0,notify:!0,appId:"UqjWdRYbIUEUQRXhBUUIh1QE-gzGzoHsz",appKey:"gj89JXC485PFbpdHLKVkz6dm",placeholder:"这里可以发送评论~（上面可以输入昵称、邮箱）",avatar:"mm",meta:e,pageSize:"10",visitor:!0,lang:"zh-cn",path:location.pathname,recordIP:!1,serverURLs:""})},window.Valine)})</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/haru02.model.json"},"display":{"position":"right","width":208,"height":520},"mobile":{"show":false},"log":false});</script></body></html>