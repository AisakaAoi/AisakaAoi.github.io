<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0"><meta name="baidu-site-verification" content="code-KCMz4b3cnd"><meta name="google-site-verification" content="MTp8U7dJ1uzrfz8Mu6rgqX1CIm3HjqPWd0xaRcv1tFg"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="mask-icon" href="/images/favicon.png" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"aisakaaoi.github.io",root:"/",scheme:"Pisces",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:"valine",storage:!0,lazyload:!1,nav:null,activeClass:"valine"},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="å¯¼è¯­æ¯å¤©é¢å¯¹æµ·é‡æ–‡æœ¬â€”â€”å‘ç¥¨å·ç ã€é“¶è¡Œè´¦å·ã€åˆåŒæ—¥æœŸã€é‡‘é¢æ•°å­—â€¦æ‰‹åŠ¨ä¸€ä¸ªä¸ªå¤åˆ¶ç²˜è´´ï¼Ÿçœ¼ç›éƒ½çœ‹èŠ±äº†ï¼æ­£åˆ™è¡¨è¾¾å¼å°±æ˜¯ä½ çš„â€œæ–‡æœ¬æ‰«æä»ªâ€ï¼Œåªè¦å‘Šè¯‰å®ƒâ€œæ‰¾æ•°å­—â€â€œæ‰¾æ—¥æœŸâ€è¿™äº›æ¨¡å¼ï¼Œå®ƒèƒ½åœ¨1ç§’å†…ä»å‡ ç™¾é¡µPDFé‡Œç²¾å‡†æå–æ‰€æœ‰ä¿¡æ¯ã€‚ä»Šå¤©å’±ä»¬æŒæ¡è¿™é—¨â€œæ•°æ®æå–é­”æ³•â€ï¼Œä»æ­¤å‘Šåˆ«æœºæ¢°é‡å¤çš„å¤åˆ¶ç²˜è´´ï¼"><meta property="og:type" content="article"><meta property="og:title" content="Python-ç¬¬21ç¯‡ã€Šæ­£åˆ™è¡¨è¾¾å¼ï¼šæ–‡æœ¬å¤„ç†åˆ©å™¨ã€‹"><meta property="og:url" content="https://aisakaaoi.github.io/86b1dcdb.html"><meta property="og:site_name" content="é€¢å‚è‘µçš„ä¸ªäººåšå®¢"><meta property="og:description" content="å¯¼è¯­æ¯å¤©é¢å¯¹æµ·é‡æ–‡æœ¬â€”â€”å‘ç¥¨å·ç ã€é“¶è¡Œè´¦å·ã€åˆåŒæ—¥æœŸã€é‡‘é¢æ•°å­—â€¦æ‰‹åŠ¨ä¸€ä¸ªä¸ªå¤åˆ¶ç²˜è´´ï¼Ÿçœ¼ç›éƒ½çœ‹èŠ±äº†ï¼æ­£åˆ™è¡¨è¾¾å¼å°±æ˜¯ä½ çš„â€œæ–‡æœ¬æ‰«æä»ªâ€ï¼Œåªè¦å‘Šè¯‰å®ƒâ€œæ‰¾æ•°å­—â€â€œæ‰¾æ—¥æœŸâ€è¿™äº›æ¨¡å¼ï¼Œå®ƒèƒ½åœ¨1ç§’å†…ä»å‡ ç™¾é¡µPDFé‡Œç²¾å‡†æå–æ‰€æœ‰ä¿¡æ¯ã€‚ä»Šå¤©å’±ä»¬æŒæ¡è¿™é—¨â€œæ•°æ®æå–é­”æ³•â€ï¼Œä»æ­¤å‘Šåˆ«æœºæ¢°é‡å¤çš„å¤åˆ¶ç²˜è´´ï¼"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2026-02-02T20:40:43.000Z"><meta property="article:modified_time" content="2026-02-02T21:28:16.497Z"><meta property="article:author" content="Aisaka Aoi"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://aisakaaoi.github.io/86b1dcdb.html"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>Python-ç¬¬21ç¯‡ã€Šæ­£åˆ™è¡¨è¾¾å¼ï¼šæ–‡æœ¬å¤„ç†åˆ©å™¨ã€‹ | é€¢å‚è‘µçš„ä¸ªäººåšå®¢</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?7308ed05421777c301eefa3754da1b42",document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="é€¢å‚è‘µçš„ä¸ªäººåšå®¢" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ "><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">aoiå­¦é™¢</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">Aisaka's Blog, School of Aoi, Aisaka University</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»<span class="badge">20</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£<span class="badge">1034</span></a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="æœç´¢..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="reading-progress-bar"></div><a href="https://github.com/AisakaAoi" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://aisakaaoi.github.io/86b1dcdb.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/manatsu.jpg"><meta itemprop="name" content="Aisaka Aoi"><meta itemprop="description" content="Aisaka's Blog, School of Aoi, Aisaka University"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="é€¢å‚è‘µçš„ä¸ªäººåšå®¢"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Python-ç¬¬21ç¯‡ã€Šæ­£åˆ™è¡¨è¾¾å¼ï¼šæ–‡æœ¬å¤„ç†åˆ©å™¨ã€‹</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">å‘è¡¨äº</span> <time title="åˆ›å»ºæ—¶é—´ï¼š2026-02-03 04:40:43" itemprop="dateCreated datePublished" datetime="2026-02-03T04:40:43+08:00">2026-02-03</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">åˆ†ç±»äº</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%F0%9F%8C%99%E9%80%A2%E5%9D%82%E6%9D%82%E8%B0%88%E4%B8%8E%E6%90%AC%E8%BF%90/" itemprop="url" rel="index"><span itemprop="name">ğŸŒ™é€¢å‚æ‚è°ˆä¸æ¬è¿</span></a> </span>ï¼Œ <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%F0%9F%8C%99%E9%80%A2%E5%9D%82%E6%9D%82%E8%B0%88%E4%B8%8E%E6%90%AC%E8%BF%90/%E2%AD%90%E6%9E%9C%E6%9E%9C%E8%AF%BE%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">â­æœæœè¯¾ç¨‹</span></a> </span></span><span id="/86b1dcdb.html" class="post-meta-item leancloud_visitors" data-flag-title="Python-ç¬¬21ç¯‡ã€Šæ­£åˆ™è¡¨è¾¾å¼ï¼šæ–‡æœ¬å¤„ç†åˆ©å™¨ã€‹" title="é˜…è¯»æ¬¡æ•°"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span> <span class="leancloud-visitors-count"></span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Valineï¼š</span> <a title="valine" href="/86b1dcdb.html#valine-comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/86b1dcdb.html" itemprop="commentCount"></span></a></span><br><span class="post-meta-item" title="æœ¬æ–‡å­—æ•°"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span> <span>23k</span> </span><span class="post-meta-item" title="é˜…è¯»æ—¶é•¿"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span> <span>58 åˆ†é’Ÿ</span></span></div></header><div class="post-body" itemprop="articleBody"><h3 id="å¯¼è¯­"><a href="#å¯¼è¯­" class="headerlink" title="å¯¼è¯­"></a>å¯¼è¯­</h3><p>æ¯å¤©é¢å¯¹æµ·é‡æ–‡æœ¬â€”â€”å‘ç¥¨å·ç ã€é“¶è¡Œè´¦å·ã€åˆåŒæ—¥æœŸã€é‡‘é¢æ•°å­—â€¦æ‰‹åŠ¨ä¸€ä¸ªä¸ªå¤åˆ¶ç²˜è´´ï¼Ÿçœ¼ç›éƒ½çœ‹èŠ±äº†ï¼æ­£åˆ™è¡¨è¾¾å¼å°±æ˜¯ä½ çš„â€œæ–‡æœ¬æ‰«æä»ªâ€ï¼Œåªè¦å‘Šè¯‰å®ƒâ€œæ‰¾æ•°å­—â€â€œæ‰¾æ—¥æœŸâ€è¿™äº›æ¨¡å¼ï¼Œå®ƒèƒ½åœ¨1ç§’å†…ä»å‡ ç™¾é¡µPDFé‡Œç²¾å‡†æå–æ‰€æœ‰ä¿¡æ¯ã€‚ä»Šå¤©å’±ä»¬æŒæ¡è¿™é—¨â€œæ•°æ®æå–é­”æ³•â€ï¼Œä»æ­¤å‘Šåˆ«æœºæ¢°é‡å¤çš„å¤åˆ¶ç²˜è´´ï¼</p><span id="more"></span><hr><h3 id="æœ¬ç¯‡ç›®æ ‡"><a href="#æœ¬ç¯‡ç›®æ ‡" class="headerlink" title="æœ¬ç¯‡ç›®æ ‡"></a>æœ¬ç¯‡ç›®æ ‡</h3><ul><li>ç†è§£æ­£åˆ™è¡¨è¾¾å¼çš„â€œæ¨¡å¼â€æ¦‚å¿µ</li><li>æŒæ¡å¸¸ç”¨è´¢åŠ¡æ•°æ®åŒ¹é…è§„åˆ™ï¼ˆé‡‘é¢ã€æ—¥æœŸã€å‘ç¥¨å·ï¼‰</li><li>å­¦ä¼šä»æ··ä¹±æ–‡æœ¬ä¸­æå–ç»“æ„åŒ–ä¿¡æ¯</li><li>å®æˆ˜ï¼šè‡ªåŠ¨è§£æè´¢åŠ¡æŠ¥è¡¨å¹¶ç”ŸæˆExcel</li><li>è·å¾—æ­£åˆ™è¡¨è¾¾å¼â€œå°æŠ„â€ï¼Œéšæ—¶æŸ¥é˜…</li></ul><hr><h3 id="ä¸€ã€å‡†å¤‡å·¥ä½œï¼šæ— éœ€å®‰è£…ï¼Œå¼€ç®±å³ç”¨"><a href="#ä¸€ã€å‡†å¤‡å·¥ä½œï¼šæ— éœ€å®‰è£…ï¼Œå¼€ç®±å³ç”¨" class="headerlink" title="ä¸€ã€å‡†å¤‡å·¥ä½œï¼šæ— éœ€å®‰è£…ï¼Œå¼€ç®±å³ç”¨"></a>ä¸€ã€å‡†å¤‡å·¥ä½œï¼šæ— éœ€å®‰è£…ï¼Œå¼€ç®±å³ç”¨</h3><p>æ­£åˆ™è¡¨è¾¾å¼æ˜¯Pythonå†…ç½®çš„reæ¨¡å—ï¼Œæ— éœ€å®‰è£…ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re  <span class="comment"># ç›´æ¥å¯¼å…¥å°±èƒ½ç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•ä¸€ä¸‹</span></span><br><span class="line">text = <span class="string">&quot;å‘ç¥¨å·ï¼šINV20250012345ï¼Œé‡‘é¢ï¼šÂ¥15,800.50&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;âœ… æ­£åˆ™è¡¨è¾¾å¼æ¨¡å—åŠ è½½æˆåŠŸï¼&quot;</span>)</span><br></pre></td></tr></table></figure><hr><h3 id="äºŒã€ä»€ä¹ˆæ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Ÿ"><a href="#äºŒã€ä»€ä¹ˆæ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Ÿ" class="headerlink" title="äºŒã€ä»€ä¹ˆæ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Ÿ"></a>äºŒã€ä»€ä¹ˆæ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Ÿ</h3><p><strong>æ­£åˆ™è¡¨è¾¾å¼ &#x3D; ç»™æ–‡æœ¬å®šçš„â€œæœç´¢æ¨¡æ¿â€</strong></p><p>å°±åƒè´¢åŠ¡æŸ¥è´¦ï¼š</p><ul><li>æ‰¾å‘ç¥¨å· â†’ æ¨¡å¼ï¼šå­—æ¯å¼€å¤´+å¹´ä»½+æµæ°´å·</li><li>æ‰¾é‡‘é¢ â†’ æ¨¡å¼ï¼šÂ¥ç¬¦å·+æ•°å­—+å¯èƒ½æœ‰çš„é€—å·+å°æ•°ç‚¹</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ========== ç¬¬ä¸€ä¸ªæ­£åˆ™ï¼šæ‰¾æ•°å­— ==========</span></span><br><span class="line"><span class="comment"># åœºæ™¯ï¼šä»&quot;æŠ¥é”€é‡‘é¢Â¥3,250.50å…ƒ&quot;ä¸­æå–æ•°å­—</span></span><br><span class="line"></span><br><span class="line">text = <span class="string">&quot;æŠ¥é”€é‡‘é¢Â¥3,250.50å…ƒï¼Œå®æŠ¥Â¥3,000.00&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å¼ï¼š\d+ åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªæ•°å­—</span></span><br><span class="line">numbers = re.findall(<span class="string">r&#x27;\d+&#x27;</span>, text)  <span class="comment"># rè¡¨ç¤ºåŸå§‹å­—ç¬¦ä¸²ï¼Œé¿å…è½¬ä¹‰é—®é¢˜</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æ‰¾åˆ°çš„æ•°å­—ï¼š<span class="subst">&#123;numbers&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š[&#x27;3&#x27;, &#x27;250&#x27;, &#x27;50&#x27;, &#x27;3&#x27;, &#x27;000&#x27;, &#x27;00&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ”¹è¿›ï¼šåŒ¹é…å¸¦é€—å·å’Œå°æ•°çš„å®Œæ•´é‡‘é¢</span></span><br><span class="line">amounts = re.findall(<span class="string">r&#x27;\d[\d,]*\.?\d*&#x27;</span>, text)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æ‰¾åˆ°çš„é‡‘é¢ï¼š<span class="subst">&#123;amounts&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š[&#x27;3,250.50&#x27;, &#x27;3,000.00&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»§ç»­æ”¹è¿›ï¼šåŒ¹é…å¸¦è´§å¸ç¬¦å·çš„é‡‘é¢</span></span><br><span class="line">full_amounts = re.findall(<span class="string">r&#x27;Â¥\d[\d,]*\.?\d*&#x27;</span>, text)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;å¸¦ç¬¦å·çš„é‡‘é¢ï¼š<span class="subst">&#123;full_amounts&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š[&#x27;Â¥3,250.50&#x27;, &#x27;Â¥3,000.00&#x27;]</span></span><br></pre></td></tr></table></figure><hr><h3 id="ä¸‰ã€è´¢åŠ¡æ•°æ®åŒ¹é…æ¨¡å¼è¯¦è§£"><a href="#ä¸‰ã€è´¢åŠ¡æ•°æ®åŒ¹é…æ¨¡å¼è¯¦è§£" class="headerlink" title="ä¸‰ã€è´¢åŠ¡æ•°æ®åŒ¹é…æ¨¡å¼è¯¦è§£"></a>ä¸‰ã€è´¢åŠ¡æ•°æ®åŒ¹é…æ¨¡å¼è¯¦è§£</h3><h4 id="3-1-åŒ¹é…é‡‘é¢ï¼ˆæœ€å¸¸ç”¨ï¼‰"><a href="#3-1-åŒ¹é…é‡‘é¢ï¼ˆæœ€å¸¸ç”¨ï¼‰" class="headerlink" title="3.1 åŒ¹é…é‡‘é¢ï¼ˆæœ€å¸¸ç”¨ï¼‰"></a>3.1 åŒ¹é…é‡‘é¢ï¼ˆæœ€å¸¸ç”¨ï¼‰</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ========== é‡‘é¢åŒ¹é…ä¸‡èƒ½å…¬å¼ ==========</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_money</span>(<span class="params">text: <span class="built_in">str</span></span>) -&gt; <span class="built_in">list</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ä»æ–‡æœ¬ä¸­æå–æ‰€æœ‰é‡‘é¢</span></span><br><span class="line"><span class="string">    æ”¯æŒæ ¼å¼ï¼šÂ¥1,234.56 æˆ– 1234.56å…ƒ æˆ– 1234.56</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># æ¨¡å¼è§£é‡Šï¼š</span></span><br><span class="line">    <span class="comment"># Â¥?        â†’ Â¥ç¬¦å·å¯é€‰ï¼ˆ?è¡¨ç¤º0æˆ–1ä¸ªï¼‰</span></span><br><span class="line">    <span class="comment"># \d+       â†’ è‡³å°‘ä¸€ä½æ•°å­—</span></span><br><span class="line">    <span class="comment"># (,\d&#123;3&#125;)* â†’ é€—å·åŠ ä¸‰ä½æ•°å­—ï¼Œé‡å¤0æ¬¡æˆ–å¤šæ¬¡ï¼ˆåŒ¹é…åƒåˆ†ä½ï¼‰</span></span><br><span class="line">    <span class="comment"># \.?\d*    â†’ å°æ•°ç‚¹å’Œæ•°å­—å¯é€‰ï¼ˆåŒ¹é…å°æ•°éƒ¨åˆ†ï¼‰</span></span><br><span class="line">    <span class="comment"># å…ƒ?        â†’ &quot;å…ƒ&quot;å­—å¯é€‰</span></span><br><span class="line">    </span><br><span class="line">    pattern = <span class="string">r&#x27;Â¥?\d+(,\d&#123;3&#125;)*\.?\d*\s*å…ƒ?&#x27;</span></span><br><span class="line">    </span><br><span class="line">    matches = re.findall(pattern, text)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ¸…ç†ç»“æœï¼ˆå»æ‰é€—å·å’Œ&quot;å…ƒ&quot;ï¼‰</span></span><br><span class="line">    clean_amounts = []</span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">match</span> <span class="keyword">in</span> matches:</span><br><span class="line">        <span class="comment"># éœ€è¦å®Œæ•´åŒ¹é…ï¼Œä¸Šé¢findallè¿”å›çš„æ˜¯å…ƒç»„ï¼Œè¿™é‡Œä¿®æ­£</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ä¿®æ­£åçš„æ¨¡å¼</span></span><br><span class="line">    pattern = <span class="string">r&#x27;Â¥?(\d+(?:,\d&#123;3&#125;)*\.?\d*)\s*å…ƒ?&#x27;</span></span><br><span class="line">    matches = re.findall(pattern, text)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è½¬æ¢ä¸ºæµ®ç‚¹æ•°</span></span><br><span class="line">    amounts = []</span><br><span class="line">    <span class="keyword">for</span> amount_str <span class="keyword">in</span> matches:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            clean_amount = amount_str.replace(<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            amount = <span class="built_in">float</span>(clean_amount)</span><br><span class="line">            <span class="keyword">if</span> amount &gt; <span class="number">0</span>:  <span class="comment"># åªä¿ç•™æ­£æ•°</span></span><br><span class="line">                amounts.append(amount)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> amounts</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•</span></span><br><span class="line">text = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">æœ¬æœˆè´¹ç”¨ï¼šåŠå…¬ç”¨å“Â¥1,250.00å…ƒï¼Œäº¤é€šè´¹800å…ƒï¼Œæ‹›å¾…è´¹Â¥2,580.50ã€‚</span></span><br><span class="line"><span class="string">å€Ÿæ¬¾ï¼šå¤‡ç”¨é‡‘5,000.00å…ƒã€‚</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">amounts = extract_money(text)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æå–åˆ°çš„é‡‘é¢ï¼š<span class="subst">&#123;amounts&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š[1250.0, 800.0, 2580.5, 5000.0]</span></span><br></pre></td></tr></table></figure><hr><h4 id="3-2-åŒ¹é…æ—¥æœŸ"><a href="#3-2-åŒ¹é…æ—¥æœŸ" class="headerlink" title="3.2 åŒ¹é…æ—¥æœŸ"></a>3.2 åŒ¹é…æ—¥æœŸ</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ========== æ—¥æœŸåŒ¹é… ==========</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_dates</span>(<span class="params">text: <span class="built_in">str</span></span>) -&gt; <span class="built_in">list</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æå–æ—¥æœŸï¼ˆæ”¯æŒYYYY-MM-DDã€YYYY/MM/DDã€YYYYå¹´MMæœˆDDæ—¥ï¼‰</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># æ¨¡å¼ï¼šåŒ¹é…2025-01-26æˆ–2025/01/26æˆ–2025å¹´01æœˆ26æ—¥</span></span><br><span class="line">    pattern = <span class="string">r&#x27;(\d&#123;4&#125;)[-/å¹´](\d&#123;1,2&#125;)[-/æœˆ](\d&#123;1,2&#125;)æ—¥?&#x27;</span></span><br><span class="line">    </span><br><span class="line">    matches = re.findall(pattern, text)</span><br><span class="line">    </span><br><span class="line">    dates = []</span><br><span class="line">    <span class="keyword">for</span> year, month, day <span class="keyword">in</span> matches:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># éªŒè¯æ—¥æœŸåˆæ³•æ€§</span></span><br><span class="line">            date_str = <span class="string">f&quot;<span class="subst">&#123;year&#125;</span>-<span class="subst">&#123;month.zfill(<span class="number">2</span>)&#125;</span>-<span class="subst">&#123;day.zfill(<span class="number">2</span>)&#125;</span>&quot;</span></span><br><span class="line">            datetime.strptime(date_str, <span class="string">&#x27;%Y-%m-%d&#x27;</span>)</span><br><span class="line">            dates.append(date_str)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> dates</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•</span></span><br><span class="line">text = <span class="string">&quot;åˆåŒæ—¥æœŸï¼š2025-01-26ï¼Œä»˜æ¬¾æˆªæ­¢2025/02/15ï¼Œå‘ç¥¨æ—¥æœŸ2025å¹´03æœˆ01æ—¥&quot;</span></span><br><span class="line">dates = extract_dates(text)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æå–åˆ°çš„æ—¥æœŸï¼š<span class="subst">&#123;dates&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š[&#x27;2025-01-26&#x27;, &#x27;2025-02-15&#x27;, &#x27;2025-03-01&#x27;]</span></span><br></pre></td></tr></table></figure><hr><h4 id="3-3-åŒ¹é…å‘ç¥¨å·-x2F-é“¶è¡Œè´¦å·"><a href="#3-3-åŒ¹é…å‘ç¥¨å·-x2F-é“¶è¡Œè´¦å·" class="headerlink" title="3.3 åŒ¹é…å‘ç¥¨å·&#x2F;é“¶è¡Œè´¦å·"></a>3.3 åŒ¹é…å‘ç¥¨å·&#x2F;é“¶è¡Œè´¦å·</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ========== å‘ç¥¨å·/é“¶è¡Œè´¦å·åŒ¹é… ==========</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_invoice_numbers</span>(<span class="params">text: <span class="built_in">str</span></span>) -&gt; <span class="built_in">list</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æå–å‘ç¥¨å·ï¼ˆæ¨¡å¼ï¼šå­—æ¯+æ•°å­—ï¼‰</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># æ¨¡å¼ï¼š2-4ä½å¤§å†™å­—æ¯ + 8-12ä½æ•°å­—</span></span><br><span class="line">    pattern = <span class="string">r&#x27;[A-Z]&#123;2,4&#125;\d&#123;8,12&#125;&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> re.findall(pattern, text)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_bank_accounts</span>(<span class="params">text: <span class="built_in">str</span></span>) -&gt; <span class="built_in">list</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æå–é“¶è¡Œè´¦å·ï¼ˆ16-19ä½æ•°å­—ï¼‰</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    pattern = <span class="string">r&#x27;\d&#123;16,19&#125;&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> re.findall(pattern, text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•</span></span><br><span class="line">text = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">å‘ç¥¨å·ï¼šINV2025123456ï¼Œä»£ç ï¼šFP202500123456</span></span><br><span class="line"><span class="string">è½¬è´¦è´¦å·ï¼š6222021234567890123ï¼Œå¤‡ç”¨é‡‘å¡ï¼š95588012345678</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">invoices = extract_invoice_numbers(text)</span><br><span class="line">accounts = extract_bank_accounts(text)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;å‘ç¥¨å·ï¼š<span class="subst">&#123;invoices&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;é“¶è¡Œè´¦å·ï¼š<span class="subst">&#123;accounts&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><hr><h3 id="å››ã€ä»æ··ä¹±æ–‡æœ¬ä¸­æå–ç»“æ„åŒ–ä¿¡æ¯"><a href="#å››ã€ä»æ··ä¹±æ–‡æœ¬ä¸­æå–ç»“æ„åŒ–ä¿¡æ¯" class="headerlink" title="å››ã€ä»æ··ä¹±æ–‡æœ¬ä¸­æå–ç»“æ„åŒ–ä¿¡æ¯"></a>å››ã€ä»æ··ä¹±æ–‡æœ¬ä¸­æå–ç»“æ„åŒ–ä¿¡æ¯</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ========== è´¢åŠ¡æŠ¥è¡¨æ–‡æœ¬è§£æå™¨ ==========</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_financial_report</span>(<span class="params">text: <span class="built_in">str</span></span>) -&gt; <span class="built_in">dict</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    è§£æè´¢åŠ¡æŠ¥å‘Šçš„æ··åˆæ–‡æœ¬ï¼Œæå–ç»“æ„åŒ–ä¿¡æ¯</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    result = &#123;</span><br><span class="line">        <span class="string">&#x27;æŠ¥å‘Šæ—¥æœŸ&#x27;</span>: <span class="literal">None</span>,</span><br><span class="line">        <span class="string">&#x27;å…¬å¸åç§°&#x27;</span>: <span class="literal">None</span>,</span><br><span class="line">        <span class="string">&#x27;æ€»è¥æ”¶&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">&#x27;å‡€åˆ©æ¶¦&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">&#x27;ä¸»è¦æ”¶å…¥é¡¹&#x27;</span>: [],</span><br><span class="line">        <span class="string">&#x27;å‘ç¥¨åˆ—è¡¨&#x27;</span>: []</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 1. æå–æ—¥æœŸ</span></span><br><span class="line">    dates = extract_dates(text)</span><br><span class="line">    <span class="keyword">if</span> dates:</span><br><span class="line">        result[<span class="string">&#x27;æŠ¥å‘Šæ—¥æœŸ&#x27;</span>] = dates[<span class="number">0</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. æå–å…¬å¸åç§°ï¼ˆæ¨¡å¼ï¼šXXæœ‰é™å…¬å¸ï¼‰</span></span><br><span class="line">    company_pattern = <span class="string">r&#x27;[\u4e00-\u9fa5]+æœ‰é™å…¬å¸&#x27;</span></span><br><span class="line">    company_match = re.search(company_pattern, text)</span><br><span class="line">    <span class="keyword">if</span> company_match:</span><br><span class="line">        result[<span class="string">&#x27;å…¬å¸åç§°&#x27;</span>] = company_match.group()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. æå–é‡‘é¢ï¼ˆè¥æ”¶å’Œå‡€åˆ©æ¶¦é€šå¸¸åœ¨ç‰¹å®šå…³é”®åï¼‰</span></span><br><span class="line">    amounts = extract_money(text)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ‰¾&quot;è¥æ”¶&quot;æˆ–&quot;æ”¶å…¥&quot;åçš„ç¬¬ä¸€ä¸ªå¤§æ•°å­—</span></span><br><span class="line">    revenue_match = re.search(<span class="string">r&#x27;è¥æ”¶[^\d]*Â¥?(\d[,\d]*\.?\d*)&#x27;</span>, text)</span><br><span class="line">    <span class="keyword">if</span> revenue_match:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            revenue = <span class="built_in">float</span>(revenue_match.group(<span class="number">1</span>).replace(<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">            result[<span class="string">&#x27;æ€»è¥æ”¶&#x27;</span>] = revenue</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ‰¾&quot;å‡€åˆ©æ¶¦&quot;åçš„æ•°å­—</span></span><br><span class="line">    profit_match = re.search(<span class="string">r&#x27;å‡€åˆ©æ¶¦[^\d]*Â¥?(\d[,\d]*\.?\d*)&#x27;</span>, text)</span><br><span class="line">    <span class="keyword">if</span> profit_match:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            profit = <span class="built_in">float</span>(profit_match.group(<span class="number">1</span>).replace(<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">            result[<span class="string">&#x27;å‡€åˆ©æ¶¦&#x27;</span>] = profit</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 4. æå–æ‰€æœ‰æ”¶å…¥é¡¹ï¼ˆæ¨¡å¼ï¼šé¡¹ç›®åç§°+é‡‘é¢ï¼‰</span></span><br><span class="line">    <span class="comment"># ä¾‹å¦‚ï¼š&quot;äº§å“é”€å”®æ”¶å…¥Â¥1,250,000.00&quot;</span></span><br><span class="line">    income_items = re.findall(<span class="string">r&#x27;([\u4e00-\u9fa5]+æ”¶å…¥)[^\d]*Â¥?(\d[,\d]*\.?\d*)&#x27;</span>, text)</span><br><span class="line">    <span class="keyword">for</span> name, amount <span class="keyword">in</span> income_items:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            result[<span class="string">&#x27;ä¸»è¦æ”¶å…¥é¡¹&#x27;</span>].append(&#123;</span><br><span class="line">                <span class="string">&#x27;åç§°&#x27;</span>: name,</span><br><span class="line">                <span class="string">&#x27;é‡‘é¢&#x27;</span>: <span class="built_in">float</span>(amount.replace(<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">            &#125;)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 5. æå–å‘ç¥¨å·</span></span><br><span class="line">    result[<span class="string">&#x27;å‘ç¥¨åˆ—è¡¨&#x27;</span>] = extract_invoice_numbers(text)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•è§£æ</span></span><br><span class="line">report_text = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">2025å¹´01æœˆè´¢åŠ¡æŠ¥å‘Š</span></span><br><span class="line"><span class="string">æ™ºæ…§è´¢åŠ¡ç§‘æŠ€æœ‰é™å…¬å¸</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ä¸€ã€æ€»ä½“æƒ…å†µ</span></span><br><span class="line"><span class="string">æŠ¥å‘Šæ—¥æœŸï¼š2025-01-26</span></span><br><span class="line"><span class="string">æœ¬æœˆæ€»è¥æ”¶Â¥2,580,000.00å…ƒï¼Œå‡€åˆ©æ¶¦Â¥450,000.00å…ƒã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">äºŒã€æ”¶å…¥æ˜ç»†</span></span><br><span class="line"><span class="string">äº§å“é”€å”®æ”¶å…¥Â¥1,250,000.00</span></span><br><span class="line"><span class="string">æŠ€æœ¯æœåŠ¡æ”¶å…¥Â¥800,000.00</span></span><br><span class="line"><span class="string">å’¨è¯¢æ”¶å…¥Â¥530,000.00</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ä¸‰ã€è´¹ç”¨æ˜ç»†</span></span><br><span class="line"><span class="string">ç›¸å…³å‘ç¥¨ï¼šINV2025001234ã€INV2025005678</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">result = parse_financial_report(report_text)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nç»“æ„åŒ–æå–ç»“æœï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(json.dumps(result, ensure_ascii=<span class="literal">False</span>, indent=<span class="number">2</span>))</span><br></pre></td></tr></table></figure><hr><h3 id="äº”ã€å®æˆ˜ï¼šæ‰¹é‡è§£æè´¢åŠ¡æŠ¥è¡¨æ–‡ä»¶"><a href="#äº”ã€å®æˆ˜ï¼šæ‰¹é‡è§£æè´¢åŠ¡æŠ¥è¡¨æ–‡ä»¶" class="headerlink" title="äº”ã€å®æˆ˜ï¼šæ‰¹é‡è§£æè´¢åŠ¡æŠ¥è¡¨æ–‡ä»¶"></a>äº”ã€å®æˆ˜ï¼šæ‰¹é‡è§£æè´¢åŠ¡æŠ¥è¡¨æ–‡ä»¶</h3><h4 id="5-1-å¤„ç†å•ä¸ªPDF-x2F-PPTæ–‡æœ¬"><a href="#5-1-å¤„ç†å•ä¸ªPDF-x2F-PPTæ–‡æœ¬" class="headerlink" title="5.1 å¤„ç†å•ä¸ªPDF&#x2F;PPTæ–‡æœ¬"></a>5.1 å¤„ç†å•ä¸ªPDF&#x2F;PPTæ–‡æœ¬</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ========== æ‰¹é‡è§£ææ–‡ä»¶å¤¹ä¸­çš„æŠ¥è¡¨ ==========</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">batch_parse_reports</span>(<span class="params">folder_path: <span class="built_in">str</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æ‰¹é‡è§£ææ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰æ–‡æœ¬æ–‡ä»¶</span></span><br><span class="line"><span class="string">    å‡è®¾æ–‡ä»¶å·²è½¬æ¢ä¸º.txtæ ¼å¼</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">import</span> glob</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æŸ¥æ‰¾æ‰€æœ‰txtæ–‡ä»¶</span></span><br><span class="line">    files = glob.glob(os.path.join(folder_path, <span class="string">&quot;*.txt&quot;</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> files:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;âš ï¸ æœªæ‰¾åˆ°txtæ–‡ä»¶ï¼Œè¯·å…ˆè½¬æ¢PDF/PPTä¸ºæ–‡æœ¬&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    all_results = []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> filepath <span class="keyword">in</span> files:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ“„ å¤„ç†: <span class="subst">&#123;os.path.basename(filepath)&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># è¯»å–æ–‡ä»¶å†…å®¹</span></span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(filepath, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                text = f.read()</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># è§£æ</span></span><br><span class="line">            result = parse_financial_report(text)</span><br><span class="line">            result[<span class="string">&#x27;æ–‡ä»¶&#x27;</span>] = os.path.basename(filepath)</span><br><span class="line">            result[<span class="string">&#x27;å¤„ç†æ—¶é—´&#x27;</span>] = datetime.now().strftime(<span class="string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>)</span><br><span class="line">            </span><br><span class="line">            all_results.append(result)</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;âœ… æå–åˆ°è¥æ”¶: Â¥<span class="subst">&#123;result[<span class="string">&#x27;æ€»è¥æ”¶&#x27;</span>]:,<span class="number">.2</span>f&#125;</span>ï¼Œå‡€åˆ©æ¶¦: Â¥<span class="subst">&#123;result[<span class="string">&#x27;å‡€åˆ©æ¶¦&#x27;</span>]:,<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;âŒ å¤„ç†å¤±è´¥: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ä¿å­˜ç»“æœ</span></span><br><span class="line">    <span class="keyword">if</span> all_results:</span><br><span class="line">        df = pd.DataFrame(all_results)</span><br><span class="line">        output_file = <span class="string">f&quot;è´¢åŠ¡æŠ¥è¡¨æ±‡æ€»_<span class="subst">&#123;datetime.now().strftime(<span class="string">&#x27;%Y%m%d&#x27;</span>)&#125;</span>.xlsx&quot;</span></span><br><span class="line">        df.to_excel(output_file, index=<span class="literal">False</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ‰ æ±‡æ€»å®Œæˆï¼Œä¿å­˜è‡³: <span class="subst">&#123;output_file&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> df</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºæµ‹è¯•æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_test_files</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;åˆ›å»ºæµ‹è¯•ç”¨çš„æŠ¥è¡¨æ–‡ä»¶&quot;&quot;&quot;</span></span><br><span class="line">    os.makedirs(<span class="string">&quot;è´¢åŠ¡æŠ¥å‘Š&quot;</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æŠ¥å‘Š1</span></span><br><span class="line">    report1 = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    2025å¹´01æœˆè´¢åŠ¡æŠ¥å‘Š</span></span><br><span class="line"><span class="string">    æ™ºæ…§è´¢åŠ¡ç§‘æŠ€æœ‰é™å…¬å¸</span></span><br><span class="line"><span class="string">    æŠ¥å‘Šæ—¥æœŸï¼š2025-01-26</span></span><br><span class="line"><span class="string">    æœ¬æœˆæ€»è¥æ”¶Â¥2,580,000.00å…ƒï¼Œå‡€åˆ©æ¶¦Â¥450,000.00å…ƒã€‚</span></span><br><span class="line"><span class="string">    äº§å“é”€å”®æ”¶å…¥Â¥1,250,000.00</span></span><br><span class="line"><span class="string">    æŠ€æœ¯æœåŠ¡æ”¶å…¥Â¥800,000.00</span></span><br><span class="line"><span class="string">    å‘ç¥¨ï¼šINV2025001234</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;è´¢åŠ¡æŠ¥å‘Š/2025å¹´01æœˆæŠ¥å‘Š.txt&quot;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(report1)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æŠ¥å‘Š2</span></span><br><span class="line">    report2 = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    2025å¹´02æœˆè´¢åŠ¡æŠ¥å‘Š</span></span><br><span class="line"><span class="string">    æ™ºæ…§è´¢åŠ¡ç§‘æŠ€æœ‰é™å…¬å¸</span></span><br><span class="line"><span class="string">    æŠ¥å‘Šæ—¥æœŸï¼š2025-02-26</span></span><br><span class="line"><span class="string">    æœ¬æœˆæ€»è¥æ”¶Â¥3,120,000.00å…ƒï¼Œå‡€åˆ©æ¶¦Â¥580,000.00å…ƒã€‚</span></span><br><span class="line"><span class="string">    äº§å“é”€å”®æ”¶å…¥Â¥1,500,000.00</span></span><br><span class="line"><span class="string">    å’¨è¯¢æ”¶å…¥Â¥620,000.00</span></span><br><span class="line"><span class="string">    å‘ç¥¨ï¼šINV2025005678</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;è´¢åŠ¡æŠ¥å‘Š/2025å¹´02æœˆæŠ¥å‘Š.txt&quot;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(report2)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;âœ… æµ‹è¯•æ–‡ä»¶åˆ›å»ºå®Œæˆï¼Œåœ¨&#x27;è´¢åŠ¡æŠ¥å‘Š&#x27;æ–‡ä»¶å¤¹&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•æ‰¹é‡å¤„ç†</span></span><br><span class="line"><span class="comment"># create_test_files()</span></span><br><span class="line"><span class="comment"># df = batch_parse_reports(&quot;è´¢åŠ¡æŠ¥å‘Š&quot;)</span></span><br><span class="line"><span class="comment"># if df is not None:</span></span><br><span class="line"><span class="comment">#     print(&quot;\næ±‡æ€»ç»“æœé¢„è§ˆï¼š&quot;)</span></span><br><span class="line"><span class="comment">#     print(df[[&#x27;æ–‡ä»¶&#x27;, &#x27;æŠ¥å‘Šæ—¥æœŸ&#x27;, &#x27;æ€»è¥æ”¶&#x27;, &#x27;å‡€åˆ©æ¶¦&#x27;]].to_string())</span></span><br></pre></td></tr></table></figure><hr><h3 id="å…­ã€å®Œæ•´é¡¹ç›®ï¼šè´¢åŠ¡æŠ¥è¡¨æ™ºèƒ½è§£æå™¨"><a href="#å…­ã€å®Œæ•´é¡¹ç›®ï¼šè´¢åŠ¡æŠ¥è¡¨æ™ºèƒ½è§£æå™¨" class="headerlink" title="å…­ã€å®Œæ•´é¡¹ç›®ï¼šè´¢åŠ¡æŠ¥è¡¨æ™ºèƒ½è§£æå™¨"></a>å…­ã€å®Œæ•´é¡¹ç›®ï¼šè´¢åŠ¡æŠ¥è¡¨æ™ºèƒ½è§£æå™¨</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ========== è´¢åŠ¡æŠ¥è¡¨æ™ºèƒ½è§£æå™¨ - å®Œæ•´ç‰ˆ ==========</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> glob</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FinancialReportParser</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è´¢åŠ¡æŠ¥è¡¨è§£æå™¨&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.results = []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extract_money</span>(<span class="params">self, text: <span class="built_in">str</span></span>) -&gt; <span class="built_in">list</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æå–é‡‘é¢&quot;&quot;&quot;</span></span><br><span class="line">        pattern = <span class="string">r&#x27;Â¥?(\d+(?:,\d&#123;3&#125;)*\.?\d*)\s*å…ƒ?&#x27;</span></span><br><span class="line">        matches = re.findall(pattern, text)</span><br><span class="line">        </span><br><span class="line">        amounts = []</span><br><span class="line">        <span class="keyword">for</span> <span class="keyword">match</span> <span class="keyword">in</span> matches:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                clean = <span class="keyword">match</span>.replace(<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">                amount = <span class="built_in">float</span>(clean)</span><br><span class="line">                <span class="keyword">if</span> amount &gt; <span class="number">0</span>:</span><br><span class="line">                    amounts.append(amount)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">return</span> amounts</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extract_dates</span>(<span class="params">self, text: <span class="built_in">str</span></span>) -&gt; <span class="built_in">list</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æå–æ—¥æœŸ&quot;&quot;&quot;</span></span><br><span class="line">        pattern = <span class="string">r&#x27;(\d&#123;4&#125;)[-/å¹´](\d&#123;1,2&#125;)[-/æœˆ](\d&#123;1,2&#125;)æ—¥?&#x27;</span></span><br><span class="line">        matches = re.findall(pattern, text)</span><br><span class="line">        </span><br><span class="line">        dates = []</span><br><span class="line">        <span class="keyword">for</span> year, month, day <span class="keyword">in</span> matches:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                date_str = <span class="string">f&quot;<span class="subst">&#123;year&#125;</span>-<span class="subst">&#123;month.zfill(<span class="number">2</span>)&#125;</span>-<span class="subst">&#123;day.zfill(<span class="number">2</span>)&#125;</span>&quot;</span></span><br><span class="line">                datetime.strptime(date_str, <span class="string">&#x27;%Y-%m-%d&#x27;</span>)</span><br><span class="line">                dates.append(date_str)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">return</span> dates</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extract_invoice_numbers</span>(<span class="params">self, text: <span class="built_in">str</span></span>) -&gt; <span class="built_in">list</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æå–å‘ç¥¨å·&quot;&quot;&quot;</span></span><br><span class="line">        pattern = <span class="string">r&#x27;[A-Z]&#123;2,4&#125;\d&#123;8,12&#125;&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> re.findall(pattern, text)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">parse_report</span>(<span class="params">self, text: <span class="built_in">str</span>, filename: <span class="built_in">str</span> = <span class="string">&quot;&quot;</span></span>) -&gt; <span class="built_in">dict</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        è§£æå•ä»½è´¢åŠ¡æŠ¥å‘Š</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        è¾“å‡ºç»“æ„ï¼š</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            &#x27;æ–‡ä»¶&#x27;: &#x27;æ–‡ä»¶å&#x27;,</span></span><br><span class="line"><span class="string">            &#x27;æŠ¥å‘Šæ—¥æœŸ&#x27;: &#x27;2025-01-26&#x27;,</span></span><br><span class="line"><span class="string">            &#x27;å…¬å¸åç§°&#x27;: &#x27;XXXæœ‰é™å…¬å¸&#x27;,</span></span><br><span class="line"><span class="string">            &#x27;æ€»è¥æ”¶&#x27;: 2580000.0,</span></span><br><span class="line"><span class="string">            &#x27;å‡€åˆ©æ¶¦&#x27;: 450000.0,</span></span><br><span class="line"><span class="string">            &#x27;ä¸»è¦æ”¶å…¥é¡¹&#x27;: [&#123;&#x27;åç§°&#x27;: &#x27;XXæ”¶å…¥&#x27;, &#x27;é‡‘é¢&#x27;: 1250000.0&#125;, ...],</span></span><br><span class="line"><span class="string">            &#x27;å‘ç¥¨åˆ—è¡¨&#x27;: [&#x27;INV2025001234&#x27;, ...]</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        result = &#123;</span><br><span class="line">            <span class="string">&#x27;æ–‡ä»¶&#x27;</span>: filename,</span><br><span class="line">            <span class="string">&#x27;æŠ¥å‘Šæ—¥æœŸ&#x27;</span>: <span class="literal">None</span>,</span><br><span class="line">            <span class="string">&#x27;å…¬å¸åç§°&#x27;</span>: <span class="literal">None</span>,</span><br><span class="line">            <span class="string">&#x27;æ€»è¥æ”¶&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="string">&#x27;å‡€åˆ©æ¶¦&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="string">&#x27;ä¸»è¦æ”¶å…¥é¡¹&#x27;</span>: [],</span><br><span class="line">            <span class="string">&#x27;å‘ç¥¨åˆ—è¡¨&#x27;</span>: []</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æå–æ—¥æœŸ</span></span><br><span class="line">        dates = self.extract_dates(text)</span><br><span class="line">        <span class="keyword">if</span> dates:</span><br><span class="line">            result[<span class="string">&#x27;æŠ¥å‘Šæ—¥æœŸ&#x27;</span>] = dates[<span class="number">0</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æå–å…¬å¸åç§°</span></span><br><span class="line">        company_pattern = <span class="string">r&#x27;[\u4e00-\u9fa5]+æœ‰é™å…¬å¸&#x27;</span></span><br><span class="line">        company_match = re.search(company_pattern, text)</span><br><span class="line">        <span class="keyword">if</span> company_match:</span><br><span class="line">            result[<span class="string">&#x27;å…¬å¸åç§°&#x27;</span>] = company_match.group()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æå–è¥æ”¶</span></span><br><span class="line">        revenue_match = re.search(<span class="string">r&#x27;è¥æ”¶[^\d]*Â¥?(\d[,\d]*\.?\d*)&#x27;</span>, text)</span><br><span class="line">        <span class="keyword">if</span> revenue_match:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                result[<span class="string">&#x27;æ€»è¥æ”¶&#x27;</span>] = <span class="built_in">float</span>(revenue_match.group(<span class="number">1</span>).replace(<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æå–å‡€åˆ©æ¶¦</span></span><br><span class="line">        profit_match = re.search(<span class="string">r&#x27;å‡€åˆ©æ¶¦[^\d]*Â¥?(\d[,\d]*\.?\d*)&#x27;</span>, text)</span><br><span class="line">        <span class="keyword">if</span> profit_match:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                result[<span class="string">&#x27;å‡€åˆ©æ¶¦&#x27;</span>] = <span class="built_in">float</span>(profit_match.group(<span class="number">1</span>).replace(<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æå–æ”¶å…¥é¡¹</span></span><br><span class="line">        income_items = re.findall(<span class="string">r&#x27;([\u4e00-\u9fa5]+æ”¶å…¥)[^\d]*Â¥?(\d[,\d]*\.?\d*)&#x27;</span>, text)</span><br><span class="line">        <span class="keyword">for</span> name, amount <span class="keyword">in</span> income_items:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                result[<span class="string">&#x27;ä¸»è¦æ”¶å…¥é¡¹&#x27;</span>].append(&#123;</span><br><span class="line">                    <span class="string">&#x27;åç§°&#x27;</span>: name,</span><br><span class="line">                    <span class="string">&#x27;é‡‘é¢&#x27;</span>: <span class="built_in">float</span>(amount.replace(<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">                &#125;)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æå–å‘ç¥¨å·</span></span><br><span class="line">        result[<span class="string">&#x27;å‘ç¥¨åˆ—è¡¨&#x27;</span>] = self.extract_invoice_numbers(text)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">parse_file</span>(<span class="params">self, filepath: <span class="built_in">str</span></span>) -&gt; <span class="built_in">dict</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;è§£æå•ä¸ªæ–‡ä»¶&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ“„ å¤„ç†: <span class="subst">&#123;os.path.basename(filepath)&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># è¯»å–æ–‡ä»¶</span></span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(filepath, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                text = f.read()</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># è§£æ</span></span><br><span class="line">            result = self.parse_report(text, os.path.basename(filepath))</span><br><span class="line">            result[<span class="string">&#x27;å¤„ç†æ—¶é—´&#x27;</span>] = datetime.now().strftime(<span class="string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;âŒ æ–‡ä»¶å¤„ç†å¤±è´¥: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">parse_folder</span>(<span class="params">self, folder_path: <span class="built_in">str</span></span>) -&gt; pd.DataFrame:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;è§£ææ–‡ä»¶å¤¹ä¸­æ‰€æœ‰æ–‡ä»¶&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># æŸ¥æ‰¾æ–‡ä»¶</span></span><br><span class="line">        files = glob.glob(os.path.join(folder_path, <span class="string">&quot;*.txt&quot;</span>))</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> files:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;âš ï¸ æœªæ‰¾åˆ°txtæ–‡ä»¶&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> pd.DataFrame()</span><br><span class="line">        </span><br><span class="line">        self.results = []</span><br><span class="line">        success = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> filepath <span class="keyword">in</span> files:</span><br><span class="line">            result = self.parse_file(filepath)</span><br><span class="line">            <span class="keyword">if</span> result:</span><br><span class="line">                self.results.append(result)</span><br><span class="line">                success += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\nâœ… æˆåŠŸå¤„ç† <span class="subst">&#123;success&#125;</span>/<span class="subst">&#123;<span class="built_in">len</span>(files)&#125;</span> ä¸ªæ–‡ä»¶&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è½¬æ¢ä¸ºDataFrame</span></span><br><span class="line">        <span class="keyword">if</span> self.results:</span><br><span class="line">            df = pd.DataFrame(self.results)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># å±•å¹³æ”¶å…¥é¡¹</span></span><br><span class="line">            df[<span class="string">&#x27;æ”¶å…¥é¡¹æ•°é‡&#x27;</span>] = df[<span class="string">&#x27;ä¸»è¦æ”¶å…¥é¡¹&#x27;</span>].apply(<span class="built_in">len</span>)</span><br><span class="line">            df[<span class="string">&#x27;å‘ç¥¨æ•°é‡&#x27;</span>] = df[<span class="string">&#x27;å‘ç¥¨åˆ—è¡¨&#x27;</span>].apply(<span class="built_in">len</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> df</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> pd.DataFrame()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">save_to_excel</span>(<span class="params">self, df: pd.DataFrame, output_path: <span class="built_in">str</span> = <span class="literal">None</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ä¿å­˜ç»“æœåˆ°Excel&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> df.empty:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;âš ï¸ æ— æ•°æ®å¯ä¿å­˜&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> output_path <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            output_path = <span class="string">f&quot;è´¢åŠ¡æŠ¥è¡¨æ±‡æ€»_<span class="subst">&#123;datetime.now().strftime(<span class="string">&#x27;%Y%m%d&#x27;</span>)&#125;</span>.xlsx&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># åˆ›å»ºExcelWriterä»¥æ”¯æŒå¤šä¸ªsheet</span></span><br><span class="line">            <span class="keyword">with</span> pd.ExcelWriter(output_path, engine=<span class="string">&#x27;openpyxl&#x27;</span>) <span class="keyword">as</span> writer:</span><br><span class="line">                <span class="comment"># æ±‡æ€»è¡¨</span></span><br><span class="line">                summary_cols = [<span class="string">&#x27;æ–‡ä»¶&#x27;</span>, <span class="string">&#x27;æŠ¥å‘Šæ—¥æœŸ&#x27;</span>, <span class="string">&#x27;å…¬å¸åç§°&#x27;</span>, <span class="string">&#x27;æ€»è¥æ”¶&#x27;</span>, <span class="string">&#x27;å‡€åˆ©æ¶¦&#x27;</span>, <span class="string">&#x27;æ”¶å…¥é¡¹æ•°é‡&#x27;</span>, <span class="string">&#x27;å‘ç¥¨æ•°é‡&#x27;</span>]</span><br><span class="line">                df[summary_cols].to_excel(writer, sheet_name=<span class="string">&#x27;æ±‡æ€»&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># è¯¦ç»†æ”¶å…¥è¡¨</span></span><br><span class="line">                detail_rows = []</span><br><span class="line">                <span class="keyword">for</span> _, row <span class="keyword">in</span> df.iterrows():</span><br><span class="line">                    <span class="keyword">for</span> item <span class="keyword">in</span> row[<span class="string">&#x27;ä¸»è¦æ”¶å…¥é¡¹&#x27;</span>]:</span><br><span class="line">                        detail_rows.append(&#123;</span><br><span class="line">                            <span class="string">&#x27;æ–‡ä»¶&#x27;</span>: row[<span class="string">&#x27;æ–‡ä»¶&#x27;</span>],</span><br><span class="line">                            <span class="string">&#x27;æŠ¥å‘Šæ—¥æœŸ&#x27;</span>: row[<span class="string">&#x27;æŠ¥å‘Šæ—¥æœŸ&#x27;</span>],</span><br><span class="line">                            <span class="string">&#x27;æ”¶å…¥åç§°&#x27;</span>: item[<span class="string">&#x27;åç§°&#x27;</span>],</span><br><span class="line">                            <span class="string">&#x27;é‡‘é¢&#x27;</span>: item[<span class="string">&#x27;é‡‘é¢&#x27;</span>]</span><br><span class="line">                        &#125;)</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> detail_rows:</span><br><span class="line">                    detail_df = pd.DataFrame(detail_rows)</span><br><span class="line">                    detail_df.to_excel(writer, sheet_name=<span class="string">&#x27;æ”¶å…¥æ˜ç»†&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># å‘ç¥¨åˆ—è¡¨</span></span><br><span class="line">                invoice_rows = []</span><br><span class="line">                <span class="keyword">for</span> _, row <span class="keyword">in</span> df.iterrows():</span><br><span class="line">                    <span class="keyword">for</span> inv <span class="keyword">in</span> row[<span class="string">&#x27;å‘ç¥¨åˆ—è¡¨&#x27;</span>]:</span><br><span class="line">                        invoice_rows.append(&#123;</span><br><span class="line">                            <span class="string">&#x27;æ–‡ä»¶&#x27;</span>: row[<span class="string">&#x27;æ–‡ä»¶&#x27;</span>],</span><br><span class="line">                            <span class="string">&#x27;æŠ¥å‘Šæ—¥æœŸ&#x27;</span>: row[<span class="string">&#x27;æŠ¥å‘Šæ—¥æœŸ&#x27;</span>],</span><br><span class="line">                            <span class="string">&#x27;å‘ç¥¨å·&#x27;</span>: inv</span><br><span class="line">                        &#125;)</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> invoice_rows:</span><br><span class="line">                    inv_df = pd.DataFrame(invoice_rows)</span><br><span class="line">                    inv_df.to_excel(writer, sheet_name=<span class="string">&#x27;å‘ç¥¨æ¸…å•&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;âœ… ExcelæŠ¥å‘Šå·²ç”Ÿæˆ: <span class="subst">&#123;output_path&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;âŒ ä¿å­˜Excelå¤±è´¥: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_sample_data</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;åˆ›å»ºç¤ºä¾‹æ–‡ä»¶&quot;&quot;&quot;</span></span><br><span class="line">    os.makedirs(<span class="string">&quot;è´¢åŠ¡æŠ¥è¡¨&quot;</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åˆ›å»º3ä¸ªç¤ºä¾‹æŠ¥å‘Š</span></span><br><span class="line">    reports = [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;filename&quot;</span>: <span class="string">&quot;2025-01-è´¢åŠ¡æŠ¥å‘Š.txt&quot;</span>,</span><br><span class="line">            <span class="string">&quot;content&quot;</span>: <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            æ™ºæ…§è´¢åŠ¡ç§‘æŠ€æœ‰é™å…¬å¸ 2025å¹´1æœˆè´¢åŠ¡æŠ¥å‘Š</span></span><br><span class="line"><span class="string">            æŠ¥å‘Šæ—¥æœŸï¼š2025-01-26</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">            æœ¬æœˆå®ç°æ€»è¥æ”¶Â¥2,580,000.00å…ƒï¼Œå‡€åˆ©æ¶¦Â¥450,000.00å…ƒã€‚</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">            æ”¶å…¥æ„æˆï¼š</span></span><br><span class="line"><span class="string">            äº§å“é”€å”®æ”¶å…¥Â¥1,250,000.00</span></span><br><span class="line"><span class="string">            æŠ€æœ¯æœåŠ¡æ”¶å…¥Â¥800,000.00</span></span><br><span class="line"><span class="string">            å’¨è¯¢æ”¶å…¥Â¥530,000.00</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">            ç›¸å…³å‘ç¥¨ï¼šINV2025001234ã€INV2025001235</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;filename&quot;</span>: <span class="string">&quot;2025-02-è´¢åŠ¡æŠ¥å‘Š.txt&quot;</span>,</span><br><span class="line">            <span class="string">&quot;content&quot;</span>: <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            æ™ºæ…§è´¢åŠ¡ç§‘æŠ€æœ‰é™å…¬å¸ 2025å¹´2æœˆè´¢åŠ¡æŠ¥å‘Š</span></span><br><span class="line"><span class="string">            æŠ¥å‘Šæ—¥æœŸï¼š2025-02-26</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">            æœ¬æœˆå®ç°æ€»è¥æ”¶Â¥3,120,000.00å…ƒï¼Œå‡€åˆ©æ¶¦Â¥580,000.00å…ƒã€‚</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">            æ”¶å…¥æ„æˆï¼š</span></span><br><span class="line"><span class="string">            äº§å“é”€å”®æ”¶å…¥Â¥1,500,000.00</span></span><br><span class="line"><span class="string">            æŠ€æœ¯æœåŠ¡æ”¶å…¥Â¥920,000.00</span></span><br><span class="line"><span class="string">            åŸ¹è®­æ”¶å…¥Â¥700,000.00</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">            ç›¸å…³å‘ç¥¨ï¼šINV2025005678</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;filename&quot;</span>: <span class="string">&quot;2025-03-è´¢åŠ¡æŠ¥å‘Š.txt&quot;</span>,</span><br><span class="line">            <span class="string">&quot;content&quot;</span>: <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            æ™ºæ…§è´¢åŠ¡ç§‘æŠ€æœ‰é™å…¬å¸ 2025å¹´3æœˆè´¢åŠ¡æŠ¥å‘Š</span></span><br><span class="line"><span class="string">            æŠ¥å‘Šæ—¥æœŸï¼š2025-03-26</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">            æœ¬æœˆå®ç°æ€»è¥æ”¶Â¥2,950,000.00å…ƒï¼Œå‡€åˆ©æ¶¦Â¥520,000.00å…ƒã€‚</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">            æ”¶å…¥æ„æˆï¼š</span></span><br><span class="line"><span class="string">            äº§å“é”€å”®æ”¶å…¥Â¥1,400,000.00</span></span><br><span class="line"><span class="string">            æŠ€æœ¯æœåŠ¡æ”¶å…¥Â¥850,000.00</span></span><br><span class="line"><span class="string">            å’¨è¯¢æ”¶å…¥Â¥700,000.00</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">            ç›¸å…³å‘ç¥¨ï¼šINV2025009012ã€INV2025009013ã€INV2025009014</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> report <span class="keyword">in</span> reports:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">f&quot;è´¢åŠ¡æŠ¥è¡¨/<span class="subst">&#123;report[<span class="string">&#x27;filename&#x27;</span>]&#125;</span>&quot;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(report[<span class="string">&#x27;content&#x27;</span>])</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;âœ… ç¤ºä¾‹æ•°æ®å·²åˆ›å»ºåœ¨&#x27;è´¢åŠ¡æŠ¥è¡¨&#x27;æ–‡ä»¶å¤¹&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ä¸»èœå•&quot;&quot;&quot;</span></span><br><span class="line">    parser = FinancialReportParser()</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">55</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è´¢åŠ¡æŠ¥è¡¨æ™ºèƒ½è§£æå™¨&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">55</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span> * <span class="number">45</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;åŠŸèƒ½èœå•&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">45</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;1. åˆ›å»ºç¤ºä¾‹æ•°æ®&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;2. è§£æå•ä¸ªæ–‡ä»¶&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;3. è§£ææ•´ä¸ªæ–‡ä»¶å¤¹&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;4. é€€å‡º&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">45</span>)</span><br><span class="line">        </span><br><span class="line">        choice = <span class="built_in">input</span>(<span class="string">&quot;è¯·é€‰æ‹©: &quot;</span>).strip()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> choice == <span class="string">&quot;1&quot;</span>:</span><br><span class="line">            create_sample_data()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">elif</span> choice == <span class="string">&quot;2&quot;</span>:</span><br><span class="line">            filepath = <span class="built_in">input</span>(<span class="string">&quot;æ–‡ä»¶è·¯å¾„: &quot;</span>).strip()</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(filepath):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;âŒ æ–‡ä»¶ä¸å­˜åœ¨&quot;</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">            result = parser.parse_file(filepath)</span><br><span class="line">            <span class="keyword">if</span> result:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;\nè§£æç»“æœï¼š&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(json.dumps(result, ensure_ascii=<span class="literal">False</span>, indent=<span class="number">2</span>))</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">elif</span> choice == <span class="string">&quot;3&quot;</span>:</span><br><span class="line">            folder = <span class="built_in">input</span>(<span class="string">&quot;æ–‡ä»¶å¤¹è·¯å¾„ï¼ˆç›´æ¥å›è½¦ç”¨&#x27;è´¢åŠ¡æŠ¥è¡¨&#x27;ï¼‰: &quot;</span>).strip() <span class="keyword">or</span> <span class="string">&quot;è´¢åŠ¡æŠ¥è¡¨&quot;</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(folder):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;âŒ æ–‡ä»¶å¤¹ä¸å­˜åœ¨&quot;</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">            df = parser.parse_folder(folder)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> df.empty:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;\næ±‡æ€»é¢„è§ˆï¼š&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(df[[<span class="string">&#x27;æ–‡ä»¶&#x27;</span>, <span class="string">&#x27;æŠ¥å‘Šæ—¥æœŸ&#x27;</span>, <span class="string">&#x27;æ€»è¥æ”¶&#x27;</span>, <span class="string">&#x27;å‡€åˆ©æ¶¦&#x27;</span>]].to_string())</span><br><span class="line">                </span><br><span class="line">                save = <span class="built_in">input</span>(<span class="string">&quot;\næ˜¯å¦ä¿å­˜ä¸ºExcelï¼Ÿ(y/n): &quot;</span>).strip()</span><br><span class="line">                <span class="keyword">if</span> save.lower() == <span class="string">&#x27;y&#x27;</span>:</span><br><span class="line">                    parser.save_to_excel(df)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;âš ï¸ æ²¡æœ‰è§£æåˆ°æœ‰æ•ˆæ•°æ®&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">elif</span> choice == <span class="string">&quot;4&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;ğŸ‘‹ å†è§ï¼&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;è¯·è¾“å…¥1-4ï¼&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><hr><h3 id="ä¸ƒã€çŸ¥è¯†ç‚¹åŠ æ²¹ç«™"><a href="#ä¸ƒã€çŸ¥è¯†ç‚¹åŠ æ²¹ç«™" class="headerlink" title="ä¸ƒã€çŸ¥è¯†ç‚¹åŠ æ²¹ç«™"></a>ä¸ƒã€çŸ¥è¯†ç‚¹åŠ æ²¹ç«™</h3><h4 id="7-1-æ­£åˆ™è¡¨è¾¾å¼â€œå°æŠ„â€"><a href="#7-1-æ­£åˆ™è¡¨è¾¾å¼â€œå°æŠ„â€" class="headerlink" title="7.1 æ­£åˆ™è¡¨è¾¾å¼â€œå°æŠ„â€"></a>7.1 æ­£åˆ™è¡¨è¾¾å¼â€œå°æŠ„â€</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">å¸¸ç”¨å…ƒå­—ç¬¦ï¼š</span></span><br><span class="line"><span class="string">.       åŒ¹é…ä»»æ„å­—ç¬¦ï¼ˆé™¤æ¢è¡Œç¬¦ï¼‰</span></span><br><span class="line"><span class="string">\d      åŒ¹é…æ•°å­— [0-9]</span></span><br><span class="line"><span class="string">\D      åŒ¹é…éæ•°å­—</span></span><br><span class="line"><span class="string">\w      åŒ¹é…å­—æ¯/æ•°å­—/ä¸‹åˆ’çº¿</span></span><br><span class="line"><span class="string">\W      åŒ¹é…éå­—æ¯/æ•°å­—/ä¸‹åˆ’çº¿</span></span><br><span class="line"><span class="string">\s      åŒ¹é…ç©ºç™½ï¼ˆç©ºæ ¼/Tabï¼‰</span></span><br><span class="line"><span class="string">\S      åŒ¹é…éç©ºç™½</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">é‡è¯ï¼š</span></span><br><span class="line"><span class="string">*       0æ¬¡æˆ–å¤šæ¬¡</span></span><br><span class="line"><span class="string">+       1æ¬¡æˆ–å¤šæ¬¡</span></span><br><span class="line"><span class="string">?       0æ¬¡æˆ–1æ¬¡</span></span><br><span class="line"><span class="string">&#123;n&#125;     æ°å¥½næ¬¡</span></span><br><span class="line"><span class="string">&#123;n,&#125;    è‡³å°‘næ¬¡</span></span><br><span class="line"><span class="string">&#123;n,m&#125;   nåˆ°mæ¬¡</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">è¾¹ç•Œï¼š</span></span><br><span class="line"><span class="string">^       å­—ç¬¦ä¸²å¼€å¤´</span></span><br><span class="line"><span class="string">$       å­—ç¬¦ä¸²ç»“å°¾</span></span><br><span class="line"><span class="string">\b      å•è¯è¾¹ç•Œ</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">åˆ†ç»„ä¸é€‰æ‹©ï¼š</span></span><br><span class="line"><span class="string">()      åˆ†ç»„ï¼Œå¯ç”¨äºæå–</span></span><br><span class="line"><span class="string">[]      å­—ç¬¦é›†åˆ</span></span><br><span class="line"><span class="string">|       æˆ–ï¼ˆabc|defï¼‰</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">è¿›é˜¶ï¼š</span></span><br><span class="line"><span class="string">(?:...) éæ•è·ç»„ï¼ˆä¸ä¿å­˜åŒ¹é…ç»“æœï¼‰</span></span><br><span class="line"><span class="string">(?P&lt;name&gt;...) å‘½ååˆ†ç»„</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">è´¢åŠ¡å¸¸ç”¨æ¨¡å¼ï¼š</span></span><br><span class="line"><span class="string">é‡‘é¢ï¼šÂ¥?\d+(,\d&#123;3&#125;)*\.?\d*</span></span><br><span class="line"><span class="string">æ—¥æœŸï¼š(\d&#123;4&#125;)[-/å¹´](\d&#123;1,2&#125;)[-/æœˆ](\d&#123;1,2&#125;)æ—¥?</span></span><br><span class="line"><span class="string">å‘ç¥¨ï¼š[A-Z]&#123;2,4&#125;\d&#123;8,12&#125;</span></span><br><span class="line"><span class="string">é“¶è¡Œè´¦å·ï¼š\d&#123;16,19&#125;</span></span><br><span class="line"><span class="string">ç™¾åˆ†æ¯”ï¼š\d+\.?\d*%</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><hr><h4 id="7-2-æ­£åˆ™è°ƒè¯•æŠ€å·§"><a href="#7-2-æ­£åˆ™è°ƒè¯•æŠ€å·§" class="headerlink" title="7.2 æ­£åˆ™è°ƒè¯•æŠ€å·§"></a>7.2 æ­£åˆ™è°ƒè¯•æŠ€å·§</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">1. ä»ç®€å•å¼€å§‹ï¼Œé€æ­¥æ·»åŠ è§„åˆ™</span></span><br><span class="line"><span class="string">   å…ˆå†™ \d+ï¼Œå†å†™ \d+\.?\d*ï¼Œæœ€åå†™ \d+(,\d&#123;3&#125;)*\.?\d*</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2. ä½¿ç”¨https://regex101.com/åœ¨çº¿è°ƒè¯•</span></span><br><span class="line"><span class="string">   ç²˜è´´æ–‡æœ¬å’Œæ¨¡å¼ï¼Œå®æ—¶çœ‹åŒ¹é…ç»“æœ</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">3. ç”¨re.DEBUGæŸ¥çœ‹ç¼–è¯‘è¿‡ç¨‹</span></span><br><span class="line"><span class="string">   re.compile(pattern, re.DEBUG)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">4. åŸå§‹å­—ç¬¦ä¸²r&#x27;pattern&#x27;</span></span><br><span class="line"><span class="string">   é¿å…è½¬ä¹‰é—®é¢˜ï¼Œæ¨èæ€»æ˜¯ä½¿ç”¨r&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">5. è´ªå©ªä¸éè´ªå©ª</span></span><br><span class="line"><span class="string">   \d+ è´ªå©ªï¼ˆåŒ¹é…å°½å¯èƒ½å¤šï¼‰</span></span><br><span class="line"><span class="string">   \d+? éè´ªå©ªï¼ˆåŒ¹é…å°½å¯èƒ½å°‘ï¼‰</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><hr><h3 id="å…«ã€æ€»ç»“"><a href="#å…«ã€æ€»ç»“" class="headerlink" title="å…«ã€æ€»ç»“"></a>å…«ã€æ€»ç»“</h3><ul><li>âœ… æ­£åˆ™è¡¨è¾¾å¼çš„æ¨¡å¼åŒ¹é…åŸç†</li><li>âœ… æå–é‡‘é¢ã€æ—¥æœŸã€å‘ç¥¨å·ç­‰è´¢åŠ¡æ•°æ®</li><li>âœ… ä»æ··ä¹±æ–‡æœ¬ä¸­æå–ç»“æ„åŒ–ä¿¡æ¯</li><li>âœ… æ‰¹é‡è§£æè´¢åŠ¡æŠ¥è¡¨</li><li>âœ… ç”ŸæˆExcelæ±‡æ€»æŠ¥å‘Š</li></ul><hr><h3 id="ä¸‹ç¯‡é¢„å‘Š"><a href="#ä¸‹ç¯‡é¢„å‘Š" class="headerlink" title="ä¸‹ç¯‡é¢„å‘Š"></a>ä¸‹ç¯‡é¢„å‘Š</h3><p>ç¬¬22ç¯‡ã€Šæ•°æ®åº“åŸºç¡€ï¼šSQLiteå…¥é—¨ã€‹â€”â€”æŠŠæå–çš„æ•°æ®å­˜åˆ°æ•°æ®åº“ï¼Œå®ç°é«˜æ•ˆæŸ¥è¯¢å’Œç®¡ç†ï¼</p><hr><blockquote><p>ğŸ¤– Powered by Kimi K2 Thinking ğŸ’» å†…å®¹ç»è‘µè‘µğŸŒ»å®¡æ ¸ä¸ä¿®æ”¹</p></blockquote><hr></div><footer class="post-footer"><div class="post-nav"><div class="post-nav-item"><a href="/43bb98e4.html" rel="prev" title="Python-ç¬¬20ç¯‡ã€Šå¼‚å¸¸å¤„ç†ï¼šè®©ç¨‹åºæ›´å¥å£®ã€‹"><i class="fa fa-chevron-left"></i> Python-ç¬¬20ç¯‡ã€Šå¼‚å¸¸å¤„ç†ï¼šè®©ç¨‹åºæ›´å¥å£®ã€‹</a></div><div class="post-nav-item"><a href="/7e12eba1.html" rel="next" title="Python-ç¬¬22ç¯‡ã€Šæ•°æ®åº“åŸºç¡€ï¼šSQLiteå…¥é—¨ã€‹">Python-ç¬¬22ç¯‡ã€Šæ•°æ®åº“åŸºç¡€ï¼šSQLiteå…¥é—¨ã€‹ <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="valine-comments"></div><script>window.addEventListener("tabs:register",()=>{let t=CONFIG.comments["activeClass"];var e;(t=CONFIG.comments.storage?localStorage.getItem("comments_active")||t:t)&&(e=document.querySelector(`a[href="#comment-${t}"]`))&&e.click()}),CONFIG.comments.storage&&window.addEventListener("tabs:click",t=>{t.target.matches(".tabs-comment .tab-content .tab-pane")&&(t=t.target.classList[1],localStorage.setItem("comments_active",t))})</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">æ–‡ç« ç›®å½•</li><li class="sidebar-nav-overview">ç«™ç‚¹æ¦‚è§ˆ</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%BC%E8%AF%AD"><span class="nav-number">1.</span> <span class="nav-text">å¯¼è¯­</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%AC%E7%AF%87%E7%9B%AE%E6%A0%87"><span class="nav-number">2.</span> <span class="nav-text">æœ¬ç¯‡ç›®æ ‡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C%EF%BC%9A%E6%97%A0%E9%9C%80%E5%AE%89%E8%A3%85%EF%BC%8C%E5%BC%80%E7%AE%B1%E5%8D%B3%E7%94%A8"><span class="nav-number">3.</span> <span class="nav-text">ä¸€ã€å‡†å¤‡å·¥ä½œï¼šæ— éœ€å®‰è£…ï¼Œå¼€ç®±å³ç”¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%9F"><span class="nav-number">4.</span> <span class="nav-text">äºŒã€ä»€ä¹ˆæ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E8%B4%A2%E5%8A%A1%E6%95%B0%E6%8D%AE%E5%8C%B9%E9%85%8D%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3"><span class="nav-number">5.</span> <span class="nav-text">ä¸‰ã€è´¢åŠ¡æ•°æ®åŒ¹é…æ¨¡å¼è¯¦è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-%E5%8C%B9%E9%85%8D%E9%87%91%E9%A2%9D%EF%BC%88%E6%9C%80%E5%B8%B8%E7%94%A8%EF%BC%89"><span class="nav-number">5.1.</span> <span class="nav-text">3.1 åŒ¹é…é‡‘é¢ï¼ˆæœ€å¸¸ç”¨ï¼‰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-%E5%8C%B9%E9%85%8D%E6%97%A5%E6%9C%9F"><span class="nav-number">5.2.</span> <span class="nav-text">3.2 åŒ¹é…æ—¥æœŸ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-%E5%8C%B9%E9%85%8D%E5%8F%91%E7%A5%A8%E5%8F%B7-x2F-%E9%93%B6%E8%A1%8C%E8%B4%A6%E5%8F%B7"><span class="nav-number">5.3.</span> <span class="nav-text">3.3 åŒ¹é…å‘ç¥¨å·&#x2F;é“¶è¡Œè´¦å·</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E4%BB%8E%E6%B7%B7%E4%B9%B1%E6%96%87%E6%9C%AC%E4%B8%AD%E6%8F%90%E5%8F%96%E7%BB%93%E6%9E%84%E5%8C%96%E4%BF%A1%E6%81%AF"><span class="nav-number">6.</span> <span class="nav-text">å››ã€ä»æ··ä¹±æ–‡æœ¬ä¸­æå–ç»“æ„åŒ–ä¿¡æ¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%94%E3%80%81%E5%AE%9E%E6%88%98%EF%BC%9A%E6%89%B9%E9%87%8F%E8%A7%A3%E6%9E%90%E8%B4%A2%E5%8A%A1%E6%8A%A5%E8%A1%A8%E6%96%87%E4%BB%B6"><span class="nav-number">7.</span> <span class="nav-text">äº”ã€å®æˆ˜ï¼šæ‰¹é‡è§£æè´¢åŠ¡æŠ¥è¡¨æ–‡ä»¶</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-%E5%A4%84%E7%90%86%E5%8D%95%E4%B8%AAPDF-x2F-PPT%E6%96%87%E6%9C%AC"><span class="nav-number">7.1.</span> <span class="nav-text">5.1 å¤„ç†å•ä¸ªPDF&#x2F;PPTæ–‡æœ¬</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%AD%E3%80%81%E5%AE%8C%E6%95%B4%E9%A1%B9%E7%9B%AE%EF%BC%9A%E8%B4%A2%E5%8A%A1%E6%8A%A5%E8%A1%A8%E6%99%BA%E8%83%BD%E8%A7%A3%E6%9E%90%E5%99%A8"><span class="nav-number">8.</span> <span class="nav-text">å…­ã€å®Œæ•´é¡¹ç›®ï¼šè´¢åŠ¡æŠ¥è¡¨æ™ºèƒ½è§£æå™¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%83%E3%80%81%E7%9F%A5%E8%AF%86%E7%82%B9%E5%8A%A0%E6%B2%B9%E7%AB%99"><span class="nav-number">9.</span> <span class="nav-text">ä¸ƒã€çŸ¥è¯†ç‚¹åŠ æ²¹ç«™</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#7-1-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E2%80%9C%E5%B0%8F%E6%8A%84%E2%80%9D"><span class="nav-number">9.1.</span> <span class="nav-text">7.1 æ­£åˆ™è¡¨è¾¾å¼â€œå°æŠ„â€</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-%E6%AD%A3%E5%88%99%E8%B0%83%E8%AF%95%E6%8A%80%E5%B7%A7"><span class="nav-number">9.2.</span> <span class="nav-text">7.2 æ­£åˆ™è°ƒè¯•æŠ€å·§</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%AB%E3%80%81%E6%80%BB%E7%BB%93"><span class="nav-number">10.</span> <span class="nav-text">å…«ã€æ€»ç»“</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8B%E7%AF%87%E9%A2%84%E5%91%8A"><span class="nav-number">11.</span> <span class="nav-text">ä¸‹ç¯‡é¢„å‘Š</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Aisaka Aoi" src="/images/manatsu.jpg"><p class="site-author-name" itemprop="name">Aisaka Aoi</p><div class="site-description" itemprop="description">é€¢å‚è‘µçš„ä¸ªäººåšå®¢</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">1034</span> <span class="site-state-item-name">æ—¥å¿—</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">20</span> <span class="site-state-item-name">åˆ†ç±»</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/AisakaAoi" title="GitHub ğŸ‘¨â€ğŸ’» â†’ https:&#x2F;&#x2F;github.com&#x2F;AisakaAoi" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub ğŸ‘¨â€ğŸ’»</a> </span><span class="links-of-author-item"><a href="https://github.com/Aisakaorz" title="GitHub ğŸ‘©â€ğŸ’» â†’ https:&#x2F;&#x2F;github.com&#x2F;Aisakaorz" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub ğŸ‘©â€ğŸ’»</a> </span><span class="links-of-author-item"><a href="mailto:aisakaaoi@qq.com" title="E-Mail ğŸ“§ â†’ mailto:aisakaaoi@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail ğŸ“§</a> </span><span class="links-of-author-item"><a href="mailto:chenzongnan@m.scnu.edu.cn" title="E-Mail ğŸ« â†’ mailto:chenzongnan@m.scnu.edu.cn" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail ğŸ«</a> </span><span class="links-of-author-item"><a href="https://space.bilibili.com/91560309" title="Bilibili ğŸ“º â†’ https:&#x2F;&#x2F;space.bilibili.com&#x2F;91560309" rel="noopener" target="_blank"><i class="fab fa-bilibili fa-fw"></i>Bilibili ğŸ“º</a> </span><span class="links-of-author-item"><a href="https://space.bilibili.com/198562921" title="Bilibili ğŸ® â†’ https:&#x2F;&#x2F;space.bilibili.com&#x2F;198562921" rel="noopener" target="_blank"><i class="fab fa-bilibili fa-fw"></i>Bilibili ğŸ®</a> </span><span class="links-of-author-item"><a href="https://www.youtube.com/channel/UCALvyn5Cl76GCotO9pczvjg" title="YouTube ğŸ“º â†’ https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCALvyn5Cl76GCotO9pczvjg" rel="noopener" target="_blank"><i class="fab fa-youtube fa-fw"></i>YouTube ğŸ“º</a></span></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2026</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Aisaka Aoi</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span class="post-meta-item-text">ç«™ç‚¹æ€»å­—æ•°ï¼š</span> <span title="ç«™ç‚¹æ€»å­—æ•°">4.1m</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span class="post-meta-item-text">ç«™ç‚¹é˜…è¯»æ—¶é•¿ &asymp;</span> <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">171:02</span></div><div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨</div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script>document.querySelectorAll(".pdfobject-container").forEach(e=>{var t=e.dataset.target,a="#"+Object.entries({navpanes:0,toolbar:0,statusbar:0,pagemode:"thumbs",view:"FitH"}).map(([e,t])=>e+"="+encodeURIComponent(t)).join("&"),r="/lib/pdf/web/viewer.html?file="+encodeURIComponent(t)+a;NexT.utils.supportsPDFs()?e.innerHTML=`<embed class="pdfobject" src="${t+a}" type="application/pdf" style="height: ${e.dataset.height};">`:e.innerHTML=`<iframe src="${r}" style="height: ${e.dataset.height};" frameborder="0"></iframe>`})</script><script>NexT.utils.loadComments(document.querySelector("#valine-comments"),()=>{NexT.utils.getScript("//unpkg.com/valine/dist/Valine.min.js",()=>{var i=["nick","mail","link"],e="nick,mail,link".split(",").filter(e=>i.includes(e));new Valine({el:"#valine-comments",verify:!0,notify:!0,appId:"UqjWdRYbIUEUQRXhBUUIh1QE-gzGzoHsz",appKey:"gj89JXC485PFbpdHLKVkz6dm",placeholder:"è¿™é‡Œå¯ä»¥å‘é€è¯„è®º~ï¼ˆä¸Šé¢å¯ä»¥è¾“å…¥æ˜µç§°ã€é‚®ç®±ï¼‰",avatar:"mm",meta:e,pageSize:"10",visitor:!0,lang:"zh-cn",path:location.pathname,recordIP:!1,serverURLs:""})},window.Valine)})</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/assets/haru02.model.json"},display:{position:"right",width:208,height:520},mobile:{show:!1},log:!1})</script></body></html>