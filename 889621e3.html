<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0"><meta name="baidu-site-verification" content="code-KCMz4b3cnd"><meta name="google-site-verification" content="MTp8U7dJ1uzrfz8Mu6rgqX1CIm3HjqPWd0xaRcv1tFg"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="mask-icon" href="/images/favicon.png" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"aisakaaoi.github.io",root:"/",scheme:"Pisces",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:"valine",storage:!0,lazyload:!1,nav:null,activeClass:"valine"},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="ğŸ“– å¼€ç¯‡è¯­è¿˜è®°å¾—ä½ ç¬¬ä¸€æ¬¡ç”¨æ•°æ®é€è§†è¡¨çš„æƒ…æ™¯å—ï¼Ÿ  â€œå“‡ï¼Œæ‹–æ‹½å‡ ä¸‹å°±èƒ½ç»Ÿè®¡å‡ºå„ç§ç»´åº¦çš„æ•°æ®ï¼Œå¤ªç¥å¥‡äº†ï¼â€ä»Šå¤©æˆ‘ä»¬è¦å­¦çš„pandasï¼Œå°±æ˜¯Pythonçš„â€œè¶…çº§æ•°æ®é€è§†è¡¨â€ã€‚å®ƒä¸ä»…èƒ½åšExcelçš„æ‰€æœ‰æ“ä½œï¼Œè¿˜èƒ½åšå¾—æ›´å¿«ã€æ›´æ™ºèƒ½ã€æ›´è‡ªåŠ¨åŒ–ï¼"><meta property="og:type" content="article"><meta property="og:title" content="Python-ç¬¬9ç¯‡ã€Špandaså…¥é—¨ï¼šæ•°æ®å¤„ç†çš„ç‘å£«å†›åˆ€ã€‹"><meta property="og:url" content="https://aisakaaoi.github.io/889621e3.html"><meta property="og:site_name" content="é€¢å‚è‘µçš„ä¸ªäººåšå®¢"><meta property="og:description" content="ğŸ“– å¼€ç¯‡è¯­è¿˜è®°å¾—ä½ ç¬¬ä¸€æ¬¡ç”¨æ•°æ®é€è§†è¡¨çš„æƒ…æ™¯å—ï¼Ÿ  â€œå“‡ï¼Œæ‹–æ‹½å‡ ä¸‹å°±èƒ½ç»Ÿè®¡å‡ºå„ç§ç»´åº¦çš„æ•°æ®ï¼Œå¤ªç¥å¥‡äº†ï¼â€ä»Šå¤©æˆ‘ä»¬è¦å­¦çš„pandasï¼Œå°±æ˜¯Pythonçš„â€œè¶…çº§æ•°æ®é€è§†è¡¨â€ã€‚å®ƒä¸ä»…èƒ½åšExcelçš„æ‰€æœ‰æ“ä½œï¼Œè¿˜èƒ½åšå¾—æ›´å¿«ã€æ›´æ™ºèƒ½ã€æ›´è‡ªåŠ¨åŒ–ï¼"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2026-01-29T19:03:20.000Z"><meta property="article:modified_time" content="2026-01-29T19:27:38.834Z"><meta property="article:author" content="Aisaka Aoi"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://aisakaaoi.github.io/889621e3.html"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>Python-ç¬¬9ç¯‡ã€Špandaså…¥é—¨ï¼šæ•°æ®å¤„ç†çš„ç‘å£«å†›åˆ€ã€‹ | é€¢å‚è‘µçš„ä¸ªäººåšå®¢</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?7308ed05421777c301eefa3754da1b42",document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="é€¢å‚è‘µçš„ä¸ªäººåšå®¢" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ "><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">aoiå­¦é™¢</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">Aisaka's Blog, School of Aoi, Aisaka University</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»<span class="badge">20</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£<span class="badge">1030</span></a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="æœç´¢..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="reading-progress-bar"></div><a href="https://github.com/AisakaAoi" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://aisakaaoi.github.io/889621e3.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/manatsu.jpg"><meta itemprop="name" content="Aisaka Aoi"><meta itemprop="description" content="Aisaka's Blog, School of Aoi, Aisaka University"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="é€¢å‚è‘µçš„ä¸ªäººåšå®¢"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Python-ç¬¬9ç¯‡ã€Špandaså…¥é—¨ï¼šæ•°æ®å¤„ç†çš„ç‘å£«å†›åˆ€ã€‹</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">å‘è¡¨äº</span> <time title="åˆ›å»ºæ—¶é—´ï¼š2026-01-30 03:03:20" itemprop="dateCreated datePublished" datetime="2026-01-30T03:03:20+08:00">2026-01-30</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">åˆ†ç±»äº</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%F0%9F%8C%99%E9%80%A2%E5%9D%82%E6%9D%82%E8%B0%88%E4%B8%8E%E6%90%AC%E8%BF%90/" itemprop="url" rel="index"><span itemprop="name">ğŸŒ™é€¢å‚æ‚è°ˆä¸æ¬è¿</span></a> </span>ï¼Œ <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%F0%9F%8C%99%E9%80%A2%E5%9D%82%E6%9D%82%E8%B0%88%E4%B8%8E%E6%90%AC%E8%BF%90/%E2%AD%90%E6%9E%9C%E6%9E%9C%E8%AF%BE%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">â­æœæœè¯¾ç¨‹</span></a> </span></span><span id="/889621e3.html" class="post-meta-item leancloud_visitors" data-flag-title="Python-ç¬¬9ç¯‡ã€Špandaså…¥é—¨ï¼šæ•°æ®å¤„ç†çš„ç‘å£«å†›åˆ€ã€‹" title="é˜…è¯»æ¬¡æ•°"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span> <span class="leancloud-visitors-count"></span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Valineï¼š</span> <a title="valine" href="/889621e3.html#valine-comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/889621e3.html" itemprop="commentCount"></span></a></span><br><span class="post-meta-item" title="æœ¬æ–‡å­—æ•°"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span> <span>33k</span> </span><span class="post-meta-item" title="é˜…è¯»æ—¶é•¿"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span> <span>1:22</span></span></div></header><div class="post-body" itemprop="articleBody"><h3 id="ğŸ“–-å¼€ç¯‡è¯­"><a href="#ğŸ“–-å¼€ç¯‡è¯­" class="headerlink" title="ğŸ“– å¼€ç¯‡è¯­"></a>ğŸ“– å¼€ç¯‡è¯­</h3><p>è¿˜è®°å¾—ä½ ç¬¬ä¸€æ¬¡ç”¨æ•°æ®é€è§†è¡¨çš„æƒ…æ™¯å—ï¼Ÿ</p><blockquote><p>â€œå“‡ï¼Œæ‹–æ‹½å‡ ä¸‹å°±èƒ½ç»Ÿè®¡å‡ºå„ç§ç»´åº¦çš„æ•°æ®ï¼Œå¤ªç¥å¥‡äº†ï¼â€<br>ä»Šå¤©æˆ‘ä»¬è¦å­¦çš„pandasï¼Œå°±æ˜¯Pythonçš„â€œè¶…çº§æ•°æ®é€è§†è¡¨â€ã€‚<br>å®ƒä¸ä»…èƒ½åšExcelçš„æ‰€æœ‰æ“ä½œï¼Œè¿˜èƒ½åšå¾—æ›´å¿«ã€æ›´æ™ºèƒ½ã€æ›´è‡ªåŠ¨åŒ–ï¼</p></blockquote><span id="more"></span><p><strong>æƒ³è±¡ä¸€ä¸‹ï¼š</strong></p><ul><li>å‡ ç§’é’Ÿå°±èƒ½å¤„ç†å‡ åä¸‡è¡Œæ•°æ®</li><li>ä¸€è¡Œä»£ç å®Œæˆå¤æ‚çš„åˆ†ç»„ç»Ÿè®¡</li><li>è‡ªåŠ¨è¯†åˆ«æ•°æ®ç±»å‹ï¼Œæ™ºèƒ½å¤„ç†ç¼ºå¤±å€¼</li><li>è½»æ¾å®ç°Excelåšä¸åˆ°çš„é«˜çº§åˆ†æ</li></ul><p>è¿™å°±æ˜¯pandasâ€”â€”æ•°æ®å¤„ç†çš„ç»ˆææ•ˆç‡ç¥å™¨ï¼</p><hr><h3 id="ğŸ¯-ä»Šæ—¥å­¦ä¹ ç›®æ ‡"><a href="#ğŸ¯-ä»Šæ—¥å­¦ä¹ ç›®æ ‡" class="headerlink" title="ğŸ¯ ä»Šæ—¥å­¦ä¹ ç›®æ ‡"></a>ğŸ¯ ä»Šæ—¥å­¦ä¹ ç›®æ ‡</h3><ul><li>ç†è§£DataFrameæ¦‚å¿µï¼ˆExcelè¡¨æ ¼çš„å‡çº§ç‰ˆï¼‰</li><li>æŒæ¡åŸºæœ¬çš„æ•°æ®ç­›é€‰å’Œç»Ÿè®¡ï¼ˆæ¯”æ•°æ®é€è§†è¡¨æ›´å¿«ï¼‰</li><li>å®æˆ˜é”€å”®æ•°æ®åˆ†æï¼ˆè‡ªåŠ¨ç”Ÿæˆåˆ†ææŠ¥å‘Šï¼‰</li></ul><hr><h3 id="ğŸ¼-ä»€ä¹ˆæ˜¯pandasï¼Ÿ"><a href="#ğŸ¼-ä»€ä¹ˆæ˜¯pandasï¼Ÿ" class="headerlink" title="ğŸ¼ ä»€ä¹ˆæ˜¯pandasï¼Ÿ"></a>ğŸ¼ ä»€ä¹ˆæ˜¯pandasï¼Ÿ</h3><p><strong>pandas &#x3D; Python Data Analysis Library</strong></p><p>pandasæ˜¯Pythonæœ€ä¸“ä¸šçš„æ•°æ®å¤„ç†åº“ï¼Œå°±åƒï¼š</p><ul><li>Excelçš„â€œè¶…çº§åŠ å¼ºç‰ˆâ€</li><li>æ•°æ®é€è§†è¡¨çš„â€œç»ˆæå½¢æ€â€</li><li>æ•°æ®å¤„ç†çš„â€œç‘å£«å†›åˆ€â€</li></ul><p><strong>ä¸ºä»€ä¹ˆè´¢åŠ¡äººå‘˜è¦å­¦pandasï¼Ÿ</strong></p><table><thead><tr><th>Excelæ“ä½œ</th><th>pandasä»£ç </th><th>æ•ˆç‡æå‡</th></tr></thead><tbody><tr><td>æ‰‹åŠ¨ç­›é€‰10000è¡Œæ•°æ®</td><td><code>df[df[&#39;é‡‘é¢&#39;]&gt;1000]</code></td><td>10å€</td></tr><tr><td>æ•°æ®é€è§†è¡¨ç»Ÿè®¡</td><td><code>df.groupby(&#39;éƒ¨é—¨&#39;)[&#39;é‡‘é¢&#39;].sum()</code></td><td>5å€</td></tr><tr><td>VLOOKUPæŸ¥æ‰¾</td><td><code>df.merge(å¦ä¸€ä¸ªè¡¨, on=&#39;å®¢æˆ·ID&#39;)</code></td><td>8å€</td></tr><tr><td>æ‰‹åŠ¨åˆ¶ä½œå›¾è¡¨</td><td><code>df.plot(kind=&#39;bar&#39;)</code></td><td>6å€</td></tr></tbody></table><hr><h3 id="ğŸ“Š-DataFrameï¼šExcelè¡¨æ ¼çš„å‡çº§ç‰ˆ"><a href="#ğŸ“Š-DataFrameï¼šExcelè¡¨æ ¼çš„å‡çº§ç‰ˆ" class="headerlink" title="ğŸ“Š DataFrameï¼šExcelè¡¨æ ¼çš„å‡çº§ç‰ˆ"></a>ğŸ“Š DataFrameï¼šExcelè¡¨æ ¼çš„å‡çº§ç‰ˆ</h3><p><strong>ä»€ä¹ˆæ˜¯DataFrameï¼Ÿ</strong></p><h2 id="æƒ³è±¡Excelå·¥ä½œè¡¨ï¼š-æœ‰è¡Œå·ï¼ˆ1-2-3â€¦ï¼‰-æœ‰åˆ—åï¼ˆA-B-Câ€¦æˆ–è‡ªå®šä¹‰ï¼‰-æ¯ä¸ªæ ¼å­æœ‰æ•°æ®"><a href="#æƒ³è±¡Excelå·¥ä½œè¡¨ï¼š-æœ‰è¡Œå·ï¼ˆ1-2-3â€¦ï¼‰-æœ‰åˆ—åï¼ˆA-B-Câ€¦æˆ–è‡ªå®šä¹‰ï¼‰-æ¯ä¸ªæ ¼å­æœ‰æ•°æ®" class="headerlink" title="æƒ³è±¡Excelå·¥ä½œè¡¨ï¼š- æœ‰è¡Œå·ï¼ˆ1,2,3â€¦ï¼‰- æœ‰åˆ—åï¼ˆA,B,Câ€¦æˆ–è‡ªå®šä¹‰ï¼‰- æ¯ä¸ªæ ¼å­æœ‰æ•°æ®"></a>æƒ³è±¡Excelå·¥ä½œè¡¨ï¼š<br>- æœ‰è¡Œå·ï¼ˆ1,2,3â€¦ï¼‰<br>- æœ‰åˆ—åï¼ˆA,B,Câ€¦æˆ–è‡ªå®šä¹‰ï¼‰<br>- æ¯ä¸ªæ ¼å­æœ‰æ•°æ®</h2><p>DataFrameå°±æ˜¯ä¸€æ ·çš„æ¦‚å¿µï¼Œä½†æ›´å¼ºå¤§ï¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºè´¢åŠ¡DataFrameï¼ˆå°±åƒåˆ›å»ºExcelè¡¨æ ¼ï¼‰</span></span><br><span class="line">é”€å”®æ•°æ® = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;æ—¥æœŸ&#x27;</span>: [<span class="string">&#x27;2024-01-01&#x27;</span>, <span class="string">&#x27;2024-01-02&#x27;</span>, <span class="string">&#x27;2024-01-03&#x27;</span>, <span class="string">&#x27;2024-01-04&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;é”€å”®å‘˜&#x27;</span>: [<span class="string">&#x27;å¼ ä¸‰&#x27;</span>, <span class="string">&#x27;æå››&#x27;</span>, <span class="string">&#x27;ç‹äº”&#x27;</span>, <span class="string">&#x27;å¼ ä¸‰&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;å®¢æˆ·&#x27;</span>: [<span class="string">&#x27;å®¢æˆ·A&#x27;</span>, <span class="string">&#x27;å®¢æˆ·B&#x27;</span>, <span class="string">&#x27;å®¢æˆ·C&#x27;</span>, <span class="string">&#x27;å®¢æˆ·A&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;äº§å“&#x27;</span>: [<span class="string">&#x27;äº§å“1&#x27;</span>, <span class="string">&#x27;äº§å“2&#x27;</span>, <span class="string">&#x27;äº§å“1&#x27;</span>, <span class="string">&#x27;äº§å“3&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;æ•°é‡&#x27;</span>: [<span class="number">100</span>, <span class="number">150</span>, <span class="number">200</span>, <span class="number">80</span>],</span><br><span class="line">    <span class="string">&#x27;å•ä»·&#x27;</span>: [<span class="number">50</span>, <span class="number">80</span>, <span class="number">50</span>, <span class="number">120</span>],</span><br><span class="line">    <span class="string">&#x27;é‡‘é¢&#x27;</span>: [<span class="number">5000</span>, <span class="number">12000</span>, <span class="number">10000</span>, <span class="number">9600</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;é”€å”®æ•°æ®è¡¨ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(é”€å”®æ•°æ®)</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">         æ—¥æœŸ é”€å”®å‘˜   å®¢æˆ·   äº§å“  æ•°é‡   å•ä»·   é‡‘é¢</span><br><span class="line">0  2024-01-01  å¼ ä¸‰  å®¢æˆ·A  äº§å“1  100   50  5000</span><br><span class="line">1  2024-01-02  æå››  å®¢æˆ·B  äº§å“2  150   80 12000</span><br><span class="line">2  2024-01-03  ç‹äº”  å®¢æˆ·C  äº§å“1  200   50 10000</span><br><span class="line">3  2024-01-04  å¼ ä¸‰  å®¢æˆ·A  äº§å“3   80  120  9600</span><br></pre></td></tr></table></figure><p><strong>DataFrame vs Excelè¡¨æ ¼</strong></p><table><thead><tr><th>Excel</th><th>DataFrame</th><th>ä¼˜åŠ¿</th></tr></thead><tbody><tr><td>A1, B1, C1</td><td>df[â€˜æ—¥æœŸâ€™], df[â€˜é”€å”®å‘˜â€™]</td><td>åˆ—åæ›´ç›´è§‚</td></tr><tr><td>ç­›é€‰ï¼šæ‰‹åŠ¨ç‚¹å‡»</td><td>df[df[â€˜é‡‘é¢â€™]&gt;10000]</td><td>ä»£ç è‡ªåŠ¨åŒ–</td></tr><tr><td>ç»Ÿè®¡ï¼šæ•°æ®é€è§†è¡¨</td><td>df.groupby(â€˜é”€å”®å‘˜â€™)[â€˜é‡‘é¢â€™].sum()</td><td>ä¸€è¡Œä»£ç </td></tr><tr><td>æŸ¥æ‰¾ï¼šVLOOKUP</td><td>df.merge(å¦ä¸€ä¸ªè¡¨)</td><td>æ›´çµæ´»å¼ºå¤§</td></tr></tbody></table><p><strong>è¯»å–Excel&#x2F;CVSæ–‡ä»¶ï¼ˆæ•°æ®å…¥å£ï¼‰</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä»Excelè¯»å–è´¢åŠ¡æ•°æ®ï¼ˆå°±åƒæ‰“å¼€Excelæ–‡ä»¶ï¼‰</span></span><br><span class="line">è´¢åŠ¡æ•°æ® = pd.read_excel(<span class="string">&#x27;æœˆåº¦è´¢åŠ¡æŠ¥è¡¨.xlsx&#x27;</span>)</span><br><span class="line"><span class="comment"># æˆ–</span></span><br><span class="line">è´¢åŠ¡æ•°æ® = pd.read_csv(<span class="string">&#x27;é“¶è¡Œæµæ°´.csv&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æ•°æ®å½¢çŠ¶ï¼š&quot;</span>, è´¢åŠ¡æ•°æ®.shape)  <span class="comment"># (è¡Œæ•°, åˆ—æ•°)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;åˆ—åï¼š&quot;</span>, è´¢åŠ¡æ•°æ®.columns.tolist())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;å‰5è¡Œï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(è´¢åŠ¡æ•°æ®.head())  <span class="comment"># å°±åƒExcelçš„å‰å‡ è¡Œ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æ•°æ®ç±»å‹ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(è´¢åŠ¡æ•°æ®.dtypes)  <span class="comment"># è‡ªåŠ¨è¯†åˆ«æ¯åˆ—çš„æ•°æ®ç±»å‹</span></span><br></pre></td></tr></table></figure><p><strong>åŸºæœ¬å±æ€§ï¼ˆäº†è§£ä½ çš„æ•°æ®ï¼‰</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç»§ç»­ä½¿ç”¨ä¸Šé¢çš„é”€å”®æ•°æ®</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æ•°æ®åŸºæœ¬ä¿¡æ¯ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;å½¢çŠ¶ï¼š<span class="subst">&#123;é”€å”®æ•°æ®.shape&#125;</span>&quot;</span>)  <span class="comment"># (4è¡Œ, 7åˆ—)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;åˆ—åï¼š<span class="subst">&#123;é”€å”®æ•°æ®.columns.tolist()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;ç´¢å¼•ï¼š<span class="subst">&#123;é”€å”®æ•°æ®.index.tolist()&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\næ¯åˆ—çš„æ•°æ®ç±»å‹ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(é”€å”®æ•°æ®.dtypes)</span><br><span class="line"><span class="comment"># æ—¥æœŸ    object</span></span><br><span class="line"><span class="comment"># é”€å”®å‘˜   object  </span></span><br><span class="line"><span class="comment"># å®¢æˆ·    object</span></span><br><span class="line"><span class="comment"># äº§å“    object</span></span><br><span class="line"><span class="comment"># æ•°é‡     int64</span></span><br><span class="line"><span class="comment"># å•ä»·     int64</span></span><br><span class="line"><span class="comment"># é‡‘é¢     int64</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\næ•°æ®ç»Ÿè®¡æ‘˜è¦ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(é”€å”®æ•°æ®.describe())  <span class="comment"># å°±åƒExcelçš„æè¿°æ€§ç»Ÿè®¡</span></span><br></pre></td></tr></table></figure><hr><h3 id="ğŸ”-æ•°æ®ç­›é€‰ï¼šæ¯”Excelç­›é€‰æ›´æ™ºèƒ½"><a href="#ğŸ”-æ•°æ®ç­›é€‰ï¼šæ¯”Excelç­›é€‰æ›´æ™ºèƒ½" class="headerlink" title="ğŸ” æ•°æ®ç­›é€‰ï¼šæ¯”Excelç­›é€‰æ›´æ™ºèƒ½"></a>ğŸ” æ•°æ®ç­›é€‰ï¼šæ¯”Excelç­›é€‰æ›´æ™ºèƒ½</h3><p><strong>åŸºç¡€ç­›é€‰ï¼ˆç±»ä¼¼Excelçš„è‡ªåŠ¨ç­›é€‰ï¼‰</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç­›é€‰å‡ºå¼ ä¸‰çš„é”€å”®è®°å½•</span></span><br><span class="line">å¼ ä¸‰çš„é”€å”® = é”€å”®æ•°æ®[é”€å”®æ•°æ®[<span class="string">&#x27;é”€å”®å‘˜&#x27;</span>] == <span class="string">&#x27;å¼ ä¸‰&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;å¼ ä¸‰çš„é”€å”®è®°å½•ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(å¼ ä¸‰çš„é”€å”®)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç­›é€‰å‡ºé‡‘é¢å¤§äº10000çš„è®°å½•</span></span><br><span class="line">å¤§é¢é”€å”® = é”€å”®æ•°æ®[é”€å”®æ•°æ®[<span class="string">&#x27;é‡‘é¢&#x27;</span>] &gt; <span class="number">10000</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nå¤§é¢é”€å”®ï¼ˆ&gt;10000å…ƒï¼‰ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(å¤§é¢é”€å”®)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤šæ¡ä»¶ç­›é€‰ï¼ˆExceléœ€è¦é«˜çº§ç­›é€‰ï¼Œpandasåªéœ€è¦&amp;ç¬¦å·ï¼‰</span></span><br><span class="line">å¼ ä¸‰çš„å¤§é¢é”€å”® = é”€å”®æ•°æ®[(é”€å”®æ•°æ®[<span class="string">&#x27;é”€å”®å‘˜&#x27;</span>] == <span class="string">&#x27;å¼ ä¸‰&#x27;</span>) &amp; (é”€å”®æ•°æ®[<span class="string">&#x27;é‡‘é¢&#x27;</span>] &gt; <span class="number">5000</span>)]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nå¼ ä¸‰çš„å¤§é¢é”€å”®ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(å¼ ä¸‰çš„å¤§é¢é”€å”®)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç­›é€‰ç‰¹å®šæ—¥æœŸçš„é”€å”®</span></span><br><span class="line">ä¸€æœˆä¸Šæ—¬é”€å”® = é”€å”®æ•°æ®[é”€å”®æ•°æ®[<span class="string">&#x27;æ—¥æœŸ&#x27;</span>].isin([<span class="string">&#x27;2024-01-01&#x27;</span>, <span class="string">&#x27;2024-01-02&#x27;</span>])]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nä¸€æœˆä¸Šæ—¬é”€å”®ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(ä¸€æœˆä¸Šæ—¬é”€å”®)</span><br></pre></td></tr></table></figure><p><strong>é«˜çº§ç­›é€‰ï¼ˆExcelåšä¸åˆ°çš„ç­›é€‰ï¼‰</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å­—ç¬¦ä¸²ç­›é€‰</span></span><br><span class="line">äº§å“<span class="number">1</span>é”€å”® = é”€å”®æ•°æ®[é”€å”®æ•°æ®[<span class="string">&#x27;äº§å“&#x27;</span>].<span class="built_in">str</span>.contains(<span class="string">&#x27;äº§å“1&#x27;</span>)]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;äº§å“1çš„é”€å”®è®°å½•ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(äº§å“<span class="number">1</span>é”€å”®)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤šå€¼ç­›é€‰</span></span><br><span class="line">é‡ç‚¹å®¢æˆ· = [<span class="string">&#x27;å®¢æˆ·A&#x27;</span>, <span class="string">&#x27;å®¢æˆ·C&#x27;</span>]</span><br><span class="line">é‡ç‚¹å®¢æˆ·é”€å”® = é”€å”®æ•°æ®[é”€å”®æ•°æ®[<span class="string">&#x27;å®¢æˆ·&#x27;</span>].isin(é‡ç‚¹å®¢æˆ·)]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\né‡ç‚¹å®¢æˆ·çš„é”€å”®ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(é‡ç‚¹å®¢æˆ·é”€å”®)</span><br><span class="line"></span><br><span class="line"><span class="comment"># èŒƒå›´ç­›é€‰</span></span><br><span class="line">ä¸­ç­‰é‡‘é¢é”€å”® = é”€å”®æ•°æ®[(é”€å”®_data[<span class="string">&#x27;é‡‘é¢&#x27;</span>] &gt;= <span class="number">8000</span>) &amp; (é”€å”®_data[<span class="string">&#x27;é‡‘é¢&#x27;</span>] &lt;= <span class="number">12000</span>)]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nä¸­ç­‰é‡‘é¢é”€å”®ï¼ˆ8000-12000å…ƒï¼‰ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(ä¸­ç­‰é‡‘é¢é”€å”®)</span><br></pre></td></tr></table></figure><hr><h3 id="ğŸ“ˆ-æ•°æ®ç»Ÿè®¡ï¼šæ¯”æ•°æ®é€è§†è¡¨æ›´å¿«"><a href="#ğŸ“ˆ-æ•°æ®ç»Ÿè®¡ï¼šæ¯”æ•°æ®é€è§†è¡¨æ›´å¿«" class="headerlink" title="ğŸ“ˆ æ•°æ®ç»Ÿè®¡ï¼šæ¯”æ•°æ®é€è§†è¡¨æ›´å¿«"></a>ğŸ“ˆ æ•°æ®ç»Ÿè®¡ï¼šæ¯”æ•°æ®é€è§†è¡¨æ›´å¿«</h3><p><strong>åŸºç¡€ç»Ÿè®¡ï¼ˆä¸€è¡Œä»£ç æå®šï¼‰</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¡ç®—æ€»é”€å”®é¢</span></span><br><span class="line">æ€»é”€å”®é¢ = é”€å”®æ•°æ®[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">sum</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æ€»é”€å”®é¢ï¼š<span class="subst">&#123;æ€»é”€å”®é¢:,&#125;</span>å…ƒ&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¹³å‡é”€å”®é¢</span></span><br><span class="line">å¹³å‡é”€å”®é¢ = é”€å”®æ•°æ®[<span class="string">&#x27;é‡‘é¢&#x27;</span>].mean()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;å¹³å‡é”€å”®é¢ï¼š<span class="subst">&#123;å¹³å‡é”€å”®é¢:,<span class="number">.2</span>f&#125;</span>å…ƒ&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœ€å¤§/æœ€å°é”€å”®é¢</span></span><br><span class="line">æœ€å¤§é”€å”®é¢ = é”€å”®æ•°æ®[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">max</span>()</span><br><span class="line">æœ€å°é”€å”®é¢ = é”€å”®_data[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">min</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æœ€å¤§é”€å”®é¢ï¼š<span class="subst">&#123;æœ€å¤§é”€å”®é¢:,&#125;</span>å…ƒ&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æœ€å°é”€å”®é¢ï¼š<span class="subst">&#123;æœ€å°é”€å”®é¢:,&#125;</span>å…ƒ&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é”€å”®æ•°é‡ç»Ÿè®¡</span></span><br><span class="line">æ€»é”€å”®æ•°é‡ = é”€å”®æ•°æ®[<span class="string">&#x27;æ•°é‡&#x27;</span>].<span class="built_in">sum</span>()</span><br><span class="line">å¹³å‡å•ä»· = é”€å”®æ•°æ®[<span class="string">&#x27;å•ä»·&#x27;</span>].mean()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æ€»é”€å”®æ•°é‡ï¼š<span class="subst">&#123;æ€»é”€å”®æ•°é‡:,&#125;</span>ä»¶&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;å¹³å‡å•ä»·ï¼š<span class="subst">&#123;å¹³å‡å•ä»·:,<span class="number">.2</span>f&#125;</span>å…ƒ&quot;</span>)</span><br></pre></td></tr></table></figure><p><strong>åˆ†ç»„ç»Ÿè®¡ï¼ˆè¶…çº§æ•°æ®é€è§†è¡¨ï¼‰</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŒ‰é”€å”®å‘˜ç»Ÿè®¡é”€å”®é¢ï¼ˆç±»ä¼¼æ•°æ®é€è§†è¡¨ï¼‰</span></span><br><span class="line">é”€å”®å‘˜ç»Ÿè®¡ = é”€å”®_data.groupby(<span class="string">&#x27;é”€å”®å‘˜&#x27;</span>)[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">sum</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;å„é”€å”®å‘˜é”€å”®é¢ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(é”€å”®å‘˜ç»Ÿè®¡)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‰å®¢æˆ·ç»Ÿè®¡ï¼ˆå¤šåˆ—ç»Ÿè®¡ï¼‰</span></span><br><span class="line">å®¢æˆ·ç»Ÿè®¡ = é”€å”®æ•°æ®.groupby(<span class="string">&#x27;å®¢æˆ·&#x27;</span>).agg(&#123;</span><br><span class="line">    <span class="string">&#x27;é‡‘é¢&#x27;</span>: <span class="string">&#x27;sum&#x27;</span>,      <span class="comment"># æ€»é‡‘é¢</span></span><br><span class="line">    <span class="string">&#x27;æ•°é‡&#x27;</span>: <span class="string">&#x27;sum&#x27;</span>,      <span class="comment"># æ€»æ•°é‡</span></span><br><span class="line">    <span class="string">&#x27;å•ä»·&#x27;</span>: <span class="string">&#x27;mean&#x27;</span>      <span class="comment"># å¹³å‡å•ä»·</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nå„å®¢æˆ·è´­ä¹°ç»Ÿè®¡ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(å®¢æˆ·ç»Ÿè®¡)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤šå±‚åˆ†ç»„ï¼ˆé”€å”®å‘˜+å®¢æˆ·ï¼‰</span></span><br><span class="line">å¤šå±‚ç»Ÿè®¡ = é”€å”®æ•°æ®.groupby([<span class="string">&#x27;é”€å”®å‘˜&#x27;</span>, <span class="string">&#x27;å®¢æˆ·&#x27;</span>])[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">sum</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\né”€å”®å‘˜-å®¢æˆ·é”€å”®é¢ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(å¤šå±‚ç»Ÿè®¡)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡ç½®ç´¢å¼•ï¼Œè®©ç»“æœæ›´ç¾è§‚</span></span><br><span class="line">å¤šå±‚ç»Ÿè®¡_df = é”€å”®æ•°æ®.groupby([<span class="string">&#x27;é”€å”®å‘˜&#x27;</span>, <span class="string">&#x27;å®¢æˆ·&#x27;</span>]).agg(&#123;</span><br><span class="line">    <span class="string">&#x27;é‡‘é¢&#x27;</span>: <span class="string">&#x27;sum&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;æ•°é‡&#x27;</span>: <span class="string">&#x27;sum&#x27;</span></span><br><span class="line">&#125;).reset_index()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\né”€å”®å‘˜-å®¢æˆ·ç»Ÿè®¡è¡¨ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(å¤šå±‚ç»Ÿè®¡_df)</span><br></pre></td></tr></table></figure><hr><h3 id="ğŸ§®-è´¢åŠ¡å®æˆ˜ï¼šé”€å”®æ•°æ®åˆ†æ"><a href="#ğŸ§®-è´¢åŠ¡å®æˆ˜ï¼šé”€å”®æ•°æ®åˆ†æ" class="headerlink" title="ğŸ§® è´¢åŠ¡å®æˆ˜ï¼šé”€å”®æ•°æ®åˆ†æ"></a>ğŸ§® è´¢åŠ¡å®æˆ˜ï¼šé”€å”®æ•°æ®åˆ†æ</h3><details><summary>ç‰ˆæœ¬1.0ï¼šåŸºç¡€é”€å”®åˆ†æ</summary><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é”€å”®æ•°æ®åˆ†æ - åŸºç¡€ç‰ˆ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=== é”€å”®æ•°æ®åˆ†æç³»ç»Ÿ ===&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºæ›´çœŸå®çš„é”€å”®æ•°æ®</span></span><br><span class="line">np.random.seed(<span class="number">42</span>)  <span class="comment"># ä¿è¯ç»“æœå¯é‡å¤</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆæœˆåº¦é”€å”®æ•°æ®</span></span><br><span class="line">æ—¥æœŸèŒƒå›´ = pd.date_range(<span class="string">&#x27;2024-01-01&#x27;</span>, <span class="string">&#x27;2024-01-31&#x27;</span>, freq=<span class="string">&#x27;D&#x27;</span>)</span><br><span class="line">é”€å”®å‘˜åˆ—è¡¨ = [<span class="string">&#x27;å¼ ä¸‰&#x27;</span>, <span class="string">&#x27;æå››&#x27;</span>, <span class="string">&#x27;ç‹äº”&#x27;</span>, <span class="string">&#x27;èµµå…­&#x27;</span>, <span class="string">&#x27;é’±ä¸ƒ&#x27;</span>]</span><br><span class="line">å®¢æˆ·åˆ—è¡¨ = [<span class="string">&#x27;å®¢æˆ·A&#x27;</span>, <span class="string">&#x27;å®¢æˆ·B&#x27;</span>, <span class="string">&#x27;å®¢æˆ·C&#x27;</span>, <span class="string">&#x27;å®¢æˆ·D&#x27;</span>, <span class="string">&#x27;å®¢æˆ·E&#x27;</span>]</span><br><span class="line">äº§å“åˆ—è¡¨ = [<span class="string">&#x27;äº§å“1&#x27;</span>, <span class="string">&#x27;äº§å“2&#x27;</span>, <span class="string">&#x27;äº§å“3&#x27;</span>, <span class="string">&#x27;äº§å“4&#x27;</span>]</span><br><span class="line"></span><br><span class="line">é”€å”®æ•°æ® = []</span><br><span class="line"><span class="keyword">for</span> æ—¥æœŸ <span class="keyword">in</span> æ—¥æœŸèŒƒå›´:</span><br><span class="line">    <span class="comment"># æ¯å¤©éšæœº2-5ç¬”é”€å”®</span></span><br><span class="line">    æ—¥é”€å”®ç¬”æ•° = np.random.randint(<span class="number">2</span>, <span class="number">6</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(æ—¥é”€å”®ç¬”æ•°):</span><br><span class="line">        é”€å”®å‘˜ = np.random.choice(é”€å”®å‘˜_<span class="built_in">list</span>)</span><br><span class="line">        å®¢æˆ· = np.random.choice(å®¢æˆ·_<span class="built_in">list</span>)</span><br><span class="line">        äº§å“ = np.random.choice(äº§å“åˆ—è¡¨)</span><br><span class="line">        æ•°é‡ = np.random.randint(<span class="number">10</span>, <span class="number">201</span>)</span><br><span class="line">        å•ä»· = np.random.randint(<span class="number">50</span>, <span class="number">201</span>)</span><br><span class="line">        </span><br><span class="line">        é”€å”®æ•°æ®.append(&#123;</span><br><span class="line">            <span class="string">&#x27;æ—¥æœŸ&#x27;</span>: æ—¥æœŸ,</span><br><span class="line">            <span class="string">&#x27;é”€å”®å‘˜&#x27;</span>: é”€å”®å‘˜,</span><br><span class="line">            <span class="string">&#x27;å®¢æˆ·&#x27;</span>: å®¢æˆ·,</span><br><span class="line">            <span class="string">&#x27;äº§å“&#x27;</span>: äº§å“,</span><br><span class="line">            <span class="string">&#x27;æ•°é‡&#x27;</span>: æ•°é‡,</span><br><span class="line">            <span class="string">&#x27;å•ä»·&#x27;</span>: å•ä»·,</span><br><span class="line">            <span class="string">&#x27;é‡‘é¢&#x27;</span>: æ•°é‡ * å•ä»·</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºDataFrame</span></span><br><span class="line">df = pd.DataFrame(é”€å”®æ•°æ®)</span><br><span class="line">df[<span class="string">&#x27;æ—¥æœŸ&#x27;</span>] = pd.to_datetime(df[<span class="string">&#x27;æ—¥æœŸ&#x27;</span>])  <span class="comment"># ç¡®ä¿æ—¥æœŸæ ¼å¼æ­£ç¡®</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ğŸ“Š é”€å”®æ•°æ®æ¦‚è§ˆï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æ•°æ®å½¢çŠ¶ï¼š<span class="subst">&#123;df.shape&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æ—¥æœŸèŒƒå›´ï¼š<span class="subst">&#123;df[<span class="string">&#x27;æ—¥æœŸ&#x27;</span>].<span class="built_in">min</span>()&#125;</span> åˆ° <span class="subst">&#123;df[<span class="string">&#x27;æ—¥æœŸ&#x27;</span>].<span class="built_in">max</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æ€»é”€å”®é¢ï¼š<span class="subst">&#123;df[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">sum</span>():,<span class="number">.2</span>f&#125;</span>å…ƒ&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŸºç¡€åˆ†æ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n=== åŸºç¡€é”€å”®åˆ†æ ===&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. æ—¥é”€å”®é¢ç»Ÿè®¡</span></span><br><span class="line">æ—¥é”€å”®é¢ = df.groupby(<span class="string">&#x27;æ—¥æœŸ&#x27;</span>)[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">sum</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;\nğŸ“… æ—¥é”€å”®é¢ç»Ÿè®¡ï¼ˆå‰5å¤©ï¼‰ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(æ—¥é”€å”®é¢.head())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. é”€å”®å‘˜ä¸šç»©æ’å</span></span><br><span class="line">é”€å”®å‘˜ä¸šç»© = df.groupby(<span class="string">&#x27;é”€å”®å‘˜&#x27;</span>).agg(&#123;</span><br><span class="line">    <span class="string">&#x27;é‡‘é¢&#x27;</span>: <span class="string">&#x27;sum&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;æ•°é‡&#x27;</span>: <span class="string">&#x27;sum&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;æ—¥æœŸ&#x27;</span>: <span class="string">&#x27;count&#x27;</span>  <span class="comment"># é”€å”®ç¬”æ•°</span></span><br><span class="line">&#125;).<span class="built_in">round</span>(<span class="number">2</span>)</span><br><span class="line">é”€å”®å‘˜ä¸šç»©.columns = [<span class="string">&#x27;æ€»é”€å”®é¢&#x27;</span>, <span class="string">&#x27;æ€»æ•°é‡&#x27;</span>, <span class="string">&#x27;é”€å”®ç¬”æ•°&#x27;</span>]</span><br><span class="line">é”€å”®å‘˜ä¸šç»© = é”€å”®å‘˜ä¸šç»©.sort_values(<span class="string">&#x27;æ€»é”€å”®é¢&#x27;</span>, ascending=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;\nğŸ† é”€å”®å‘˜ä¸šç»©æ’åï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(é”€å”®å‘˜ä¸šç»©)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. å®¢æˆ·è´­ä¹°åˆ†æ</span></span><br><span class="line">å®¢æˆ·åˆ†æ = df.groupby(<span class="string">&#x27;å®¢æˆ·&#x27;</span>).agg(&#123;</span><br><span class="line">    <span class="string">&#x27;é‡‘é¢&#x27;</span>: [<span class="string">&#x27;sum&#x27;</span>, <span class="string">&#x27;mean&#x27;</span>, <span class="string">&#x27;count&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;æ•°é‡&#x27;</span>: <span class="string">&#x27;sum&#x27;</span></span><br><span class="line">&#125;).<span class="built_in">round</span>(<span class="number">2</span>)</span><br><span class="line">å®¢æˆ·åˆ†æ.columns = [<span class="string">&#x27;æ€»è´­ä¹°é¢&#x27;</span>, <span class="string">&#x27;å¹³å‡è´­ä¹°é¢&#x27;</span>, <span class="string">&#x27;è´­ä¹°æ¬¡æ•°&#x27;</span>, <span class="string">&#x27;æ€»æ•°é‡&#x27;</span>]</span><br><span class="line">å®¢æˆ·åˆ†æ = å®¢æˆ·åˆ†æ.sort_values(<span class="string">&#x27;æ€»è´­ä¹°é¢&#x27;</span>, ascending=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;\nğŸ’° å®¢æˆ·è´­ä¹°åˆ†æï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(å®¢æˆ·åˆ†æ)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. äº§å“é”€å”®åˆ†æ</span></span><br><span class="line">äº§å“åˆ†æ = df.groupby(<span class="string">&#x27;äº§å“&#x27;</span>).agg(&#123;</span><br><span class="line">    <span class="string">&#x27;é‡‘é¢&#x27;</span>: <span class="string">&#x27;sum&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;æ•°é‡&#x27;</span>: <span class="string">&#x27;sum&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;å•ä»·&#x27;</span>: <span class="string">&#x27;mean&#x27;</span></span><br><span class="line">&#125;).<span class="built_in">round</span>(<span class="number">2</span>)</span><br><span class="line">äº§å“åˆ†æ = äº§å“åˆ†æ.sort_values(<span class="string">&#x27;é‡‘é¢&#x27;</span>, ascending=<span class="literal">False</span>)</span><br><span class="line">äº§å“åˆ†æ.columns = [<span class="string">&#x27;é”€å”®é¢&#x27;</span>, <span class="string">&#x27;é”€å”®æ•°é‡&#x27;</span>, <span class="string">&#x27;å¹³å‡å•ä»·&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;\nğŸ“¦ äº§å“é”€å”®åˆ†æï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(äº§å“åˆ†æ)</span><br></pre></td></tr></table></figure></details><details><summary>ç‰ˆæœ¬2.0ï¼šé«˜çº§åˆ†æåŠŸèƒ½</summary><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é”€å”®æ•°æ®åˆ†æ - é«˜çº§ç‰ˆ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n=== é«˜çº§é”€å”®åˆ†æ ===&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. æ—¶é—´åºåˆ—åˆ†æ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nğŸ“ˆ æ—¶é—´åºåˆ—åˆ†æï¼š&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‰å‘¨ç»Ÿè®¡</span></span><br><span class="line">df[<span class="string">&#x27;å‘¨&#x27;</span>] = df[<span class="string">&#x27;æ—¥æœŸ&#x27;</span>].dt.isocalendar().week</span><br><span class="line">å‘¨é”€å”®é¢ = df.groupby(<span class="string">&#x27;å‘¨&#x27;</span>)[<span class="string">&#x27;é‡‘é¢&#x27;</span>].agg([<span class="string">&#x27;sum&#x27;</span>, <span class="string">&#x27;mean&#x27;</span>, <span class="string">&#x27;count&#x27;</span>])</span><br><span class="line">å‘¨é”€å”®é¢.columns = [<span class="string">&#x27;å‘¨é”€å”®æ€»é¢&#x27;</span>, <span class="string">&#x27;æ—¥å‡é”€å”®é¢&#x27;</span>, <span class="string">&#x27;é”€å”®å¤©æ•°&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æŒ‰å‘¨é”€å”®ç»Ÿè®¡ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(å‘¨é”€å”®é¢)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å·¥ä½œæ—¥vså‘¨æœ«åˆ†æ</span></span><br><span class="line">df[<span class="string">&#x27;æ˜¯å¦å‘¨æœ«&#x27;</span>] = df[<span class="string">&#x27;æ—¥æœŸ&#x27;</span>].dt.dayofweek &gt;= <span class="number">5</span></span><br><span class="line">å‘¨æœ«åˆ†æ = df.groupby(<span class="string">&#x27;æ˜¯å¦å‘¨æœ«&#x27;</span>)[<span class="string">&#x27;é‡‘é¢&#x27;</span>].agg([<span class="string">&#x27;sum&#x27;</span>, <span class="string">&#x27;mean&#x27;</span>, <span class="string">&#x27;count&#x27;</span>])</span><br><span class="line">å‘¨æœ«åˆ†æ.index = [<span class="string">&#x27;å·¥ä½œæ—¥&#x27;</span>, <span class="string">&#x27;å‘¨æœ«&#x27;</span>]</span><br><span class="line">å‘¨æœ«åˆ†æ.columns = [<span class="string">&#x27;é”€å”®é¢&#x27;</span>, <span class="string">&#x27;å¹³å‡æ—¥é”€å”®é¢&#x27;</span>, <span class="string">&#x27;å¤©æ•°&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nå·¥ä½œæ—¥vså‘¨æœ«é”€å”®å¯¹æ¯”ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(å‘¨æœ«åˆ†æ)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. äº¤å‰åˆ†æï¼ˆæ•°æ®é€è§†è¡¨ï¼‰</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nğŸ“Š äº¤å‰åˆ†æï¼š&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é”€å”®å‘˜-å®¢æˆ·äº¤å‰è¡¨</span></span><br><span class="line">äº¤å‰è¡¨ = pd.crosstab(df[<span class="string">&#x27;é”€å”®å‘˜&#x27;</span>], df[<span class="string">&#x27;å®¢æˆ·&#x27;</span>], values=df[<span class="string">&#x27;é‡‘é¢&#x27;</span>], aggfunc=<span class="string">&#x27;sum&#x27;</span>)</span><br><span class="line">äº¤å‰è¡¨ = äº¤å‰è¡¨.fillna(<span class="number">0</span>)  <span class="comment"># å¡«å……NaNä¸º0</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;é”€å”®å‘˜-å®¢æˆ·é”€å”®äº¤å‰è¡¨ï¼ˆé‡‘é¢ï¼‰ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(äº¤å‰è¡¨)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é”€å”®å‘˜-äº§å“äº¤å‰è¡¨ï¼ˆæ˜¾ç¤ºå¤šä¸ªæŒ‡æ ‡ï¼‰</span></span><br><span class="line">é€è§†è¡¨ = df.pivot_table(values=<span class="string">&#x27;é‡‘é¢&#x27;</span>, index=<span class="string">&#x27;é”€å”®å‘˜&#x27;</span>, columns=<span class="string">&#x27;äº§å“&#x27;</span>, aggfunc=<span class="string">&#x27;sum&#x27;</span>, fill_value=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\né”€å”®å‘˜-äº§å“é”€å”®é€è§†è¡¨ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(é€è§†è¡¨)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. æ’åå’Œç™¾åˆ†æ¯”åˆ†æ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nğŸ… æ’ååˆ†æï¼š&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é”€å”®å‘˜æ—¥é”€å”®é¢æ’å</span></span><br><span class="line">æ—¥é”€å”®å‘˜æ’å = df.groupby([<span class="string">&#x27;æ—¥æœŸ&#x27;</span>, <span class="string">&#x27;é”€å”®å‘˜&#x27;</span>])[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">sum</span>().reset_index()</span><br><span class="line">æ—¥é”€å”®å‘˜æ’å[<span class="string">&#x27;æ’å&#x27;</span>] =æ—¥é”€å”®å‘˜æ’å.groupby(<span class="string">&#x27;æ—¥æœŸ&#x27;</span>)[<span class="string">&#x27;é‡‘é¢&#x27;</span>].rank(ascending=<span class="literal">False</span>, method=<span class="string">&#x27;dense&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æ¯æ—¥é”€å”®å‘˜æ’åï¼ˆå‰10åï¼‰ï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(æ—¥é”€å”®å‘˜æ’å.head(<span class="number">10</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. å¼‚å¸¸æ£€æµ‹</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nâš ï¸ å¼‚å¸¸æ£€æµ‹ï¼š&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æµ‹å¼‚å¸¸é«˜é”€å”®é¢ï¼ˆè¶…è¿‡å¹³å‡å€¼2ä¸ªæ ‡å‡†å·®ï¼‰</span></span><br><span class="line">å¹³å‡æ—¥é”€å”®é¢ = df.groupby(<span class="string">&#x27;æ—¥æœŸ&#x27;</span>)[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">sum</span>().mean()</span><br><span class="line">æ—¥é”€å”®é¢æ ‡å‡†å·® = df.groupby(<span class="string">&#x27;æ—¥æœŸ&#x27;</span>)[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">sum</span>().std()</span><br><span class="line">å¼‚å¸¸é˜ˆå€¼ = å¹³å‡æ—¥é”€å”®é¢ + <span class="number">2</span> * æ—¥é”€å”®é¢æ ‡å‡†å·®</span><br><span class="line"></span><br><span class="line">å¼‚å¸¸æ—¥æœŸ = df.groupby(<span class="string">&#x27;æ—¥æœŸ&#x27;</span>)[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">sum</span>()[df.groupby(<span class="string">&#x27;æ—¥æœŸ&#x27;</span>)[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">sum</span>() &gt; å¼‚å¸¸é˜ˆå€¼]</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(å¼‚å¸¸æ—¥æœŸ) &gt; <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å¼‚å¸¸é«˜é”€å”®é¢æ—¥æœŸï¼š&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> æ—¥æœŸ, é‡‘é¢ <span class="keyword">in</span> å¼‚å¸¸æ—¥æœŸ.items():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;æ—¥æœŸ.strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>)&#125;</span>ï¼š<span class="subst">&#123;é‡‘é¢:,<span class="number">.2</span>f&#125;</span>å…ƒï¼ˆè¶…å‡ºæ­£å¸¸èŒƒå›´ï¼‰&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;  æœªå‘ç°å¼‚å¸¸é«˜é”€å”®é¢æ—¥æœŸ&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æµ‹å¼‚å¸¸å•ä»·</span></span><br><span class="line">äº§å“å•ä»·ç»Ÿè®¡ = df.groupby(<span class="string">&#x27;äº§å“&#x27;</span>)[<span class="string">&#x27;å•ä»·&#x27;</span>].agg([<span class="string">&#x27;mean&#x27;</span>, <span class="string">&#x27;std&#x27;</span>])</span><br><span class="line"><span class="keyword">for</span> äº§å“ <span class="keyword">in</span> äº§å“å•ä»·ç»Ÿè®¡.index:</span><br><span class="line">    å¹³å‡å•ä»· = äº§å“å•ä»·ç»Ÿè®¡.loc[äº§å“, <span class="string">&#x27;mean&#x27;</span>]</span><br><span class="line">    æ ‡å‡†å·® = äº§å“å•ä»·ç»Ÿè®¡.loc[äº§å“, <span class="string">&#x27;std&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> pd.notna(æ ‡å‡†å·®) <span class="keyword">and</span> æ ‡å‡†å·® &gt; <span class="number">0</span>:</span><br><span class="line">        å¼‚å¸¸å•ä»·é˜ˆå€¼ = å¹³å‡å•ä»· + <span class="number">2</span> * æ ‡å‡†å·®</span><br><span class="line">        å¼‚å¸¸è®°å½• = df[(df[<span class="string">&#x27;äº§å“&#x27;</span>] == äº§å“) &amp; (df[<span class="string">&#x27;å•ä»·&#x27;</span>] &gt; å¼‚å¸¸å•ä»·é˜ˆå€¼)]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(å¼‚å¸¸è®°å½•) &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\n<span class="subst">&#123;äº§å“&#125;</span>å¼‚å¸¸é«˜å•ä»·è®°å½•ï¼š&quot;</span>)</span><br><span class="line">            <span class="keyword">for</span> _, è®°å½• <span class="keyword">in</span> å¼‚å¸¸è®°å½•.iterrows():</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;è®°å½•[<span class="string">&#x27;æ—¥æœŸ&#x27;</span>].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>)&#125;</span>ï¼šå•ä»·<span class="subst">&#123;è®°å½•[<span class="string">&#x27;å•ä»·&#x27;</span>]&#125;</span>å…ƒï¼ˆå¹³å‡<span class="subst">&#123;å¹³å‡å•ä»·:<span class="number">.0</span>f&#125;</span>å…ƒï¼‰&quot;</span>)</span><br></pre></td></tr></table></figure></details><details><summary>ç‰ˆæœ¬3.0ï¼šä¸“ä¸šåˆ†ææŠ¥å‘Š</summary><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é”€å”®æ•°æ®åˆ†æ - ä¸“ä¸šç‰ˆ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n=== ä¸“ä¸šé”€å”®åˆ†ææŠ¥å‘Š ===&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> Workbook</span><br><span class="line"><span class="keyword">from</span> openpyxl.styles <span class="keyword">import</span> Font, PatternFill, Alignment</span><br><span class="line"><span class="keyword">from</span> openpyxl.chart <span class="keyword">import</span> LineChart, BarChart, Reference</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ç”Ÿæˆä¸“ä¸šé”€å”®æŠ¥å‘Š</span>(<span class="params">df, æ–‡ä»¶å=<span class="string">&quot;é”€å”®åˆ†ææŠ¥å‘Š.xlsx&quot;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ç”Ÿæˆä¸“ä¸šçš„é”€å”®åˆ†ææŠ¥å‘Š&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åˆ›å»ºå·¥ä½œç°¿</span></span><br><span class="line">    wb = Workbook()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 1. æ‰§è¡Œæ±‡æ€»è¡¨</span></span><br><span class="line">    æ±‡æ€»è¡¨ = wb.active</span><br><span class="line">    æ±‡æ€»è¡¨.title = <span class="string">&quot;æ‰§è¡Œæ±‡æ€»&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ ‡é¢˜</span></span><br><span class="line">    æ±‡æ€»è¡¨[<span class="string">&quot;A1&quot;</span>] = <span class="string">&quot;é”€å”®æ•°æ®åˆ†ææŠ¥å‘Š&quot;</span></span><br><span class="line">    æ±‡æ€»è¡¨[<span class="string">&quot;A1&quot;</span>].font = Font(size=<span class="number">18</span>, bold=<span class="literal">True</span>, color=<span class="string">&quot;FFFFFF&quot;</span>)</span><br><span class="line">    æ±‡æ€»è¡¨[<span class="string">&quot;A1&quot;</span>].fill = PatternFill(start_color=<span class="string">&quot;366092&quot;</span>, end_color=<span class="string">&quot;366092&quot;</span>, fill_type=<span class="string">&quot;solid&quot;</span>)</span><br><span class="line">    æ±‡æ€»è¡¨.merge_cells(<span class="string">&quot;A1:H1&quot;</span>)</span><br><span class="line">    æ±‡æ€»è¡¨[<span class="string">&quot;A1&quot;</span>].alignment = Alignment(horizontal=<span class="string">&quot;center&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åŸºæœ¬ä¿¡æ¯</span></span><br><span class="line">    æ±‡æ€»è¡¨[<span class="string">&quot;A3&quot;</span>] = <span class="string">f&quot;æŠ¥å‘Šç”Ÿæˆæ—¶é—´ï¼š<span class="subst">&#123;datetime.now().strftime(<span class="string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>)&#125;</span>&quot;</span></span><br><span class="line">    æ±‡æ€»è¡¨[<span class="string">&quot;A4&quot;</span>] = <span class="string">f&quot;åˆ†ææœŸé—´ï¼š<span class="subst">&#123;df[<span class="string">&#x27;æ—¥æœŸ&#x27;</span>].<span class="built_in">min</span>().strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>)&#125;</span> è‡³ <span class="subst">&#123;df[<span class="string">&#x27;æ—¥æœŸ&#x27;</span>].<span class="built_in">max</span>().strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>)&#125;</span>&quot;</span></span><br><span class="line">    æ±‡æ€»è¡¨[<span class="string">&quot;A5&quot;</span>] = <span class="string">f&quot;æ•°æ®è®°å½•æ•°ï¼š<span class="subst">&#123;<span class="built_in">len</span>(df)&#125;</span>ç¬”&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å…³é”®æŒ‡æ ‡</span></span><br><span class="line">    å…³é”®æŒ‡æ ‡ = [</span><br><span class="line">        [<span class="string">&quot;å…³é”®æŒ‡æ ‡&quot;</span>, <span class="string">&quot;æ•°å€¼&quot;</span>, <span class="string">&quot;å•ä½&quot;</span>, <span class="string">&quot;è¯´æ˜&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;æ€»é”€å”®é¢&quot;</span>, <span class="string">f&quot;<span class="subst">&#123;df[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">sum</span>():,<span class="number">.2</span>f&#125;</span>&quot;</span>, <span class="string">&quot;å…ƒ&quot;</span>, <span class="string">&quot;æœŸé—´å†…æ‰€æœ‰é”€å”®é‡‘é¢åˆè®¡&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;å¹³å‡æ—¥é”€å”®é¢&quot;</span>, <span class="string">f&quot;<span class="subst">&#123;df.groupby(<span class="string">&#x27;æ—¥æœŸ&#x27;</span>)[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">sum</span>().mean():,<span class="number">.2</span>f&#125;</span>&quot;</span>, <span class="string">&quot;å…ƒ&quot;</span>, <span class="string">&quot;æ—¥å‡é”€å”®æ°´å¹³&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;æ€»é”€å”®æ•°é‡&quot;</span>, <span class="string">f&quot;<span class="subst">&#123;df[<span class="string">&#x27;æ•°é‡&#x27;</span>].<span class="built_in">sum</span>():,&#125;</span>&quot;</span>, <span class="string">&quot;ä»¶&quot;</span>, <span class="string">&quot;æœŸé—´å†…æ‰€æœ‰é”€å”®æ•°é‡åˆè®¡&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;å¹³å‡å•ä»·&quot;</span>, <span class="string">f&quot;<span class="subst">&#123;df[<span class="string">&#x27;å•ä»·&#x27;</span>].mean():<span class="number">.2</span>f&#125;</span>&quot;</span>, <span class="string">&quot;å…ƒ&quot;</span>, <span class="string">&quot;æ‰€æœ‰äº§å“çš„å¹³å‡å•ä»·&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;é”€å”®ç¬”æ•°&quot;</span>, <span class="string">f&quot;<span class="subst">&#123;<span class="built_in">len</span>(df):,&#125;</span>&quot;</span>, <span class="string">&quot;ç¬”&quot;</span>, <span class="string">&quot;æœŸé—´å†…æ€»é”€å”®ç¬”æ•°&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;å®¢å•ä»·&quot;</span>, <span class="string">f&quot;<span class="subst">&#123;df[<span class="string">&#x27;é‡‘é¢&#x27;</span>].mean():<span class="number">.2</span>f&#125;</span>&quot;</span>, <span class="string">&quot;å…ƒ&quot;</span>, <span class="string">&quot;å¹³å‡æ¯ç¬”é”€å”®é‡‘é¢&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;é”€å”®å‘˜æ•°é‡&quot;</span>, <span class="string">f&quot;<span class="subst">&#123;df[<span class="string">&#x27;é”€å”®å‘˜&#x27;</span>].nunique()&#125;</span>&quot;</span>, <span class="string">&quot;äºº&quot;</span>, <span class="string">&quot;å‚ä¸é”€å”®çš„é”€å”®å‘˜äººæ•°&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;å®¢æˆ·æ•°é‡&quot;</span>, <span class="string">f&quot;<span class="subst">&#123;df[<span class="string">&#x27;å®¢æˆ·&#x27;</span>].nunique()&#125;</span>&quot;</span>, <span class="string">&quot;ä¸ª&quot;</span>, <span class="string">&quot;è´­ä¹°äº§å“çš„å®¢æˆ·æ•°é‡&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;äº§å“ç§ç±»&quot;</span>, <span class="string">f&quot;<span class="subst">&#123;df[<span class="string">&#x27;äº§å“&#x27;</span>].nunique()&#125;</span>&quot;</span>, <span class="string">&quot;ç§&quot;</span>, <span class="string">&quot;é”€å”®çš„äº§å“ç§ç±»æ•°é‡&quot;</span>]</span><br><span class="line">    ]</span><br><span class="line">    </span><br><span class="line">    èµ·å§‹è¡Œ = <span class="number">7</span></span><br><span class="line">    <span class="keyword">for</span> è¡Œå·, æ•°æ®è¡Œ <span class="keyword">in</span> <span class="built_in">enumerate</span>(å…³é”®æŒ‡æ ‡, èµ·å§‹è¡Œ):</span><br><span class="line">        <span class="keyword">for</span> åˆ—å·, å€¼ <span class="keyword">in</span> <span class="built_in">enumerate</span>(æ•°æ®è¡Œ, <span class="number">1</span>):</span><br><span class="line">            å•å…ƒæ ¼ = æ±‡æ€»è¡¨.cell(row=è¡Œå·, column=åˆ—å·, value=å€¼)</span><br><span class="line">            <span class="keyword">if</span> è¡Œå· == èµ·å§‹è¡Œ:</span><br><span class="line">                å•å…ƒæ ¼.font = Font(bold=<span class="literal">True</span>)</span><br><span class="line">                å•å…ƒæ ¼.fill = PatternFill(start_color=<span class="string">&quot;D9E2F3&quot;</span>, end_color=<span class="string">&quot;D9E2F3&quot;</span>, fill_type=<span class="string">&quot;solid&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è°ƒæ•´åˆ—å®½</span></span><br><span class="line">    <span class="keyword">for</span> åˆ— <span class="keyword">in</span> [<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>, <span class="string">&quot;D&quot;</span>]:</span><br><span class="line">        æ±‡æ€»è¡¨.column_dimensions[åˆ—].width = <span class="number">20</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. é”€å”®å‘˜ä¸šç»©è¡¨</span></span><br><span class="line">    ä¸šç»©è¡¨ = wb.create_sheet(<span class="string">&quot;é”€å”®å‘˜ä¸šç»©&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    ä¸šç»©è¡¨[<span class="string">&quot;A1&quot;</span>] = <span class="string">&quot;é”€å”®å‘˜ä¸šç»©æ’å&quot;</span></span><br><span class="line">    ä¸šç»©è¡¨[<span class="string">&quot;A1&quot;</span>].font = Font(size=<span class="number">14</span>, bold=<span class="literal">True</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è·å–ä¸šç»©æ•°æ®</span></span><br><span class="line">    é”€å”®å‘˜ä¸šç»© = df.groupby(<span class="string">&#x27;é”€å”®å‘˜&#x27;</span>).agg(&#123;</span><br><span class="line">        <span class="string">&#x27;é‡‘é¢&#x27;</span>: [<span class="string">&#x27;sum&#x27;</span>, <span class="string">&#x27;mean&#x27;</span>, <span class="string">&#x27;count&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;æ•°é‡&#x27;</span>: <span class="string">&#x27;sum&#x27;</span></span><br><span class="line">    &#125;).<span class="built_in">round</span>(<span class="number">2</span>)</span><br><span class="line">    </span><br><span class="line">    é”€å”®å‘˜ä¸šç»©.columns = [<span class="string">&#x27;æ€»é”€å”®é¢&#x27;</span>, <span class="string">&#x27;å¹³å‡é”€å”®é¢&#x27;</span>, <span class="string">&#x27;é”€å”®ç¬”æ•°&#x27;</span>, <span class="string">&#x27;æ€»æ•°é‡&#x27;</span>]</span><br><span class="line">    é”€å”®å‘˜ä¸šç»© = é”€å”®å‘˜ä¸šç»©.sort_values(<span class="string">&#x27;æ€»é”€å”®é¢&#x27;</span>, ascending=<span class="literal">False</span>)</span><br><span class="line">    é”€å”®å‘˜ä¸šç»©[<span class="string">&#x27;æ’å&#x27;</span>] = <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(é”€å”®å‘˜ä¸šç»©) + <span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å†™å…¥è¡¨å¤´</span></span><br><span class="line">    è¡¨å¤´ = [<span class="string">&#x27;æ’å&#x27;</span>, <span class="string">&#x27;é”€å”®å‘˜&#x27;</span>, <span class="string">&#x27;æ€»é”€å”®é¢&#x27;</span>, <span class="string">&#x27;å¹³å‡é”€å”®é¢&#x27;</span>, <span class="string">&#x27;é”€å”®ç¬”æ•°&#x27;</span>, <span class="string">&#x27;æ€»æ•°é‡&#x27;</span>, <span class="string">&#x27;å æ¯”&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> åˆ—å·, æ ‡é¢˜ <span class="keyword">in</span> <span class="built_in">enumerate</span>(è¡¨å¤´, <span class="number">1</span>):</span><br><span class="line">        å•å…ƒæ ¼ = ä¸šç»©è¡¨.cell(row=<span class="number">3</span>, column=åˆ—å·, value=æ ‡é¢˜)</span><br><span class="line">        å•å…ƒæ ¼.font = Font(bold=<span class="literal">True</span>)</span><br><span class="line">        å•å…ƒæ ¼.fill = PatternFill(start_color=<span class="string">&quot;E8F4FD&quot;</span>, end_color=<span class="string">&quot;E8F4FD&quot;</span>, fill_type=<span class="string">&quot;solid&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å†™å…¥æ•°æ®</span></span><br><span class="line">    æ€»é”€å”®é¢ = df[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">sum</span>()</span><br><span class="line">    <span class="keyword">for</span> è¡Œå·, (é”€å”®å‘˜, æ•°æ®) <span class="keyword">in</span> <span class="built_in">enumerate</span>(é”€å”®å‘˜ä¸šç»©.iterrows(), <span class="number">4</span>):</span><br><span class="line">        ä¸šç»©è¡¨.cell(row=è¡Œå·, column=<span class="number">1</span>, value=æ•°æ®[<span class="string">&#x27;æ’å&#x27;</span>])</span><br><span class="line">        ä¸šç»©è¡¨.cell(row=è¡Œå·, column=<span class="number">2</span>, value=é”€å”®å‘˜)</span><br><span class="line">        ä¸šç»©è¡¨.cell(row=è¡Œå·, column=<span class="number">3</span>, value=æ•°æ®[<span class="string">&#x27;æ€»é”€å”®é¢&#x27;</span>])</span><br><span class="line">        ä¸šç»©è¡¨.cell(row=è¡Œå·, column=<span class="number">4</span>, value=æ•°æ®[<span class="string">&#x27;å¹³å‡é”€å”®é¢&#x27;</span>])</span><br><span class="line">        ä¸šç»©è¡¨.cell(row=è¡Œå·, column=<span class="number">5</span>, value=æ•°æ®[<span class="string">&#x27;é”€å”®ç¬”æ•°&#x27;</span>])</span><br><span class="line">        ä¸šç»©è¡¨.cell(row=è¡Œå·, column=<span class="number">6</span>, value=æ•°æ®[<span class="string">&#x27;æ€»æ•°é‡&#x27;</span>])</span><br><span class="line">        ä¸šç»©è¡¨.cell(row=è¡Œå·, column=<span class="number">7</span>, value=<span class="string">f&quot;<span class="subst">&#123;æ•°æ®[<span class="string">&#x27;æ€»é”€å”®é¢&#x27;</span>]/æ€»é”€å”®é¢*<span class="number">100</span>:<span class="number">.1</span>f&#125;</span>%&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ·»åŠ å›¾è¡¨æ•°æ®</span></span><br><span class="line">    å›¾è¡¨æ•°æ®èµ·å§‹è¡Œ = <span class="built_in">len</span>(é”€å”®å‘˜ä¸šç»©) + <span class="number">6</span></span><br><span class="line">    ä¸šç»©è¡¨.cell(row=å›¾è¡¨æ•°æ®èµ·å§‹è¡Œ, column=<span class="number">1</span>, value=<span class="string">&quot;å›¾è¡¨æ•°æ®&quot;</span>)</span><br><span class="line">    ä¸šç»©è¡¨.cell(row=å›¾è¡¨æ•°æ®èµ·å§‹è¡Œ, column=<span class="number">1</span>).font = Font(bold=<span class="literal">True</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i, (é”€å”®å‘˜, æ•°æ®) <span class="keyword">in</span> <span class="built_in">enumerate</span>(é”€å”®å‘˜ä¸šç»©.iterrows(), å›¾è¡¨æ•°æ®èµ·å§‹è¡Œ + <span class="number">1</span>):</span><br><span class="line">        ä¸šç»©è¡¨.cell(row=i, column=<span class="number">1</span>, value=é”€å”®å‘˜)</span><br><span class="line">        ä¸šç»©è¡¨.cell(row=i, column=<span class="number">2</span>, value=æ•°æ®[<span class="string">&#x27;æ€»é”€å”®é¢&#x27;</span>])</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åˆ›å»ºæŸ±çŠ¶å›¾</span></span><br><span class="line">    å›¾è¡¨ = BarChart()</span><br><span class="line">    å›¾è¡¨.title = <span class="string">&quot;é”€å”®å‘˜é”€å”®é¢å¯¹æ¯”&quot;</span></span><br><span class="line">    å›¾è¡¨.style = <span class="number">10</span></span><br><span class="line">    å›¾è¡¨.y_axis.title = <span class="string">&#x27;é”€å”®é¢ï¼ˆå…ƒï¼‰&#x27;</span></span><br><span class="line">    å›¾è¡¨.x_axis.title = <span class="string">&#x27;é”€å”®å‘˜&#x27;</span></span><br><span class="line">    </span><br><span class="line">    æ•°æ® = Reference(ä¸šç»©è¡¨, min_col=<span class="number">2</span>, min_row=å›¾è¡¨æ•°æ®èµ·å§‹è¡Œ + <span class="number">1</span>, max_row=å›¾è¡¨æ•°æ®èµ·å§‹è¡Œ + <span class="built_in">len</span>(é”€å”®å‘˜ä¸šç»©), max_col=<span class="number">2</span>)</span><br><span class="line">    åˆ†ç±» = Reference(ä¸šç»©è¡¨, min_col=<span class="number">1</span>, min_row=å›¾è¡¨æ•°æ®èµ·å§‹è¡Œ + <span class="number">1</span>, max_row=å›¾è¡¨æ•°æ®èµ·å§‹è¡Œ + <span class="built_in">len</span>(é”€å”®å‘˜ä¸šç»©))</span><br><span class="line">    </span><br><span class="line">    å›¾è¡¨.add_data(data)</span><br><span class="line">    å›¾è¡¨.set_categories(åˆ†ç±»)</span><br><span class="line">    ä¸šç»©è¡¨.add_chart(å›¾è¡¨, <span class="string">&quot;I3&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. å®¢æˆ·åˆ†æè¡¨</span></span><br><span class="line">    å®¢æˆ·è¡¨ = wb.create_sheet(<span class="string">&quot;å®¢æˆ·åˆ†æ&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    å®¢æˆ·è¡¨[<span class="string">&quot;A1&quot;</span>] = <span class="string">&quot;å®¢æˆ·è´­ä¹°åˆ†æ&quot;</span></span><br><span class="line">    å®¢æˆ·è¡¨[<span class="string">&quot;A1&quot;</span>].font = Font(size=<span class="number">14</span>, bold=<span class="literal">True</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å®¢æˆ·åˆ†ææ•°æ®</span></span><br><span class="line">    å®¢æˆ·åˆ†æ = df.groupby(<span class="string">&#x27;å®¢æˆ·&#x27;</span>).agg(&#123;</span><br><span class="line">        <span class="string">&#x27;é‡‘é¢&#x27;</span>: [<span class="string">&#x27;sum&#x27;</span>, <span class="string">&#x27;mean&#x27;</span>, <span class="string">&#x27;count&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;æ•°é‡&#x27;</span>: <span class="string">&#x27;sum&#x27;</span></span><br><span class="line">    &#125;).<span class="built_in">round</span>(<span class="number">2</span>)</span><br><span class="line">    </span><br><span class="line">    å®¢æˆ·åˆ†æ.columns = [<span class="string">&#x27;æ€»è´­ä¹°é¢&#x27;</span>, <span class="string">&#x27;å¹³å‡è´­ä¹°é¢&#x27;</span>, <span class="string">&#x27;è´­ä¹°æ¬¡æ•°&#x27;</span>, <span class="string">&#x27;æ€»æ•°é‡&#x27;</span>]</span><br><span class="line">    å®¢æˆ·åˆ†æ = å®¢æˆ·åˆ†æ.sort_values(<span class="string">&#x27;æ€»è´­ä¹°é¢&#x27;</span>, ascending=<span class="literal">False</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å†™å…¥æ•°æ®</span></span><br><span class="line">    è¡¨å¤´ = [<span class="string">&#x27;å®¢æˆ·&#x27;</span>, <span class="string">&#x27;æ€»è´­ä¹°é¢&#x27;</span>, <span class="string">&#x27;å¹³å‡è´­ä¹°é¢&#x27;</span>, <span class="string">&#x27;è´­ä¹°æ¬¡æ•°&#x27;</span>, <span class="string">&#x27;æ€»æ•°é‡&#x27;</span>, <span class="string">&#x27;å®¢å•ä»·&#x27;</span>, <span class="string">&#x27;ç­‰çº§&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> åˆ—å·, æ ‡é¢˜ <span class="keyword">in</span> <span class="built_in">enumerate</span>(è¡¨å¤´, <span class="number">1</span>):</span><br><span class="line">        å•å…ƒæ ¼ = å®¢æˆ·è¡¨.cell(row=<span class="number">3</span>, column=åˆ—å·, value=æ ‡é¢˜)</span><br><span class="line">        å•å…ƒæ ¼.font = Font(bold=<span class="literal">True</span>)</span><br><span class="line">        å•å…ƒæ ¼.fill = PatternFill(start_color=<span class="string">&quot;E8F4FD&quot;</span>, end_color=<span class="string">&quot;E8F4FD&quot;</span>, fill_type=<span class="string">&quot;solid&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> è¡Œå·, (å®¢æˆ·, æ•°æ®) <span class="keyword">in</span> <span class="built_in">enumerate</span>(å®¢æˆ·åˆ†æ.iterrows(), <span class="number">4</span>):</span><br><span class="line">        å®¢æˆ·è¡¨.cell(row=è¡Œå·, column=<span class="number">1</span>, value=å®¢æˆ·)</span><br><span class="line">        å®¢æˆ·è¡¨.cell(row=è¡Œå·, column=<span class="number">2</span>, value=æ•°æ®[<span class="string">&#x27;æ€»è´­ä¹°é¢&#x27;</span>])</span><br><span class="line">        å®¢æˆ·è¡¨.cell(row=è¡Œå·, column=<span class="number">3</span>, value=æ•°æ®[<span class="string">&#x27;å¹³å‡è´­ä¹°é¢&#x27;</span>])</span><br><span class="line">        å®¢æˆ·è¡¨.cell(row=è¡Œå·, column=<span class="number">4</span>, value=æ•°æ®[<span class="string">&#x27;è´­ä¹°æ¬¡æ•°&#x27;</span>])</span><br><span class="line">        å®¢æˆ·è¡¨.cell(row=è¡Œå·, column=<span class="number">5</span>, value=æ•°æ®[<span class="string">&#x27;æ€»æ•°é‡&#x27;</span>])</span><br><span class="line">        å®¢æˆ·è¡¨.cell(row=è¡Œå·, column=<span class="number">6</span>, value=æ•°æ®[<span class="string">&#x27;æ€»è´­ä¹°é¢&#x27;</span>]/æ•°æ®[<span class="string">&#x27;è´­ä¹°æ¬¡æ•°&#x27;</span>])</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å®¢æˆ·åˆ†çº§</span></span><br><span class="line">        <span class="keyword">if</span> æ•°æ®[<span class="string">&#x27;æ€»è´­ä¹°é¢&#x27;</span>] &gt; <span class="number">20000</span>:</span><br><span class="line">            ç­‰çº§ = <span class="string">&quot;VIPå®¢æˆ·&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> æ•°æ®[<span class="string">&#x27;æ€»è´­ä¹°é¢&#x27;</span>] &gt; <span class="number">10000</span>:</span><br><span class="line">            ç­‰çº§ = <span class="string">&quot;é‡ç‚¹å®¢æˆ·&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> æ•°æ®[<span class="string">&#x27;æ€»è´­ä¹°é¢&#x27;</span>] &gt; <span class="number">5000</span>:</span><br><span class="line">            ç­‰çº§ = <span class="string">&quot;æ™®é€šå®¢æˆ·&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ç­‰çº§ = <span class="string">&quot;å°å®¢æˆ·&quot;</span></span><br><span class="line">        </span><br><span class="line">        å®¢æˆ·è¡¨.cell(row=è¡Œå·, column=<span class="number">7</span>, value=ç­‰çº§)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 4. æ—¶é—´åˆ†æè¡¨</span></span><br><span class="line">    æ—¶é—´è¡¨ = wb.create_sheet(<span class="string">&quot;æ—¶é—´åˆ†æ&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    æ—¶é—´è¡¨[<span class="string">&quot;A1&quot;</span>] = <span class="string">&quot;æ—¶é—´åºåˆ—åˆ†æ&quot;</span></span><br><span class="line">    æ—¶é—´è¡¨[<span class="string">&quot;A1&quot;</span>].font = Font(size=<span class="number">14</span>, bold=<span class="literal">True</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ—¥é”€å”®é¢</span></span><br><span class="line">    æ—¥é”€å”®é¢ = df.groupby(<span class="string">&#x27;æ—¥æœŸ&#x27;</span>)[<span class="string">&#x27;é‡‘é¢&#x27;</span>].agg([<span class="string">&#x27;sum&#x27;</span>, <span class="string">&#x27;count&#x27;</span>]).reset_index()</span><br><span class="line">    æ—¥é”€å”®é¢.columns = [<span class="string">&#x27;æ—¥æœŸ&#x27;</span>, <span class="string">&#x27;é”€å”®é¢&#x27;</span>, <span class="string">&#x27;ç¬”æ•°&#x27;</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å†™å…¥æ•°æ®</span></span><br><span class="line">    æ—¶é—´è¡¨[<span class="string">&quot;A3&quot;</span>] = <span class="string">&quot;æ—¥é”€å”®é¢ç»Ÿè®¡&quot;</span></span><br><span class="line">    æ—¶é—´è¡¨[<span class="string">&quot;A3&quot;</span>].font = Font(bold=<span class="literal">True</span>)</span><br><span class="line">    </span><br><span class="line">    è¡¨å¤´ = [<span class="string">&#x27;æ—¥æœŸ&#x27;</span>, <span class="string">&#x27;é”€å”®é¢&#x27;</span>, <span class="string">&#x27;ç¬”æ•°&#x27;</span>, <span class="string">&#x27;æ—¥å‡å•ä»·&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> åˆ—å·, æ ‡é¢˜ <span class="keyword">in</span> <span class="built_in">enumerate</span>(è¡¨å¤´, <span class="number">1</span>):</span><br><span class="line">        å•å…ƒæ ¼ = æ—¶é—´è¡¨.cell(row=<span class="number">5</span>, column=åˆ—å·, value=æ ‡é¢˜)</span><br><span class="line">        å•å…ƒæ ¼.font = Font(bold=<span class="literal">True</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> è¡Œå·, (_, æ•°æ®) <span class="keyword">in</span> <span class="built_in">enumerate</span>(æ—¥é”€å”®é¢.iterrows(), <span class="number">6</span>):</span><br><span class="line">        æ—¶é—´è¡¨.cell(row=è¡Œå·, column=<span class="number">1</span>, value=æ•°æ®[<span class="string">&#x27;æ—¥æœŸ&#x27;</span>].strftime(<span class="string">&#x27;%m-%d&#x27;</span>))</span><br><span class="line">        æ—¶é—´è¡¨.cell(row=è¡Œå·, column=<span class="number">2</span>, value=æ•°æ®[<span class="string">&#x27;é”€å”®é¢&#x27;</span>])</span><br><span class="line">        æ—¶é—´è¡¨.cell(row=è¡Œå·, column=<span class="number">3</span>, value=æ•°æ®[<span class="string">&#x27;ç¬”æ•°&#x27;</span>])</span><br><span class="line">        æ—¶é—´è¡¨.cell(row=è¡Œå·, column=<span class="number">4</span>, value=æ•°æ®[<span class="string">&#x27;é”€å”®é¢&#x27;</span>]/æ•°æ®[<span class="string">&#x27;ç¬”æ•°&#x27;</span>] <span class="keyword">if</span> æ•°æ®[<span class="string">&#x27;ç¬”æ•°&#x27;</span>] &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åˆ›å»ºæŠ˜çº¿å›¾</span></span><br><span class="line">    æŠ˜çº¿å›¾ = LineChart()</span><br><span class="line">    æŠ˜çº¿å›¾.title = <span class="string">&quot;æ—¥é”€å”®é¢è¶‹åŠ¿&quot;</span></span><br><span class="line">    æŠ˜çº¿å›¾.style = <span class="number">2</span></span><br><span class="line">    æŠ˜çº¿å›¾.y_axis.title = <span class="string">&#x27;é”€å”®é¢ï¼ˆå…ƒï¼‰&#x27;</span></span><br><span class="line">    æŠ˜çº¿å›¾.x_axis.title = <span class="string">&#x27;æ—¥æœŸ&#x27;</span></span><br><span class="line">    </span><br><span class="line">    æ•°æ® = Reference(æ—¶é—´è¡¨, min_col=<span class="number">2</span>, min_row=<span class="number">6</span>, max_row=<span class="number">6</span> + <span class="built_in">len</span>(æ—¥é”€å”®é¢), max_col=<span class="number">2</span>)</span><br><span class="line">    åˆ†ç±» = Reference(æ—¶é—´è¡¨, min_col=<span class="number">1</span>, min_row=<span class="number">6</span>, max_row=<span class="number">6</span> + <span class="built_in">len</span>(æ—¥é”€å”®é¢))</span><br><span class="line">    </span><br><span class="line">    æŠ˜çº¿å›¾.add_data(data, titles_from_data=<span class="literal">True</span>)</span><br><span class="line">    æŠ˜çº¿å›¾.set_categories(åˆ†ç±»)</span><br><span class="line">    æ—¶é—´è¡¨.add_chart(æŠ˜çº¿å›¾, <span class="string">&quot;F5&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ä¿å­˜æ–‡ä»¶</span></span><br><span class="line">    wb.save(æ–‡ä»¶å)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;âœ… ä¸“ä¸šé”€å”®æŠ¥å‘Šå·²ç”Ÿæˆï¼š<span class="subst">&#123;æ–‡ä»¶å&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> æ–‡ä»¶å</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆä¸“ä¸šæŠ¥å‘Š</span></span><br><span class="line">ä¸“ä¸šæŠ¥å‘Š = ç”Ÿæˆä¸“ä¸šé”€å”®æŠ¥å‘Š(df)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢å¤–ï¼šç”Ÿæˆæ•°æ®å¯è§†åŒ–å›¾è¡¨ï¼ˆmatplotlibï¼‰</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nğŸ“Š ç”Ÿæˆæ•°æ®å¯è§†åŒ–å›¾è¡¨...&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]  <span class="comment"># è®¾ç½®ä¸­æ–‡å­—ä½“</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span>   <span class="comment"># æ­£ç¡®æ˜¾ç¤ºè´Ÿå·</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. é”€å”®å‘˜ä¸šç»©æŸ±çŠ¶å›¾</span></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">6</span>))</span><br><span class="line">é”€å”®å‘˜ä¸šç»© = df.groupby(<span class="string">&#x27;é”€å”®å‘˜&#x27;</span>)[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">sum</span>().sort_values(ascending=<span class="literal">False</span>)</span><br><span class="line">plt.bar(é”€å”®å‘˜ä¸šç»©.index, é”€å”®å‘˜ä¸šç»©.values, color=<span class="string">&#x27;skyblue&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;é”€å”®å‘˜ä¸šç»©å¯¹æ¯”&#x27;</span>, fontsize=<span class="number">16</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;é”€å”®å‘˜&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;é”€å”®é¢ï¼ˆå…ƒï¼‰&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">plt.xticks(rotation=<span class="number">45</span>)</span><br><span class="line"><span class="keyword">for</span> i, v <span class="keyword">in</span> <span class="built_in">enumerate</span>(é”€å”®å‘˜ä¸šç»©.values):</span><br><span class="line">    plt.text(i, v + <span class="number">1000</span>, <span class="string">f&#x27;<span class="subst">&#123;v:,<span class="number">.0</span>f&#125;</span>&#x27;</span>, ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;bottom&#x27;</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.savefig(<span class="string">&#x27;é”€å”®å‘˜ä¸šç»©å¯¹æ¯”.png&#x27;</span>, dpi=<span class="number">300</span>, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br><span class="line">plt.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. å®¢æˆ·è´­ä¹°é¢é¥¼å›¾</span></span><br><span class="line">plt.figure(figsize=(<span class="number">8</span>, <span class="number">8</span>))</span><br><span class="line">å®¢æˆ·è´­ä¹° = df.groupby(<span class="string">&#x27;å®¢æˆ·&#x27;</span>)[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">sum</span>()</span><br><span class="line">plt.pie(å®¢æˆ·è´­ä¹°.values, labels=å®¢æˆ·è´­ä¹°.index, autopct=<span class="string">&#x27;%1.1f%%&#x27;</span>, startangle=<span class="number">90</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;å®¢æˆ·è´­ä¹°åˆ†å¸ƒ&#x27;</span>, fontsize=<span class="number">16</span>)</span><br><span class="line">plt.axis(<span class="string">&#x27;equal&#x27;</span>)</span><br><span class="line">plt.savefig(<span class="string">&#x27;å®¢æˆ·è´­ä¹°åˆ†å¸ƒ.png&#x27;</span>, dpi=<span class="number">300</span>, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br><span class="line">plt.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. æ—¥é”€å”®é¢è¶‹åŠ¿å›¾</span></span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>, <span class="number">6</span>))</span><br><span class="line">æ—¥é”€å”®é¢ = df.groupby(<span class="string">&#x27;æ—¥æœŸ&#x27;</span>)[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">sum</span>()</span><br><span class="line">plt.plot(æ—¥é”€å”®é¢.index, æ—¥é”€å”®é¢.values, marker=<span class="string">&#x27;o&#x27;</span>, linewidth=<span class="number">2</span>, markersize=<span class="number">4</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;æ—¥é”€å”®é¢è¶‹åŠ¿&#x27;</span>, fontsize=<span class="number">16</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;æ—¥æœŸ&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;é”€å”®é¢ï¼ˆå…ƒï¼‰&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">plt.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line">plt.xticks(rotation=<span class="number">45</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.savefig(<span class="string">&#x27;æ—¥é”€å”®é¢è¶‹åŠ¿.png&#x27;</span>, dpi=<span class="number">300</span>, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br><span class="line">plt.close()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;âœ… å¯è§†åŒ–å›¾è¡¨å·²ç”Ÿæˆï¼&quot;</span>)</span><br></pre></td></tr></table></figure></details><hr><h3 id="ğŸƒâ€â™€ï¸-è¿›é˜¶å°æŒ‘æˆ˜"><a href="#ğŸƒâ€â™€ï¸-è¿›é˜¶å°æŒ‘æˆ˜" class="headerlink" title="ğŸƒâ€â™€ï¸ è¿›é˜¶å°æŒ‘æˆ˜"></a>ğŸƒâ€â™€ï¸ è¿›é˜¶å°æŒ‘æˆ˜</h3><details><summary>æŒ‘æˆ˜1ï¼šè´¢åŠ¡æ¯”ç‡åˆ†æ</summary><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è´¢åŠ¡æ¯”ç‡åˆ†æå·¥å…·</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=== è´¢åŠ¡æ¯”ç‡åˆ†æå·¥å…· ===&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">è®¡ç®—è´¢åŠ¡æ¯”ç‡</span>(<span class="params">èµ„äº§è´Ÿå€ºè¡¨, åˆ©æ¶¦è¡¨</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    è®¡ç®—å¸¸ç”¨è´¢åŠ¡æ¯”ç‡</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    å‚æ•°ï¼š</span></span><br><span class="line"><span class="string">    èµ„äº§è´Ÿå€ºè¡¨ï¼šåŒ…å«èµ„äº§ã€è´Ÿå€ºã€æ‰€æœ‰è€…æƒç›Šçš„DataFrame</span></span><br><span class="line"><span class="string">    åˆ©æ¶¦è¡¨ï¼šåŒ…å«æ”¶å…¥ã€æˆæœ¬ã€è´¹ç”¨çš„DataFrame</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    è¿”å›ï¼š</span></span><br><span class="line"><span class="string">    è´¢åŠ¡æ¯”ç‡å­—å…¸</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ä»æ•°æ®ä¸­æå–å…³é”®æ•°æ®</span></span><br><span class="line">    æ€»èµ„äº§ = èµ„äº§è´Ÿå€ºè¡¨[<span class="string">&#x27;æ€»èµ„äº§&#x27;</span>].iloc[-<span class="number">1</span>]</span><br><span class="line">    æ€»è´Ÿå€º = èµ„äº§è´Ÿå€ºè¡¨[<span class="string">&#x27;æ€»è´Ÿå€º&#x27;</span>].iloc[-<span class="number">1</span>]</span><br><span class="line">    æ‰€æœ‰è€…æƒç›Š = èµ„äº§è´Ÿå€ºè¡¨[<span class="string">&#x27;æ‰€æœ‰è€…æƒç›Š&#x27;</span>].iloc[-<span class="number">1</span>]</span><br><span class="line">    æµåŠ¨èµ„äº§ = èµ„äº§è´Ÿå€ºè¡¨[<span class="string">&#x27;æµåŠ¨èµ„äº§&#x27;</span>].iloc[-<span class="number">1</span>]</span><br><span class="line">    æµåŠ¨è´Ÿå€º = èµ„äº§è´Ÿå€ºè¡¨[<span class="string">&#x27;æµåŠ¨è´Ÿå€º&#x27;</span>].iloc[-<span class="number">1</span>]</span><br><span class="line">    å­˜è´§ = èµ„äº§è´Ÿå€ºè¡¨[<span class="string">&#x27;å­˜è´§&#x27;</span>].iloc[-<span class="number">1</span>]</span><br><span class="line">    åº”æ”¶è´¦æ¬¾ = èµ„äº§è´Ÿå€ºè¡¨[<span class="string">&#x27;åº”æ”¶è´¦æ¬¾&#x27;</span>].iloc[-<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line">    è¥ä¸šæ”¶å…¥ = åˆ©æ¶¦è¡¨[<span class="string">&#x27;è¥ä¸šæ”¶å…¥&#x27;</span>].iloc[-<span class="number">1</span>]</span><br><span class="line">    è¥ä¸šæˆæœ¬ = åˆ©æ¶¦è¡¨[<span class="string">&#x27;è¥ä¸šæˆæœ¬&#x27;</span>].iloc[-<span class="number">1</span>]</span><br><span class="line">    å‡€åˆ©æ¶¦ = åˆ©æ¶¦è¡¨[<span class="string">&#x27;å‡€åˆ©æ¶¦&#x27;</span>].iloc[-<span class="number">1</span>]</span><br><span class="line">    åˆ©æ¯è´¹ç”¨ = åˆ©æ¶¦è¡¨.get(<span class="string">&#x27;åˆ©æ¯è´¹ç”¨&#x27;</span>, pd.Series([<span class="number">0</span>])).iloc[-<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è®¡ç®—è´¢åŠ¡æ¯”ç‡</span></span><br><span class="line">    è´¢åŠ¡æ¯”ç‡ = &#123;</span><br><span class="line">        <span class="comment"># å¿å€ºèƒ½åŠ›æ¯”ç‡</span></span><br><span class="line">        <span class="string">&quot;æµåŠ¨æ¯”ç‡&quot;</span>: æµåŠ¨èµ„äº§ / æµåŠ¨è´Ÿå€º <span class="keyword">if</span> æµåŠ¨è´Ÿå€º &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="literal">None</span>,</span><br><span class="line">        <span class="string">&quot;é€ŸåŠ¨æ¯”ç‡&quot;</span>: (æµåŠ¨èµ„äº§ - å­˜è´§) / æµåŠ¨è´Ÿå€º <span class="keyword">if</span> æµåŠ¨è´Ÿå€º &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="literal">None</span>,</span><br><span class="line">        <span class="string">&quot;èµ„äº§è´Ÿå€ºç‡&quot;</span>: æ€»è´Ÿå€º / æ€»èµ„äº§ <span class="keyword">if</span> æ€»èµ„äº§ &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="literal">None</span>,</span><br><span class="line">        <span class="string">&quot;æƒç›Šä¹˜æ•°&quot;</span>: æ€»èµ„äº§ / æ‰€æœ‰è€…æƒç›Š <span class="keyword">if</span> æ‰€æœ‰è€…æƒç›Š &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="literal">None</span>,</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è¥è¿èƒ½åŠ›æ¯”ç‡</span></span><br><span class="line">        <span class="string">&quot;åº”æ”¶è´¦æ¬¾å‘¨è½¬ç‡&quot;</span>: è¥ä¸šæ”¶å…¥ / åº”æ”¶è´¦æ¬¾ <span class="keyword">if</span> åº”æ”¶è´¦æ¬¾ &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="literal">None</span>,</span><br><span class="line">        <span class="string">&quot;å­˜è´§å‘¨è½¬ç‡&quot;</span>: è¥ä¸šæˆæœ¬ / å­˜è´§ <span class="keyword">if</span> å­˜è´§ &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="literal">None</span>,</span><br><span class="line">        <span class="string">&quot;æ€»èµ„äº§å‘¨è½¬ç‡&quot;</span>: è¥ä¸šæ”¶å…¥ / æ€»èµ„äº§ <span class="keyword">if</span> æ€»èµ„äº§ &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="literal">None</span>,</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç›ˆåˆ©èƒ½åŠ›æ¯”ç‡</span></span><br><span class="line">        <span class="string">&quot;é”€å”®å‡€åˆ©ç‡&quot;</span>: å‡€åˆ©æ¶¦ / è¥ä¸šæ”¶å…¥ <span class="keyword">if</span> è¥ä¸šæ”¶å…¥ &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="literal">None</span>,</span><br><span class="line">        <span class="string">&quot;èµ„äº§å‡€åˆ©ç‡&quot;</span>: å‡€åˆ©æ¶¦ / æ€»èµ„äº§ <span class="keyword">if</span> æ€»èµ„äº§ &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="literal">None</span>,</span><br><span class="line">        <span class="string">&quot;å‡€èµ„äº§æ”¶ç›Šç‡&quot;</span>: å‡€åˆ©æ¶¦ / æ‰€æœ‰è€…æƒç›Š <span class="keyword">if</span> æ‰€æœ‰è€…æƒç›Š &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="literal">None</span>,</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ æ†æ¯”ç‡</span></span><br><span class="line">        <span class="string">&quot;åˆ©æ¯ä¿éšœå€æ•°&quot;</span>: (å‡€åˆ©æ¶¦ + åˆ©æ¯è´¹ç”¨) / åˆ©æ¯è´¹ç”¨ <span class="keyword">if</span> åˆ©æ¯è´¹ç”¨ &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="literal">None</span>,</span><br><span class="line">        <span class="string">&quot;è´Ÿå€ºæƒç›Šæ¯”&quot;</span>: æ€»è´Ÿå€º / æ‰€æœ‰è€…æƒç›Š <span class="keyword">if</span> æ‰€æœ‰è€…æƒç›Š &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> è´¢åŠ¡æ¯”ç‡</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºç¤ºä¾‹è´¢åŠ¡æ•°æ®</span></span><br><span class="line">èµ„äº§è´Ÿå€ºè¡¨ = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;é¡¹ç›®&#x27;</span>: [<span class="string">&#x27;æµåŠ¨èµ„äº§&#x27;</span>, <span class="string">&#x27;éæµåŠ¨èµ„äº§&#x27;</span>, <span class="string">&#x27;æ€»èµ„äº§&#x27;</span>, <span class="string">&#x27;æµåŠ¨è´Ÿå€º&#x27;</span>, <span class="string">&#x27;éæµåŠ¨è´Ÿå€º&#x27;</span>, <span class="string">&#x27;æ€»è´Ÿå€º&#x27;</span>, <span class="string">&#x27;æ‰€æœ‰è€…æƒç›Š&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;2023å¹´æœ«&#x27;</span>: [<span class="number">500000</span>, <span class="number">800000</span>, <span class="number">1300000</span>, <span class="number">300000</span>, <span class="number">200000</span>, <span class="number">500000</span>, <span class="number">800000</span>],</span><br><span class="line">    <span class="string">&#x27;2024å¹´æœ«&#x27;</span>: [<span class="number">600000</span>, <span class="number">900000</span>, <span class="number">1500000</span>, <span class="number">350000</span>, <span class="number">250000</span>, <span class="number">600000</span>, <span class="number">900000</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">åˆ©æ¶¦è¡¨ = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;é¡¹ç›®&#x27;</span>: [<span class="string">&#x27;è¥ä¸šæ”¶å…¥&#x27;</span>, <span class="string">&#x27;è¥ä¸šæˆæœ¬&#x27;</span>, <span class="string">&#x27;è¥ä¸šåˆ©æ¶¦&#x27;</span>, <span class="string">&#x27;å‡€åˆ©æ¶¦&#x27;</span>, <span class="string">&#x27;åˆ©æ¯è´¹ç”¨&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;2024å¹´åº¦&#x27;</span>: [<span class="number">2000000</span>, <span class="number">1500000</span>, <span class="number">400000</span>, <span class="number">300000</span>, <span class="number">50000</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—è´¢åŠ¡æ¯”ç‡</span></span><br><span class="line">æ¯”ç‡ç»“æœ = è®¡ç®—è´¢åŠ¡æ¯”ç‡(èµ„äº§è´Ÿå€ºè¡¨, åˆ©æ¶¦è¡¨)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ğŸ“Š è´¢åŠ¡æ¯”ç‡åˆ†æç»“æœï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nå¿å€ºèƒ½åŠ›æ¯”ç‡ï¼š&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> æ¯”ç‡, æ•°å€¼ <span class="keyword">in</span> æ¯”ç‡ç»“æœ.items():</span><br><span class="line">    <span class="keyword">if</span> æ¯”ç‡ <span class="keyword">in</span> [<span class="string">&quot;æµåŠ¨æ¯”ç‡&quot;</span>, <span class="string">&quot;é€ŸåŠ¨æ¯”ç‡&quot;</span>, <span class="string">&quot;èµ„äº§è´Ÿå€ºç‡&quot;</span>, <span class="string">&quot;æƒç›Šä¹˜æ•°&quot;</span>] <span class="keyword">and</span> æ•°å€¼ <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;æ¯”ç‡&#125;</span>ï¼š<span class="subst">&#123;æ•°å€¼:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nè¥è¿èƒ½åŠ›æ¯”ç‡ï¼š&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> æ¯”ç‡, æ•°å€¼ <span class="keyword">in</span> æ¯”ç‡ç»“æœ.items():</span><br><span class="line">    <span class="keyword">if</span> æ¯”ç‡ <span class="keyword">in</span> [<span class="string">&quot;åº”æ”¶è´¦æ¬¾å‘¨è½¬ç‡&quot;</span>, <span class="string">&quot;å­˜è´§å‘¨è½¬ç‡&quot;</span>, <span class="string">&quot;æ€»èµ„äº§å‘¨è½¬ç‡&quot;</span>] <span class="keyword">and</span> æ•°å€¼ <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;æ¯”ç‡&#125;</span>ï¼š<span class="subst">&#123;æ•°å€¼:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nç›ˆåˆ©èƒ½åŠ›æ¯”ç‡ï¼š&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> æ¯”ç‡, æ•°å€¼ <span class="keyword">in</span> æ¯”ç‡ç»“æœ.items():</span><br><span class="line">    <span class="keyword">if</span> æ¯”ç‡ <span class="keyword">in</span> [<span class="string">&quot;é”€å”®å‡€åˆ©ç‡&quot;</span>, <span class="string">&quot;èµ„äº§å‡€åˆ©ç‡&quot;</span>, <span class="string">&quot;å‡€èµ„äº§æ”¶ç›Šç‡&quot;</span>] <span class="keyword">and</span> æ•°å€¼ <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;æ¯”ç‡&#125;</span>ï¼š<span class="subst">&#123;æ•°å€¼:<span class="number">.2</span>%&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¯”ç‡åˆ†æå’Œå»ºè®®</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;\nğŸ’¡ è´¢åŠ¡åˆ†æå»ºè®®ï¼š&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> æ¯”ç‡ç»“æœ[<span class="string">&#x27;æµåŠ¨æ¯”ç‡&#x27;</span>] <span class="keyword">and</span> æ¯”ç‡ç»“æœ[<span class="string">&#x27;æµåŠ¨æ¯”ç‡&#x27;</span>] &lt; <span class="number">1.5</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;âš ï¸ æµåŠ¨æ¯”ç‡åä½ï¼ŒçŸ­æœŸå¿å€ºèƒ½åŠ›éœ€è¦å…³æ³¨&quot;</span>)</span><br><span class="line"><span class="keyword">elif</span> æ¯”ç‡ç»“æœ[<span class="string">&#x27;æµåŠ¨æ¯”ç‡&#x27;</span>] <span class="keyword">and</span> æ¯”ç‡ç»“æœ[<span class="string">&#x27;æµåŠ¨æ¯”ç‡&#x27;</span>] &gt; <span class="number">3</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ğŸ’¡ æµåŠ¨æ¯”ç‡åé«˜ï¼Œå¯èƒ½å­˜åœ¨èµ„é‡‘é—²ç½®&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> æ¯”ç‡ç»“æœ[<span class="string">&#x27;èµ„äº§è´Ÿå€ºç‡&#x27;</span>] <span class="keyword">and</span> æ¯”ç‡ç»“æœ[<span class="string">&#x27;èµ„äº§è´Ÿå€ºç‡&#x27;</span>] &gt; <span class="number">0.7</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;âš ï¸ èµ„äº§è´Ÿå€ºç‡åé«˜ï¼Œè´¢åŠ¡é£é™©è¾ƒå¤§&quot;</span>)</span><br><span class="line"><span class="keyword">elif</span> æ¯”ç‡ç»“æœ[<span class="string">&#x27;èµ„äº§è´Ÿå€ºç‡&#x27;</span>] <span class="keyword">and</span> æ¯”ç‡ç»“æœ[<span class="string">&#x27;èµ„äº§è´Ÿå€ºç‡&#x27;</span>] &lt; <span class="number">0.3</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ğŸ’¡ èµ„äº§è´Ÿå€ºç‡åä½ï¼Œå¯ä»¥è€ƒè™‘é€‚å½“å¢åŠ æ æ†&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> æ¯”ç‡ç»“æœ[<span class="string">&#x27;å‡€èµ„äº§æ”¶ç›Šç‡&#x27;</span>] <span class="keyword">and</span> æ¯”ç‡ç»“æœ[<span class="string">&#x27;å‡€èµ„äº§æ”¶ç›Šç‡&#x27;</span>] &gt; <span class="number">0.15</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;âœ… å‡€èµ„äº§æ”¶ç›Šç‡è‰¯å¥½ï¼Œè‚¡ä¸œå›æŠ¥è¾ƒé«˜&quot;</span>)</span><br><span class="line"><span class="keyword">elif</span> æ¯”ç‡ç»“æœ[<span class="string">&#x27;å‡€èµ„äº§æ”¶ç›Šç‡&#x27;</span>] <span class="keyword">and</span> æ¯”ç‡ç»“æœ[<span class="string">&#x27;å‡€èµ„äº§æ”¶ç›Šç‡&#x27;</span>] &lt; <span class="number">0.1</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;âš ï¸ å‡€èµ„äº§æ”¶ç›Šç‡åä½ï¼Œç›ˆåˆ©èƒ½åŠ›éœ€è¦æå‡&quot;</span>)</span><br></pre></td></tr></table></figure></details><details><summary>æŒ‘æˆ˜2ï¼šé¢„ç®—å·®å¼‚åˆ†æ</summary><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é¢„ç®—å·®å¼‚åˆ†æç³»ç»Ÿ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=== é¢„ç®—å·®å¼‚åˆ†æç³»ç»Ÿ ===&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">é¢„ç®—å·®å¼‚åˆ†æ</span>(<span class="params">å®é™…æ•°æ®, é¢„ç®—æ•°æ®, åˆ†æç»´åº¦=[<span class="string">&#x27;éƒ¨é—¨&#x27;</span>, <span class="string">&#x27;é¡¹ç›®&#x27;</span>]</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    åˆ†æå®é™…æ•°æ®ä¸é¢„ç®—æ•°æ®çš„å·®å¼‚</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    å‚æ•°ï¼š</span></span><br><span class="line"><span class="string">    å®é™…æ•°æ®ï¼šå®é™…å‘ç”Ÿçš„æ•°æ®DataFrame</span></span><br><span class="line"><span class="string">    é¢„ç®—æ•°æ®ï¼šé¢„ç®—æ•°æ®DataFrame</span></span><br><span class="line"><span class="string">    åˆ†æç»´åº¦ï¼šæŒ‰å“ªäº›ç»´åº¦è¿›è¡Œåˆ†æ</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    è¿”å›ï¼š</span></span><br><span class="line"><span class="string">    å·®å¼‚åˆ†æç»“æœ</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ç¡®ä¿æ•°æ®æ ¼å¼ä¸€è‡´</span></span><br><span class="line">    å®é™…æ•°æ® = å®é™…æ•°æ®.copy()</span><br><span class="line">    é¢„ç®—æ•°æ® = é¢„ç®—æ•°æ®.copy()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æŒ‰åˆ†æç»´åº¦æ±‡æ€»</span></span><br><span class="line">    å®é™…æ±‡æ€» = å®é™…æ•°æ®.groupby(åˆ†æç»´åº¦)[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">sum</span>().reset_index()</span><br><span class="line">    å®é™…æ±‡æ€».columns = åˆ†æç»´åº¦ + [<span class="string">&#x27;å®é™…é‡‘é¢&#x27;</span>]</span><br><span class="line">    </span><br><span class="line">    é¢„ç®—æ±‡æ€» = é¢„ç®—æ•°æ®.groupby(åˆ†æç»´åº¦)[<span class="string">&#x27;é‡‘é¢&#x27;</span>].<span class="built_in">sum</span>().reset_index()</span><br><span class="line">    é¢„ç®—æ±‡æ€».columns = åˆ†æç»´åº¦ + [<span class="string">&#x27;é¢„ç®—é‡‘é¢&#x27;</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åˆå¹¶æ•°æ®</span></span><br><span class="line">    å·®å¼‚åˆ†æ = pd.merge(å®é™…æ±‡æ€», é¢„ç®—æ±‡æ€», on=åˆ†æç»´åº¦, how=<span class="string">&#x27;outer&#x27;</span>).fillna(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è®¡ç®—å·®å¼‚</span></span><br><span class="line">    å·®å¼‚åˆ†æ[<span class="string">&#x27;å·®å¼‚é‡‘é¢&#x27;</span>] = å·®å¼‚åˆ†æ[<span class="string">&#x27;å®é™…é‡‘é¢&#x27;</span>] - å·®å¼‚åˆ†æ[<span class="string">&#x27;é¢„ç®—é‡‘é¢&#x27;</span>]</span><br><span class="line">    å·®å¼‚åˆ†æ[<span class="string">&#x27;å·®å¼‚ç‡&#x27;</span>] = å·®å¼‚åˆ†æ[<span class="string">&#x27;å·®å¼‚é‡‘é¢&#x27;</span>] / (å·®å¼‚åˆ†æ[<span class="string">&#x27;é¢„ç®—é‡‘é¢&#x27;</span>] + <span class="number">1e-10</span>) * <span class="number">100</span>  <span class="comment"># åŠ å°å€¼é¿å…é™¤é›¶</span></span><br><span class="line">    å·®å¼‚åˆ†æ[<span class="string">&#x27;å®Œæˆç‡&#x27;</span>] = å·®å¼‚åˆ†æ[<span class="string">&#x27;å®é™…é‡‘é¢&#x27;</span>] / (å·®å¼‚åˆ†æ[<span class="string">&#x27;é¢„ç®—é‡‘é¢&#x27;</span>] + <span class="number">1e-10</span>) * <span class="number">100</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å·®å¼‚åˆ†çº§</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">å·®å¼‚åˆ†çº§</span>(<span class="params">å·®å¼‚ç‡</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">abs</span>(å·®å¼‚ç‡) &lt;= <span class="number">5</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;æ­£å¸¸&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">abs</span>(å·®å¼‚ç‡) &lt;= <span class="number">10</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;è½»å¾®å·®å¼‚&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">abs</span>(å·®å¼‚ç‡) &lt;= <span class="number">20</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;æ˜¾è‘—å·®å¼‚&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;é‡å¤§å·®å¼‚&quot;</span></span><br><span class="line">    </span><br><span class="line">    å·®å¼‚åˆ†æ[<span class="string">&#x27;å·®å¼‚çº§åˆ«&#x27;</span>] = å·®å¼‚åˆ†æ[<span class="string">&#x27;å·®å¼‚ç‡&#x27;</span>].apply(å·®å¼‚åˆ†çº§)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> å·®å¼‚åˆ†æ</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ç”Ÿæˆé¢„ç®—åˆ†ææŠ¥å‘Š</span>(<span class="params">å·®å¼‚åˆ†æç»“æœ, æ–‡ä»¶å=<span class="string">&quot;é¢„ç®—å·®å¼‚åˆ†ææŠ¥å‘Š.xlsx&quot;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ç”Ÿæˆé¢„ç®—å·®å¼‚åˆ†ææŠ¥å‘Š&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åˆ›å»ºExcelå·¥ä½œç°¿</span></span><br><span class="line">    wb = Workbook()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 1. å·®å¼‚æ±‡æ€»è¡¨</span></span><br><span class="line">    æ±‡æ€»è¡¨ = wb.active</span><br><span class="line">    æ±‡æ€»è¡¨.title = <span class="string">&quot;é¢„ç®—å·®å¼‚æ±‡æ€»&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ ‡é¢˜</span></span><br><span class="line">    æ±‡æ€»è¡¨[<span class="string">&quot;A1&quot;</span>] = <span class="string">&quot;é¢„ç®—å·®å¼‚åˆ†ææŠ¥å‘Š&quot;</span></span><br><span class="line">    æ±‡æ€»è¡¨[<span class="string">&quot;A1&quot;</span>].font = Font(size=<span class="number">16</span>, bold=<span class="literal">True</span>)</span><br><span class="line">    æ±‡æ€»è¡¨.merge_cells(<span class="string">&quot;A1:F1&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å†™å…¥å·®å¼‚æ•°æ®</span></span><br><span class="line">    è¡¨å¤´ = [<span class="string">&#x27;éƒ¨é—¨&#x27;</span>, <span class="string">&#x27;é¡¹ç›®&#x27;</span>, <span class="string">&#x27;å®é™…é‡‘é¢&#x27;</span>, <span class="string">&#x27;é¢„ç®—é‡‘é¢&#x27;</span>, <span class="string">&#x27;å·®å¼‚é‡‘é¢&#x27;</span>, <span class="string">&#x27;å·®å¼‚ç‡&#x27;</span>, <span class="string">&#x27;å®Œæˆç‡&#x27;</span>, <span class="string">&#x27;å·®å¼‚çº§åˆ«&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> åˆ—å·, æ ‡é¢˜ <span class="keyword">in</span> <span class="built_in">enumerate</span>(è¡¨å¤´, <span class="number">1</span>):</span><br><span class="line">        å•å…ƒæ ¼ = æ±‡æ€»è¡¨.cell(row=<span class="number">3</span>, column=åˆ—å·, value=æ ‡é¢˜)</span><br><span class="line">        å•å…ƒæ ¼.font = Font(bold=<span class="literal">True</span>)</span><br><span class="line">        å•å…ƒæ ¼.fill = PatternFill(start_color=<span class="string">&quot;E8F4FD&quot;</span>, end_color=<span class="string">&quot;E8F4FD&quot;</span>, fill_type=<span class="string">&quot;solid&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> è¡Œå·, (_, æ•°æ®) <span class="keyword">in</span> <span class="built_in">enumerate</span>(å·®å¼‚åˆ†æç»“æœ.iterrows(), <span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> åˆ—å·, åˆ—å <span class="keyword">in</span> <span class="built_in">enumerate</span>(è¡¨å¤´, <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> åˆ—å == <span class="string">&#x27;å·®å¼‚ç‡&#x27;</span> <span class="keyword">or</span> åˆ—å == <span class="string">&#x27;å®Œæˆç‡&#x27;</span>:</span><br><span class="line">                å€¼ = <span class="string">f&quot;<span class="subst">&#123;æ•°æ®[åˆ—å]:<span class="number">.1</span>f&#125;</span>%&quot;</span></span><br><span class="line">            <span class="keyword">elif</span> <span class="string">&#x27;é‡‘é¢&#x27;</span> <span class="keyword">in</span> åˆ—å:</span><br><span class="line">                å€¼ = <span class="string">f&quot;<span class="subst">&#123;æ•°æ®[åˆ—å]:,<span class="number">.2</span>f&#125;</span>&quot;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                å€¼ = æ•°æ®[åˆ—å]</span><br><span class="line">            æ±‡æ€»è¡¨.cell(row=è¡Œå·, column=åˆ—å·, value=å€¼)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. å·®å¼‚åˆ†çº§ç»Ÿè®¡</span></span><br><span class="line">    åˆ†çº§ç»Ÿè®¡ = å·®å¼‚åˆ†æç»“æœ.groupby(<span class="string">&#x27;å·®å¼‚çº§åˆ«&#x27;</span>).agg(&#123;</span><br><span class="line">        <span class="string">&#x27;å·®å¼‚é‡‘é¢&#x27;</span>: [<span class="string">&#x27;count&#x27;</span>, <span class="string">&#x27;sum&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;å·®å¼‚ç‡&#x27;</span>: <span class="string">&#x27;mean&#x27;</span></span><br><span class="line">    &#125;).<span class="built_in">round</span>(<span class="number">2</span>)</span><br><span class="line">    </span><br><span class="line">    ç»Ÿè®¡è¡¨ = wb.create_sheet(<span class="string">&quot;å·®å¼‚åˆ†çº§ç»Ÿè®¡&quot;</span>)</span><br><span class="line">    ç»Ÿè®¡è¡¨[<span class="string">&quot;A1&quot;</span>] = <span class="string">&quot;å·®å¼‚åˆ†çº§ç»Ÿè®¡&quot;</span></span><br><span class="line">    ç»Ÿè®¡è¡¨[<span class="string">&quot;A1&quot;</span>].font = Font(size=<span class="number">14</span>, bold=<span class="literal">True</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å†™å…¥ç»Ÿè®¡ç»“æœ</span></span><br><span class="line">    è¡¨å¤´ = [<span class="string">&#x27;å·®å¼‚çº§åˆ«&#x27;</span>, <span class="string">&#x27;æ•°é‡&#x27;</span>, <span class="string">&#x27;æ¶‰åŠé‡‘é¢&#x27;</span>, <span class="string">&#x27;å¹³å‡å·®å¼‚ç‡&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> åˆ—å·, æ ‡é¢˜ <span class="keyword">in</span> <span class="built_in">enumerate</span>(è¡¨å¤´, <span class="number">1</span>):</span><br><span class="line">        å•å…ƒæ ¼ = ç»Ÿè®¡è¡¨.cell(row=<span class="number">3</span>, column=åˆ—å·, value=æ ‡é¢˜)</span><br><span class="line">        å•å…ƒæ ¼.font = Font(bold=<span class="literal">True</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> è¡Œå·, (çº§åˆ«, æ•°æ®) <span class="keyword">in</span> <span class="built_in">enumerate</span>(åˆ†çº§ç»Ÿè®¡.iterrows(), <span class="number">4</span>):</span><br><span class="line">        ç»Ÿè®¡è¡¨.cell(row=è¡Œå·, column=<span class="number">1</span>, value=çº§åˆ«)</span><br><span class="line">        ç»Ÿè®¡è¡¨.cell(row=è¡Œå·, column=<span class="number">2</span>, value=æ•°æ®[(<span class="string">&#x27;å·®å¼‚é‡‘é¢&#x27;</span>, <span class="string">&#x27;count&#x27;</span>)])</span><br><span class="line">        ç»Ÿè®¡è¡¨.cell(row=è¡Œå·, column=<span class="number">3</span>, value=<span class="string">f&quot;<span class="subst">&#123;æ•°æ®[(<span class="string">&#x27;å·®å¼‚é‡‘é¢&#x27;</span>, <span class="string">&#x27;sum&#x27;</span>)]:,<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line">        ç»Ÿè®¡è¡¨.cell(row=è¡Œå·, column=<span class="number">4</span>, value=<span class="string">f&quot;<span class="subst">&#123;æ•°æ®[(<span class="string">&#x27;å·®å¼‚ç‡&#x27;</span>, <span class="string">&#x27;mean&#x27;</span>)]:<span class="number">.1</span>f&#125;</span>%&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. ä¸»è¦å·®å¼‚é¡¹ç›®</span></span><br><span class="line">    é‡å¤§å·®å¼‚ = å·®å¼‚åˆ†æç»“æœ[å·®å¼‚åˆ†æç»“æœ[<span class="string">&#x27;å·®å¼‚çº§åˆ«&#x27;</span>].isin([<span class="string">&#x27;æ˜¾è‘—å·®å¼‚&#x27;</span>, <span class="string">&#x27;é‡å¤§å·®å¼‚&#x27;</span>])]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(é‡å¤§å·®å¼‚) &gt; <span class="number">0</span>:</span><br><span class="line">        é‡å¤§å·®å¼‚ = é‡å¤§å·®å¼‚.sort_values(<span class="string">&#x27;å·®å¼‚é‡‘é¢&#x27;</span>, key=<span class="built_in">abs</span>, ascending=<span class="literal">False</span>)</span><br><span class="line">        </span><br><span class="line">        å·®å¼‚è¡¨ = wb.create_sheet(<span class="string">&quot;ä¸»è¦å·®å¼‚é¡¹ç›®&quot;</span>)</span><br><span class="line">        å·®å¼‚è¡¨[<span class="string">&quot;A1&quot;</span>] = <span class="string">&quot;ä¸»è¦å·®å¼‚é¡¹ç›®ï¼ˆå·®å¼‚é‡‘é¢å‰10ï¼‰&quot;</span></span><br><span class="line">        å·®å¼‚è¡¨[<span class="string">&quot;A1&quot;</span>].font = Font(size=<span class="number">14</span>, bold=<span class="literal">True</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å†™å…¥é‡å¤§å·®å¼‚é¡¹ç›®</span></span><br><span class="line">        è¡¨å¤´ = [<span class="string">&#x27;éƒ¨é—¨&#x27;</span>, <span class="string">&#x27;é¡¹ç›®&#x27;</span>, <span class="string">&#x27;å·®å¼‚é‡‘é¢&#x27;</span>, <span class="string">&#x27;å·®å¼‚ç‡&#x27;</span>, <span class="string">&#x27;å¯èƒ½åŸå› &#x27;</span>]</span><br><span class="line">        <span class="keyword">for</span> åˆ—å·, æ ‡é¢˜ <span class="keyword">in</span> <span class="built_in">enumerate</span>(è¡¨å¤´, <span class="number">1</span>):</span><br><span class="line">            å•å…ƒæ ¼ = å·®å¼‚è¡¨.cell(row=<span class="number">3</span>, column=åˆ—å·, value=æ ‡é¢˜)</span><br><span class="line">            å•å…ƒæ ¼.font = Font(bold=<span class="literal">True</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> è¡Œå·, (_, æ•°æ®) <span class="keyword">in</span> <span class="built_in">enumerate</span>(é‡å¤§å·®å¼‚.head(<span class="number">10</span>).iterrows(), <span class="number">4</span>):</span><br><span class="line">            å·®å¼‚è¡¨.cell(row=è¡Œå·, column=<span class="number">1</span>, value=æ•°æ®[<span class="string">&#x27;éƒ¨é—¨&#x27;</span>])</span><br><span class="line">            å·®å¼‚è¡¨.cell(row=è¡Œå·, column=<span class="number">2</span>, value=æ•°æ®[<span class="string">&#x27;é¡¹ç›®&#x27;</span>])</span><br><span class="line">            å·®å¼‚è¡¨.cell(row=è¡Œå·, column=<span class="number">3</span>, value=<span class="string">f&quot;<span class="subst">&#123;æ•°æ®[<span class="string">&#x27;å·®å¼‚é‡‘é¢&#x27;</span>]:,<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line">            å·®å¼‚è¡¨.cell(row=è¡Œå·, column=<span class="number">4</span>, value=<span class="string">f&quot;<span class="subst">&#123;æ•°æ®[<span class="string">&#x27;å·®å¼‚ç‡&#x27;</span>]:<span class="number">.1</span>f&#125;</span>%&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æ ¹æ®å·®å¼‚ç‡åˆ¤æ–­å¯èƒ½åŸå› </span></span><br><span class="line">            <span class="keyword">if</span> æ•°æ®[<span class="string">&#x27;å·®å¼‚ç‡&#x27;</span>] &gt; <span class="number">50</span>:</span><br><span class="line">                åŸå›  = <span class="string">&quot;è¿œè¶…é¢„ç®—ï¼Œå¯èƒ½é¢„ç®—åä½æˆ–å®é™…æƒ…å†µå˜åŒ–&quot;</span></span><br><span class="line">            <span class="keyword">elif</span> æ•°æ®[<span class="string">&#x27;å·®å¼‚ç‡&#x27;</span>] &gt; <span class="number">20</span>:</span><br><span class="line">                åŸå›  = <span class="string">&quot;æ˜¾è‘—è¶…å‡ºé¢„ç®—ï¼Œéœ€è¦è¯¦ç»†åˆ†æåŸå› &quot;</span></span><br><span class="line">            <span class="keyword">elif</span> æ•°æ®[<span class="string">&#x27;å·®å¼‚ç‡&#x27;</span>] &lt; -<span class="number">50</span>:</span><br><span class="line">                åŸå›  = <span class="string">&quot;è¿œæœªè¾¾é¢„ç®—ï¼Œå¯èƒ½é¢„ç®—è¿‡é«˜æˆ–æ‰§è¡Œä¸åŠ›&quot;</span></span><br><span class="line">            <span class="keyword">elif</span> æ•°æ®[<span class="string">&#x27;å·®å¼‚ç‡&#x27;</span>] &lt; -<span class="number">20</span>:</span><br><span class="line">                åŸå›  = <span class="string">&quot;æ˜¾è‘—ä½äºé¢„ç®—ï¼Œéœ€è¦å…³æ³¨æ‰§è¡Œæƒ…å†µ&quot;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                åŸå›  = <span class="string">&quot;å·®å¼‚åœ¨æ­£å¸¸èŒƒå›´å†…&quot;</span></span><br><span class="line">            </span><br><span class="line">            å·®å¼‚è¡¨.cell(row=è¡Œå·, column=<span class="number">5</span>, value=åŸå› )</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ä¿å­˜æ–‡ä»¶</span></span><br><span class="line">    wb.save(æ–‡ä»¶å)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;âœ… é¢„ç®—å·®å¼‚åˆ†ææŠ¥å‘Šå·²ç”Ÿæˆï¼š<span class="subst">&#123;æ–‡ä»¶å&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> æ–‡ä»¶å</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºç¤ºä¾‹é¢„ç®—æ•°æ®</span></span><br><span class="line">å®é™…æ•°æ® = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;éƒ¨é—¨&#x27;</span>: [<span class="string">&#x27;é”€å”®éƒ¨&#x27;</span>, <span class="string">&#x27;é”€å”®éƒ¨&#x27;</span>, <span class="string">&#x27;å¸‚åœºéƒ¨&#x27;</span>, <span class="string">&#x27;å¸‚åœºéƒ¨&#x27;</span>, <span class="string">&#x27;æŠ€æœ¯éƒ¨&#x27;</span>, <span class="string">&#x27;æŠ€æœ¯éƒ¨&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;é¡¹ç›®&#x27;</span>: [<span class="string">&#x27;å·®æ—…è´¹&#x27;</span>, <span class="string">&#x27;æ‹›å¾…è´¹&#x27;</span>, <span class="string">&#x27;å¹¿å‘Šè´¹&#x27;</span>, <span class="string">&#x27;æ¨å¹¿è´¹&#x27;</span>, <span class="string">&#x27;è®¾å¤‡è´¹&#x27;</span>, <span class="string">&#x27;åŸ¹è®­è´¹&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;é‡‘é¢&#x27;</span>: [<span class="number">25000</span>, <span class="number">15000</span>, <span class="number">80000</span>, <span class="number">60000</span>, <span class="number">120000</span>, <span class="number">25000</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">é¢„ç®—æ•°æ® = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;éƒ¨é—¨&#x27;</span>: [<span class="string">&#x27;é”€å”®éƒ¨&#x27;</span>, <span class="string">&#x27;é”€å”®éƒ¨&#x27;</span>, <span class="string">&#x27;å¸‚åœºéƒ¨&#x27;</span>, <span class="string">&#x27;å¸‚åœºéƒ¨&#x27;</span>, <span class="string">&#x27;æŠ€æœ¯éƒ¨&#x27;</span>, <span class="string">&#x27;æŠ€æœ¯éƒ¨&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;é¡¹ç›®&#x27;</span>: [<span class="string">&#x27;å·®æ—…è´¹&#x27;</span>, <span class="string">&#x27;æ‹›å¾…è´¹&#x27;</span>, <span class="string">&#x27;å¹¿å‘Šè´¹&#x27;</span>, <span class="string">&#x27;æ¨å¹¿è´¹&#x27;</span>, <span class="string">&#x27;è®¾å¤‡è´¹&#x27;</span>, <span class="string">&#x27;åŸ¹è®­è´¹&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;é‡‘é¢&#x27;</span>: [<span class="number">20000</span>, <span class="number">18000</span>, <span class="number">60000</span>, <span class="number">50000</span>, <span class="number">100000</span>, <span class="number">30000</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œé¢„ç®—å·®å¼‚åˆ†æ</span></span><br><span class="line">å·®å¼‚ç»“æœ = é¢„ç®—å·®å¼‚åˆ†æ(å®é™…æ•°æ®, é¢„ç®—_data)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ğŸ“Š é¢„ç®—å·®å¼‚åˆ†æç»“æœï¼š&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(å·®å¼‚ç»“æœ)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆåˆ†ææŠ¥å‘Š</span></span><br><span class="line">é¢„ç®—æŠ¥å‘Š = ç”Ÿæˆé¢„ç®—åˆ†ææŠ¥å‘Š(å·®å¼‚ç»“æœ, <span class="string">&quot;é¢„ç®—å·®å¼‚åˆ†ææŠ¥å‘Š.xlsx&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ†æå»ºè®®</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;\nğŸ’¡ é¢„ç®—ç®¡ç†å»ºè®®ï¼š&quot;</span>)</span><br><span class="line"></span><br><span class="line">é‡å¤§å·®å¼‚æ•°é‡ = <span class="built_in">len</span>(å·®å¼‚ç»“æœ[å·®å¼‚ç»“æœ[<span class="string">&#x27;å·®å¼‚çº§åˆ«&#x27;</span>].isin([<span class="string">&#x27;æ˜¾è‘—å·®å¼‚&#x27;</span>, <span class="string">&#x27;é‡å¤§å·®å¼‚&#x27;</span>])])</span><br><span class="line"><span class="keyword">if</span> é‡å¤§å·®å¼‚æ•°é‡ &gt; <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;âš ï¸ å‘ç°<span class="subst">&#123;é‡å¤§å·®å¼‚æ•°é‡&#125;</span>ä¸ªé‡å¤§å·®å¼‚é¡¹ç›®ï¼Œéœ€è¦é‡ç‚¹å…³æ³¨&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å»ºè®®ï¼š&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;1. å¯¹é‡å¤§å·®å¼‚é¡¹ç›®è¿›è¡Œè¯¦ç»†è°ƒæŸ¥&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;2. åˆ†æå·®å¼‚äº§ç”Ÿçš„åŸå› &quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;3. æ ¹æ®åˆ†æç»“æœè°ƒæ•´ä¸‹æœŸé¢„ç®—&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;4. åŠ å¼ºé¢„ç®—æ‰§è¡Œç›‘æ§&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;âœ… é¢„ç®—æ‰§è¡Œæƒ…å†µè‰¯å¥½ï¼Œå·®å¼‚éƒ½åœ¨æ­£å¸¸èŒƒå›´å†…&quot;</span>)</span><br><span class="line"></span><br><span class="line">è¶…é¢„ç®—é¡¹ç›® = å·®å¼‚ç»“æœ[å·®å¼‚ç»“æœ[<span class="string">&#x27;å·®å¼‚é‡‘é¢&#x27;</span>] &gt; <span class="number">0</span>]</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(è¶…é¢„ç®—é¡¹ç›®) &gt; <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ“ˆ è¶…é¢„ç®—é¡¹ç›®ï¼š<span class="subst">&#123;<span class="built_in">len</span>(è¶…é¢„ç®—é¡¹ç›®)&#125;</span>ä¸ª&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å»ºè®®åŠ å¼ºæˆæœ¬æ§åˆ¶å’Œé¢„ç®—ç®¡ç†&quot;</span>)</span><br><span class="line"></span><br><span class="line">ä½é¢„ç®—é¡¹ç›® = å·®å¼‚ç»“æœ[å·®å¼‚ç»“æœ[<span class="string">&#x27;å·®å¼‚é‡‘é¢&#x27;</span>] &lt; <span class="number">0</span>]</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(ä½é¢„ç®—é¡¹ç›®) &gt; <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ“‰ ä½é¢„ç®—é¡¹ç›®ï¼š<span class="subst">&#123;<span class="built_in">len</span>(ä½é¢„ç®—é¡¹ç›®)&#125;</span>ä¸ª&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å»ºè®®åˆ†ææ˜¯å¦é¢„ç®—åˆ¶å®šè¿‡é«˜æˆ–æ‰§è¡Œä¸åŠ›&quot;</span>)</span><br></pre></td></tr></table></figure></details><hr><h3 id="ğŸ’­-ä»Šæ—¥æ€è€ƒ"><a href="#ğŸ’­-ä»Šæ—¥æ€è€ƒ" class="headerlink" title="ğŸ’­ ä»Šæ—¥æ€è€ƒ"></a>ğŸ’­ ä»Šæ—¥æ€è€ƒ</h3><p>é€šè¿‡ä»Šå¤©çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å‘ç°ï¼š</p><ul><li>pandasçš„DataFrameå°±æ˜¯Excelè¡¨æ ¼çš„â€è¶…çº§å‡çº§ç‰ˆâ€</li><li>æ•°æ®ç­›é€‰æ¯”Excelçš„è‡ªåŠ¨ç­›é€‰æ›´çµæ´»ã€æ›´å¼ºå¤§</li><li>åˆ†ç»„ç»Ÿè®¡æ¯”æ•°æ®é€è§†è¡¨æ›´å¿«ã€æ›´ç›´è§‚</li><li>ç”¨pandasåšè´¢åŠ¡åˆ†æï¼Œæ•ˆç‡æå‡æ˜¯æ•°é‡çº§çš„</li></ul><hr><h3 id="ğŸ“-è¯¾åå°ç»“"><a href="#ğŸ“-è¯¾åå°ç»“" class="headerlink" title="ğŸ“ è¯¾åå°ç»“"></a>ğŸ“ è¯¾åå°ç»“</h3><ul><li>âœ… ç†è§£äº†DataFrameçš„æ¦‚å¿µå’Œç”¨é€”</li><li>âœ… æŒæ¡äº†æ•°æ®ç­›é€‰çš„å„ç§æ–¹æ³•</li><li>âœ… å­¦ä¼šäº†åˆ†ç»„ç»Ÿè®¡å’Œäº¤å‰åˆ†æ</li><li>âœ… å®Œæˆäº†ä¸“ä¸šçº§çš„é”€å”®æ•°æ®åˆ†æ</li></ul><hr><h3 id="ğŸ¯-ä¸‹èŠ‚é¢„å‘Š"><a href="#ğŸ¯-ä¸‹èŠ‚é¢„å‘Š" class="headerlink" title="ğŸ¯ ä¸‹èŠ‚é¢„å‘Š"></a>ğŸ¯ ä¸‹èŠ‚é¢„å‘Š</h3><p>ä¸‹èŠ‚æˆ‘ä»¬å°†å­¦ä¹ <strong>æ•°æ®æ¸…æ´—ï¼šè®©è„æ•°æ®å˜å¹²å‡€</strong>ï¼Œå­¦ä¼šå¤„ç†ç°å®ä¸–ç•Œä¸­é‚£äº›â€œä¸å®Œç¾â€çš„æ•°æ®â€”â€”ç¼ºå¤±å€¼ã€é‡å¤å€¼ã€æ ¼å¼é”™è¯¯ï¼Œè®©pandaså¸®ä½ æŠŠâ€œè„æ•°æ®â€å˜æˆâ€œå¹²å‡€æ•°æ®â€ï¼</p><hr><h3 id="ğŸ’¡-å°è´´å£«"><a href="#ğŸ’¡-å°è´´å£«" class="headerlink" title="ğŸ’¡ å°è´´å£«"></a>ğŸ’¡ å°è´´å£«</h3><ul><li>DataFrameæ˜¯pandasçš„æ ¸å¿ƒï¼Œå¤šç»ƒä¹ åˆ›å»ºå’Œæ“ä½œ</li><li>æ•°æ®ç­›é€‰æ¡ä»¶è¦ç”¨æ‹¬å·æ‹¬èµ·æ¥ï¼Œå¤šä¸ªæ¡ä»¶ç”¨ <code>&amp;</code> æˆ– <code>|</code> è¿æ¥</li><li>groupbyæ˜¯è´¢åŠ¡åˆ†æçš„åˆ©å™¨ï¼Œè¦ç†Ÿç»ƒæŒæ¡</li><li>å¤šç»ƒä¹ çœŸå®æ•°æ®çš„åˆ†æï¼Œç†è®ºç»“åˆå®è·µ</li></ul><hr><blockquote><p>ğŸ¤– Powered by Kimi K2 0905 ğŸ’» å†…å®¹ç»è‘µè‘µğŸŒ»å®¡æ ¸ä¸ä¿®æ”¹</p></blockquote><hr></div><footer class="post-footer"><div class="post-nav"><div class="post-nav-item"><a href="/c0084aa4.html" rel="prev" title="Python-ç¬¬8ç¯‡ã€Šæ–‡ä»¶æ“ä½œï¼šè®©Pythonè¯»å†™Excelã€‹"><i class="fa fa-chevron-left"></i> Python-ç¬¬8ç¯‡ã€Šæ–‡ä»¶æ“ä½œï¼šè®©Pythonè¯»å†™Excelã€‹</a></div><div class="post-nav-item"><a href="/805a0f35.html" rel="next" title="Python-ç¬¬10ç¯‡ã€Šæ•°æ®æ¸…æ´—ï¼šè®©è„æ•°æ®å˜å¹²å‡€ã€‹">Python-ç¬¬10ç¯‡ã€Šæ•°æ®æ¸…æ´—ï¼šè®©è„æ•°æ®å˜å¹²å‡€ã€‹ <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="valine-comments"></div><script>window.addEventListener("tabs:register",()=>{let t=CONFIG.comments["activeClass"];var e;(t=CONFIG.comments.storage?localStorage.getItem("comments_active")||t:t)&&(e=document.querySelector(`a[href="#comment-${t}"]`))&&e.click()}),CONFIG.comments.storage&&window.addEventListener("tabs:click",t=>{t.target.matches(".tabs-comment .tab-content .tab-pane")&&(t=t.target.classList[1],localStorage.setItem("comments_active",t))})</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">æ–‡ç« ç›®å½•</li><li class="sidebar-nav-overview">ç«™ç‚¹æ¦‚è§ˆ</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%93%96-%E5%BC%80%E7%AF%87%E8%AF%AD"><span class="nav-number">1.</span> <span class="nav-text">ğŸ“– å¼€ç¯‡è¯­</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%8E%AF-%E4%BB%8A%E6%97%A5%E5%AD%A6%E4%B9%A0%E7%9B%AE%E6%A0%87"><span class="nav-number">2.</span> <span class="nav-text">ğŸ¯ ä»Šæ—¥å­¦ä¹ ç›®æ ‡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%90%BC-%E4%BB%80%E4%B9%88%E6%98%AFpandas%EF%BC%9F"><span class="nav-number">3.</span> <span class="nav-text">ğŸ¼ ä»€ä¹ˆæ˜¯pandasï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%93%8A-DataFrame%EF%BC%9AExcel%E8%A1%A8%E6%A0%BC%E7%9A%84%E5%8D%87%E7%BA%A7%E7%89%88"><span class="nav-number">4.</span> <span class="nav-text">ğŸ“Š DataFrameï¼šExcelè¡¨æ ¼çš„å‡çº§ç‰ˆ</span></a></li></ol><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%83%B3%E8%B1%A1Excel%E5%B7%A5%E4%BD%9C%E8%A1%A8%EF%BC%9A-%E6%9C%89%E8%A1%8C%E5%8F%B7%EF%BC%881-2-3%E2%80%A6%EF%BC%89-%E6%9C%89%E5%88%97%E5%90%8D%EF%BC%88A-B-C%E2%80%A6%E6%88%96%E8%87%AA%E5%AE%9A%E4%B9%89%EF%BC%89-%E6%AF%8F%E4%B8%AA%E6%A0%BC%E5%AD%90%E6%9C%89%E6%95%B0%E6%8D%AE"><span class="nav-number"></span> <span class="nav-text">æƒ³è±¡Excelå·¥ä½œè¡¨ï¼š- æœ‰è¡Œå·ï¼ˆ1,2,3â€¦ï¼‰- æœ‰åˆ—åï¼ˆA,B,Câ€¦æˆ–è‡ªå®šä¹‰ï¼‰- æ¯ä¸ªæ ¼å­æœ‰æ•°æ®</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%94%8D-%E6%95%B0%E6%8D%AE%E7%AD%9B%E9%80%89%EF%BC%9A%E6%AF%94Excel%E7%AD%9B%E9%80%89%E6%9B%B4%E6%99%BA%E8%83%BD"><span class="nav-number">1.</span> <span class="nav-text">ğŸ” æ•°æ®ç­›é€‰ï¼šæ¯”Excelç­›é€‰æ›´æ™ºèƒ½</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%93%88-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1%EF%BC%9A%E6%AF%94%E6%95%B0%E6%8D%AE%E9%80%8F%E8%A7%86%E8%A1%A8%E6%9B%B4%E5%BF%AB"><span class="nav-number">2.</span> <span class="nav-text">ğŸ“ˆ æ•°æ®ç»Ÿè®¡ï¼šæ¯”æ•°æ®é€è§†è¡¨æ›´å¿«</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%A7%AE-%E8%B4%A2%E5%8A%A1%E5%AE%9E%E6%88%98%EF%BC%9A%E9%94%80%E5%94%AE%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90"><span class="nav-number">3.</span> <span class="nav-text">ğŸ§® è´¢åŠ¡å®æˆ˜ï¼šé”€å”®æ•°æ®åˆ†æ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%8F%83%E2%80%8D%E2%99%80%EF%B8%8F-%E8%BF%9B%E9%98%B6%E5%B0%8F%E6%8C%91%E6%88%98"><span class="nav-number">4.</span> <span class="nav-text">ğŸƒâ€â™€ï¸ è¿›é˜¶å°æŒ‘æˆ˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%92%AD-%E4%BB%8A%E6%97%A5%E6%80%9D%E8%80%83"><span class="nav-number">5.</span> <span class="nav-text">ğŸ’­ ä»Šæ—¥æ€è€ƒ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%93%9D-%E8%AF%BE%E5%90%8E%E5%B0%8F%E7%BB%93"><span class="nav-number">6.</span> <span class="nav-text">ğŸ“ è¯¾åå°ç»“</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%8E%AF-%E4%B8%8B%E8%8A%82%E9%A2%84%E5%91%8A"><span class="nav-number">7.</span> <span class="nav-text">ğŸ¯ ä¸‹èŠ‚é¢„å‘Š</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%92%A1-%E5%B0%8F%E8%B4%B4%E5%A3%AB"><span class="nav-number">8.</span> <span class="nav-text">ğŸ’¡ å°è´´å£«</span></a></li></ol></li></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Aisaka Aoi" src="/images/manatsu.jpg"><p class="site-author-name" itemprop="name">Aisaka Aoi</p><div class="site-description" itemprop="description">é€¢å‚è‘µçš„ä¸ªäººåšå®¢</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">1030</span> <span class="site-state-item-name">æ—¥å¿—</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">20</span> <span class="site-state-item-name">åˆ†ç±»</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/AisakaAoi" title="GitHub ğŸ‘¨â€ğŸ’» â†’ https:&#x2F;&#x2F;github.com&#x2F;AisakaAoi" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub ğŸ‘¨â€ğŸ’»</a> </span><span class="links-of-author-item"><a href="https://github.com/Aisakaorz" title="GitHub ğŸ‘©â€ğŸ’» â†’ https:&#x2F;&#x2F;github.com&#x2F;Aisakaorz" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub ğŸ‘©â€ğŸ’»</a> </span><span class="links-of-author-item"><a href="mailto:aisakaaoi@qq.com" title="E-Mail ğŸ“§ â†’ mailto:aisakaaoi@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail ğŸ“§</a> </span><span class="links-of-author-item"><a href="mailto:chenzongnan@m.scnu.edu.cn" title="E-Mail ğŸ« â†’ mailto:chenzongnan@m.scnu.edu.cn" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail ğŸ«</a> </span><span class="links-of-author-item"><a href="https://space.bilibili.com/91560309" title="Bilibili ğŸ“º â†’ https:&#x2F;&#x2F;space.bilibili.com&#x2F;91560309" rel="noopener" target="_blank"><i class="fab fa-bilibili fa-fw"></i>Bilibili ğŸ“º</a> </span><span class="links-of-author-item"><a href="https://space.bilibili.com/198562921" title="Bilibili ğŸ® â†’ https:&#x2F;&#x2F;space.bilibili.com&#x2F;198562921" rel="noopener" target="_blank"><i class="fab fa-bilibili fa-fw"></i>Bilibili ğŸ®</a> </span><span class="links-of-author-item"><a href="https://www.youtube.com/channel/UCALvyn5Cl76GCotO9pczvjg" title="YouTube ğŸ“º â†’ https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCALvyn5Cl76GCotO9pczvjg" rel="noopener" target="_blank"><i class="fab fa-youtube fa-fw"></i>YouTube ğŸ“º</a></span></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2026</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Aisaka Aoi</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span class="post-meta-item-text">ç«™ç‚¹æ€»å­—æ•°ï¼š</span> <span title="ç«™ç‚¹æ€»å­—æ•°">4.1m</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span class="post-meta-item-text">ç«™ç‚¹é˜…è¯»æ—¶é•¿ &asymp;</span> <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">170:44</span></div><div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨</div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script>document.querySelectorAll(".pdfobject-container").forEach(e=>{var t=e.dataset.target,a="#"+Object.entries({navpanes:0,toolbar:0,statusbar:0,pagemode:"thumbs",view:"FitH"}).map(([e,t])=>e+"="+encodeURIComponent(t)).join("&"),r="/lib/pdf/web/viewer.html?file="+encodeURIComponent(t)+a;NexT.utils.supportsPDFs()?e.innerHTML=`<embed class="pdfobject" src="${t+a}" type="application/pdf" style="height: ${e.dataset.height};">`:e.innerHTML=`<iframe src="${r}" style="height: ${e.dataset.height};" frameborder="0"></iframe>`})</script><script>NexT.utils.loadComments(document.querySelector("#valine-comments"),()=>{NexT.utils.getScript("//unpkg.com/valine/dist/Valine.min.js",()=>{var i=["nick","mail","link"],e="nick,mail,link".split(",").filter(e=>i.includes(e));new Valine({el:"#valine-comments",verify:!0,notify:!0,appId:"UqjWdRYbIUEUQRXhBUUIh1QE-gzGzoHsz",appKey:"gj89JXC485PFbpdHLKVkz6dm",placeholder:"è¿™é‡Œå¯ä»¥å‘é€è¯„è®º~ï¼ˆä¸Šé¢å¯ä»¥è¾“å…¥æ˜µç§°ã€é‚®ç®±ï¼‰",avatar:"mm",meta:e,pageSize:"10",visitor:!0,lang:"zh-cn",path:location.pathname,recordIP:!1,serverURLs:""})},window.Valine)})</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/haru02.model.json"},"display":{"position":"right","width":208,"height":520},"mobile":{"show":false},"log":false});</script></body></html>