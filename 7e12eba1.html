<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0"><meta name="baidu-site-verification" content="code-KCMz4b3cnd"><meta name="google-site-verification" content="MTp8U7dJ1uzrfz8Mu6rgqX1CIm3HjqPWd0xaRcv1tFg"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="mask-icon" href="/images/favicon.png" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"aisakaaoi.github.io",root:"/",scheme:"Pisces",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:"valine",storage:!0,lazyload:!1,nav:null,activeClass:"valine"},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="å¯¼è¯­ä¸Šç¯‡æˆ‘ä»¬ç”¨æ­£åˆ™è¡¨è¾¾å¼ä»æ–‡æœ¬é‡Œâ€œæâ€å‡ºäº†é‡‘å­ï¼Œä½†è¿™äº›æ•°æ®æ”¾å“ªå„¿ï¼Ÿå­˜Excelï¼Ÿæ–‡ä»¶ä¸€å¤šå°±ä¹±å¥—ã€‚å­˜CSVï¼ŸæŸ¥è¯¢èµ·æ¥ç¿»éæ–‡ä»¶å¤¹ã€‚æ˜¯æ—¶å€™è¯·å‡ºæ•°æ®ç®¡ç†çš„â€œç»ˆæç¥å™¨â€â€”â€”æ•°æ®åº“ï¼å®ƒå°±åƒå…¬å¸çš„æ¡£æ¡ˆå®¤ï¼Œæœ‰ä¸“é—¨çš„ç®¡ç†å‘˜ï¼ˆSQLè¯­è¨€ï¼‰ï¼Œæƒ³æ‰¾â€œå»å¹´äº¤æ˜“é¢è¶…è¿‡50ä¸‡çš„å®¢æˆ·â€ï¼Œ1ç§’å°±æå®šã€‚ä»Šå¤©æˆ‘ä»¬ä»æœ€è½»é‡çº§çš„SQLiteå¼€å§‹ï¼Œä¸ç”¨å®‰è£…æœåŠ¡å™¨ï¼Œåƒæ“ä½œExcelä¸€æ ·ç®€å•ï¼"><meta property="og:type" content="article"><meta property="og:title" content="Python-ç¬¬22ç¯‡ã€Šæ•°æ®åº“åŸºç¡€ï¼šSQLiteå…¥é—¨ã€‹"><meta property="og:url" content="https://aisakaaoi.github.io/7e12eba1.html"><meta property="og:site_name" content="é€¢å‚è‘µçš„ä¸ªäººåšå®¢"><meta property="og:description" content="å¯¼è¯­ä¸Šç¯‡æˆ‘ä»¬ç”¨æ­£åˆ™è¡¨è¾¾å¼ä»æ–‡æœ¬é‡Œâ€œæâ€å‡ºäº†é‡‘å­ï¼Œä½†è¿™äº›æ•°æ®æ”¾å“ªå„¿ï¼Ÿå­˜Excelï¼Ÿæ–‡ä»¶ä¸€å¤šå°±ä¹±å¥—ã€‚å­˜CSVï¼ŸæŸ¥è¯¢èµ·æ¥ç¿»éæ–‡ä»¶å¤¹ã€‚æ˜¯æ—¶å€™è¯·å‡ºæ•°æ®ç®¡ç†çš„â€œç»ˆæç¥å™¨â€â€”â€”æ•°æ®åº“ï¼å®ƒå°±åƒå…¬å¸çš„æ¡£æ¡ˆå®¤ï¼Œæœ‰ä¸“é—¨çš„ç®¡ç†å‘˜ï¼ˆSQLè¯­è¨€ï¼‰ï¼Œæƒ³æ‰¾â€œå»å¹´äº¤æ˜“é¢è¶…è¿‡50ä¸‡çš„å®¢æˆ·â€ï¼Œ1ç§’å°±æå®šã€‚ä»Šå¤©æˆ‘ä»¬ä»æœ€è½»é‡çº§çš„SQLiteå¼€å§‹ï¼Œä¸ç”¨å®‰è£…æœåŠ¡å™¨ï¼Œåƒæ“ä½œExcelä¸€æ ·ç®€å•ï¼"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2026-02-03T16:30:19.000Z"><meta property="article:modified_time" content="2026-02-03T21:28:01.531Z"><meta property="article:author" content="Aisaka Aoi"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://aisakaaoi.github.io/7e12eba1.html"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>Python-ç¬¬22ç¯‡ã€Šæ•°æ®åº“åŸºç¡€ï¼šSQLiteå…¥é—¨ã€‹ | é€¢å‚è‘µçš„ä¸ªäººåšå®¢</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?7308ed05421777c301eefa3754da1b42",document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="é€¢å‚è‘µçš„ä¸ªäººåšå®¢" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ "><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">aoiå­¦é™¢</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">Aisaka's Blog, School of Aoi, Aisaka University</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»<span class="badge">20</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£<span class="badge">1034</span></a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="æœç´¢..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="reading-progress-bar"></div><a href="https://github.com/AisakaAoi" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://aisakaaoi.github.io/7e12eba1.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/manatsu.jpg"><meta itemprop="name" content="Aisaka Aoi"><meta itemprop="description" content="Aisaka's Blog, School of Aoi, Aisaka University"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="é€¢å‚è‘µçš„ä¸ªäººåšå®¢"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Python-ç¬¬22ç¯‡ã€Šæ•°æ®åº“åŸºç¡€ï¼šSQLiteå…¥é—¨ã€‹</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">å‘è¡¨äº</span> <time title="åˆ›å»ºæ—¶é—´ï¼š2026-02-04 00:30:19" itemprop="dateCreated datePublished" datetime="2026-02-04T00:30:19+08:00">2026-02-04</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">åˆ†ç±»äº</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%F0%9F%8C%99%E9%80%A2%E5%9D%82%E6%9D%82%E8%B0%88%E4%B8%8E%E6%90%AC%E8%BF%90/" itemprop="url" rel="index"><span itemprop="name">ğŸŒ™é€¢å‚æ‚è°ˆä¸æ¬è¿</span></a> </span>ï¼Œ <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%F0%9F%8C%99%E9%80%A2%E5%9D%82%E6%9D%82%E8%B0%88%E4%B8%8E%E6%90%AC%E8%BF%90/%E2%AD%90%E6%9E%9C%E6%9E%9C%E8%AF%BE%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">â­æœæœè¯¾ç¨‹</span></a> </span></span><span id="/7e12eba1.html" class="post-meta-item leancloud_visitors" data-flag-title="Python-ç¬¬22ç¯‡ã€Šæ•°æ®åº“åŸºç¡€ï¼šSQLiteå…¥é—¨ã€‹" title="é˜…è¯»æ¬¡æ•°"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span> <span class="leancloud-visitors-count"></span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Valineï¼š</span> <a title="valine" href="/7e12eba1.html#valine-comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/7e12eba1.html" itemprop="commentCount"></span></a></span><br><span class="post-meta-item" title="æœ¬æ–‡å­—æ•°"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span> <span>21k</span> </span><span class="post-meta-item" title="é˜…è¯»æ—¶é•¿"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span> <span>52 åˆ†é’Ÿ</span></span></div></header><div class="post-body" itemprop="articleBody"><h3 id="å¯¼è¯­"><a href="#å¯¼è¯­" class="headerlink" title="å¯¼è¯­"></a>å¯¼è¯­</h3><p>ä¸Šç¯‡æˆ‘ä»¬ç”¨æ­£åˆ™è¡¨è¾¾å¼ä»æ–‡æœ¬é‡Œâ€œæâ€å‡ºäº†é‡‘å­ï¼Œä½†è¿™äº›æ•°æ®æ”¾å“ªå„¿ï¼Ÿå­˜Excelï¼Ÿæ–‡ä»¶ä¸€å¤šå°±ä¹±å¥—ã€‚å­˜CSVï¼ŸæŸ¥è¯¢èµ·æ¥ç¿»éæ–‡ä»¶å¤¹ã€‚æ˜¯æ—¶å€™è¯·å‡ºæ•°æ®ç®¡ç†çš„â€œç»ˆæç¥å™¨â€â€”â€”æ•°æ®åº“ï¼å®ƒå°±åƒå…¬å¸çš„æ¡£æ¡ˆå®¤ï¼Œæœ‰ä¸“é—¨çš„ç®¡ç†å‘˜ï¼ˆSQLè¯­è¨€ï¼‰ï¼Œæƒ³æ‰¾â€œå»å¹´äº¤æ˜“é¢è¶…è¿‡50ä¸‡çš„å®¢æˆ·â€ï¼Œ1ç§’å°±æå®šã€‚ä»Šå¤©æˆ‘ä»¬ä»æœ€è½»é‡çº§çš„SQLiteå¼€å§‹ï¼Œä¸ç”¨å®‰è£…æœåŠ¡å™¨ï¼Œåƒæ“ä½œExcelä¸€æ ·ç®€å•ï¼</p><span id="more"></span><hr><h3 id="æœ¬ç¯‡ç›®æ ‡"><a href="#æœ¬ç¯‡ç›®æ ‡" class="headerlink" title="æœ¬ç¯‡ç›®æ ‡"></a>æœ¬ç¯‡ç›®æ ‡</h3><ul><li>ç†è§£æ•°æ®åº“çš„â€œè¡¨â€å’Œâ€œè®°å½•â€æ¦‚å¿µ</li><li>æŒæ¡SQLçš„â€œå¢åˆ æ”¹æŸ¥â€å››å¤§æ“ä½œ</li><li>å­¦ä¼šç”¨Pythonæ“ä½œSQLiteæ•°æ®åº“</li><li>å®æˆ˜ï¼šæ„å»ºå¯æŸ¥è¯¢çš„å®¢æˆ·ç®¡ç†ç³»ç»Ÿ</li><li>å®ç°æ•°æ®çš„å¯¼å…¥å¯¼å‡º</li></ul><hr><h3 id="ä¸€ã€å‡†å¤‡å·¥ä½œï¼šå®‰è£…åº“"><a href="#ä¸€ã€å‡†å¤‡å·¥ä½œï¼šå®‰è£…åº“" class="headerlink" title="ä¸€ã€å‡†å¤‡å·¥ä½œï¼šå®‰è£…åº“"></a>ä¸€ã€å‡†å¤‡å·¥ä½œï¼šå®‰è£…åº“</h3><p>SQLiteæ˜¯Pythonå†…ç½®çš„ï¼Œä½†æ“ä½œå®ƒéœ€è¦<code>sqlite3</code>æ¨¡å—ï¼ˆPython 3è‡ªå¸¦ï¼‰ã€‚å†åŠ ä¸ªè¾…åŠ©åº“ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‘½ä»¤è¡Œè¿è¡Œ</span></span><br><span class="line"><span class="comment"># pip install pandas openpyxl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;âœ… SQLiteç¯å¢ƒå‡†å¤‡å°±ç»ªï¼&quot;</span>)</span><br></pre></td></tr></table></figure><hr><h3 id="äºŒã€ç†è§£æ•°æ®åº“ï¼šä»Excelè¡¨æ ¼è¯´èµ·"><a href="#äºŒã€ç†è§£æ•°æ®åº“ï¼šä»Excelè¡¨æ ¼è¯´èµ·" class="headerlink" title="äºŒã€ç†è§£æ•°æ®åº“ï¼šä»Excelè¡¨æ ¼è¯´èµ·"></a>äºŒã€ç†è§£æ•°æ®åº“ï¼šä»Excelè¡¨æ ¼è¯´èµ·</h3><h4 id="2-1-æ•°æ®åº“-vs-Excel"><a href="#2-1-æ•°æ®åº“-vs-Excel" class="headerlink" title="2.1 æ•°æ®åº“ vs Excel"></a>2.1 æ•°æ®åº“ vs Excel</h4><table><thead><tr><th>Excel</th><th>SQLiteæ•°æ®åº“</th></tr></thead><tbody><tr><td>ä¸€ä¸ªæ–‡ä»¶ä¸€ä¸ªè¡¨</td><td>ä¸€ä¸ªæ–‡ä»¶å¤šä¸ªè¡¨ï¼ˆåƒå·¥ä½œç°¿ï¼‰</td></tr><tr><td>ç”¨é¼ æ ‡æ“ä½œ</td><td>ç”¨SQLå‘½ä»¤æ“ä½œ</td></tr><tr><td>æ•°æ®é‡å¤§äº†å¡é¡¿</td><td>ç™¾ä¸‡çº§æ•°æ®ä¾ç„¶é£å¿«</td></tr><tr><td>å®¹æ˜“è¯¯åˆ æ”¹</td><td>æœ‰äº‹åŠ¡ä¿æŠ¤ï¼Œå®‰å…¨</td></tr><tr><td>éš¾ä»¥å¤šæ¡ä»¶æŸ¥è¯¢</td><td>SQLä¸€å¥è¯æå®šå¤æ‚æŸ¥è¯¢</td></tr></tbody></table><p><strong>æ ¸å¿ƒæ¦‚å¿µï¼š</strong></p><ul><li><strong>æ•°æ®åº“ï¼ˆDatabaseï¼‰</strong> &#x3D; ä¸€ä¸ª<code>.db</code>æ–‡ä»¶ &#x3D; æ•´ä¸ªæ¡£æ¡ˆæŸœ</li><li><strong>è¡¨ï¼ˆTableï¼‰</strong> &#x3D; ä¸€å¼ äºŒç»´è¡¨æ ¼ &#x3D; æ¡£æ¡ˆæŸœä¸­çš„ä¸€ä¸ªæŠ½å±‰</li><li><strong>è®°å½•ï¼ˆRecord&#x2F;Rowï¼‰</strong> &#x3D; ä¸€è¡Œæ•°æ® &#x3D; ä¸€ä»½æ¡£æ¡ˆ</li><li><strong>å­—æ®µï¼ˆField&#x2F;Columnï¼‰</strong> &#x3D; ä¸€åˆ—æ•°æ® &#x3D; æ¡£æ¡ˆçš„æŸä¸ªå±æ€§ï¼ˆå§“åã€ç”µè¯ï¼‰</li></ul><hr><h4 id="2-2-åˆ›å»ºç¬¬ä¸€ä¸ªæ•°æ®åº“"><a href="#2-2-åˆ›å»ºç¬¬ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="2.2 åˆ›å»ºç¬¬ä¸€ä¸ªæ•°æ®åº“"></a>2.2 åˆ›å»ºç¬¬ä¸€ä¸ªæ•°æ®åº“</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ========== åˆ›å»ºå®¢æˆ·ç®¡ç†æ•°æ®åº“ ==========</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_customer_db</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    åˆ›å»ºSQLiteæ•°æ®åº“å’Œcustomerè¡¨</span></span><br><span class="line"><span class="string">    å°±åƒæ–°å»ºä¸€ä¸ªExcelæ–‡ä»¶ï¼Œå¹¶åœ¨é‡Œé¢åˆ›å»º&quot;å®¢æˆ·ä¿¡æ¯&quot;å·¥ä½œè¡¨</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 1. è¿æ¥æ•°æ®åº“ï¼ˆå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»ºï¼‰</span></span><br><span class="line">    conn = sqlite3.connect(<span class="string">&#x27;customer_management.db&#x27;</span>)</span><br><span class="line">    cursor = conn.cursor()</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;âœ… æˆåŠŸè¿æ¥åˆ°æ•°æ®åº“&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. åˆ›å»ºè¡¨ï¼ˆå®šä¹‰è¡¨ç»“æ„ï¼‰</span></span><br><span class="line">    <span class="comment"># IF NOT EXISTSï¼šå¦‚æœè¡¨å·²å­˜åœ¨å°±ä¸åˆ›å»ºï¼ˆé¿å…é‡å¤æŠ¥é”™ï¼‰</span></span><br><span class="line">    create_table_sql = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    CREATE TABLE IF NOT EXISTS customers (</span></span><br><span class="line"><span class="string">        id INTEGER PRIMARY KEY AUTOINCREMENT,  -- å®¢æˆ·IDï¼Œä¸»é”®ï¼Œè‡ªåŠ¨é€’å¢</span></span><br><span class="line"><span class="string">        name TEXT NOT NULL,                    -- å§“åï¼Œæ–‡æœ¬ç±»å‹ï¼Œä¸èƒ½ä¸ºç©º</span></span><br><span class="line"><span class="string">        company TEXT,                          -- å…¬å¸åç§°</span></span><br><span class="line"><span class="string">        phone TEXT UNIQUE,                     -- ç”µè¯ï¼Œå”¯ä¸€ï¼ˆä¸èƒ½é‡å¤ï¼‰</span></span><br><span class="line"><span class="string">        email TEXT,                            -- é‚®ç®±</span></span><br><span class="line"><span class="string">        level TEXT DEFAULT &#x27;æ™®é€š&#x27;,             -- å®¢æˆ·ç­‰çº§ï¼Œé»˜è®¤å€¼</span></span><br><span class="line"><span class="string">        total_amount REAL DEFAULT 0.0,         -- ç´¯è®¡äº¤æ˜“é‡‘é¢</span></span><br><span class="line"><span class="string">        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP  -- åˆ›å»ºæ—¶é—´ï¼Œè‡ªåŠ¨è®°å½•</span></span><br><span class="line"><span class="string">    )</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    cursor.execute(create_table_sql)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;âœ… å®¢æˆ·è¡¨åˆ›å»ºæˆåŠŸï¼&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. æäº¤å¹¶å…³é—­</span></span><br><span class="line">    conn.commit()</span><br><span class="line">    conn.close()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ğŸ“ æ•°æ®åº“æ–‡ä»¶å·²ä¿å­˜: customer_management.db&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºæ•°æ®åº“</span></span><br><span class="line">create_customer_db()</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹æ•°æ®åº“å†…å®¹ï¼š</strong><br>åˆ›å»ºåï¼Œå½“å‰æ–‡ä»¶å¤¹ä¼šå‡ºç°<code>customer_management.db</code>æ–‡ä»¶ã€‚å¯ä»¥ç”¨<strong>DB Browser for SQLite</strong>ï¼ˆå…è´¹å›¾å½¢åŒ–å·¥å…·ï¼‰æ‰“å¼€æŸ¥çœ‹ï¼Œåƒæ“ä½œExcelä¸€æ ·ç›´è§‚ï¼</p><hr><h3 id="ä¸‰ã€SQLåŸºç¡€ï¼šæ•°æ®çš„â€œå¢åˆ æ”¹æŸ¥â€"><a href="#ä¸‰ã€SQLåŸºç¡€ï¼šæ•°æ®çš„â€œå¢åˆ æ”¹æŸ¥â€" class="headerlink" title="ä¸‰ã€SQLåŸºç¡€ï¼šæ•°æ®çš„â€œå¢åˆ æ”¹æŸ¥â€"></a>ä¸‰ã€SQLåŸºç¡€ï¼šæ•°æ®çš„â€œå¢åˆ æ”¹æŸ¥â€</h3><p>SQLï¼ˆStructured Query Languageï¼‰æ˜¯æ•°æ®åº“çš„â€œæ™®é€šè¯â€ï¼Œå­¦ä¼šè¿™å››å¥ï¼Œèµ°éå¤©ä¸‹éƒ½ä¸æ€•ï¼š</p><h4 id="3-1-INSERT-å¢åŠ è®°å½•ï¼ˆæ·»åŠ å®¢æˆ·ï¼‰"><a href="#3-1-INSERT-å¢åŠ è®°å½•ï¼ˆæ·»åŠ å®¢æˆ·ï¼‰" class="headerlink" title="3.1 INSERT - å¢åŠ è®°å½•ï¼ˆæ·»åŠ å®¢æˆ·ï¼‰"></a>3.1 INSERT - å¢åŠ è®°å½•ï¼ˆæ·»åŠ å®¢æˆ·ï¼‰</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ========== INSERTï¼šæ·»åŠ æ–°å®¢æˆ· ==========</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_customers</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ‰¹é‡æ·»åŠ å®¢æˆ·&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    conn = sqlite3.connect(<span class="string">&#x27;customer_management.db&#x27;</span>)</span><br><span class="line">    cursor = conn.cursor()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ–¹æ³•ä¸€ï¼šé€æ¡æ’å…¥</span></span><br><span class="line">    customers = [</span><br><span class="line">        (<span class="string">&#x27;å¼ ä¸‰&#x27;</span>, <span class="string">&#x27;æ™ºæ…§ç§‘æŠ€æœ‰é™å…¬å¸&#x27;</span>, <span class="string">&#x27;13800138001&#x27;</span>, <span class="string">&#x27;zhangsan@example.com&#x27;</span>, <span class="string">&#x27;VIP&#x27;</span>, <span class="number">150000</span>),</span><br><span class="line">        (<span class="string">&#x27;æå››&#x27;</span>, <span class="string">&#x27;åˆ›æ–°è´¸æ˜“å…¬å¸&#x27;</span>, <span class="string">&#x27;13900139002&#x27;</span>, <span class="string">&#x27;lisi@example.com&#x27;</span>, <span class="string">&#x27;æ™®é€š&#x27;</span>, <span class="number">32000</span>),</span><br><span class="line">        (<span class="string">&#x27;ç‹äº”&#x27;</span>, <span class="string">&#x27;ä¼˜è´¨æœåŠ¡é›†å›¢&#x27;</span>, <span class="string">&#x27;13700137003&#x27;</span>, <span class="string">&#x27;wangwu@example.com&#x27;</span>, <span class="string">&#x27;é‡è¦&#x27;</span>, <span class="number">85000</span>),</span><br><span class="line">    ]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ï¼Ÿæ˜¯å ä½ç¬¦ï¼Œé˜²æ­¢SQLæ³¨å…¥ï¼ˆå®‰å…¨ï¼‰</span></span><br><span class="line">    insert_sql = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    INSERT INTO customers (name, company, phone, email, level, total_amount)</span></span><br><span class="line"><span class="string">    VALUES (?, ?, ?, ?, ?, ?)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ‰¹é‡æ’å…¥</span></span><br><span class="line">    cursor.executemany(insert_sql, customers)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æäº¤ï¼ˆä¿å­˜æ›´æ”¹ï¼‰</span></span><br><span class="line">    conn.commit()</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;âœ… æˆåŠŸæ’å…¥ <span class="subst">&#123;cursor.rowcount&#125;</span> æ¡å®¢æˆ·è®°å½•&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ–¹æ³•äºŒï¼šæ’å…¥å•æ¡å¹¶è·å–è‡ªåŠ¨ç”Ÿæˆçš„ID</span></span><br><span class="line">    single_customer = (<span class="string">&#x27;èµµå…­&#x27;</span>, <span class="string">&#x27;å¿«é€Ÿå‘å±•ä¼ä¸š&#x27;</span>, <span class="string">&#x27;13600136004&#x27;</span>, <span class="string">&#x27;zhaoliu@example.com&#x27;</span>, <span class="string">&#x27;VIP&#x27;</span>, <span class="number">210000</span>)</span><br><span class="line">    </span><br><span class="line">    cursor.execute(insert_sql, single_customer)</span><br><span class="line">    conn.commit()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è·å–åˆšæ’å…¥çš„ID</span></span><br><span class="line">    new_id = cursor.lastrowid</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;âœ… æ–°å®¢æˆ·ID: <span class="subst">&#123;new_id&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•æ·»åŠ </span></span><br><span class="line">add_customers()</span><br></pre></td></tr></table></figure><hr><h4 id="3-2-SELECT-æŸ¥è¯¢è®°å½•ï¼ˆæŸ¥æ‰¾å®¢æˆ·ï¼‰"><a href="#3-2-SELECT-æŸ¥è¯¢è®°å½•ï¼ˆæŸ¥æ‰¾å®¢æˆ·ï¼‰" class="headerlink" title="3.2 SELECT - æŸ¥è¯¢è®°å½•ï¼ˆæŸ¥æ‰¾å®¢æˆ·ï¼‰"></a>3.2 SELECT - æŸ¥è¯¢è®°å½•ï¼ˆæŸ¥æ‰¾å®¢æˆ·ï¼‰</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ========== SELECTï¼šæŸ¥è¯¢å®¢æˆ· ==========</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">query_customers</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ¼”ç¤ºå„ç§æŸ¥è¯¢æ–¹å¼&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    conn = sqlite3.connect(<span class="string">&#x27;customer_management.db&#x27;</span>)</span><br><span class="line">    cursor = conn.cursor()</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span> * <span class="number">50</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å®¢æˆ·æŸ¥è¯¢æ¼”ç¤º&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">50</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 1. æŸ¥è¯¢æ‰€æœ‰å®¢æˆ·ï¼ˆ*è¡¨ç¤ºæ‰€æœ‰åˆ—ï¼‰</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n1ï¸âƒ£ æ‰€æœ‰å®¢æˆ·åˆ—è¡¨ï¼š&quot;</span>)</span><br><span class="line">    cursor.execute(<span class="string">&quot;SELECT * FROM customers&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># fetchall()è·å–æ‰€æœ‰ç»“æœ</span></span><br><span class="line">    all_customers = cursor.fetchall()</span><br><span class="line">    <span class="keyword">for</span> customer <span class="keyword">in</span> all_customers:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ID: <span class="subst">&#123;customer[<span class="number">0</span>]&#125;</span> | å§“å: <span class="subst">&#123;customer[<span class="number">1</span>]&#125;</span> | å…¬å¸: <span class="subst">&#123;customer[<span class="number">2</span>]&#125;</span> | ç­‰çº§: <span class="subst">&#123;customer[<span class="number">5</span>]&#125;</span> | äº¤æ˜“é¢: Â¥<span class="subst">&#123;customer[<span class="number">6</span>]:,<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. æ¡ä»¶æŸ¥è¯¢ï¼šVIPå®¢æˆ·</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n2ï¸âƒ£ VIPå®¢æˆ·åˆ—è¡¨ï¼š&quot;</span>)</span><br><span class="line">    cursor.execute(<span class="string">&quot;SELECT name, company, total_amount FROM customers WHERE level = &#x27;VIP&#x27;&quot;</span>)</span><br><span class="line">    vip_customers = cursor.fetchall()</span><br><span class="line">    <span class="keyword">for</span> name, company, amount <span class="keyword">in</span> vip_customers:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ğŸ† <span class="subst">&#123;name&#125;</span> (<span class="subst">&#123;company&#125;</span>) - ç´¯è®¡äº¤æ˜“: Â¥<span class="subst">&#123;amount:,<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. æ¨¡ç³ŠæŸ¥è¯¢ï¼šå…¬å¸åç§°åŒ…å«&quot;ç§‘æŠ€&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n3ï¸âƒ£ ç§‘æŠ€å…¬å¸å®¢æˆ·ï¼š&quot;</span>)</span><br><span class="line">    cursor.execute(<span class="string">&quot;SELECT * FROM customers WHERE company LIKE &#x27;%ç§‘æŠ€%&#x27;&quot;</span>)</span><br><span class="line">    tech_companies = cursor.fetchall()</span><br><span class="line">    <span class="keyword">for</span> customer <span class="keyword">in</span> tech_companies:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ğŸ”¬ <span class="subst">&#123;customer[<span class="number">1</span>]&#125;</span> - <span class="subst">&#123;customer[<span class="number">2</span>]&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 4. èŒƒå›´æŸ¥è¯¢ï¼šäº¤æ˜“é¢è¶…è¿‡5ä¸‡</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n4ï¸âƒ£ é«˜ä»·å€¼å®¢æˆ·ï¼ˆäº¤æ˜“é¢&gt;5ä¸‡ï¼‰ï¼š&quot;</span>)</span><br><span class="line">    cursor.execute(<span class="string">&quot;SELECT name, total_amount FROM customers WHERE total_amount &gt; 50000 ORDER BY total_amount DESC&quot;</span>)</span><br><span class="line">    high_value = cursor.fetchall()</span><br><span class="line">    <span class="keyword">for</span> name, amount <span class="keyword">in</span> high_value:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ğŸ’ <span class="subst">&#123;name&#125;</span> - Â¥<span class="subst">&#123;amount:,<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 5. èšåˆæŸ¥è¯¢ï¼šç»Ÿè®¡å®¢æˆ·æ•°é‡ã€å¹³å‡äº¤æ˜“é¢</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n5ï¸âƒ£ å®¢æˆ·ç»Ÿè®¡ï¼š&quot;</span>)</span><br><span class="line">    cursor.execute(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    SELECT </span></span><br><span class="line"><span class="string">        COUNT(*) as å®¢æˆ·æ€»æ•°,</span></span><br><span class="line"><span class="string">        AVG(total_amount) as å¹³å‡äº¤æ˜“é¢,</span></span><br><span class="line"><span class="string">        SUM(total_amount) as æ€»äº¤æ˜“é¢,</span></span><br><span class="line"><span class="string">        MAX(total_amount) as æœ€é«˜äº¤æ˜“é¢,</span></span><br><span class="line"><span class="string">        MIN(total_amount) as æœ€ä½äº¤æ˜“é¢</span></span><br><span class="line"><span class="string">    FROM customers</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span>)</span><br><span class="line">    stats = cursor.fetchone()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ğŸ‘¥ å®¢æˆ·æ€»æ•°: <span class="subst">&#123;stats[<span class="number">0</span>]&#125;</span>äºº&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ğŸ’µ å¹³å‡äº¤æ˜“é¢: Â¥<span class="subst">&#123;stats[<span class="number">1</span>]:,<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ğŸ’° æ€»äº¤æ˜“é¢: Â¥<span class="subst">&#123;stats[<span class="number">2</span>]:,<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ğŸ“ˆ æœ€é«˜äº¤æ˜“: Â¥<span class="subst">&#123;stats[<span class="number">3</span>]:,<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ğŸ“‰ æœ€ä½äº¤æ˜“: Â¥<span class="subst">&#123;stats[<span class="number">4</span>]:,<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line">query_customers()</span><br></pre></td></tr></table></figure><hr><h4 id="3-3-UPDATE-ä¿®æ”¹è®°å½•ï¼ˆæ›´æ–°å®¢æˆ·ä¿¡æ¯ï¼‰"><a href="#3-3-UPDATE-ä¿®æ”¹è®°å½•ï¼ˆæ›´æ–°å®¢æˆ·ä¿¡æ¯ï¼‰" class="headerlink" title="3.3 UPDATE - ä¿®æ”¹è®°å½•ï¼ˆæ›´æ–°å®¢æˆ·ä¿¡æ¯ï¼‰"></a>3.3 UPDATE - ä¿®æ”¹è®°å½•ï¼ˆæ›´æ–°å®¢æˆ·ä¿¡æ¯ï¼‰</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ========== UPDATEï¼šæ›´æ–°å®¢æˆ·ä¿¡æ¯ ==========</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update_customer</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ›´æ–°å®¢æˆ·æ•°æ®&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    conn = sqlite3.connect(<span class="string">&#x27;customer_management.db&#x27;</span>)</span><br><span class="line">    cursor = conn.cursor()</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span> * <span class="number">50</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ›´æ–°å®¢æˆ·ä¿¡æ¯&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">50</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åœºæ™¯ï¼šå¼ ä¸‰æ™‹å‡ä¸ºé‡è¦å®¢æˆ·ï¼Œäº¤æ˜“é¢å¢åŠ äº†5ä¸‡</span></span><br><span class="line">    update_sql = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    UPDATE customers</span></span><br><span class="line"><span class="string">    SET level = ?, total_amount = total_amount + ?</span></span><br><span class="line"><span class="string">    WHERE name = ?</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    cursor.execute(update_sql, (<span class="string">&#x27;é‡è¦&#x27;</span>, <span class="number">50000</span>, <span class="string">&#x27;å¼ ä¸‰&#x27;</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ£€æŸ¥æ›´æ–°è¡Œæ•°</span></span><br><span class="line">    <span class="keyword">if</span> cursor.rowcount &gt; <span class="number">0</span>:</span><br><span class="line">        conn.commit()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;âœ… æ›´æ–°æˆåŠŸï¼å½±å“ <span class="subst">&#123;cursor.rowcount&#125;</span> æ¡è®°å½•&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;âš ï¸ æœªæ‰¾åˆ°åŒ¹é…çš„è®°å½•&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ‰¹é‡æ›´æ–°ï¼šæ‰€æœ‰æ™®é€šå®¢æˆ·äº¤æ˜“é¢å¢åŠ 10%ï¼ˆå¥–åŠ±ï¼‰</span></span><br><span class="line">    cursor.execute(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    UPDATE customers</span></span><br><span class="line"><span class="string">    SET total_amount = total_amount * 1.10</span></span><br><span class="line"><span class="string">    WHERE level = &#x27;æ™®é€š&#x27;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    conn.commit()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;âœ… æ‰¹é‡æ›´æ–°å®Œæˆï¼å¥–åŠ±äº† <span class="subst">&#123;cursor.rowcount&#125;</span> ä½æ™®é€šå®¢æˆ·&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line">update_customer()</span><br></pre></td></tr></table></figure><hr><h4 id="3-4-DELETE-åˆ é™¤è®°å½•ï¼ˆåˆ é™¤å®¢æˆ·ï¼‰"><a href="#3-4-DELETE-åˆ é™¤è®°å½•ï¼ˆåˆ é™¤å®¢æˆ·ï¼‰" class="headerlink" title="3.4 DELETE - åˆ é™¤è®°å½•ï¼ˆåˆ é™¤å®¢æˆ·ï¼‰"></a>3.4 DELETE - åˆ é™¤è®°å½•ï¼ˆåˆ é™¤å®¢æˆ·ï¼‰</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ========== DELETEï¼šåˆ é™¤å®¢æˆ· ==========</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete_customer</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;åˆ é™¤å®¢æˆ·ï¼ˆè°¨æ…æ“ä½œï¼ï¼‰&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    conn = sqlite3.connect(<span class="string">&#x27;customer_management.db&#x27;</span>)</span><br><span class="line">    cursor = conn.cursor()</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span> * <span class="number">50</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;åˆ é™¤å®¢æˆ·&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">50</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åœºæ™¯ï¼šåˆ é™¤äº¤æ˜“é¢ä½äº1ä¸‡çš„å®¢æˆ·ï¼ˆæ¸…ç†å°å®¢æˆ·ï¼‰</span></span><br><span class="line">    <span class="comment"># å…ˆæŸ¥è¯¢è¦åˆ é™¤å“ªäº›</span></span><br><span class="line">    cursor.execute(<span class="string">&quot;SELECT id, name, total_amount FROM customers WHERE total_amount &lt; 10000&quot;</span>)</span><br><span class="line">    to_delete = cursor.fetchall()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> to_delete:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;å³å°†åˆ é™¤ä»¥ä¸‹å®¢æˆ·ï¼š&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> cid, name, amount <span class="keyword">in</span> to_delete:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  ID <span class="subst">&#123;cid&#125;</span>: <span class="subst">&#123;name&#125;</span>ï¼ˆäº¤æ˜“é¢Â¥<span class="subst">&#123;amount:,<span class="number">.2</span>f&#125;</span>ï¼‰&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        confirm = <span class="built_in">input</span>(<span class="string">&quot;ç¡®è®¤åˆ é™¤ï¼Ÿ(y/n): &quot;</span>).strip()</span><br><span class="line">        <span class="keyword">if</span> confirm.lower() == <span class="string">&#x27;y&#x27;</span>:</span><br><span class="line">            <span class="comment"># æ‰§è¡Œåˆ é™¤</span></span><br><span class="line">            cursor.execute(<span class="string">&quot;DELETE FROM customers WHERE total_amount &lt; 10000&quot;</span>)</span><br><span class="line">            conn.commit()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;âœ… å·²åˆ é™¤ <span class="subst">&#123;cursor.rowcount&#125;</span> ä½å®¢æˆ·&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;âŒ æ“ä½œå·²å–æ¶ˆ&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;â„¹ï¸ æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„å®¢æˆ·&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line">delete_customer()</span><br></pre></td></tr></table></figure><hr><h3 id="å››ã€Python-SQLï¼šæ›´ä¼˜é›…çš„æ“ä½œæ–¹å¼"><a href="#å››ã€Python-SQLï¼šæ›´ä¼˜é›…çš„æ“ä½œæ–¹å¼" class="headerlink" title="å››ã€Python + SQLï¼šæ›´ä¼˜é›…çš„æ“ä½œæ–¹å¼"></a>å››ã€Python + SQLï¼šæ›´ä¼˜é›…çš„æ“ä½œæ–¹å¼</h3><h4 id="4-1-ä½¿ç”¨Pandasæ“ä½œSQLite"><a href="#4-1-ä½¿ç”¨Pandasæ“ä½œSQLite" class="headerlink" title="4.1 ä½¿ç”¨Pandasæ“ä½œSQLite"></a>4.1 ä½¿ç”¨Pandasæ“ä½œSQLite</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ========== Pandas + SQLite ==========</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pandas_with_sqlite</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ç”¨Pandasè¯»å†™SQLiteï¼ŒåƒExcelä¸€æ ·ç®€å•&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 1. ä»æ•°æ®åº“è¯»å–åˆ°DataFrame</span></span><br><span class="line">    conn = sqlite3.connect(<span class="string">&#x27;customer_management.db&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è¯»å–æ•´ä¸ªè¡¨</span></span><br><span class="line">    df = pd.read_sql(<span class="string">&quot;SELECT * FROM customers&quot;</span>, conn)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nğŸ“Š å®¢æˆ·æ•°æ®DataFrameï¼š&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(df.head())</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. å¤æ‚æŸ¥è¯¢</span></span><br><span class="line">    vip_df = pd.read_sql(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    SELECT name, company, total_amount </span></span><br><span class="line"><span class="string">    FROM customers </span></span><br><span class="line"><span class="string">    WHERE level = &#x27;VIP&#x27; </span></span><br><span class="line"><span class="string">    ORDER BY total_amount DESC</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span>, conn)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nğŸ† VIPå®¢æˆ·DataFrameï¼š&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(vip_df)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. ç”¨Pandaså¤„ç†æ•°æ®ï¼ˆç­›é€‰ã€è®¡ç®—ï¼‰</span></span><br><span class="line">    <span class="comment"># æ‰¾å‡ºäº¤æ˜“é¢è¶…è¿‡å¹³å‡å€¼çš„å®¢æˆ·</span></span><br><span class="line">    avg_amount = df[<span class="string">&#x27;total_amount&#x27;</span>].mean()</span><br><span class="line">    high_value = df[df[<span class="string">&#x27;total_amount&#x27;</span>] &gt; avg_amount]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ’ é«˜äºå¹³å‡å€¼(Â¥<span class="subst">&#123;avg_amount:,<span class="number">.2</span>f&#125;</span>)çš„å®¢æˆ·ï¼š<span class="subst">&#123;<span class="built_in">len</span>(high_value)&#125;</span>äºº&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(high_value[[<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;total_amount&#x27;</span>]])</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 4. å°†Pandasæ•°æ®å†™å›æ•°æ®åº“</span></span><br><span class="line">    <span class="comment"># æ–°å»ºä¸€ä¸ª&quot;å®¢æˆ·ç»Ÿè®¡&quot;è¡¨</span></span><br><span class="line">    stats_df = df.groupby(<span class="string">&#x27;level&#x27;</span>).agg(&#123;</span><br><span class="line">        <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;count&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;total_amount&#x27;</span>: [<span class="string">&#x27;sum&#x27;</span>, <span class="string">&#x27;mean&#x27;</span>]</span><br><span class="line">    &#125;).<span class="built_in">round</span>(<span class="number">2</span>)</span><br><span class="line">    </span><br><span class="line">    stats_df.columns = [<span class="string">&#x27;å®¢æˆ·æ•°&#x27;</span>, <span class="string">&#x27;æ€»äº¤æ˜“é¢&#x27;</span>, <span class="string">&#x27;å¹³å‡äº¤æ˜“é¢&#x27;</span>]</span><br><span class="line">    stats_df = stats_df.reset_index()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å†™å…¥æ•°æ®åº“ï¼ˆå¦‚æœè¡¨å·²å­˜åœ¨åˆ™æ›¿æ¢ï¼‰</span></span><br><span class="line">    stats_df.to_sql(<span class="string">&#x27;customer_stats&#x27;</span>, conn, if_exists=<span class="string">&#x27;replace&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nâœ… ç»Ÿè®¡è¡¨å·²å†™å…¥æ•°æ®åº“&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 5. ä»æ•°æ®åº“è¯»å–ç»Ÿè®¡è¡¨éªŒè¯</span></span><br><span class="line">    stats_from_db = pd.read_sql(<span class="string">&quot;SELECT * FROM customer_stats&quot;</span>, conn)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nğŸ“ˆ å®¢æˆ·ç­‰çº§ç»Ÿè®¡ï¼š&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(stats_from_db)</span><br><span class="line">    </span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line">pandas_with_sqlite()</span><br></pre></td></tr></table></figure><hr><h3 id="äº”ã€å®æˆ˜ï¼šæ„å»ºå®¢æˆ·ç®¡ç†ç³»ç»Ÿ"><a href="#äº”ã€å®æˆ˜ï¼šæ„å»ºå®¢æˆ·ç®¡ç†ç³»ç»Ÿ" class="headerlink" title="äº”ã€å®æˆ˜ï¼šæ„å»ºå®¢æˆ·ç®¡ç†ç³»ç»Ÿ"></a>äº”ã€å®æˆ˜ï¼šæ„å»ºå®¢æˆ·ç®¡ç†ç³»ç»Ÿ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ========== å®¢æˆ·ç®¡ç†ç³»ç»Ÿ - å®Œæ•´ç‰ˆ ==========</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CustomerManagementSystem</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å®¢æˆ·ç®¡ç†ç³»ç»Ÿï¼ˆSQLiteç‰ˆï¼‰&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, db_file=<span class="string">&#x27;customer_management.db&#x27;</span></span>):</span><br><span class="line">        self.db_file = db_file</span><br><span class="line">        self.init_database()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">init_database</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;åˆå§‹åŒ–æ•°æ®åº“å’Œè¡¨&quot;&quot;&quot;</span></span><br><span class="line">        conn = sqlite3.connect(self.db_file)</span><br><span class="line">        cursor = conn.cursor()</span><br><span class="line">        </span><br><span class="line">        create_table_sql = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        CREATE TABLE IF NOT EXISTS customers (</span></span><br><span class="line"><span class="string">            id INTEGER PRIMARY KEY AUTOINCREMENT,</span></span><br><span class="line"><span class="string">            name TEXT NOT NULL,</span></span><br><span class="line"><span class="string">            company TEXT,</span></span><br><span class="line"><span class="string">            phone TEXT UNIQUE,</span></span><br><span class="line"><span class="string">            email TEXT,</span></span><br><span class="line"><span class="string">            level TEXT DEFAULT &#x27;æ™®é€š&#x27;,</span></span><br><span class="line"><span class="string">            total_amount REAL DEFAULT 0,</span></span><br><span class="line"><span class="string">            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP</span></span><br><span class="line"><span class="string">        )</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        </span><br><span class="line">        cursor.execute(create_table_sql)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åˆ›å»ºäº¤äº’è®°å½•è¡¨ï¼ˆè¿›é˜¶ï¼‰</span></span><br><span class="line">        cursor.execute(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        CREATE TABLE IF NOT EXISTS interactions (</span></span><br><span class="line"><span class="string">            id INTEGER PRIMARY KEY AUTOINCREMENT,</span></span><br><span class="line"><span class="string">            customer_id INTEGER,</span></span><br><span class="line"><span class="string">            type TEXT,</span></span><br><span class="line"><span class="string">            content TEXT,</span></span><br><span class="line"><span class="string">            amount REAL,</span></span><br><span class="line"><span class="string">            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,</span></span><br><span class="line"><span class="string">            FOREIGN KEY (customer_id) REFERENCES customers(id)</span></span><br><span class="line"><span class="string">        )</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        conn.commit()</span><br><span class="line">        conn.close()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_customer</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;äº¤äº’å¼æ·»åŠ å®¢æˆ·&quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span> * <span class="number">40</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;æ·»åŠ æ–°å®¢æˆ·&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">40</span>)</span><br><span class="line">        </span><br><span class="line">        name = <span class="built_in">input</span>(<span class="string">&quot;å§“å: &quot;</span>).strip()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> name:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;âŒ å§“åä¸èƒ½ä¸ºç©º&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        company = <span class="built_in">input</span>(<span class="string">&quot;å…¬å¸: &quot;</span>).strip()</span><br><span class="line">        phone = <span class="built_in">input</span>(<span class="string">&quot;ç”µè¯: &quot;</span>).strip()</span><br><span class="line">        email = <span class="built_in">input</span>(<span class="string">&quot;é‚®ç®±: &quot;</span>).strip()</span><br><span class="line">        level = <span class="built_in">input</span>(<span class="string">&quot;ç­‰çº§ï¼ˆVIP/é‡è¦/æ™®é€šï¼Œé»˜è®¤æ™®é€šï¼‰: &quot;</span>).strip() <span class="keyword">or</span> <span class="string">&#x27;æ™®é€š&#x27;</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            amount = <span class="built_in">float</span>(<span class="built_in">input</span>(<span class="string">&quot;ç´¯è®¡äº¤æ˜“é‡‘é¢: &quot;</span>).strip() <span class="keyword">or</span> <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            amount = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        conn = sqlite3.connect(self.db_file)</span><br><span class="line">        cursor = conn.cursor()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            cursor.execute(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            INSERT INTO customers (name, company, phone, email, level, total_amount)</span></span><br><span class="line"><span class="string">            VALUES (?, ?, ?, ?, ?, ?)</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span>, (name, company, phone, email, level, amount))</span><br><span class="line">            </span><br><span class="line">            conn.commit()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;âœ… å®¢æˆ·æ·»åŠ æˆåŠŸï¼ID: <span class="subst">&#123;cursor.lastrowid&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">except</span> sqlite3.IntegrityError:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;âŒ é”™è¯¯ï¼šç”µè¯å·ç å·²å­˜åœ¨ï¼Œè¯·ä½¿ç”¨å…¶ä»–å·ç &quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            conn.close()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">search_customers</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;é«˜çº§æŸ¥è¯¢&quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span> * <span class="number">40</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;å®¢æˆ·æŸ¥è¯¢&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">40</span>)</span><br><span class="line">        </span><br><span class="line">        keyword = <span class="built_in">input</span>(<span class="string">&quot;è¾“å…¥æœç´¢å…³é”®è¯ï¼ˆå§“å/å…¬å¸/ç”µè¯ï¼‰: &quot;</span>).strip()</span><br><span class="line">        </span><br><span class="line">        conn = sqlite3.connect(self.db_file)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢é˜²æ­¢SQLæ³¨å…¥</span></span><br><span class="line">        query = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        SELECT * FROM customers </span></span><br><span class="line"><span class="string">        WHERE name LIKE ? OR company LIKE ? OR phone LIKE ?</span></span><br><span class="line"><span class="string">        ORDER BY total_amount DESC</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># %è¡¨ç¤ºæ¨¡ç³ŠåŒ¹é…</span></span><br><span class="line">        keyword_pattern = <span class="string">f&#x27;%<span class="subst">&#123;keyword&#125;</span>%&#x27;</span></span><br><span class="line">        df = pd.read_sql(query, conn, params=[keyword_pattern, keyword_pattern, keyword_pattern])</span><br><span class="line">        </span><br><span class="line">        conn.close()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> df.empty:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;ğŸ“­ æœªæ‰¾åˆ°åŒ¹é…çš„å®¢æˆ·&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ” æ‰¾åˆ° <span class="subst">&#123;<span class="built_in">len</span>(df)&#125;</span> ä½å®¢æˆ·ï¼š&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(df.to_string(index=<span class="literal">False</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">record_interaction</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;è®°å½•å®¢æˆ·äº¤äº’ï¼ˆè®¢å•ã€æŠ•è¯‰ã€å›è®¿ï¼‰&quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span> * <span class="number">40</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;è®°å½•å®¢æˆ·äº¤äº’&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">40</span>)</span><br><span class="line">        </span><br><span class="line">        customer_id = <span class="built_in">input</span>(<span class="string">&quot;å®¢æˆ·ID: &quot;</span>).strip()</span><br><span class="line">        interaction_type = <span class="built_in">input</span>(<span class="string">&quot;äº¤äº’ç±»å‹ï¼ˆè®¢å•/æŠ•è¯‰/å›è®¿/ä»˜æ¬¾ï¼‰: &quot;</span>).strip()</span><br><span class="line">        content = <span class="built_in">input</span>(<span class="string">&quot;äº¤äº’å†…å®¹: &quot;</span>).strip()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            amount = <span class="built_in">float</span>(<span class="built_in">input</span>(<span class="string">&quot;æ¶‰åŠé‡‘é¢ï¼ˆæ— åˆ™å›è½¦ï¼‰: &quot;</span>).strip() <span class="keyword">or</span> <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            amount = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        conn = sqlite3.connect(self.db_file)</span><br><span class="line">        cursor = conn.cursor()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ’å…¥äº¤äº’è®°å½•</span></span><br><span class="line">        cursor.execute(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        INSERT INTO interactions (customer_id, type, content, amount)</span></span><br><span class="line"><span class="string">        VALUES (?, ?, ?, ?)</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span>, (customer_id, interaction_type, content, amount))</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¦‚æœæ˜¯è®¢å•ï¼Œæ›´æ–°å®¢æˆ·ç´¯è®¡äº¤æ˜“é‡‘é¢</span></span><br><span class="line">        <span class="keyword">if</span> interaction_type == <span class="string">&#x27;è®¢å•&#x27;</span>:</span><br><span class="line">            cursor.execute(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            UPDATE customers </span></span><br><span class="line"><span class="string">            SET total_amount = total_amount + ?</span></span><br><span class="line"><span class="string">            WHERE id = ?</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span>, (amount, customer_id))</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;âœ… è®¢å•è®°å½•æˆåŠŸï¼Œå®¢æˆ·ç´¯è®¡äº¤æ˜“å·²æ›´æ–°&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        conn.commit()</span><br><span class="line">        conn.close()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;âœ… äº¤äº’è®°å½•å·²ä¿å­˜&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">generate_report</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç”Ÿæˆå®¢æˆ·åˆ†ææŠ¥å‘Š&quot;&quot;&quot;</span></span><br><span class="line">        conn = sqlite3.connect(self.db_file)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span> * <span class="number">50</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;å®¢æˆ·åˆ†ææŠ¥å‘Š&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">50</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å®¢æˆ·åˆ†å¸ƒç»Ÿè®¡</span></span><br><span class="line">        stats_df = pd.read_sql(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        SELECT </span></span><br><span class="line"><span class="string">            level as å®¢æˆ·ç­‰çº§,</span></span><br><span class="line"><span class="string">            COUNT(*) as å®¢æˆ·æ•°é‡,</span></span><br><span class="line"><span class="string">            ROUND(AVG(total_amount), 2) as å¹³å‡äº¤æ˜“é¢,</span></span><br><span class="line"><span class="string">            ROUND(SUM(total_amount), 2) as æ€»äº¤æ˜“é¢</span></span><br><span class="line"><span class="string">        FROM customers</span></span><br><span class="line"><span class="string">        GROUP BY level</span></span><br><span class="line"><span class="string">        ORDER BY æ€»äº¤æ˜“é¢ DESC</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span>, conn)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\nğŸ“Š å®¢æˆ·ç­‰çº§åˆ†å¸ƒï¼š&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(stats_df.to_string(index=<span class="literal">False</span>))</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æœ¬æœˆæ–°å¢å®¢æˆ·</span></span><br><span class="line">        new_customers = pd.read_sql(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        SELECT name, company, created_at </span></span><br><span class="line"><span class="string">        FROM customers </span></span><br><span class="line"><span class="string">        WHERE created_at &gt;= date(&#x27;now&#x27;, &#x27;-30 days&#x27;)</span></span><br><span class="line"><span class="string">        ORDER BY created_at DESC</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span>, conn)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> new_customers.empty:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ†• æœ¬æœˆæ–°å¢å®¢æˆ·ï¼ˆ<span class="subst">&#123;<span class="built_in">len</span>(new_customers)&#125;</span>äººï¼‰ï¼š&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(new_customers.to_string(index=<span class="literal">False</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\nğŸ†• æœ¬æœˆæš‚æ— æ–°å®¢æˆ·&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># é«˜ä»·å€¼å®¢æˆ·TOP5</span></span><br><span class="line">        top5 = pd.read_sql(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        SELECT name, company, total_amount, level</span></span><br><span class="line"><span class="string">        FROM customers</span></span><br><span class="line"><span class="string">        ORDER BY total_amount DESC</span></span><br><span class="line"><span class="string">        LIMIT 5</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span>, conn)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\nğŸ’ é«˜ä»·å€¼å®¢æˆ·TOP5ï¼š&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(top5.to_string(index=<span class="literal">False</span>))</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># äº¤äº’ç»Ÿè®¡</span></span><br><span class="line">        interaction_stats = pd.read_sql(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        SELECT </span></span><br><span class="line"><span class="string">            type as äº¤äº’ç±»å‹,</span></span><br><span class="line"><span class="string">            COUNT(*) as æ¬¡æ•°,</span></span><br><span class="line"><span class="string">            ROUND(SUM(amount), 2) as æ€»é‡‘é¢</span></span><br><span class="line"><span class="string">        FROM interactions</span></span><br><span class="line"><span class="string">        WHERE created_at &gt;= date(&#x27;now&#x27;, &#x27;-30 days&#x27;)</span></span><br><span class="line"><span class="string">        GROUP BY type</span></span><br><span class="line"><span class="string">        ORDER BY æ¬¡æ•° DESC</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span>, conn)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> interaction_stats.empty:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\nğŸ“ æœ¬æœˆäº¤äº’ç»Ÿè®¡ï¼š&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(interaction_stats.to_string(index=<span class="literal">False</span>))</span><br><span class="line">        </span><br><span class="line">        conn.close()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ä¿å­˜æŠ¥å‘Š</span></span><br><span class="line">        <span class="keyword">with</span> pd.ExcelWriter(<span class="string">&#x27;å®¢æˆ·åˆ†ææŠ¥å‘Š.xlsx&#x27;</span>, engine=<span class="string">&#x27;openpyxl&#x27;</span>) <span class="keyword">as</span> writer:</span><br><span class="line">            stats_df.to_excel(writer, sheet_name=<span class="string">&#x27;å®¢æˆ·ç»Ÿè®¡&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> new_customers.empty:</span><br><span class="line">                new_customers.to_excel(writer, sheet_name=<span class="string">&#x27;æ–°å®¢æˆ·&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">            top5.to_excel(writer, sheet_name=<span class="string">&#x27;TOP5å®¢æˆ·&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> interaction_stats.empty:</span><br><span class="line">                interaction_stats.to_excel(writer, sheet_name=<span class="string">&#x27;äº¤äº’ç»Ÿè®¡&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\nâœ… æŠ¥å‘Šå·²ä¿å­˜: å®¢æˆ·åˆ†ææŠ¥å‘Š.xlsx&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ä¸»èœå•&quot;&quot;&quot;</span></span><br><span class="line">    cms = CustomerManagementSystem()</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">55</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å®¢æˆ·ç®¡ç†ç³»ç»Ÿ&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ•°æ®åº“ç‰ˆ - æ•°æ®å®‰å…¨å¯é ï¼ŒæŸ¥è¯¢å¿«é€Ÿ&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">55</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span> * <span class="number">45</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;åŠŸèƒ½èœå•&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">45</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;1. æ·»åŠ å®¢æˆ·&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;2. æŸ¥è¯¢å®¢æˆ·&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;3. è®°å½•å®¢æˆ·äº¤äº’&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;4. ç”Ÿæˆåˆ†ææŠ¥å‘Š&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;5. é€€å‡º&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">45</span>)</span><br><span class="line">        </span><br><span class="line">        choice = <span class="built_in">input</span>(<span class="string">&quot;è¯·é€‰æ‹©: &quot;</span>).strip()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> choice == <span class="string">&quot;1&quot;</span>:</span><br><span class="line">            cms.add_customer()</span><br><span class="line">        <span class="keyword">elif</span> choice == <span class="string">&quot;2&quot;</span>:</span><br><span class="line">            cms.search_customers()</span><br><span class="line">        <span class="keyword">elif</span> choice == <span class="string">&quot;3&quot;</span>:</span><br><span class="line">            cms.record_interaction()</span><br><span class="line">        <span class="keyword">elif</span> choice == <span class="string">&quot;4&quot;</span>:</span><br><span class="line">            cms.generate_report()</span><br><span class="line">        <span class="keyword">elif</span> choice == <span class="string">&quot;5&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;ğŸ‘‹ æ„Ÿè°¢ä½¿ç”¨ï¼Œæ•°æ®å·²å®‰å…¨ä¿å­˜ï¼&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;è¯·è¾“å…¥1-5ï¼&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><hr><h3 id="å…­ã€çŸ¥è¯†ç‚¹åŠ æ²¹ç«™"><a href="#å…­ã€çŸ¥è¯†ç‚¹åŠ æ²¹ç«™" class="headerlink" title="å…­ã€çŸ¥è¯†ç‚¹åŠ æ²¹ç«™"></a>å…­ã€çŸ¥è¯†ç‚¹åŠ æ²¹ç«™</h3><h4 id="6-1-SQLè¯­å¥é€ŸæŸ¥"><a href="#6-1-SQLè¯­å¥é€ŸæŸ¥" class="headerlink" title="6.1 SQLè¯­å¥é€ŸæŸ¥"></a>6.1 SQLè¯­å¥é€ŸæŸ¥</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">-- æŸ¥è¯¢</span></span><br><span class="line"><span class="string">SELECT åˆ—1, åˆ—2 FROM è¡¨ WHERE æ¡ä»¶ ORDER BY åˆ—</span></span><br><span class="line"><span class="string">-- æ¨¡ç³ŠæŸ¥è¯¢</span></span><br><span class="line"><span class="string">SELECT * FROM customers WHERE name LIKE &#x27;å¼ %&#x27;</span></span><br><span class="line"><span class="string">-- èšåˆå‡½æ•°</span></span><br><span class="line"><span class="string">COUNT(), SUM(), AVG(), MAX(), MIN()</span></span><br><span class="line"><span class="string">-- åˆ†ç»„</span></span><br><span class="line"><span class="string">SELECT level, COUNT(*) FROM customers GROUP BY level</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- æ’å…¥</span></span><br><span class="line"><span class="string">INSERT INTO è¡¨ (åˆ—1, åˆ—2) VALUES (å€¼1, å€¼2)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- æ›´æ–°</span></span><br><span class="line"><span class="string">UPDATE è¡¨ SET åˆ—=å€¼ WHERE æ¡ä»¶</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- åˆ é™¤</span></span><br><span class="line"><span class="string">DELETE FROM è¡¨ WHERE æ¡ä»¶</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- åˆ›å»ºè¡¨</span></span><br><span class="line"><span class="string">CREATE TABLE IF NOT EXISTS è¡¨å (</span></span><br><span class="line"><span class="string">    id INTEGER PRIMARY KEY AUTOINCREMENT,</span></span><br><span class="line"><span class="string">    åˆ—å ç±»å‹ çº¦æŸ,</span></span><br><span class="line"><span class="string">    ...</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- æ•°æ®ç±»å‹</span></span><br><span class="line"><span class="string">INTEGER  æ•´æ•°</span></span><br><span class="line"><span class="string">REAL     æµ®ç‚¹æ•°</span></span><br><span class="line"><span class="string">TEXT     æ–‡æœ¬</span></span><br><span class="line"><span class="string">BLOB     äºŒè¿›åˆ¶</span></span><br><span class="line"><span class="string">TIMESTAMP æ—¶é—´æˆ³</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><hr><h4 id="6-2-SQLite-vs-å…¶ä»–æ•°æ®åº“"><a href="#6-2-SQLite-vs-å…¶ä»–æ•°æ®åº“" class="headerlink" title="6.2 SQLite vs å…¶ä»–æ•°æ®åº“"></a>6.2 SQLite vs å…¶ä»–æ•°æ®åº“</h4><table><thead><tr><th>ç‰¹æ€§</th><th>SQLite</th><th>MySQL&#x2F;PostgreSQL</th></tr></thead><tbody><tr><td>å®‰è£…</td><td>æ— éœ€å®‰è£…ï¼Œæ–‡ä»¶å³æ•°æ®åº“</td><td>éœ€å®‰è£…æœåŠ¡å™¨</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>å°å‹åº”ç”¨ã€å•æœºã€å­¦ä¹ </td><td>å¤§å‹åº”ç”¨ã€å¤šç”¨æˆ·ã€ä¼ä¸šçº§</td></tr><tr><td>æ€§èƒ½</td><td>ç™¾ä¸‡çº§æ•°æ®è‰¯å¥½</td><td>åƒä¸‡çº§ä»¥ä¸Šä¼˜ç§€</td></tr><tr><td>å¹¶å‘</td><td>é€‚åˆä½å¹¶å‘</td><td>é«˜å¹¶å‘ä¼˜åŒ–</td></tr><tr><td>å­¦ä¹ æˆæœ¬</td><td>æä½ï¼Œä¸Šæ‰‹å¿«</td><td>è¾ƒé«˜ï¼Œéœ€é…ç½®ç®¡ç†</td></tr></tbody></table><p><strong>ç»“è®º</strong>ï¼šå¯¹äºä¸ªäººè´¢åŠ¡ç®¡ç†ã€å°å‹ä¼ä¸šåº”ç”¨ï¼ŒSQLiteå®Œå…¨å¤Ÿç”¨ï¼</p><hr><h3 id="ä¸ƒã€æ€»ç»“"><a href="#ä¸ƒã€æ€»ç»“" class="headerlink" title="ä¸ƒã€æ€»ç»“"></a>ä¸ƒã€æ€»ç»“</h3><ul><li>âœ… æ•°æ®åº“æ ¸å¿ƒæ¦‚å¿µï¼ˆè¡¨ã€è®°å½•ã€å­—æ®µï¼‰</li><li>âœ… SQLå››å¤§æ“ä½œï¼šå¢åˆ æ”¹æŸ¥</li><li>âœ… Pythonæ“ä½œSQLite</li><li>âœ… Pandasä¸SQLiteç»“åˆ</li><li>âœ… æ„å»ºå®Œæ•´çš„å®¢æˆ·ç®¡ç†ç³»ç»Ÿ</li></ul><hr><h3 id="ä¸‹ç¯‡é¢„å‘Š"><a href="#ä¸‹ç¯‡é¢„å‘Š" class="headerlink" title="ä¸‹ç¯‡é¢„å‘Š"></a>ä¸‹ç¯‡é¢„å‘Š</h3><p>ç¬¬23ç¯‡ã€Šè‡ªåŠ¨åŒ–åŠå…¬ï¼šPython+Excelé«˜çº§åº”ç”¨ã€‹â€”â€”è‡ªåŠ¨ç”Ÿæˆå¤æ‚æŠ¥è¡¨ã€æ•°æ®é€è§†è¡¨è‡ªåŠ¨åŒ–ï¼</p><hr><blockquote><p>ğŸ¤– Powered by Kimi K2 Thinking ğŸ’» å†…å®¹ç»è‘µè‘µğŸŒ»å®¡æ ¸ä¸ä¿®æ”¹</p></blockquote><hr></div><footer class="post-footer"><div class="post-nav"><div class="post-nav-item"><a href="/86b1dcdb.html" rel="prev" title="Python-ç¬¬21ç¯‡ã€Šæ­£åˆ™è¡¨è¾¾å¼ï¼šæ–‡æœ¬å¤„ç†åˆ©å™¨ã€‹"><i class="fa fa-chevron-left"></i> Python-ç¬¬21ç¯‡ã€Šæ­£åˆ™è¡¨è¾¾å¼ï¼šæ–‡æœ¬å¤„ç†åˆ©å™¨ã€‹</a></div><div class="post-nav-item"><a href="/7cea4f2.html" rel="next" title="Python-ç¬¬23ç¯‡ã€Šè‡ªåŠ¨åŒ–åŠå…¬ï¼šPython+Excelé«˜çº§åº”ç”¨ã€‹">Python-ç¬¬23ç¯‡ã€Šè‡ªåŠ¨åŒ–åŠå…¬ï¼šPython+Excelé«˜çº§åº”ç”¨ã€‹ <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="valine-comments"></div><script>window.addEventListener("tabs:register",()=>{let t=CONFIG.comments["activeClass"];var e;(t=CONFIG.comments.storage?localStorage.getItem("comments_active")||t:t)&&(e=document.querySelector(`a[href="#comment-${t}"]`))&&e.click()}),CONFIG.comments.storage&&window.addEventListener("tabs:click",t=>{t.target.matches(".tabs-comment .tab-content .tab-pane")&&(t=t.target.classList[1],localStorage.setItem("comments_active",t))})</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">æ–‡ç« ç›®å½•</li><li class="sidebar-nav-overview">ç«™ç‚¹æ¦‚è§ˆ</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%BC%E8%AF%AD"><span class="nav-number">1.</span> <span class="nav-text">å¯¼è¯­</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%AC%E7%AF%87%E7%9B%AE%E6%A0%87"><span class="nav-number">2.</span> <span class="nav-text">æœ¬ç¯‡ç›®æ ‡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C%EF%BC%9A%E5%AE%89%E8%A3%85%E5%BA%93"><span class="nav-number">3.</span> <span class="nav-text">ä¸€ã€å‡†å¤‡å·¥ä½œï¼šå®‰è£…åº“</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E7%90%86%E8%A7%A3%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%9A%E4%BB%8EExcel%E8%A1%A8%E6%A0%BC%E8%AF%B4%E8%B5%B7"><span class="nav-number">4.</span> <span class="nav-text">äºŒã€ç†è§£æ•°æ®åº“ï¼šä»Excelè¡¨æ ¼è¯´èµ·</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-%E6%95%B0%E6%8D%AE%E5%BA%93-vs-Excel"><span class="nav-number">4.1.</span> <span class="nav-text">2.1 æ•°æ®åº“ vs Excel</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-%E5%88%9B%E5%BB%BA%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">4.2.</span> <span class="nav-text">2.2 åˆ›å»ºç¬¬ä¸€ä¸ªæ•°æ®åº“</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E3%80%81SQL%E5%9F%BA%E7%A1%80%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%9A%84%E2%80%9C%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5%E2%80%9D"><span class="nav-number">5.</span> <span class="nav-text">ä¸‰ã€SQLåŸºç¡€ï¼šæ•°æ®çš„â€œå¢åˆ æ”¹æŸ¥â€</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-INSERT-%E5%A2%9E%E5%8A%A0%E8%AE%B0%E5%BD%95%EF%BC%88%E6%B7%BB%E5%8A%A0%E5%AE%A2%E6%88%B7%EF%BC%89"><span class="nav-number">5.1.</span> <span class="nav-text">3.1 INSERT - å¢åŠ è®°å½•ï¼ˆæ·»åŠ å®¢æˆ·ï¼‰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-SELECT-%E6%9F%A5%E8%AF%A2%E8%AE%B0%E5%BD%95%EF%BC%88%E6%9F%A5%E6%89%BE%E5%AE%A2%E6%88%B7%EF%BC%89"><span class="nav-number">5.2.</span> <span class="nav-text">3.2 SELECT - æŸ¥è¯¢è®°å½•ï¼ˆæŸ¥æ‰¾å®¢æˆ·ï¼‰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-UPDATE-%E4%BF%AE%E6%94%B9%E8%AE%B0%E5%BD%95%EF%BC%88%E6%9B%B4%E6%96%B0%E5%AE%A2%E6%88%B7%E4%BF%A1%E6%81%AF%EF%BC%89"><span class="nav-number">5.3.</span> <span class="nav-text">3.3 UPDATE - ä¿®æ”¹è®°å½•ï¼ˆæ›´æ–°å®¢æˆ·ä¿¡æ¯ï¼‰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-DELETE-%E5%88%A0%E9%99%A4%E8%AE%B0%E5%BD%95%EF%BC%88%E5%88%A0%E9%99%A4%E5%AE%A2%E6%88%B7%EF%BC%89"><span class="nav-number">5.4.</span> <span class="nav-text">3.4 DELETE - åˆ é™¤è®°å½•ï¼ˆåˆ é™¤å®¢æˆ·ï¼‰</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%9B%E3%80%81Python-SQL%EF%BC%9A%E6%9B%B4%E4%BC%98%E9%9B%85%E7%9A%84%E6%93%8D%E4%BD%9C%E6%96%B9%E5%BC%8F"><span class="nav-number">6.</span> <span class="nav-text">å››ã€Python + SQLï¼šæ›´ä¼˜é›…çš„æ“ä½œæ–¹å¼</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-%E4%BD%BF%E7%94%A8Pandas%E6%93%8D%E4%BD%9CSQLite"><span class="nav-number">6.1.</span> <span class="nav-text">4.1 ä½¿ç”¨Pandasæ“ä½œSQLite</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%94%E3%80%81%E5%AE%9E%E6%88%98%EF%BC%9A%E6%9E%84%E5%BB%BA%E5%AE%A2%E6%88%B7%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F"><span class="nav-number">7.</span> <span class="nav-text">äº”ã€å®æˆ˜ï¼šæ„å»ºå®¢æˆ·ç®¡ç†ç³»ç»Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%AD%E3%80%81%E7%9F%A5%E8%AF%86%E7%82%B9%E5%8A%A0%E6%B2%B9%E7%AB%99"><span class="nav-number">8.</span> <span class="nav-text">å…­ã€çŸ¥è¯†ç‚¹åŠ æ²¹ç«™</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#6-1-SQL%E8%AF%AD%E5%8F%A5%E9%80%9F%E6%9F%A5"><span class="nav-number">8.1.</span> <span class="nav-text">6.1 SQLè¯­å¥é€ŸæŸ¥</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-2-SQLite-vs-%E5%85%B6%E4%BB%96%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">8.2.</span> <span class="nav-text">6.2 SQLite vs å…¶ä»–æ•°æ®åº“</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%83%E3%80%81%E6%80%BB%E7%BB%93"><span class="nav-number">9.</span> <span class="nav-text">ä¸ƒã€æ€»ç»“</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8B%E7%AF%87%E9%A2%84%E5%91%8A"><span class="nav-number">10.</span> <span class="nav-text">ä¸‹ç¯‡é¢„å‘Š</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Aisaka Aoi" src="/images/manatsu.jpg"><p class="site-author-name" itemprop="name">Aisaka Aoi</p><div class="site-description" itemprop="description">é€¢å‚è‘µçš„ä¸ªäººåšå®¢</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">1034</span> <span class="site-state-item-name">æ—¥å¿—</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">20</span> <span class="site-state-item-name">åˆ†ç±»</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/AisakaAoi" title="GitHub ğŸ‘¨â€ğŸ’» â†’ https:&#x2F;&#x2F;github.com&#x2F;AisakaAoi" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub ğŸ‘¨â€ğŸ’»</a> </span><span class="links-of-author-item"><a href="https://github.com/Aisakaorz" title="GitHub ğŸ‘©â€ğŸ’» â†’ https:&#x2F;&#x2F;github.com&#x2F;Aisakaorz" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub ğŸ‘©â€ğŸ’»</a> </span><span class="links-of-author-item"><a href="mailto:aisakaaoi@qq.com" title="E-Mail ğŸ“§ â†’ mailto:aisakaaoi@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail ğŸ“§</a> </span><span class="links-of-author-item"><a href="mailto:chenzongnan@m.scnu.edu.cn" title="E-Mail ğŸ« â†’ mailto:chenzongnan@m.scnu.edu.cn" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail ğŸ«</a> </span><span class="links-of-author-item"><a href="https://space.bilibili.com/91560309" title="Bilibili ğŸ“º â†’ https:&#x2F;&#x2F;space.bilibili.com&#x2F;91560309" rel="noopener" target="_blank"><i class="fab fa-bilibili fa-fw"></i>Bilibili ğŸ“º</a> </span><span class="links-of-author-item"><a href="https://space.bilibili.com/198562921" title="Bilibili ğŸ® â†’ https:&#x2F;&#x2F;space.bilibili.com&#x2F;198562921" rel="noopener" target="_blank"><i class="fab fa-bilibili fa-fw"></i>Bilibili ğŸ®</a> </span><span class="links-of-author-item"><a href="https://www.youtube.com/channel/UCALvyn5Cl76GCotO9pczvjg" title="YouTube ğŸ“º â†’ https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCALvyn5Cl76GCotO9pczvjg" rel="noopener" target="_blank"><i class="fab fa-youtube fa-fw"></i>YouTube ğŸ“º</a></span></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2026</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Aisaka Aoi</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span class="post-meta-item-text">ç«™ç‚¹æ€»å­—æ•°ï¼š</span> <span title="ç«™ç‚¹æ€»å­—æ•°">4.1m</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span class="post-meta-item-text">ç«™ç‚¹é˜…è¯»æ—¶é•¿ &asymp;</span> <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">171:02</span></div><div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨</div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script>document.querySelectorAll(".pdfobject-container").forEach(e=>{var t=e.dataset.target,a="#"+Object.entries({navpanes:0,toolbar:0,statusbar:0,pagemode:"thumbs",view:"FitH"}).map(([e,t])=>e+"="+encodeURIComponent(t)).join("&"),r="/lib/pdf/web/viewer.html?file="+encodeURIComponent(t)+a;NexT.utils.supportsPDFs()?e.innerHTML=`<embed class="pdfobject" src="${t+a}" type="application/pdf" style="height: ${e.dataset.height};">`:e.innerHTML=`<iframe src="${r}" style="height: ${e.dataset.height};" frameborder="0"></iframe>`})</script><script>NexT.utils.loadComments(document.querySelector("#valine-comments"),()=>{NexT.utils.getScript("//unpkg.com/valine/dist/Valine.min.js",()=>{var i=["nick","mail","link"],e="nick,mail,link".split(",").filter(e=>i.includes(e));new Valine({el:"#valine-comments",verify:!0,notify:!0,appId:"UqjWdRYbIUEUQRXhBUUIh1QE-gzGzoHsz",appKey:"gj89JXC485PFbpdHLKVkz6dm",placeholder:"è¿™é‡Œå¯ä»¥å‘é€è¯„è®º~ï¼ˆä¸Šé¢å¯ä»¥è¾“å…¥æ˜µç§°ã€é‚®ç®±ï¼‰",avatar:"mm",meta:e,pageSize:"10",visitor:!0,lang:"zh-cn",path:location.pathname,recordIP:!1,serverURLs:""})},window.Valine)})</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/assets/haru02.model.json"},display:{position:"right",width:208,height:520},mobile:{show:!1},log:!1})</script></body></html>