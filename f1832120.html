<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0"><meta name="baidu-site-verification" content="code-KCMz4b3cnd"><meta name="google-site-verification" content="MTp8U7dJ1uzrfz8Mu6rgqX1CIm3HjqPWd0xaRcv1tFg"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="mask-icon" href="/images/favicon.png" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"aisakaaoi.github.io",root:"/",scheme:"Pisces",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:"valine",storage:!0,lazyload:!1,nav:null,activeClass:"valine"},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="ä¸€ã€RecyclerViewä¸ListViewã€ViewPagerRecyclerViewA flexible view for providing a limited window into a large data set."><meta property="og:type" content="article"><meta property="og:title" content="Android-RecyclerView-ç¼“å­˜å¤ç”¨ä¸æ•°æ®æ›´æ–°"><meta property="og:url" content="https://aisakaaoi.github.io/f1832120.html"><meta property="og:site_name" content="é€¢å‚è‘µçš„ä¸ªäººåšå®¢"><meta property="og:description" content="ä¸€ã€RecyclerViewä¸ListViewã€ViewPagerRecyclerViewA flexible view for providing a limited window into a large data set."><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://aisakaaoi.github.io/f1832120/1.webp"><meta property="og:image" content="https://aisakaaoi.github.io/f1832120/2.webp"><meta property="og:image" content="https://aisakaaoi.github.io/f1832120/3.webp"><meta property="og:image" content="https://aisakaaoi.github.io/f1832120/4.webp"><meta property="og:image" content="https://aisakaaoi.github.io/f1832120/5.webp"><meta property="og:image" content="https://aisakaaoi.github.io/f1832120/6.webp"><meta property="og:image" content="https://aisakaaoi.github.io/f1832120/7.webp"><meta property="og:image" content="https://aisakaaoi.github.io/f1832120/8.webp"><meta property="og:image" content="https://aisakaaoi.github.io/f1832120/9.webp"><meta property="og:image" content="https://aisakaaoi.github.io/f1832120/10.webp"><meta property="og:image" content="https://aisakaaoi.github.io/f1832120/11.webp"><meta property="og:image" content="https://aisakaaoi.github.io/f1832120/12.webp"><meta property="article:published_time" content="2021-08-19T08:01:02.000Z"><meta property="article:modified_time" content="2026-01-23T11:02:36.718Z"><meta property="article:author" content="Aisaka Aoi"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://aisakaaoi.github.io/f1832120/1.webp"><link rel="canonical" href="https://aisakaaoi.github.io/f1832120.html"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>Android-RecyclerView-ç¼“å­˜å¤ç”¨ä¸æ•°æ®æ›´æ–° | é€¢å‚è‘µçš„ä¸ªäººåšå®¢</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?7308ed05421777c301eefa3754da1b42",document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="é€¢å‚è‘µçš„ä¸ªäººåšå®¢" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ "><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">aoiå­¦é™¢</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">Aisaka's Blog, School of Aoi, Aisaka University</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»<span class="badge">20</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£<span class="badge">1034</span></a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="æœç´¢..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="reading-progress-bar"></div><a href="https://github.com/AisakaAoi" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://aisakaaoi.github.io/f1832120.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/manatsu.jpg"><meta itemprop="name" content="Aisaka Aoi"><meta itemprop="description" content="Aisaka's Blog, School of Aoi, Aisaka University"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="é€¢å‚è‘µçš„ä¸ªäººåšå®¢"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Android-RecyclerView-ç¼“å­˜å¤ç”¨ä¸æ•°æ®æ›´æ–°</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">å‘è¡¨äº</span> <time title="åˆ›å»ºæ—¶é—´ï¼š2021-08-19 16:01:02" itemprop="dateCreated datePublished" datetime="2021-08-19T16:01:02+08:00">2021-08-19</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">åˆ†ç±»äº</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%F0%9F%8C%99%E9%80%A2%E5%9D%82%E6%9D%82%E8%B0%88%E4%B8%8E%E6%90%AC%E8%BF%90/" itemprop="url" rel="index"><span itemprop="name">ğŸŒ™é€¢å‚æ‚è°ˆä¸æ¬è¿</span></a> </span>ï¼Œ <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%F0%9F%8C%99%E9%80%A2%E5%9D%82%E6%9D%82%E8%B0%88%E4%B8%8E%E6%90%AC%E8%BF%90/%E2%AD%90%E4%B8%80%E4%BA%9B%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">â­ä¸€äº›æŠ€æœ¯</span></a> </span></span><span id="/f1832120.html" class="post-meta-item leancloud_visitors" data-flag-title="Android-RecyclerView-ç¼“å­˜å¤ç”¨ä¸æ•°æ®æ›´æ–°" title="é˜…è¯»æ¬¡æ•°"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span> <span class="leancloud-visitors-count"></span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Valineï¼š</span> <a title="valine" href="/f1832120.html#valine-comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/f1832120.html" itemprop="commentCount"></span></a></span><br><span class="post-meta-item" title="æœ¬æ–‡å­—æ•°"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span> <span>12k</span> </span><span class="post-meta-item" title="é˜…è¯»æ—¶é•¿"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span> <span>30 åˆ†é’Ÿ</span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="ä¸€ã€RecyclerViewä¸ListViewã€ViewPager"><a href="#ä¸€ã€RecyclerViewä¸ListViewã€ViewPager" class="headerlink" title="ä¸€ã€RecyclerViewä¸ListViewã€ViewPager"></a>ä¸€ã€RecyclerViewä¸ListViewã€ViewPager</h2><h3 id="RecyclerView"><a href="#RecyclerView" class="headerlink" title="RecyclerView"></a>RecyclerView</h3><p>A flexible view for providing a limited window into a large data set.</p><img src="/f1832120/1.webp"> <img src="/f1832120/2.webp"> <img src="/f1832120/3.webp"> <span id="more"></span><p>ä¸€èˆ¬æ­¥éª¤ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mRecyclerView.setLayoutManager(layoutManager); </span><br><span class="line">mRecyclerView.setAdapter(galleryAdapter); </span><br><span class="line"><span class="keyword">new</span> <span class="title class_">PagerSnapHelper</span>().attachToRecyclerView(mGalleryRecyclerView);</span><br></pre></td></tr></table></figure><h3 id="ListViewå’ŒRecyclerView"><a href="#ListViewå’ŒRecyclerView" class="headerlink" title="ListViewå’ŒRecyclerView"></a>ListViewå’ŒRecyclerView</h3><p>Recyclerviewé€šè¿‡å†…éƒ¨ç±»Recyclerç®¡ç†çš„ç¼“å­˜ï¼Œç¼“å­˜çš„æ˜¯ViewHolderï¼ˆå†…éƒ¨åŒ…å«å­Viewï¼‰ï¼Œè¿™æ ·åœ¨æ»‘åŠ¨æ—¶å¯ä»¥å¤ç”¨å­Viewï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿˜å¯ä»¥å¤ç”¨å­Viewç»‘å®šçš„æ•°æ®ã€‚æ‰€ä»¥<strong>æœ¬è´¨ä¸Šç¼“å­˜æ˜¯ä¸ºäº†å‡å°‘é‡å¤ç»˜åˆ¶Viewå’Œç»‘å®šæ•°æ®çš„æ—¶é—´ï¼Œä»è€Œæé«˜äº†æ»‘åŠ¨æ—¶çš„æ€§èƒ½ã€‚</strong></p><p>ListViewç¼“å­˜æœºåˆ¶ï¼Œå¯¹åº”åˆ°å±å¹•ä¸Šï¼š</p><img src="/f1832120/4.webp"> <img src="/f1832120/5.webp"><p>RecyclerViewç¼“å­˜æœºåˆ¶ï¼Œå¯¹åº”åˆ°å±å¹•ä¸Šï¼Œä»¥åŠå¯è‡ªå®šä¹‰éƒ¨åˆ†ï¼š</p><img src="/f1832120/6.webp"> <img src="/f1832120/7.webp"><table><thead><tr><th>ListViewçš„å±€é™</th><th>RecyclerViewçš„ä¼˜åŠ¿</th></tr></thead><tbody><tr><td>1. çºµå‘åˆ—è¡¨ä¸€ç§å¸ƒå±€</td><td>1.é»˜è®¤æ”¯æŒLinear, Grid, Staggered Gridä¸‰ç§å¸ƒå±€</td></tr><tr><td>2. æ²¡æœ‰æ”¯æŒåŠ¨ç”»çš„API</td><td>2. ItemAnimatoråŠ¨ç”»API</td></tr><tr><td>3. æ¥å£è®¾è®¡å’Œç³»ç»Ÿä¸ä¸€è‡´</td><td>3. å¼ºåˆ¶å®ç°ViewHolder</td></tr><tr><td>4. æ²¡æœ‰å¼ºåˆ¶å®ç°ViewHolder</td><td>4. è§£è€¦æ¶æ„è®¾è®¡</td></tr><tr><td>5. æ€§èƒ½ä¸å¦‚RecyclerView</td><td>5. ç›¸æ¯”ListViewæ›´å¥½çš„æ€§èƒ½</td></tr></tbody></table><p><strong>ç›¸ä¼¼ç‚¹ï¼š</strong></p><ol><li><p>mActiveViewså’ŒmAttachedScrapåŠŸèƒ½ç›¸ä¼¼ï¼Œæ„ä¹‰åœ¨äºå¿«é€Ÿé‡ç”¨å±å¹•ä¸Šå¯è§çš„åˆ—è¡¨é¡¹ItemViewï¼Œè€Œä¸éœ€è¦é‡æ–°createView()å’ŒbindView()</p></li><li><p>mScrapViewå’ŒmCachedViews+mReyclerViewPoolåŠŸèƒ½ç›¸ä¼¼ï¼Œæ„ä¹‰åœ¨äºç¼“å­˜ç¦»å¼€å±å¹•çš„ItemViewï¼Œç›®çš„æ˜¯è®©å³å°†è¿›å…¥å±å¹•çš„ItemViewé‡ç”¨</p></li><li><p>RecyclerViewçš„ä¼˜åŠ¿åœ¨äºã€mCacheViewsçš„ä½¿ç”¨ï¼Œå¯ä»¥åšåˆ°å±å¹•å¤–çš„åˆ—è¡¨é¡¹ItemViewè¿›å…¥å±å¹•å†…æ—¶ä¹Ÿæ— é¡»bindViewå¿«é€Ÿé‡ç”¨ã€‘ï¼›ã€mRecyclerPoolå¯ä»¥ä¾›å¤šä¸ªRecyclerViewå…±åŒä½¿ç”¨ã€‘ï¼Œåœ¨ç‰¹å®šåœºæ™¯ä¸‹ï¼Œå¦‚viewpager+å¤šä¸ªåˆ—è¡¨é¡µä¸‹æœ‰ä¼˜åŠ¿</p></li></ol><ul><li>æ€»çš„æ¥è¯´ï¼ŒRecyclerViewåœ¨ç‰¹å®šåœºæ™¯ä¸‹å¯¹ListViewçš„ç¼“å­˜æœºåˆ¶è¿›è¡Œå®Œå–„ã€‚</li></ul><p><strong>ä¸åŒç‚¹ï¼š</strong></p><ol><li><p>RecyclerViewç¼“å­˜RecyclerView.ViewHolderï¼ŒæŠ½è±¡å¯ç†è§£ä¸ºï¼šView+ViewHolderï¼ˆé¿å…æ¯æ¬¡createViewæ—¶è°ƒç”¨findViewByIdï¼‰+flagï¼ˆæ ‡è¯†çŠ¶æ€ï¼‰</p></li><li><p>ListViewç¼“å­˜View</p></li></ol><h3 id="ViewPagerå’ŒViewPager2ï¼ˆRecyclerViewï¼‰"><a href="#ViewPagerå’ŒViewPager2ï¼ˆRecyclerViewï¼‰" class="headerlink" title="ViewPagerå’ŒViewPager2ï¼ˆRecyclerViewï¼‰"></a>ViewPagerå’ŒViewPager2ï¼ˆRecyclerViewï¼‰</h3><p>ViewPager2 åº•å±‚æ˜¯ç”¨ RecycleView å®ç°ï¼ˆRecyclerView.Adapterï¼‰</p><p>RecyclerViewçš„Adapterå¯ä»¥é’ˆå¯¹ä¸åŒItemçš„ViewTypeæ¥ç¼“å­˜ä¸åŒçš„Item</p><p>ä¾‹å­ï¼šTabLayout ä¸ ViewPager2</p><hr><h2 id="äºŒã€RecyclerViewåœ¨TVä¸Šçš„åº”ç”¨"><a href="#äºŒã€RecyclerViewåœ¨TVä¸Šçš„åº”ç”¨" class="headerlink" title="äºŒã€RecyclerViewåœ¨TVä¸Šçš„åº”ç”¨"></a>äºŒã€RecyclerViewåœ¨TVä¸Šçš„åº”ç”¨</h2><h3 id="åŸç”ŸRecyclerViewä½¿ç”¨æ—¶çš„å±€é™æ€§"><a href="#åŸç”ŸRecyclerViewä½¿ç”¨æ—¶çš„å±€é™æ€§" class="headerlink" title="åŸç”ŸRecyclerViewä½¿ç”¨æ—¶çš„å±€é™æ€§"></a>åŸç”ŸRecyclerViewä½¿ç”¨æ—¶çš„å±€é™æ€§</h3><p>åœ¨æ‰‹æœºç«¯ä½¿ç”¨RecyclerViewæ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯åœ¨TVç«¯å°±ä¼šå‡ºç°ä¸å°‘çš„é—®é¢˜ï¼Œä¾‹å¦‚ç„¦ç‚¹æ˜¾ç¤ºä¸å…¨ï¼Œæ— æ³•å®šä½åˆ°æŸä¸ªpositionç­‰ç­‰</p><img src="/f1832120/8.webp"><h4 id="RecyclerViewåˆ·æ–°æ•°æ®çš„æ—¶å€™ï¼Œç„¦ç‚¹é”™ä¹±é—®é¢˜"><a href="#RecyclerViewåˆ·æ–°æ•°æ®çš„æ—¶å€™ï¼Œç„¦ç‚¹é”™ä¹±é—®é¢˜" class="headerlink" title="RecyclerViewåˆ·æ–°æ•°æ®çš„æ—¶å€™ï¼Œç„¦ç‚¹é”™ä¹±é—®é¢˜"></a>RecyclerViewåˆ·æ–°æ•°æ®çš„æ—¶å€™ï¼Œç„¦ç‚¹é”™ä¹±é—®é¢˜</h4><p><strong>åŸå› ï¼š</strong></p><p>ï¼ˆè‡ªè®¤ä¸ºæ˜¯viewHolderå¤ç”¨çš„é—®é¢˜ï¼Œè·Ÿæ•°æ®åˆ·æ–°ä½ç½®é”™ä¹±ç±»ä¼¼ï¼‰</p><p><strong>è§£å†³åŠæ³•ï¼š</strong></p><ol><li><p>adapterè°ƒç”¨setHasStableIds(true)æ–¹æ³•</p><p>ç­‰åŒäºè°ƒç”¨äº†viewholderä¸­çš„viewçš„requestFocus()æ–¹æ³•ã€‚</p><p>ç›¸å½“äºåŠ äº†ä¸€ä¸ªtagï¼Œtagä¸å˜çš„è¯ï¼Œä¸ç”¨é‡æ–°åŠ è½½ã€‚ä½†æ˜¯set trueåä¼šä½¿å¾—åˆ—è¡¨çš„æ•°æ®é¡¹é‡å¤ï¼Œæ‰€ä»¥éœ€è¦åœ¨Adapteré‡Œé¢é‡å†™getItemIdã€‚åŒæ—¶RecyclerViewçš„notifyæ–¹æ³•å›¾ç‰‡åŠ è½½æ—¶ä¸é—ªçƒã€‚</p></li><li><p>é‡å†™getItemId()æ–¹æ³•,è®©æ¯ä¸ªviewéƒ½æœ‰å„è‡ªçš„id</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">long</span> <span class="title function_">getItemId</span><span class="params">(<span class="type">int</span> position)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> position;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>RecyclerViewçš„å»æ‰åŠ¨ç”»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mRecyclerView.setItemAnimator(<span class="literal">null</span>);</span><br></pre></td></tr></table></figure></li></ol><h4 id="é•¿æŒ‰é¥æ§å™¨RecyclerViewå¿«é€Ÿæ»‘åŠ¨ï¼Œç„¦ç‚¹é”™ä¹±é—®é¢˜"><a href="#é•¿æŒ‰é¥æ§å™¨RecyclerViewå¿«é€Ÿæ»‘åŠ¨ï¼Œç„¦ç‚¹é”™ä¹±é—®é¢˜" class="headerlink" title="é•¿æŒ‰é¥æ§å™¨RecyclerViewå¿«é€Ÿæ»‘åŠ¨ï¼Œç„¦ç‚¹é”™ä¹±é—®é¢˜"></a>é•¿æŒ‰é¥æ§å™¨RecyclerViewå¿«é€Ÿæ»‘åŠ¨ï¼Œç„¦ç‚¹é”™ä¹±é—®é¢˜</h4><p><strong>åŸå› ï¼š</strong></p><p>RecyclerViewåœ¨é•¿æŒ‰é¥æ§å™¨çš„æƒ…å†µä¸‹ä¼šå¯¼è‡´Itemçš„ç„¦ç‚¹ä¸¢å¤±æˆ–è€…è¯´æ˜¯é£åˆ°åˆ«çš„æ§ä»¶ä¸Šã€‚ä¸»è¦æ˜¯å› ä¸ºRecyclerViewè®¾ç½®é€‚é…å™¨ï¼Œå°†æ•°æ®å…¨éƒ¨å¡«å……è¿›å»ä¹‹åï¼Œå¹¶ä¸ä¼šå°†æ‰€æœ‰çš„itemçš„viewåˆ›å»ºå‡ºæ¥ï¼Œåªä¼šåˆ›å»ºå‡ºæ˜¾ç¤ºå’Œéœ€è¦çš„itemçš„Viewï¼Œæ²¡æœ‰æ˜¾ç¤ºçš„Viewå¾ˆå¯èƒ½æ²¡æœ‰è¢«åˆ›å»ºã€‚åœ¨æ»‘åŠ¨çš„è¿‡ç¨‹ä¸­ï¼Œä¸‹ä¸€ä¸ªè¦è·å–ç„¦ç‚¹çš„viewï¼Œè¿˜å¤„äºç»˜åˆ¶æ¸²æŸ“é˜¶æ®µï¼ˆPFLAG_INVALIDATEDï¼ŒPFLAG_DIRTY_MASKï¼‰ï¼Œè¿™ä¸ªé˜¶æ®µçš„viewæ˜¯æ— æ³•è·å–ç„¦ç‚¹çš„ã€‚</p><p><strong>è§£å†³åŠæ³•ï¼š</strong></p><ol><li><p>è‡ªå®šä¹‰RecyclerViewï¼Œæ‹¦æˆªdispatchkeyEventäº‹ä»¶ï¼Œå¯¹æŒ‰é”®è¿›è¡Œè¿‡æ»¤ï¼Œå–æ¶ˆä¸€äº›viewè¿˜å¤„äºä¸èƒ½è·å–ç„¦ç‚¹çš„æŒ‰é”®äº‹ä»¶ï¼Œå¹¶æ ¹æ®é¥æ§å™¨æŒ‰é’®æ“ä½œæ¥è·å–ç„¦ç‚¹</p></li><li><p>æ¯”å¦‚ç›‘å¬äº†ä¸‹é”®ï¼Œåˆ¤æ–­å±•ç¤ºæ•°æ®çš„RecyclerViewæ˜¯å¦è·å¾—ç„¦ç‚¹äº†ï¼Œæ¥ç€åˆ¤æ–­äº†æ•°æ®sizeæ˜¯å¦ä¸ºç©ºï¼Œç®—å‡ºæ•°æ®æ•°é‡ï¼Œæœ€åä¸€ä¸ªitemè·å–åˆ°ç„¦ç‚¹å°±æ‹¦æˆªé¥æ§ä¸‹é”®ï¼Œè®©ç„¦ç‚¹ä¸€ç›´åœç•™åœ¨æœ€åä¸€ä¸ªitemä¸Šï¼Œå°±ä¸ä¼šå‡ºç°ç„¦ç‚¹ä¹±è·‘äº†</p></li></ol><h4 id="è§£å†³RecyclerView-å®šä½åˆ°æŸä¸ªitemä¸è·å–ç„¦ç‚¹é—®é¢˜"><a href="#è§£å†³RecyclerView-å®šä½åˆ°æŸä¸ªitemä¸è·å–ç„¦ç‚¹é—®é¢˜" class="headerlink" title="è§£å†³RecyclerView å®šä½åˆ°æŸä¸ªitemä¸è·å–ç„¦ç‚¹é—®é¢˜"></a>è§£å†³RecyclerView å®šä½åˆ°æŸä¸ªitemä¸è·å–ç„¦ç‚¹é—®é¢˜</h4><p><strong>åŸå› ï¼š</strong></p><p>RecyclerViewæä¾›äº†ä¸€ä¸ªsmoothScrollToPosition(int position)æ–¹æ³•ï¼Œè¯¥æ–¹æ³•èƒ½æ»‘åˆ°æŒ‡å®šçš„positionä½ç½®ï¼Œä½†æ˜¯å®é™…è¯¥positionå¤„çš„itemå¹¶æ²¡æœ‰è·å–ç„¦ç‚¹ã€‚</p><p><strong>è§£å†³åŠæ³•ï¼š</strong></p><ol><li><p>å®šä½åˆ°æŒ‡å®šä½ç½®çš„itemåï¼Œæ‰¾åˆ°ç›®æ ‡çš„itemï¼Œå¹¶è®©å…¶ä¸»åŠ¨è¯·æ±‚ç„¦ç‚¹</p></li><li><p>RecyclerViewå¼¹æ€§æ»‘åŠ¨SmoothScrollerä¸­æœ‰onStartå’ŒonStopçš„å›è°ƒï¼Œåœ¨onStopæ»‘åŠ¨ç»“æŸçš„å›è°ƒæ‰¾åˆ°targetViewï¼Œå¹¶è®©å…¶è¯·æ±‚ç„¦ç‚¹</p></li></ol><h4 id="Android-TV-ä¸­RecyclerViewèšç„¦Itemå®ç°å±…ä¸­åŠŸèƒ½"><a href="#Android-TV-ä¸­RecyclerViewèšç„¦Itemå®ç°å±…ä¸­åŠŸèƒ½" class="headerlink" title="Android TV ä¸­RecyclerViewèšç„¦Itemå®ç°å±…ä¸­åŠŸèƒ½"></a>Android TV ä¸­RecyclerViewèšç„¦Itemå®ç°å±…ä¸­åŠŸèƒ½</h4><p><strong>éœ€æ±‚ï¼š</strong></p><p>å®ç°ä¸€ç§èŠ‚ç›®åˆ—è¡¨é€‰ä¸­è‡ªåŠ¨å±…ä¸­æ”¾å¤§çš„åŠŸèƒ½</p><img src="/f1832120/9.webp"><p><strong>æ–¹æ³•1ï¼š</strong> é‡å†™RecyclerViewçš„layoutManagerçš„smoothScrollToPositionå‡½æ•°ï¼Œè¯¥æ–¹æ³•é€šè¿‡ä¿®æ”¹æ»‘åŠ¨Scrolleré‡Œé¢çš„åç§»é‡æ¥è¾¾åˆ°å±…ä¸­çš„æ•ˆæœ</p><p><strong>æ–¹æ³•2ï¼š</strong> åœ¨adapterä¸­ç»™itemæ·»åŠ ä¸€ä¸ªèšç„¦çš„ç›‘å¬ï¼Œç„¶åå¯¹å½“å‰Itemçš„åæ ‡ä»¥åŠRecyclerViewçš„ä½ç½®è®¡ç®—å‡ºéœ€è¦åç§»çš„é•¿åº¦ï¼Œæœ€åè°ƒç”¨RecyclerViewçš„smoothScrollByå‡½æ•°è¿›è¡Œæ»šåŠ¨ã€‚</p><hr><h2 id="ä¸‰ã€RecyclerViewç¼“å­˜ä¸å¤ç”¨åŸç†"><a href="#ä¸‰ã€RecyclerViewç¼“å­˜ä¸å¤ç”¨åŸç†" class="headerlink" title="ä¸‰ã€RecyclerViewç¼“å­˜ä¸å¤ç”¨åŸç†"></a>ä¸‰ã€RecyclerViewç¼“å­˜ä¸å¤ç”¨åŸç†</h2><h3 id="å››çº§ç¼“å­˜"><a href="#å››çº§ç¼“å­˜" class="headerlink" title="å››çº§ç¼“å­˜"></a>å››çº§ç¼“å­˜</h3><p>ä¼˜å…ˆçº§åˆé«˜åˆ°ä½ä¾æ¬¡æ˜¯ï¼š</p><p><strong>ArrayList mAttachedScrap</strong> â†’ ç¼“å­˜å±å¹•ä¸­å¯è§èŒƒå›´çš„ViewHolder</p><p><strong>ArrayList mCachedViews</strong> â†’ ç¼“å­˜æ»‘åŠ¨æ—¶å³å°†ä¸RecyclerViewåˆ†ç¦»çš„ViewHolderï¼ŒæŒ‰å­Viewçš„positionæˆ–idç¼“å­˜ï¼Œé»˜è®¤æœ€å¤šå­˜æ”¾2ä¸ª</p><p><strong>ViewCacheExtension mViewCacheExtension</strong> â†’ å¼€å‘è€…è‡ªè¡Œå®ç°çš„ç¼“å­˜</p><p><strong>RecycledViewPool mRecycledViewPool</strong> â†’ ViewHolderç¼“å­˜æ± ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªSparseArrayï¼Œå…¶ä¸­Keyæ˜¯ViewTypeï¼ˆIntç±»å‹ï¼‰ï¼Œvalueå­˜æ”¾çš„æ˜¯ArrayList<viewholder>ï¼Œé»˜è®¤æ¯ä¸ªArrayListä¸­æœ€å¤šå­˜æ”¾5ä¸ªViewHolder</viewholder></p><img src="/f1832120/10.webp"><p>é€šè¿‡mAttachedScrapï¼ˆ1ï¼‰ã€mCachedViewsï¼ˆ2ï¼‰è·å–çš„ViewHolderä¸éœ€è¦é‡æ–°åˆ›å»ºå¸ƒå±€åŠç»‘å®šæ•°æ®</p><p>é€šè¿‡ç¼“å­˜æ± mRecyclerPoolï¼ˆ4ï¼‰è·å–çš„ViewHolderä¸éœ€è¦é‡æ–°åˆ›å»ºå¸ƒå±€ï¼Œä½†æ˜¯éœ€è¦é‡æ–°ç»‘å®šæ•°æ®</p><p>å¦‚æœä¸Šè¿°ç¼“å­˜ä¸­éƒ½æ²¡æœ‰è·å–åˆ°ç›®æ ‡ViewHolderï¼Œé‚£ä¹ˆå°±ä¼šå›è°ƒAdapter#onCreateViewHolderåˆ›å»ºå¸ƒå±€ï¼Œä»¥åŠå›è°ƒAdapter#onBindViewHolderæ¥ç»‘å®šæ•°æ®ã€‚</p><table><thead><tr><th>ç¼“å­˜ç­‰çº§</th><th>æ˜¯å¦éœ€è¦å›è°ƒcreateView()</th><th>æ˜¯å¦éœ€è¦å›è°ƒbindView()</th><th>ç”Ÿå‘½å‘¨æœŸ</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>mAttachedScrap</td><td>å¦</td><td>å¦</td><td>onLayout()å‘¨æœŸå†…</td><td>ç”¨äºå±å¹•å†…ItemViewå¿«é€Ÿé‡ç”¨</td></tr><tr><td>mCacheViews</td><td>å¦</td><td>å¦</td><td>ä¸mAdapterä¸€è‡´ï¼Œå½“mAdapterè¢«æ›´æ¢æ—¶ï¼ŒmCacheViewså³è¢«ç¼“å­˜è‡³mRecyclerPool</td><td>é»˜è®¤ä¸Šé™ä¸º2ï¼Œå³ç¼“å­˜å±å¹•å¤–2ä¸ªItemView</td></tr><tr><td>mViewCacheExtension</td><td></td><td></td><td></td><td>ä¸ç›´æ¥ä½¿ç”¨ï¼Œéœ€è¦ç”¨æˆ·è‡ªå·±å®šåˆ¶ï¼Œé»˜è®¤ä¸å®ç°</td></tr><tr><td>mRecyclerPool</td><td>å¦</td><td>æ˜¯</td><td>ä¸è‡ªèº«ç”Ÿå‘½å‘¨æœŸä¸€è‡´ï¼Œä¸å†è¢«å¼•ç”¨æ—¶å³è¢«é‡Šæ”¾</td><td>é»˜è®¤ä¸Šé™ä¸º5ï¼ŒæŠ€æœ¯ä¸Šå¯ä»¥å®ç°æ‰€æœ‰RecyclerViewPoolå…±ç”¨åŒä¸€ä¸ª</td></tr></tbody></table><h3 id="æºç èµ°æŸ¥"><a href="#æºç èµ°æŸ¥" class="headerlink" title="æºç èµ°æŸ¥"></a>æºç èµ°æŸ¥</h3><ol><li><p>å¤ç”¨</p><table><thead><tr><th>å¸ƒå±€</th><th>æ»‘åŠ¨</th></tr></thead><tbody><tr><td>RecyclerView.onLayout(â€¦)</td><td>RecyclerView.onTouchEvent(â€¦)</td></tr><tr><td>-&gt; RecyclerView.dispatchLayout()</td><td>-&gt; MotionEvent.ACTION_MOVE</td></tr><tr><td>-&gt; RecyclerView.dispatchLayoutStep2()</td><td>-&gt; RecyclerView.scrollByInternal(â€¦)</td></tr><tr><td>-&gt; mLayout.onLayoutChildren(mRecycler, mState)</td><td>-&gt; RecyclerView.scrollStep(â€¦)</td></tr><tr><td>-&gt; LinearLayoutManager.onLayoutChildren(â€¦)</td><td>-&gt; LinearLayoutManager.scrollHorizontallyBy(â€¦)</td></tr><tr><td>-&gt; LinearLayoutManager.fill(â€¦)</td><td>-&gt; LinearLayoutManager.scrollBy(â€¦)</td></tr><tr><td>-&gt; LinearLayoutManager.layoutChunk(recycler, layoutState)</td><td>-&gt; LinearLayoutManager.fill(â€¦)</td></tr><tr><td>-&gt; LinearLayoutManager.LayoutState.next(recycler)</td><td>-&gt; â€¦â€¦</td></tr><tr><td>-&gt; RecyclerView.Recycler.getViewForPosition(int)</td><td></td></tr><tr><td>-&gt; Recycler.getViewForPosition(int, boolean)</td><td></td></tr><tr><td>-&gt; Recycler.tryGetViewHolderForPositionByDeadline(â€¦)</td><td></td></tr></tbody></table><img src="/f1832120/11.webp"></li><li><p>ç¼“å­˜</p><p>æ²¡æœ‰ç¼“å­˜é‚£æ€ä¹ˆå¤ç”¨ï¼Ÿæ‰€ä»¥å»fill()å¤ç”¨å‰æ‰¾ç¼“å­˜çš„æ–¹æ³•å‡½æ•°ã€‚</p><table><thead><tr><th>å¸ƒå±€</th></tr></thead><tbody><tr><td>LinearLayoutManager.fill(â€¦)ä¹‹å‰</td></tr><tr><td>-&gt; RecyclerView.detachAndScrapAttachedViews(â€¦)</td></tr><tr><td>-&gt; RecyclerView.scrapOrRecycleView()</td></tr><tr><td>-&gt; recycler.recycleViewHolderInternal()å’Œrecycler.scrapView()</td></tr><tr><td>-&gt; åè€…æ˜¯æœ‰æ•ˆæ—¶ï¼ŒåŠ è¿›ç¬¬ä¸€çº§ç¼“å­˜ï¼Œéæœ¬æ¬¡é‡ç‚¹</td></tr><tr><td>-&gt; recycler.recycleViewHolderInternal()</td></tr><tr><td>-&gt; (cachedViewSizeã€recycleCachedViewAt())</td></tr><tr><td>-&gt; addViewHolderToRecycledViewPool()</td></tr><tr><td>-&gt; getRecycledViewPool().putRecycledView()</td></tr><tr><td>-&gt; å·²æ»¡ç›´æ¥returnï¼Œæœªæ»¡å°±æ¸…é™¤æ•°æ®åadd</td></tr></tbody></table><img src="/f1832120/12.webp"></li></ol><h3 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h3><h4 id="ViewCacheExtensionçš„ä½¿ç”¨åœºæ™¯ä¸å®ç°"><a href="#ViewCacheExtensionçš„ä½¿ç”¨åœºæ™¯ä¸å®ç°" class="headerlink" title="ViewCacheExtensionçš„ä½¿ç”¨åœºæ™¯ä¸å®ç°"></a>ViewCacheExtensionçš„ä½¿ç”¨åœºæ™¯ä¸å®ç°</h4><p>RecyclerViewä¸­çš„å…¶ä»–ç¼“å­˜ï¼šç¬¬ä¸€çº§ç¼“å­˜mAttachedScrapç”¨æ¥å¤„ç†å¯è§å±å¹•çš„ç¼“å­˜ï¼›ç¬¬äºŒçº§ç¼“å­˜mCachedViewsé‡Œå­˜å‚¨çš„æ•°æ®è™½ç„¶æ˜¯æ ¹æ®positionæ¥ç¼“å­˜ï¼Œä½†æ˜¯é‡Œé¢çš„æ•°æ®éšæ—¶å¯èƒ½ä¼šè¢«æ›¿æ¢çš„ï¼›ç¬¬å››çº§ç¼“å­˜mRecyclerPoolé‡ŒæŒ‰viewTypeå»å­˜å‚¨ArrayList<viewholder>ï¼Œæ‰€ä»¥mRecyclerPoolå¹¶ä¸èƒ½æŒ‰positionå»å­˜å‚¨ViewHolderï¼Œè€Œä¸”ä»mRecyclerPoolå–å‡ºçš„Viewæ¯æ¬¡éƒ½è¦å»èµ°Adapter#onBindViewHolderå»é‡æ–°ç»‘å®šæ•°æ®ã€‚</viewholder></p><p>æ‰€ä»¥å‡å¦‚ç°åœ¨éœ€è¦åœ¨ä¸€ä¸ªç‰¹å®šçš„ä½ç½®ï¼ˆæ¯”å¦‚position&#x3D;0ä½ç½®ï¼‰ä¸€ç›´å±•ç¤ºæŸä¸ªViewï¼Œä¸”é‡Œé¢çš„å†…å®¹æ˜¯ä¸å˜çš„ï¼Œé‚£ä¹ˆæœ€å¥½çš„æƒ…å†µå°±æ˜¯åœ¨ç‰¹å®šä½ç½®æ—¶ï¼Œæ—¢ä¸éœ€è¦æ¯æ¬¡é‡æ–°åˆ›å»ºViewï¼Œä¹Ÿä¸éœ€è¦æ¯æ¬¡éƒ½å»é‡æ–°ç»‘å®šæ•°æ®ï¼Œä¸Šé¢çš„å‡ ç§ç¼“å­˜æ˜¾ç„¶éƒ½æ˜¯ä¸é€‚ç”¨çš„ï¼Œè¿™ç§æƒ…å†µå¯ä»¥é€šè¿‡è‡ªå®šä¹‰ç¼“å­˜ViewCacheExtensionå®ç°ä¸Šè¿°éœ€æ±‚ã€‚</p><p>ViewCacheExtensioné€‚ç”¨åœºæ™¯ï¼šViewHolderä½ç½®å›ºå®šã€å†…å®¹å›ºå®šã€æ•°é‡æœ‰é™æ—¶ä½¿ç”¨ã€‚</p><h4 id="SparseArray"><a href="#SparseArray" class="headerlink" title="SparseArray"></a>SparseArray</h4><p>SparseArrayæ˜¯Androidé‡Œä¸º&lt;Interger,Object&gt;è¿™æ ·çš„Hashmapè€Œä¸“é—¨å†™çš„ç±»ï¼Œç›®çš„æ˜¯æé«˜å†…å­˜æ•ˆç‡ï¼Œå…¶æ ¸å¿ƒæ˜¯æŠ˜åŠæŸ¥æ‰¾å‡½æ•°ã€‚</p><p>SparseArrayæœ‰ä¸¤ä¸ªä¼˜ç‚¹ï¼š1. é¿å…äº†è‡ªåŠ¨è£…ç®±ï¼ˆç±»ä¼¼enumï¼‰2. æ•°æ®ç»“æ„ä¸ä¼šä¾èµ–äºå¤–éƒ¨å¯¹è±¡æ˜ å°„ï¼ˆæ•°ç»„æ•°æ®ç»“æ„æ¥ä¿å­˜æ˜ å°„ï¼‰ã€‚</p><hr><h2 id="å››ã€RecyclerViewåˆ·æ–°åˆ—è¡¨æ•°æ®çš„notifyDatasetChange-ä¸ºä»€ä¹ˆæ¶ˆè€—èµ„æºæ¯”å…¶ä»–åˆ·æ–°æ–¹æ³•å¤š"><a href="#å››ã€RecyclerViewåˆ·æ–°åˆ—è¡¨æ•°æ®çš„notifyDatasetChange-ä¸ºä»€ä¹ˆæ¶ˆè€—èµ„æºæ¯”å…¶ä»–åˆ·æ–°æ–¹æ³•å¤š" class="headerlink" title="å››ã€RecyclerViewåˆ·æ–°åˆ—è¡¨æ•°æ®çš„notifyDatasetChange()ä¸ºä»€ä¹ˆæ¶ˆè€—èµ„æºæ¯”å…¶ä»–åˆ·æ–°æ–¹æ³•å¤š"></a>å››ã€RecyclerViewåˆ·æ–°åˆ—è¡¨æ•°æ®çš„notifyDatasetChange()ä¸ºä»€ä¹ˆæ¶ˆè€—èµ„æºæ¯”å…¶ä»–åˆ·æ–°æ–¹æ³•å¤š</h2><h3 id="RecyclerView-Adapterä¸­åˆ·æ–°æ•°æ®çš„æ–¹æ³•"><a href="#RecyclerView-Adapterä¸­åˆ·æ–°æ•°æ®çš„æ–¹æ³•" class="headerlink" title="RecyclerView.Adapterä¸­åˆ·æ–°æ•°æ®çš„æ–¹æ³•"></a>RecyclerView.Adapterä¸­åˆ·æ–°æ•°æ®çš„æ–¹æ³•</h3><ol><li><p>notifyDataSetChanged()</p><p>æ­¤æ–¹æ³•è·ŸListViewçš„Adapterçš„æ–¹æ³•ä¸€æ ·</p></li><li><p>notifyItemChanged(int position)</p><p>å½“positionä½ç½®çš„æ•°æ®å‘ç”Ÿäº†æ”¹å˜æ—¶å°±ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå°±ä¼šå›è°ƒå¯¹åº”positionçš„onBindViewHolder()æ–¹æ³•äº†ï¼Œå½“ç„¶ï¼Œå› ä¸ºViewHolderæ˜¯å¤ç”¨çš„ï¼Œæ‰€ä»¥å¦‚æœpositionåœ¨å½“å‰å±å¹•ä»¥å¤–ï¼Œå› ä¸ºæ²¡æœ‰æ„ä¹‰ä¹Ÿå°±ä¸ä¼šå›è°ƒäº†ï¼Œä¸‹æ¬¡positionæ»šåŠ¨ä¼šå½“å‰å±å¹•ä»¥å†…çš„æ—¶å€™åŒæ ·ä¼šè°ƒç”¨onBindViewHolder()æ–¹æ³•åˆ·æ–°æ•°æ®äº†ã€‚å…¶ä»–çš„æ–¹æ³•ä¹Ÿæ˜¯åŒæ ·çš„é“ç†ã€‚</p><p>å…¶å®ƒï¼šnotifyItemRangeChanged(int positionStart, int itemCount)â€¦â€¦ï¼ˆåŒ…æ‹¬æ’å…¥ã€ç§»åŠ¨ã€åˆ é™¤ã€æ‰¹é‡æ“ä½œï¼‰</p><p>å½“åˆ—è¡¨æ•°æ®å˜æ›´æ—¶ï¼Œè°ƒç”¨notifyDataSetChanged()æ˜¯æœ€çœäº‹çš„ã€‚æ— éœ€å…³å¿ƒå˜æ›´çš„ç»†èŠ‚ï¼Œä½†è¿™æ ·åšä¹Ÿæ˜¯æœ€æ˜‚è´µçš„ã€‚</p></li></ol><h3 id="è§‚å¯Ÿè€…æ¨¡å¼"><a href="#è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="è§‚å¯Ÿè€…æ¨¡å¼"></a>è§‚å¯Ÿè€…æ¨¡å¼</h3><ol><li><p>Adapter.notifyDataSetChanged() å°†åˆ·æ–°æ“ä½œå§”æ‰˜ç»™ AdapterDataObservable</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Adapter</span>&lt;VH <span class="keyword">extends</span> <span class="title class_">ViewHolder</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">AdapterDataObservable</span> <span class="variable">mObservable</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AdapterDataObservable</span>();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">notifyDataSetChanged</span><span class="params">()</span> &#123;</span><br><span class="line">        mObservable.notifyChanged();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>AdapterDataObservable æ˜¯ RecyclerView çš„é™æ€å†…éƒ¨ç±»ï¼Œå®ƒç»§æ‰¿è‡ªObservableï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">AdapterDataObservable</span> <span class="keyword">extends</span> <span class="title class_">Observable</span>&lt;AdapterDataObserver&gt; &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">notifyChanged</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// éå†æ‰€æœ‰è§‚å¯Ÿè€…å¹¶å§”æ‰˜ä¹‹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> mObservers.size() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            mObservers.get(i).onChanged();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>Adapter æ•°æ®çš„è§‚å¯Ÿè€…çš„æ³¨å†Œæ—¶é—´ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAdapter</span><span class="params">(<span class="meta">@Nullable</span> Adapter adapter)</span> &#123;</span><br><span class="line">    setLayoutFrozen(<span class="literal">false</span>);</span><br><span class="line">    setAdapterInternal(adapter, <span class="literal">false</span>, <span class="literal">true</span>);</span><br><span class="line">    processDataSetCompletelyChanged(<span class="literal">false</span>);</span><br><span class="line">    requestLayout();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸º RecyclerView è®¾ç½® Adapter</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">setAdapterInternal</span><span class="params">(<span class="meta">@Nullable</span> Adapter adapter, <span class="type">boolean</span> compatibleWithPrevious, <span class="type">boolean</span> removeAndRecycleViews)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (mAdapter != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// ç§»é™¤ä¹‹å‰çš„è§‚å¯Ÿè€…</span></span><br><span class="line">        mAdapter.unregisterAdapterDataObserver(mObserver);</span><br><span class="line">        mAdapter.onDetachedFromRecyclerView(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">final</span> <span class="type">Adapter</span> <span class="variable">oldAdapter</span> <span class="operator">=</span> mAdapter;</span><br><span class="line">    mAdapter = adapter;</span><br><span class="line">    <span class="keyword">if</span> (adapter != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// æ³¨å†Œæ–°çš„è§‚å¯Ÿè€…</span></span><br><span class="line">        adapter.registerAdapterDataObserver(mObserver);</span><br><span class="line">        adapter.onAttachedToRecyclerView(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Adapter</span>&lt;VH <span class="keyword">extends</span> <span class="title class_">ViewHolder</span>&gt; &#123;</span><br><span class="line">    <span class="comment">// æ³¨å†Œè§‚å¯Ÿè€…</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registerAdapterDataObserver</span><span class="params">(<span class="meta">@NonNull</span> AdapterDataObserver observer)</span> &#123;</span><br><span class="line">        mObservable.registerObserver(observer);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>Observableæ˜¯ä¸€ä¸ªæŠ½è±¡çš„å¯è¢«è§‚å¯Ÿè€…ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¢«è§‚å¯Ÿè€…, æ³›å‹è¡¨ç¤ºè§‚å¯Ÿè€…çš„ç±»å‹</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Observable</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="comment">// è§‚å¯Ÿè€…åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">final</span> ArrayList&lt;T&gt; mObservers = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;T&gt;();</span><br><span class="line">    <span class="comment">// æ³¨å†Œè§‚å¯Ÿè€…</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registerObserver</span><span class="params">(T observer)</span> &#123;</span><br><span class="line">        ...</span><br><span class="line">        mObservers.add(observer);</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ³¨é”€è§‚å¯Ÿè€…</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">unregisterObserver</span><span class="params">(T observer)</span> &#123;</span><br><span class="line">        ...</span><br><span class="line">        mObservers.remove(index);</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ç§»é™¤æ‰€æœ‰è§‚å¯Ÿè€…</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">unregisterAll</span><span class="params">()</span> &#123;</span><br><span class="line">        ...</span><br><span class="line">        mObservers.clear();</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>åœ¨ä¸º RecyclerView ç»‘å®š Adapter çš„æ—¶å€™ï¼Œä¸€ä¸ªè§‚å¯Ÿè€…å®ä¾‹RecyclerViewDataObserverè¢«æ³¨å†Œäº†ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">RecyclerViewDataObserver</span> <span class="keyword">extends</span> <span class="title class_">AdapterDataObserver</span> &#123;</span><br><span class="line">    RecyclerViewDataObserver() &#123;&#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onChanged</span><span class="params">()</span> &#123;</span><br><span class="line">        assertNotInLayoutOrScroll(<span class="literal">null</span>);</span><br><span class="line">        mState.mStructureChanged = <span class="literal">true</span>;</span><br><span class="line">        processDataSetCompletelyChanged(<span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">if</span> (!mAdapterHelper.hasPendingUpdates()) &#123;</span><br><span class="line">            requestLayout();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="onChange-æ›´æ–°å‰çš„å…¨é‡æ— æ•ˆåŒ–"><a href="#onChange-æ›´æ–°å‰çš„å…¨é‡æ— æ•ˆåŒ–" class="headerlink" title="onChange()æ›´æ–°å‰çš„å…¨é‡æ— æ•ˆåŒ–"></a>onChange()æ›´æ–°å‰çš„å…¨é‡æ— æ•ˆåŒ–</h3><ol><li><p>RecyclerView éå†äº†å½“å‰æ‰€æœ‰å·²ç»è¢«åŠ è½½çš„è¡¨é¡¹ï¼Œå¹¶ä¸ºå…¶ ViewHolder æ·»åŠ  FLAG_UPDATE å’Œ FLAT_INVALID æ ‡å¿—ä½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">processDataSetCompletelyChanged</span><span class="params">(<span class="type">boolean</span> dispatchItemsChanged)</span> &#123;</span><br><span class="line">    mDispatchItemsChangedEvent |= dispatchItemsChanged;</span><br><span class="line">    mDataSetHasChangedAfterLayout = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">// å°†å½“å‰æ‰€æœ‰è¡¨é¡¹æ— æ•ˆåŒ–</span></span><br><span class="line">    markKnownViewsInvalid();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">markKnownViewsInvalid</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// éå†åˆ—è¡¨æ‰€æœ‰è¡¨é¡¹</span></span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> <span class="variable">childCount</span> <span class="operator">=</span> mChildHelper.getUnfilteredChildCount();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; childCount; i++) &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">ViewHolder</span> <span class="variable">holder</span> <span class="operator">=</span> getChildViewHolderInt(mChildHelper.getUnfilteredChildAt(i));</span><br><span class="line">        <span class="comment">// åˆ—è¡¨ä¸­æ¯ä¸ªè¡¨é¡¹çš„ ViewHolder æ·»åŠ  FLAG_UPDATE å’Œ FLAG_INVALID æ ‡å¿—ä½</span></span><br><span class="line">        <span class="keyword">if</span> (holder != <span class="literal">null</span> &amp;&amp; !holder.shouldIgnore()) &#123;</span><br><span class="line">            holder.addFlags(ViewHolder.FLAG_UPDATE | ViewHolder.FLAG_INVALID);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    markItemDecorInsetsDirty();</span><br><span class="line">    <span class="comment">// å°†ç¼“å­˜ä¸­è¡¨é¡¹æ— æ•ˆåŒ–</span></span><br><span class="line">    mRecycler.markKnownViewsInvalid();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>RecyclerView å°†æ‰€æœ‰ç¦»å±ç¼“å­˜ä¸­çš„ ViewHolder ä¹Ÿéƒ½åšäº†æ— æ•ˆåŒ–å¤„ç†ï¼Œå›æ”¶åˆ°ç¼“å­˜æ± ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">Recycler</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">markKnownViewsInvalid</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// éå†æ‰€æœ‰ç¦»å±ç¼“å­˜</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">int</span> <span class="variable">cachedCount</span> <span class="operator">=</span> mCachedViews.size();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; cachedCount; i++) &#123;</span><br><span class="line">            <span class="keyword">final</span> <span class="type">ViewHolder</span> <span class="variable">holder</span> <span class="operator">=</span> mCachedViews.get(i);</span><br><span class="line">            <span class="comment">// å°†æ¯ä¸ªç¦»å±ç¼“å­˜ä¸­çš„ ViewHolder ä¹Ÿæ·»åŠ  FLAG_UPDATE å’Œ FLAG_INVALID æ ‡å¿—ä½</span></span><br><span class="line">            <span class="keyword">if</span> (holder != <span class="literal">null</span>) &#123;</span><br><span class="line">                holder.addFlags(ViewHolder.FLAG_UPDATE | ViewHolder.FLAG_INVALID);</span><br><span class="line">                holder.addChangePayload(<span class="literal">null</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (mAdapter == <span class="literal">null</span> || !mAdapter.hasStableIds()) &#123;</span><br><span class="line">            <span class="comment">// å°†ç¦»å±ç¼“å­˜ä¸­çš„ ViewHolder å­˜å…¥ç¼“å­˜æ± </span></span><br><span class="line">            recycleAndClearCachedViews();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="çœŸæ­£çš„åˆ·æ–°"><a href="#çœŸæ­£çš„åˆ·æ–°" class="headerlink" title="çœŸæ­£çš„åˆ·æ–°"></a>çœŸæ­£çš„åˆ·æ–°</h3><p>åœ¨å°†ä¸€åˆ‡éƒ½æ— æ•ˆåŒ–åï¼Œè°ƒç”¨äº†View.requestLayout()ï¼Œå³è¯·æ±‚é‡æ–°å¸ƒå±€ï¼Œè¯¥è¯·æ±‚ä¼šä¸æ–­åœ°å‘çˆ¶æ§ä»¶ä¼ é€’</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">requestLayout</span><span class="params">()</span> &#123;</span><br><span class="line">        ...</span><br><span class="line">        <span class="comment">// æ·»åŠ ä¸¤ä¸ªæ ‡å¿—ä½</span></span><br><span class="line">        mPrivateFlags |= PFLAG_FORCE_LAYOUT;</span><br><span class="line">        mPrivateFlags |= PFLAG_INVALIDATED;</span><br><span class="line">        <span class="comment">// å‘çˆ¶æ§ä»¶ä¼ é€’é‡ç»˜è¯·æ±‚</span></span><br><span class="line">        <span class="keyword">if</span> (mParent != <span class="literal">null</span> &amp;&amp; !mParent.isLayoutRequested()) &#123;</span><br><span class="line">            mParent.requestLayout();</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ—è¡¨çš„é‡æ–°å¸ƒå±€æ„å‘³ç€é‡æ–°å¸ƒå±€å…¶ä¸­çš„æ¯ä¸€ä¸ªè¡¨é¡¹ï¼Œä½“ç°åœ¨ä»£ç ä¸Šå³æ˜¯LinearLayoutManager.onLayoutChildren()ï¼ˆholder.needsUpdate() || holder.isInvalid()ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LinearLayoutManager</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onLayoutChildren</span><span class="params">(RecyclerView.Recycler recycler, RecyclerView.State state)</span> &#123;</span><br><span class="line">        ...</span><br><span class="line">        fill();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ€»ç»“</li></ul><ol><li><p>RecyclerView ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼åˆ·æ–°è‡ªå·±ï¼Œåˆ·æ–°å³æ˜¯é€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…ã€‚</p></li><li><p>è§‚å¯Ÿè€…æ˜¯RecyclerViewDataObserverï¼ˆæŠ½è±¡ä¸ºAdapterDataObserverï¼‰ï¼Œå®ƒä»¬ç»´æŠ¤åœ¨RecyclerViewçš„é™æ€å†…éƒ¨ç±»AdapterDataObservableä¸­ï¼Œå‚¨å­˜çš„æ•°æ®ç»“æ„æ˜¯ArrayList<t>ã€‚</t></p></li><li><p>RecyclerView åœ¨çœŸæ­£åˆ·æ–°åˆ—è¡¨ä¹‹å‰ï¼Œä½¿ç”¨processDataSetCompletelyChanged(true);å°†ä¸€åˆ‡éƒ½æ— æ•ˆåŒ–äº†ï¼ŒåŒ…æ‹¬å½“å‰æ‰€æœ‰è¢«å¡«å……è¡¨é¡¹åŠç¦»å±ç¼“å­˜ä¸­çš„ ViewHolder å®ä¾‹ã€‚æ— æ•ˆåŒ–ä½“ç°åœ¨ä»£ç ä¸Šå³æ˜¯ä¸º ViewHolder æ·»åŠ  FLAG_UPDATE å’Œ FLAG_INVALID æ ‡å¿—ä½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">holder.addFlags(ViewHolder.FLAG_UPDATE | ViewHolder.FLAG_INVALID);</span><br></pre></td></tr></table></figure></li><li><p>RecyclerView.requestLayout();æ˜¯é©±åŠ¨åˆ—è¡¨åˆ·æ–°çš„æºå¤´ï¼Œè¯¥æ–¹æ³•ä¼šä»æ ¹è§†å›¾è‡ªé¡¶å‘ä¸‹è¿›è¡Œé‡ç»˜ã€‚RecyclerViewçš„é‡ç»˜è¡¨ç°ä¸ºé‡æ–°å¸ƒå±€æ‰€æœ‰è¡¨é¡¹ã€‚</p></li><li><p>RecyclerViewé‡æ–°å¸ƒå±€æ‰€æœ‰è¡¨é¡¹ï¼šå…ˆå›æ”¶ç°æœ‰è¡¨é¡¹åˆ°ç¼“å­˜æ± ï¼Œå†é‡æ–°å¡«å……ä»–ä»¬ã€‚å› ä¸ºå›æ”¶æ—¶ViewHolderéƒ½è¢«æ·»åŠ äº†æ— æ•ˆåŒ–çš„ä¸¤ä¸ªæ ‡å¿—ä½ï¼Œæ‰€ä»¥é‡ç»˜æ—¶å³ä½¿æ•°æ®æ²¡å˜ä¹Ÿéœ€è¦é‡æ–°ç»‘å®šæ•°æ®ï¼Œå¯¼è‡´èµ„æºæ¶ˆè€—æ¯”è¾ƒæ˜‚è´µã€‚</p></li></ol></div><footer class="post-footer"><div class="post-nav"><div class="post-nav-item"><a href="/d21f647b.html" rel="prev" title="ä¸€ç§åŸºäºè§†è§‰å’Œå¬è§‰ç›¸ç»“åˆçš„æ·±åº¦è·¨åŸŸæƒ…ç»ªè¯†åˆ«ç½‘ç»œ"><i class="fa fa-chevron-left"></i> ä¸€ç§åŸºäºè§†è§‰å’Œå¬è§‰ç›¸ç»“åˆçš„æ·±åº¦è·¨åŸŸæƒ…ç»ªè¯†åˆ«ç½‘ç»œ</a></div><div class="post-nav-item"><a href="/a312c491.html" rel="next" title="ERICA:é€šè¿‡å¯¹æ¯”å­¦ä¹ æé«˜é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„å®ä½“å’Œå…³ç³»ç†è§£">ERICA:é€šè¿‡å¯¹æ¯”å­¦ä¹ æé«˜é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„å®ä½“å’Œå…³ç³»ç†è§£ <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="valine-comments"></div><script>window.addEventListener("tabs:register",()=>{let t=CONFIG.comments["activeClass"];var e;(t=CONFIG.comments.storage?localStorage.getItem("comments_active")||t:t)&&(e=document.querySelector(`a[href="#comment-${t}"]`))&&e.click()}),CONFIG.comments.storage&&window.addEventListener("tabs:click",t=>{t.target.matches(".tabs-comment .tab-content .tab-pane")&&(t=t.target.classList[1],localStorage.setItem("comments_active",t))})</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">æ–‡ç« ç›®å½•</li><li class="sidebar-nav-overview">ç«™ç‚¹æ¦‚è§ˆ</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81RecyclerView%E4%B8%8EListView%E3%80%81ViewPager"><span class="nav-number">1.</span> <span class="nav-text">ä¸€ã€RecyclerViewä¸ListViewã€ViewPager</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#RecyclerView"><span class="nav-number">1.1.</span> <span class="nav-text">RecyclerView</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ListView%E5%92%8CRecyclerView"><span class="nav-number">1.2.</span> <span class="nav-text">ListViewå’ŒRecyclerView</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ViewPager%E5%92%8CViewPager2%EF%BC%88RecyclerView%EF%BC%89"><span class="nav-number">1.3.</span> <span class="nav-text">ViewPagerå’ŒViewPager2ï¼ˆRecyclerViewï¼‰</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81RecyclerView%E5%9C%A8TV%E4%B8%8A%E7%9A%84%E5%BA%94%E7%94%A8"><span class="nav-number">2.</span> <span class="nav-text">äºŒã€RecyclerViewåœ¨TVä¸Šçš„åº”ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%9F%E7%94%9FRecyclerView%E4%BD%BF%E7%94%A8%E6%97%B6%E7%9A%84%E5%B1%80%E9%99%90%E6%80%A7"><span class="nav-number">2.1.</span> <span class="nav-text">åŸç”ŸRecyclerViewä½¿ç”¨æ—¶çš„å±€é™æ€§</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#RecyclerView%E5%88%B7%E6%96%B0%E6%95%B0%E6%8D%AE%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E7%84%A6%E7%82%B9%E9%94%99%E4%B9%B1%E9%97%AE%E9%A2%98"><span class="nav-number">2.1.1.</span> <span class="nav-text">RecyclerViewåˆ·æ–°æ•°æ®çš„æ—¶å€™ï¼Œç„¦ç‚¹é”™ä¹±é—®é¢˜</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%95%BF%E6%8C%89%E9%81%A5%E6%8E%A7%E5%99%A8RecyclerView%E5%BF%AB%E9%80%9F%E6%BB%91%E5%8A%A8%EF%BC%8C%E7%84%A6%E7%82%B9%E9%94%99%E4%B9%B1%E9%97%AE%E9%A2%98"><span class="nav-number">2.1.2.</span> <span class="nav-text">é•¿æŒ‰é¥æ§å™¨RecyclerViewå¿«é€Ÿæ»‘åŠ¨ï¼Œç„¦ç‚¹é”™ä¹±é—®é¢˜</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3RecyclerView-%E5%AE%9A%E4%BD%8D%E5%88%B0%E6%9F%90%E4%B8%AAitem%E4%B8%8D%E8%8E%B7%E5%8F%96%E7%84%A6%E7%82%B9%E9%97%AE%E9%A2%98"><span class="nav-number">2.1.3.</span> <span class="nav-text">è§£å†³RecyclerView å®šä½åˆ°æŸä¸ªitemä¸è·å–ç„¦ç‚¹é—®é¢˜</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Android-TV-%E4%B8%ADRecyclerView%E8%81%9A%E7%84%A6Item%E5%AE%9E%E7%8E%B0%E5%B1%85%E4%B8%AD%E5%8A%9F%E8%83%BD"><span class="nav-number">2.1.4.</span> <span class="nav-text">Android TV ä¸­RecyclerViewèšç„¦Itemå®ç°å±…ä¸­åŠŸèƒ½</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E3%80%81RecyclerView%E7%BC%93%E5%AD%98%E4%B8%8E%E5%A4%8D%E7%94%A8%E5%8E%9F%E7%90%86"><span class="nav-number">3.</span> <span class="nav-text">ä¸‰ã€RecyclerViewç¼“å­˜ä¸å¤ç”¨åŸç†</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%9B%E7%BA%A7%E7%BC%93%E5%AD%98"><span class="nav-number">3.1.</span> <span class="nav-text">å››çº§ç¼“å­˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BA%90%E7%A0%81%E8%B5%B0%E6%9F%A5"><span class="nav-number">3.2.</span> <span class="nav-text">æºç èµ°æŸ¥</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A5%E5%85%85"><span class="nav-number">3.3.</span> <span class="nav-text">è¡¥å……</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ViewCacheExtension%E7%9A%84%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF%E4%B8%8E%E5%AE%9E%E7%8E%B0"><span class="nav-number">3.3.1.</span> <span class="nav-text">ViewCacheExtensionçš„ä½¿ç”¨åœºæ™¯ä¸å®ç°</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SparseArray"><span class="nav-number">3.3.2.</span> <span class="nav-text">SparseArray</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9B%E3%80%81RecyclerView%E5%88%B7%E6%96%B0%E5%88%97%E8%A1%A8%E6%95%B0%E6%8D%AE%E7%9A%84notifyDatasetChange-%E4%B8%BA%E4%BB%80%E4%B9%88%E6%B6%88%E8%80%97%E8%B5%84%E6%BA%90%E6%AF%94%E5%85%B6%E4%BB%96%E5%88%B7%E6%96%B0%E6%96%B9%E6%B3%95%E5%A4%9A"><span class="nav-number">4.</span> <span class="nav-text">å››ã€RecyclerViewåˆ·æ–°åˆ—è¡¨æ•°æ®çš„notifyDatasetChange()ä¸ºä»€ä¹ˆæ¶ˆè€—èµ„æºæ¯”å…¶ä»–åˆ·æ–°æ–¹æ³•å¤š</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#RecyclerView-Adapter%E4%B8%AD%E5%88%B7%E6%96%B0%E6%95%B0%E6%8D%AE%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-number">4.1.</span> <span class="nav-text">RecyclerView.Adapterä¸­åˆ·æ–°æ•°æ®çš„æ–¹æ³•</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F"><span class="nav-number">4.2.</span> <span class="nav-text">è§‚å¯Ÿè€…æ¨¡å¼</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#onChange-%E6%9B%B4%E6%96%B0%E5%89%8D%E7%9A%84%E5%85%A8%E9%87%8F%E6%97%A0%E6%95%88%E5%8C%96"><span class="nav-number">4.3.</span> <span class="nav-text">onChange()æ›´æ–°å‰çš„å…¨é‡æ— æ•ˆåŒ–</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9C%9F%E6%AD%A3%E7%9A%84%E5%88%B7%E6%96%B0"><span class="nav-number">4.4.</span> <span class="nav-text">çœŸæ­£çš„åˆ·æ–°</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Aisaka Aoi" src="/images/manatsu.jpg"><p class="site-author-name" itemprop="name">Aisaka Aoi</p><div class="site-description" itemprop="description">é€¢å‚è‘µçš„ä¸ªäººåšå®¢</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">1034</span> <span class="site-state-item-name">æ—¥å¿—</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">20</span> <span class="site-state-item-name">åˆ†ç±»</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/AisakaAoi" title="GitHub ğŸ‘¨â€ğŸ’» â†’ https:&#x2F;&#x2F;github.com&#x2F;AisakaAoi" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub ğŸ‘¨â€ğŸ’»</a> </span><span class="links-of-author-item"><a href="https://github.com/Aisakaorz" title="GitHub ğŸ‘©â€ğŸ’» â†’ https:&#x2F;&#x2F;github.com&#x2F;Aisakaorz" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub ğŸ‘©â€ğŸ’»</a> </span><span class="links-of-author-item"><a href="mailto:aisakaaoi@qq.com" title="E-Mail ğŸ“§ â†’ mailto:aisakaaoi@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail ğŸ“§</a> </span><span class="links-of-author-item"><a href="mailto:chenzongnan@m.scnu.edu.cn" title="E-Mail ğŸ« â†’ mailto:chenzongnan@m.scnu.edu.cn" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail ğŸ«</a> </span><span class="links-of-author-item"><a href="https://space.bilibili.com/91560309" title="Bilibili ğŸ“º â†’ https:&#x2F;&#x2F;space.bilibili.com&#x2F;91560309" rel="noopener" target="_blank"><i class="fab fa-bilibili fa-fw"></i>Bilibili ğŸ“º</a> </span><span class="links-of-author-item"><a href="https://space.bilibili.com/198562921" title="Bilibili ğŸ® â†’ https:&#x2F;&#x2F;space.bilibili.com&#x2F;198562921" rel="noopener" target="_blank"><i class="fab fa-bilibili fa-fw"></i>Bilibili ğŸ®</a> </span><span class="links-of-author-item"><a href="https://www.youtube.com/channel/UCALvyn5Cl76GCotO9pczvjg" title="YouTube ğŸ“º â†’ https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCALvyn5Cl76GCotO9pczvjg" rel="noopener" target="_blank"><i class="fab fa-youtube fa-fw"></i>YouTube ğŸ“º</a></span></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2026</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Aisaka Aoi</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span class="post-meta-item-text">ç«™ç‚¹æ€»å­—æ•°ï¼š</span> <span title="ç«™ç‚¹æ€»å­—æ•°">4.1m</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span class="post-meta-item-text">ç«™ç‚¹é˜…è¯»æ—¶é•¿ &asymp;</span> <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">171:02</span></div><div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨</div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script>document.querySelectorAll(".pdfobject-container").forEach(e=>{var t=e.dataset.target,a="#"+Object.entries({navpanes:0,toolbar:0,statusbar:0,pagemode:"thumbs",view:"FitH"}).map(([e,t])=>e+"="+encodeURIComponent(t)).join("&"),r="/lib/pdf/web/viewer.html?file="+encodeURIComponent(t)+a;NexT.utils.supportsPDFs()?e.innerHTML=`<embed class="pdfobject" src="${t+a}" type="application/pdf" style="height: ${e.dataset.height};">`:e.innerHTML=`<iframe src="${r}" style="height: ${e.dataset.height};" frameborder="0"></iframe>`})</script><script>NexT.utils.loadComments(document.querySelector("#valine-comments"),()=>{NexT.utils.getScript("//unpkg.com/valine/dist/Valine.min.js",()=>{var i=["nick","mail","link"],e="nick,mail,link".split(",").filter(e=>i.includes(e));new Valine({el:"#valine-comments",verify:!0,notify:!0,appId:"UqjWdRYbIUEUQRXhBUUIh1QE-gzGzoHsz",appKey:"gj89JXC485PFbpdHLKVkz6dm",placeholder:"è¿™é‡Œå¯ä»¥å‘é€è¯„è®º~ï¼ˆä¸Šé¢å¯ä»¥è¾“å…¥æ˜µç§°ã€é‚®ç®±ï¼‰",avatar:"mm",meta:e,pageSize:"10",visitor:!0,lang:"zh-cn",path:location.pathname,recordIP:!1,serverURLs:""})},window.Valine)})</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/assets/haru02.model.json"},display:{position:"right",width:208,height:520},mobile:{show:!1},log:!1})</script></body></html>